window.__require=function t(e,n,o){function r(a,s){if(!n[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){return r(e[a][1][t]||t)},u,u.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<o.length;a++)r(o[a]);return r}({AStar:[function(t,e,n){"use strict";cc._RF.push(e,"b78e4u1GV5D7bzvXML2JVLE","AStar");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i=t("../constant/Constant"),a=function(){function t(){this.uid="0_0",this.point=cc.v2(0,0),this.parent=null,this.F=0,this.G=0,this.H=0,this.ignoreCheck=!1,this.isMovePoint=!0}return Object.defineProperty(t.prototype,"x",{get:function(){return this.point.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.point.y},enumerable:!1,configurable:!0}),t.prototype.init=function(t,e){return this.uid=t+"_"+e,this.point.set2(t,e),this.parent=null,this.F=0,this.G=0,this.H=0,this.ignoreCheck=!1,this.isMovePoint=!0,this},t.prototype.has=function(t,e){return this.point.x===t&&this.point.y===e},t.prototype.updateParent=function(t,e){this.parent=t,this.G=t.G+e,this.F=this.H+this.G},t}(),s=new(function(){function t(){this.nodePool=[]}return t.prototype.newNode=function(){return this.nodePool.length>0?this.nodePool.pop():new a},t.prototype.removeNode=function(t){this.nodePool.push(t)},t}()),c=function(){function t(){this.tempPathPoints=[],this.tempDisV2=cc.v2(),this.nodePool=[],this.nodePoolIdx=0,this.opened=[],this.closed={},this.dirPoints=[],this.dirCount=0,this.checkCanPass=null,this.area=null,this.mapHeight=0,this.mapWidth=0}return t.prototype.setDir=function(t){this.dirPoints=4===t?i.DIR_POINTS_4:i.DIR_POINTS_8,this.dirCount=this.dirPoints.length},t.prototype.clean=function(){this.checkCanPass=null,this.area=null,this.opened=null,this.closed=null,this.dirPoints=null,this.tempPathPoints=null,this.nodePool.forEach(function(t){s.removeNode(t)}),this.nodePool.length=0,this.nodePool=null},t.prototype.reset=function(){this.nodePoolIdx=0,this.opened.length=0,this.closed={},this.tempPathPoints.length=0;for(var t=Math.floor(.5*this.nodePool.length),e=0;e<t;e++){var n=this.nodePool.pop();s.removeNode(n)}},t.prototype.newNode=function(t,e){var n=this.nodePool[this.nodePoolIdx++];return n||(n=s.newNode(),this.nodePool.push(n)),n.init(t,e),n},t.prototype.inMapRange=function(t){return t.x>=0&&t.x<this.mapWidth&&t.y>=0&&t.y<this.mapHeight},t.prototype.checkCornerHasTile=function(t,e,n,o){return this.checkCanPass(t,e,this.area)&&this.checkCanPass(n,o,this.area)},t.prototype.searchPath=function(t,e,n,i){return o(this,void 0,Promise,function(){var o,a,s,c,l,u;return r(this,function(r){switch(r.label){case 0:if(!this.opened)return[2,[]];if(t.equals(e)||!this.inMapRange(e))return[2,[]];this.reset(),this.opened.push(this.newNode(t.x,t.y)),o=0,r.label=1;case 1:if(!(this.opened.length>0))return[3,4];if((a=this.opened.shift()).point.equals(e))return[2,Promise.resolve(this.genPoints(a,!!n,!!i))];for(this.closed[a.uid]=!0,s=!1,c=function(t){var n=l.dirPoints[t],o=a.x+n.point.x,r=a.y+n.point.y;if(a.ignoreCheck);else{if(!(e.equals2(o,r)||l.checkCanPass(o,r,l.area)&&!l.closed[o+"_"+r]))return"continue";if(8===l.dirCount&&1!==n.tag&&!l.checkCornerHasTile(o,a.y,a.x,r))return"continue"}s=!0;var i=l.opened.find(function(t){return t.point.equals2(o,r)});if(i)a.G+n.tag<i.G&&i.updateParent(a,n.tag);else{var c=l.newNode(o,r);c.H=e.sub(c.point,l.tempDisV2).mag(),c.updateParent(a,n.tag),l.opened.push(c)}},l=this,u=0;u<this.dirCount;u++)c(u);return s||this.checkCanPass(a.x,a.y,this.area)?a.ignoreCheck=!1:(this.opened.unshift(a),a.ignoreCheck=!0),this.opened.sort(function(t,e){return t.F-e.F}),++o>50?(o=0,[4,ut.waitNextFrame()]):[3,3];case 2:r.sent(),r.label=3;case 3:return this.opened?[3,1]:[2,[]];case 4:return[2,[]]}})})},t.prototype.genPoints=function(t,e,n){var o=this;for(this.tempPathPoints.length=0;null!==t.parent;)this.tempPathPoints.push(t.point),t=t.parent;if(this.tempPathPoints.reverse(),n&&this.tempPathPoints.length>1&&this.tempPathPoints.pop(),!e)for(var r=function(t){var e=i.tempPathPoints[t];i.dirPoints.some(function(t){return!o.checkCanPass(e.x+t.point.x,e.y+t.point.y,o.area)})||i.tempPathPoints.splice(t,1)},i=this,a=this.tempPathPoints.length-2;a>=1;a--)r(a);return this.tempPathPoints},t}();n.default=c,cc._RF.pop()},{"../constant/Constant":"Constant"}],AbTestHelper:[function(t,e,n){"use strict";cc._RF.push(e,"369a5RwbXhIVaVOYKVZSC6n","AbTestHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.abTestHelper=void 0;var i=t("./GameHelper"),a=function(){function t(){}return t.prototype.init=function(){return o(this,void 0,void 0,function(){var t,e=this;return r(this,function(){if(!ut.isWechatOrQQ()||!wx.uma)return[2];if(wx.uma.rc.setDefaultValues({show_ad_banner:"true",finger:"",first_guest:""}),0==(t=storageMgr.loadNumber("#testState_01")||0)){if(i.gameHelper.getHeart()>=25)return storageMgr.saveNumber("#testState_01",-1),[2];storageMgr.saveNumber("#testState_01",1)}else if(-1==t)return[2];return[2,new Promise(function(t){wx.uma.rc.fetch({active:!0,callback:function(n){lplog.info("ab fetch: ",n),e.active(),t(null)}})})]})})},t.prototype.active=function(){},t.prototype.getWxValue=function(t){var e;return ut.isWechatGame()&&wx.getExptInfoSync&&(null===(e=wx.getExptInfoSync([t]))||void 0===e?void 0:e[t])||""},t}();n.abTestHelper=new a,cc._RF.pop()},{"./GameHelper":"GameHelper"}],AdModel:[function(t,e,n){"use strict";cc._RF.push(e,"a1bd7ZxDNJCBoREgCpIaWFP","AdModel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../helper/DatabaseHelper"),l=t("../constant/Enums"),u=t("../helper/GameHelper"),p=t("./BannerAd"),h=t("./InterstitialAd"),d=t("./NativeAd"),f=t("./RewardAd"),y=t("./ShareAd"),_=t("../helper/ViewHelper"),g=t("../helper/ShareHelper"),m=t("../LocalConfig"),v=t("./EcpmLevelAd"),b=t("../event/JsbEvent"),w=t("../../../../startScene/version"),S=t("./GridAd"),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardAd=null,e.bannerAd=null,e.customeAd=null,e.interstitialAd=null,e.nativeAd=null,e.gamePortalAd=null,e.shareAd=null,e.isCreated=!1,e.bannerOffsetY=-1,e.startLoad=!1,e.startLoadNativeAd=!1,e.currAdType=null,e.exposureCount=0,e.abTestGroup=-1,e.adTime=0,e.last_ad_time=0,e.isSetPangleDIDOnce=!1,e}return r(e,t),e.prototype.getAdTime=function(){return this.adTime},e.prototype.getLastAdTime=function(){return this.last_ad_time},e.prototype.resetAdTime=function(){this.adTime=0},e.prototype.init=function(){if(!this.isCreated){this.isCreated=!0;var t=c.dbHelper.register("ad",1,this.toDB,this)||{};ut.isWechatOrQQ()?(this.rewardAd=new f.WxRewardAd(t.rewardAd),this.interstitialAd=new h.WxInterstitialAd,this.bannerAd=new S.WxGridAd,this.customeAd,new S.WxCustomerAd):ut.isMobile()?((u.gameHelper.isInland()&&ut.isAndroid()||u.gameHelper.isGLobal())&&jsbHelper.cast(b.default.INIT_AD),u.gameHelper.isInlandApp()&&(this.nativeAd=new d.AppNaitveAd,this.isSetPangleDIDOnce=t.isSetPangleDIDOnce||!1),this.rewardAd=new f.NativeRewardAd(t.rewardAd),u.gameHelper.getHeart()>=60&&(this.bannerAd=new p.NativeBannerAd),u.gameHelper.isGLobal()&&jsbHelper.on(b.default.GET_AD_INFO,function(){})):ut.isFBInstant()?(this.rewardAd=new f.FBInstantRewardAd(0),u.gameHelper.getHeart()>=60&&(this.bannerAd=new p.FBInstantBannerAd)):w.default.IS_GAME_MONETIZE&&(this.rewardAd=new f.GameRewardAd(0)),this.shareAd=new y.ShareAd,this.shareAd.init(t.shareAd,this),this.currAdType=t.currAdType,this.load()}},e.prototype.toDB=function(){return{shareAd:this.shareAd&&this.shareAd.toDB(),currAdType:this.currAdType,exposureCount:this.exposureCount,last_ad_time:this.last_ad_time,isSetPangleDIDOnce:this.isSetPangleDIDOnce}},e.prototype.load=function(){this.intervalLoad(this.rewardAd),this.intervalLoadBanner(),this.intervalLoadCustome(),this.intervalLoad(this.shareAd),this.intervalLoad(this.nativeAd),this.intervalLoadInsert(this.interstitialAd),this.gamePortalAd&&this.gamePortalAd.load()},e.prototype.intervalLoadBanner=function(){var t=this;u.gameHelper.setInterval(function(){t.bannerAd?t.bannerAd.load(1):ut.isWechatOrQQ()?t.bannerAd=new p.WxBannerAd:ut.isMobile()?t.bannerAd=new p.NativeBannerAd:ut.isFBInstant()&&(t.bannerAd=new p.FBInstantBannerAd)},1*ut.Time.Second)},e.prototype.intervalLoadCustome=function(){var t=this;u.gameHelper.setInterval(function(){t.customeAd?t.customeAd.load(1):ut.isWechatOrQQ()&&(t.customeAd=new S.WxCustomerAd)},1*ut.Time.Second)},e.prototype.intervalLoad=function(t){t&&u.gameHelper.setInterval(function(){t.load(1)},1*ut.Time.Second)},e.prototype.intervalLoadInsert=function(t){t&&u.gameHelper.setInterval(function(){t.load(1)},1*ut.Time.Second)},e.prototype.initCurrentAd=function(t){if(t)return this.currAdType=t;if(this.currAdType==l.AdType.SHARE)if(this.isRewardAdReady())this.resetAd();else{if(this.exposureCount++,!(this.exposureCount>3||u.gameHelper.isGLobal()))return this.currAdType;this.resetAd()}var e=l.AdType.REWARD;return e=this.isRewardAdReady()?l.AdType.REWARD:l.AdType.SHARE,this.currAdType=e},e.prototype.isWorking=function(){return this.__lock_showAd},e.prototype.showAd=function(t,e){return a(this,void 0,Promise,function(){var n,o;return s(this,function(r){switch(r.label){case 0:return m.localConfig.isGm?[2,{status:l.RewardAdStatus.SUCCESS}]:(this.adTime=u.gameHelper.now(),(n=this.currAdType)!=l.AdType.REWARD?[3,2]:[4,this.showRewardAd(t,"",e)]);case 1:return o=r.sent(),[3,7];case 2:return n!=l.AdType.INTERSTITIAL?[3,4]:[4,this.showInterstitialAd(t)];case 3:return o=r.sent(),[3,7];case 4:return n!=l.AdType.SHARE?[3,6]:[4,this.showShareAd(t)];case 5:return o=r.sent(),[3,7];case 6:console.error("\u8bf7\u5728\u5f39\u7a97\u6253\u5f00\u65f6\u5148\u8c03\u7528this.initCurrentAd"),r.label=7;case 7:return o?(o.status==l.RewardAdStatus.SUCCESS?(this.resetAd(),this.initCurrentAd()):o.status==l.RewardAdStatus.FAIL?_.viewHelper.showAlert("toast.ad_not_finish"):o.status==l.RewardAdStatus.SHARE_FAIL?g.shareHelper.showFailToast():_.viewHelper.showAlert("toast.ad_fail"),[2,o]):(_.viewHelper.showAlert("toast.ad_fail"),[2,{status:l.RewardAdStatus.FAIL}])}})})},e.prototype.isAdReady=function(t){if(cc.sys.isBrowser&&!ut.isFBInstant()&&m.localConfig.isGm)return!0;var e=this.currAdType;return e==l.AdType.REWARD?this.isRewardAdReady(!!t):e==l.AdType.INTERSTITIAL?this.isInterstitialAdReady():e==l.AdType.SHARE&&this.isShareReady()},e.prototype.isCanShowShare=function(){var t;return null===(t=this.rewardAd)||void 0===t?void 0:t.isCanShare()},e.prototype.initiativeLoad=function(){var t;null===(t=this.rewardAd)||void 0===t||t.initiativeLoad()},e.prototype.destroyRewardAd=function(){var t;null===(t=this.rewardAd)||void 0===t||t.destroy()},e.prototype.reportShareBehavior=function(t){var e;null===(e=this.rewardAd)||void 0===e||e.reportShareBehavior(t)},e.prototype.getPlanBAD=function(){var t;return null===(t=this.rewardAd)||void 0===t?void 0:t.getPlanBAD()},e.prototype.resetAd=function(){this.currAdType=null,this.exposureCount=0},e.prototype.isType=function(t){return this.currAdType==t},e.prototype.showShareAd=function(t){return a(this,void 0,Promise,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.shareAd.show(t)];case 1:return[2,{status:e.sent()?l.RewardAdStatus.SUCCESS:l.RewardAdStatus.SHARE_FAIL}]}})})},e.prototype.isShareReady=function(){return!!this.shareAd&&this.shareAd.isReady()},e.prototype.isRewardAdOutOfUse=function(t){return void 0===t&&(t=16),!this.rewardAd||!this.isRewardAdReady()&&this.rewardAd.noSuitAdCount>=t},e.prototype.isRewardAdReady=function(t){return void 0===t&&(t=!1),!!this.rewardAd&&(this.startLoad||(this.startLoad=!0,this.rewardAd&&this.rewardAd.load(0)),this.rewardAd.isReady(t))},e.prototype.showRewardAd=function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=!1),a(this,void 0,Promise,function(){var t,o,r,i;return s(this,function(a){switch(a.label){case 0:return mc.lockTouch(!0),this.rewardAd instanceof f.NativeRewardAd||this.rewardAd instanceof v.EcpmLevelAd?(_.viewHelper.showLoadingWait(!0),[4,this.rewardAd.waitCacheReady()]):[3,2];case 1:if(t=a.sent(),_.viewHelper.showLoadingWait(!1),!t)return mc.lockTouch(!1),[2,{status:l.RewardAdStatus.LOAD_CACHE_FAIL}];a.label=2;case 2:return audioMgr.pauseAll(),o=u.gameHelper.now(),[4,this.rewardAd.show(e,n)];case 3:return r=a.sent(),i=u.gameHelper.now()-o,!ut.isWechatGame()&&i<3*ut.Time.Second&&(r=!1),audioMgr.resumeAll(),mc.lockTouch(!1),r&&(this.last_ad_time=o),[2,{status:r?l.RewardAdStatus.SUCCESS:l.RewardAdStatus.FAIL}]}})})},e.prototype.isInterstitialAdReady=function(){return this.interstitialAd&&this.interstitialAd.isReady()},e.prototype.showInterstitialAd=function(){return a(this,void 0,Promise,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return ut.isWechatGame()?(mc.lockTouch(!0),this.interstitialAd instanceof h.NativeInterstitialAd?(_.viewHelper.showLoadingWait(!0),[4,this.interstitialAd.waitCacheReady()]):[3,2]):[2];case 1:if(t=n.sent(),_.viewHelper.showLoadingWait(!1),!t)return mc.lockTouch(!1),[2,{status:l.RewardAdStatus.LOAD_CACHE_FAIL}];n.label=2;case 2:return[4,this.interstitialAd.show()];case 3:return e=n.sent(),mc.lockTouch(!1),[2,{status:e?l.RewardAdStatus.SUCCESS:l.RewardAdStatus.FAIL}]}})})},e.prototype.showBannerAd=function(){this.bannerAd&&this.bannerAd.show()},e.prototype.showCustomerAd=function(){this.customeAd&&this.customeAd.show()},e.prototype.hideCustomerAd=function(){this.customeAd&&this.customeAd.hideAll()},e.prototype.hideBannerAd=function(){this.bannerAd&&this.bannerAd.hideAll()},e.prototype.hideAllBannerAd=function(){this.bannerAd&&this.bannerAd.hideAll()},e.prototype._calBannerOffsetY=function(){if(!this.bannerAd)return 0;if(this.bannerOffsetY>=0)return this.bannerOffsetY;if(ut.isWechatOrQQ()){var t=this.bannerAd.getBoundary().yMax,e=(cc.winSize.height-1500)/2-t-.4*t;this.bannerOffsetY=e>=0?0:Math.min(150,-e)}return this.bannerOffsetY=0,this.bannerOffsetY},e.prototype.checkBannerAd=function(t,e){var n=t<0?0:this._calBannerOffsetY(),o={offsetY:n,maxAdaptScale:1.2};if(!this.bannerAd)return o;var r=!1,i=1.2;if(ut.isWechatOrQQ()){var a=e.getContentSize().height,s=this.bannerAd.getBoundary().yMax,c=(cc.winSize.height-a)/2+n+(e._oy||0)-s-.4*s;c<0?r=!1:(r=!0,i=Math.min(1.2,(c+a)/a))}else ut.isMobile()?r=!0:ut.isFBInstant()&&(r=!0);return r?this.showBannerAd():this.hideAllBannerAd(),{offsetY:n,maxAdaptScale:i}},e.prototype.showNativeAd=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.nativeAd.show(t)];case 1:return[2,{status:e.sent()?l.RewardAdStatus.SUCCESS:l.RewardAdStatus.FAIL}]}})})},e.prototype.isNativeAdReady=function(){return!!this.nativeAd&&(this.startLoadNativeAd||(this.startLoadNativeAd=!0,this.nativeAd&&this.nativeAd.load(0)),this.nativeAd.isReady())},e.prototype.closeNativeAd=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.nativeAd?[4,this.nativeAd.closeAd()]:[2];case 1:return t.sent(),[2]}})})},e.prototype.showGamePortalAd=function(){return a(this,void 0,Promise,function(){return s(this,function(t){switch(t.label){case 0:return this.gamePortalAd?[4,this.gamePortalAd.show()]:[2];case 1:return[2,t.sent()]}})})},e.prototype.getABTestGroup=function(){var t;return-1==this.abTestGroup&&("undefined"!=typeof wx&&wx.getExptInfoSync?this.abTestGroup=Number(null===(t=wx.getExptInfoSync(["ad_test_01"]))||void 0===t?void 0:t.ad_test_01)||0:this.abTestGroup=l.AdABTestType.NONE),this.abTestGroup},i([ut.addLock],e.prototype,"showAd",null),i([ut.addLock],e.prototype,"showRewardAd",null),i([ut.addLock],e.prototype,"showInterstitialAd",null),i([ut.addLock],e.prototype,"showGamePortalAd",null),i([mc.addmodel("ad")],e)}(mc.BaseModel);n.default=C,cc._RF.pop()},{"../../../../startScene/version":void 0,"../LocalConfig":"LocalConfig","../constant/Enums":"Enums","../event/JsbEvent":"JsbEvent","../helper/DatabaseHelper":"DatabaseHelper","../helper/GameHelper":"GameHelper","../helper/ShareHelper":"ShareHelper","../helper/ViewHelper":"ViewHelper","./BannerAd":"BannerAd","./EcpmLevelAd":"EcpmLevelAd","./GridAd":"GridAd","./InterstitialAd":"InterstitialAd","./NativeAd":"NativeAd","./RewardAd":"RewardAd","./ShareAd":"ShareAd"}],AdPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"b828a9rDsFHbYqqd63OSVCA","AdPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/GameHelper"),l=cc._decorator.ccclass,u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("AdPnlCtrl onCreate"),this.setParam({isAct:!1}),[2]})})},e.prototype.onEnter=function(){cc.log("AdPnlCtrl onEnter"),c.gameHelper.ad.showCustomerAd()},e.prototype.onRemove=function(){cc.log("AdPnlCtrl onRemove"),c.gameHelper.ad.hideCustomerAd()},e.prototype.onClean=function(){cc.log("AdPnlCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close()},i([l],e)}(mc.BasePnlCmpt);n.default=u,cc._RF.pop()},{"../../common/helper/GameHelper":"GameHelper"}],AdSkipCardModel:[function(t,e,n){"use strict";cc._RF.push(e,"b293aVRRAlH1qA3xOgpNseV","AdSkipCardModel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/GameHelper"),l=t("../../common/helper/ViewHelper"),u=t("../../common/net/netMgr"),p=t("../../common/wx/WxHelper"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ERROR_CONFIG=[{code:0,message:"success"},{code:-1,message:"general_error"},{code:-2,message:"session_key_error"},{code:-3,message:"access_token_error"},{code:-4,message:"initiative_cancel"},{code:-5,message:"permission_denied"}],e.adSkipCardCount=-1,e.adSkipCardReceiveCount=0,e.adSkipCardTestGroup=-1,e}return r(e,t),e.prototype.onCreate=function(){},e.prototype.init=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.toDB=function(){return{}},e.prototype.asynAdSkipCardInfo=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){t.getAdSkipCardPermission()?wx.getAdsSkipCardQuestInfo({success:function(t){var n=0;t.questInfoList.forEach(function(t){"ACHIEVED"==t.status&&(n+=t.bonusAdCardCount)}),e({count:t.balance,receiveCount:n})},fail:function(){e({count:0,receiveCount:0})}}):e({count:0,receiveCount:0})}).then(function(e){return t.adSkipCardCount=e.count,t.adSkipCardReceiveCount=e.receiveCount,e})]})})},e.prototype.getAdSkipCardCount=function(){return this.adSkipCardCount},e.prototype.getAdSkipCardReceiveCount=function(){return this.adSkipCardReceiveCount},e.prototype.gotoUserCenter=function(){this.getAdSkipCardPermission()&&wx.navigateToUserCenter({type:"adsSkipCard",success:function(){},fail:function(){}})},e.prototype.createAdSkipCardOrder=function(t,e){return a(this,void 0,void 0,function(){var n=this;return s(this,function(){return l.viewHelper.showLoadingWait(!0),[2,new Promise(function(t){return a(n,void 0,void 0,function(){var n,o,r,i,a;return s(this,function(s){switch(s.label){case 0:return this.getAdSkipCardPermission()?[4,this.requestAdSkipCardOrder(e,null)]:[3,5];case 1:return-2!=(n=s.sent()).status&&87009!=n.status?[3,4]:(o=this.requestAdSkipCardOrder,r=[e],[4,p.wxHelper.getCode()]);case 2:return[4,o.apply(this,r.concat([s.sent()]))];case 3:n=s.sent(),s.label=4;case 4:return i=this,0==(a=this.ERROR_CONFIG.find(function(t){return t.code==n.status})||{code:n.status,message:n.message}).code&&n.order?wx.requestConsumeAdsSkipCard({orderNo:n.order,success:function(){t(a)},fail:function(){t(i.ERROR_CONFIG.find(function(t){return-4==t.code}))}}):t(a),[3,6];case 5:t(this.ERROR_CONFIG.find(function(t){return-5==t.code})),s.label=6;case 6:return[2]}})})}).then(function(n){return n.type=t,n.amount=e,l.viewHelper.showLoadingWait(!1),console.log("------ createAdSkipCardOrder error:"+JSON.stringify(n)),n})]})})},e.prototype.requestAdSkipCardOrder=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i;return s(this,function(a){switch(a.label){case 0:return null!=e?[3,3]:[4,p.wxHelper.checkSession()];case 1:return-1!=a.sent()?[3,3]:[4,p.wxHelper.getCode()];case 2:e=a.sent(),a.label=3;case 3:return[4,u.netMgr.post("adSkipCard/createAdSkipCardOrder",{uid:c.gameHelper.user.getUid(),openid:c.gameHelper.user.getOpenId(),amount:t,code:e})];case 4:return n=a.sent()||{status:-1},o=n.status,r=n.message,i=n.order,[2,{status:o,message:r,order:i}]}})})},e.prototype.getAdSkipCardPermission=function(){return ut.isWechatGame()&&wx.getAdsSkipCardQuestInfo&&wx.navigateToUserCenter&&1==this.getAdSkipCardTestGroup()&&0!=this.adSkipCardCount},e.prototype.getAdSkipCardTestGroup=function(){var t;return-1==this.adSkipCardTestGroup&&("undefined"!=typeof wx&&wx.getExptInfoSync?this.adSkipCardTestGroup=Number(null===(t=wx.getExptInfoSync(["ad_skip_test"]))||void 0===t?void 0:t.ad_skip_test)||0:this.adSkipCardTestGroup=0),this.adSkipCardTestGroup},i([mc.addmodel("adSkipCard")],e)}(mc.BaseModel);n.default=h,cc._RF.pop()},{"../../common/helper/GameHelper":"GameHelper","../../common/helper/ViewHelper":"ViewHelper","../../common/net/netMgr":"netMgr","../../common/wx/WxHelper":"WxHelper"}],AdaptNodeSizeCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"5a5ccJoahRI5Yub64AMvaxp","AdaptNodeSizeCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a,s=cc._decorator,c=s.ccclass,l=s.property;(function(t){t[t.NONE=0]="NONE",t[t.WIDTH=1]="WIDTH",t[t.HEIGHT=2]="HEIGHT"})(a||(a={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e.adaptType=a.NONE,e.addOffset=cc.v2(),e.minSize=cc.v2(0,0),e.preScaleX=-1,e.preScaleY=-1,e.preWidth=-1,e.preHeight=-1,e}return r(e,t),e.prototype.update=function(){if(this.target){var t=this.target.scaleX,e=this.target.scaleY,n=this.target.width,o=this.target.height;if(this.preScaleX!==t||this.preScaleY!==e||this.preWidth!==n||this.preHeight!==o){this.preScaleX=t,this.preScaleY=t,this.preWidth=n,this.preHeight=o;var r=this.node.width,i=this.node.height;this.adaptType===a.NONE?(r=n*t+this.addOffset.x,i=o*e+this.addOffset.y):this.adaptType===a.WIDTH?r=n*t+this.addOffset.x:this.adaptType===a.HEIGHT&&(i=o*e+this.addOffset.y),this.minSize.x>0&&(r=Math.max(this.minSize.x,r)),this.minSize.y>0&&(i=Math.max(this.minSize.y,i)),this.node.width=r,this.node.height=i}}},i([l(cc.Node)],e.prototype,"target",void 0),i([l({type:cc.Enum(a)})],e.prototype,"adaptType",void 0),i([l(cc.Vec2)],e.prototype,"addOffset",void 0),i([l(cc.Vec2)],e.prototype,"minSize",void 0),i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],AdaptWidthCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"128c9mONJlJMr3lWfz+WHGR","AdaptWidthCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxWidth=0,e.preWidth=0,e}return r(e,t),e.prototype.setMaxWidth=function(t){this.maxWidth!==t&&(this.maxWidth=t,this.preWidth=0)},e.prototype.update=function(){if(this.preWidth!==this.node.width){var t=this.preWidth=this.node.width,e=t>this.maxWidth?this.maxWidth/t:1;this.node.scale=e}},i([c],e.prototype,"maxWidth",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],AddLabelAutoAdaptSizeCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"6f6386K2GNDSr8RQtbq5BDe","AddLabelAutoAdaptSizeCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.path="",e.size=cc.v2(),e.minScaleWidth=.8,e}return r(e,t),e.prototype.start=function(){this.do()},e.prototype.do=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<2?this.add()?[2]:[4,ut.waitNextFrame(1,this)]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})})},e.prototype.add=function(){var t=this.FindChild(this.path);if(!t)return!1;var e=t.addComponent(cc.LabelAutoAdaptSize);return e.setMinScaleWidth(this.minScaleWidth),e.setSize(this.size),!0},i([u],e.prototype,"path",void 0),i([u(cc.Vec2)],e.prototype,"size",void 0),i([u],e.prototype,"minScaleWidth",void 0),i([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],AlertNotCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"f37acD6ASBFaI1oQCBVhU/F","AlertNotCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator.ccclass,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.closeNode_=null,e.rootNode_=null,e.iconNode_=null,e.textLbl_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("AlertNotCtrl onCreate"),[2]})})},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e)},i([c],e)}(mc.BaseNoticeCtrl);n.default=l,cc._RF.pop()},{}],AnimHelper:[function(t,e,n){"use strict";cc._RF.push(e,"a9b5dJHmRlC7Kl97gekbyNu","AnimHelper");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.animHelper=void 0;var a=t("../../../scene/CameraCtrl"),s=t("../constant/Constant"),c=t("./ResHelper"),l=t("../shader/FlashLightShaderCtrl"),u=t("../../view/cmpt/component/IgnoreFlashLightCmpt"),p=t("./GameHelper"),h=t("../../../core/utils/Utils"),d=t("../../view/guide/WeakGuideFingerCmpt"),f=t("../component/AutoReleaseCmt"),y=t("../../../core/component/MultiFrameParticle"),_=t("../../../core/component/MultiFrame"),g=function(){function t(){this.tempVec=cc.v2(),this.weak_guide_finger=null}return t.prototype.playClickFlyMoney=function(t,e,n,o,a){return r(this,void 0,void 0,function(){var s,l,u,p,h=this;return i(this,function(d){switch(d.label){case 0:return e&&t&&t.isValid?(s=t.convertToWorldSpaceAR(cc.Vec2.ZERO),l=o.convertToWorldSpaceAR(cc.Vec2.ZERO),u=cc.misc.clampf(Math.ceil(e/500),6,10),[4,c.resHelper.getNode(n)]):[2];case 1:return p=d.sent(),[2,Promise.all(ut.newArray(u).map(function(t,e){return r(h,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return t=cc.instantiate(p),o.isValid&&o.parent&&o.parent.isValid?t&&t.isValid?(t.parent=a,t.opacity=0,[4,ut.wait(.05*e)]):[2]:(t.destroy(),[2]);case 1:return n.sent(),o.isValid&&o.parent&&o.parent.isValid?(t.opacity=255,t.setPosition(a.convertToNodeSpaceAR(s,this.tempVec)),[2,this.flyOneMoney(t,a.convertToNodeSpaceAR(l),t,e,1)]):[2]}})})}))]}})})},t.prototype.playFlyRotate=function(t,e,n,o,a){return r(this,void 0,void 0,function(){var s,l,u,p=this;return i(this,function(h){switch(h.label){case 0:return e&&t&&t.isValid?(s=t.convertToWorldSpaceAR(cc.Vec2.ZERO),l=o.convertToWorldSpaceAR(cc.Vec2.ZERO),[4,c.resHelper.getNode(n)]):[2];case 1:return u=h.sent(),[2,Promise.all(ut.newArray(1).map(function(t,e){return r(p,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return t=cc.instantiate(u),o.isValid&&o.parent&&o.parent.isValid?t&&t.isValid?(t.parent=a,t.opacity=0,[4,ut.wait(.05*e)]):[2]:(t.destroy(),[2]);case 1:return n.sent(),o.isValid&&o.parent&&o.parent.isValid?(t.opacity=255,t.setPosition(a.convertToNodeSpaceAR(s,this.tempVec)),[2,this.flyOneMoney(t,a.convertToNodeSpaceAR(l),t,1,2)]):[2]}})})}))]}})})},t.prototype.flyOneMoney=function(t,e,n,o,a){return void 0===o&&(o=1),void 0===a&&(a=1),r(this,void 0,void 0,function(){var o=this;return i(this,function(){return[2,new Promise(function(r){var i=t.getPosition(o.tempVec),s=Math.floor((e.x-i.x)/3),c=Math.floor((e.y-i.y)/3),l=cc.v2(i.x+s+ut.randomRange(-80,80),i.y+c+ut.randomRange(-80,80)),u=cc.v2(i.x+2*s+ut.randomRange(-80,80),i.y+2*c+ut.randomRange(-80,80));cc.tween(t).bezierTo(.5*a,l,u,e).call(function(){r(),n.stopAllActions(),cc.tween(n).to(.3,{opacity:0,scale:1.1}).call(function(){return t.destroy()}).start()}).start(),cc.tween(n).to(.5*a,{scale:1}).start()})]})})},t.prototype.playFlutterText=function(t,e,n,o,a){return void 0===a&&(a=!0),r(this,void 0,void 0,function(){var r,s,l,u;return i(this,function(p){switch(p.label){case 0:if(!n)return[2];r=function(r,s){var l,u,p;return i(this,function(i){switch(i.label){case 0:return t[r]?[4,c.resHelper.getNode("score",o)]:[2,"continue"];case 1:return l=i.sent(),e.isValid?l&&l.isValid?(l.parent=e,l.Child("val",cc.Label).string=a?"+"+t[r]:"",30==t[r]?l.Child("icon",_.default).setFrame(0):60==t[r]?l.Child("icon",_.default).setFrame(1):t[r]>60&&l.Child("icon",_.default).setFrame(2),u=ut.random(n.x-30,n.x+10),l.x=u,p=l.y=n.y+50,l.opacity=255,l.scale=.5,l.z=1e4,cc.tween(l).to(.3,{y:p+50,scale:1},{easing:cc.easing.sineOut}).delay(.5).to(.3,{y:p+100,opacity:0},{easing:cc.easing.sineIn}).call(function(){return c.resHelper.putNode(l)}).start(),r<s-1?[4,ut.wait(.2)]:[3,3]):[2,{value:void 0}]:(c.resHelper.putNode(l),[2,{value:lplog.info("playFlutterText !root.isValid")}]);case 2:i.sent(),i.label=3;case 3:return[2]}})},s=0,l=t.length,p.label=1;case 1:return s<l?[5,r(s,l)]:[3,4];case 2:if("object"==typeof(u=p.sent()))return[2,u.value];p.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},t.prototype.playFlutterMoney=function(t,e,n,o){return r(this,void 0,void 0,function(){var r,a;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("FLUTTER_TEXT_2",o)];case 1:return r=i.sent(),e.isValid?r&&r.isValid?(r.parent=e,r.Child("val",cc.Label).string=""+t,r.setPosition(n),a=n.y+140,r.opacity=255,cc.tween(r).to(.3,{y:a+50},{easing:cc.easing.sineOut}).to(1,{y:a+100,opacity:0},{easing:cc.easing.sineIn}).call(function(){return c.resHelper.putNode(r)}).start(),[2]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playFlutterMoney !root.isValid")])}})})},t.prototype.playFlutterItem=function(t,e,n,o,a){return r(this,void 0,void 0,function(){var r,s;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("rewardItem",a)];case 1:return r=i.sent(),n.isValid?r&&r.isValid?(r.parent=n,r.Child("val",cc.Label).string="x"+e,c.resHelper.loadTempIcon(r,""+t,a),r.setPosition(o),s=o.y+140,r.opacity=255,cc.tween(r).to(.3,{y:s+50},{easing:cc.easing.sineOut}).to(.5,{y:s+100,opacity:0},{easing:cc.easing.sineIn}).call(function(){return c.resHelper.putNode(r)}).start(),[2]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playFlutterItem !root.isValid")])}})})},t.prototype.playFlutterCost=function(t,e,n,o){return r(this,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("FLUTTER_TEXT_3",o)];case 1:return r=i.sent(),e.isValid?r&&r.isValid?(r.parent=e,r.Child("val",cc.Label).string=ut.numberToString(t),r.setPosition(n.x-20,n.y),r.opacity=255,cc.tween(r).by(.3,{y:30},{easing:cc.easing.sineOut}).by(1,{y:40,opacity:0},{easing:cc.easing.sineIn}).call(function(){return c.resHelper.putNode(r)}).start(),[2]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playFlutterCost !root.isValid")])}})})},t.prototype.playFlutterGali=function(t,e,n,o){return r(this,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("FLUTTER_TEXT_4",o)];case 1:return r=i.sent(),e.isValid?r&&r.isValid?(r.parent=e,r.Child("val",cc.Label).string=ut.numberToString(t),r.setPosition(n.x+40,n.y),r.opacity=255,cc.tween(r).by(.3,{y:30},{easing:cc.easing.sineOut}).by(1,{y:40,opacity:0},{easing:cc.easing.sineIn}).call(function(){return c.resHelper.putNode(r)}).start(),[2]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playFlutterCost !root.isValid")])}})})},t.prototype.playFlutterDropNodeCount=function(t,e,n,o,a,s,l){return void 0===s&&(s=!1),void 0===l&&(l=!0),r(this,void 0,void 0,function(){var r,u,p;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("FLUTTER_NEW_YEAR",o)];case 1:return r=i.sent(),e.isValid?r&&r.isValid?(u=n.x+40,p=n.y,l&&(u+=ut.randomRange(-20,100),p+=ut.random(0,120)),r.Child("val").SetColor(a),r.parent=e,r.Child("val",cc.Label).string=""+(s?ut.numberToString(t)+"s":ut.numberToString(t)),r.setPosition(u,p),r.opacity=255,cc.tween(r).by(.12,{y:50},{easing:cc.easing.sineOut}).by(.5,{y:40,opacity:0},{easing:cc.easing.sineIn}).call(function(){return c.resHelper.putNode(r)}).start(),[2]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playFlutteDropNodeCount !root.isValid")])}})})},t.prototype.playRoleFlutterCrit=function(t,e,n,o,a){return r(this,void 0,void 0,function(){var r,l;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode(t,a)];case 1:return r=i.sent(),n.isValid?r&&r.isValid?(r.parent=n,r.Child("val",cc.Label).string="+"+e,r.x=o.x,l=r.y=o.y+s.ROLE_BUBBLE_OFFSETY,r.opacity=255,r.scale=.5,cc.tween(r).to(.1,{y:l+300,scale:5},{easing:cc.easing.sineOut}).to(.12,{y:l+200,scale:3},{easing:cc.easing.sineOut}).to(.16,{y:l+100,scale:.75},{easing:cc.easing.sineOut}).to(.35,{y:l+150}).to(.7,{y:l+140,opacity:0,scale:1},{easing:cc.easing.sineIn}).call(function(){return c.resHelper.putNode(r)}).start(),[2]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playRoleFlutterCrit !root.isValid")])}})})},t.prototype.playFlutterOutput=function(t,e,n,o){return r(this,void 0,void 0,function(){var r,a;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("FLUTTER_BISCUIT",o)];case 1:return r=i.sent(),e.isValid?r&&r.isValid?(r.parent=e,r.Child("val",cc.Label).string="+"+t,r.x=n.x,a=r.y=n.y+50,r.opacity=255,r.scale=.8,cc.tween(r).to(.3,{y:a+50,scale:1},{easing:cc.easing.sineOut}).to(1,{y:a+100,opacity:0},{easing:cc.easing.sineIn}).call(function(){return c.resHelper.putNode(r)}).start(),[2]):[2]:[2,c.resHelper.putNode(r)]}})})},t.prototype.playRoleUpDi=function(t,e,n){return r(this,void 0,void 0,function(){var o,r;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("ROLE_UP_DI",n)];case 1:return o=i.sent(),t.isValid?o&&o.isValid?(o.parent=t,o.setPosition(e),(r=o.Child("val",sp.Skeleton)).animation="animation",r.setCompleteListener(function(){r.setCompleteListener(null),c.resHelper.putNode(o)}),[2]):[2]:[2,c.resHelper.putNode(o)]}})})},t.prototype.roleEnterMap=function(t){t.stopAllActions(),t.scale=.9,t.opacity=0;var e=t.y;t.y=e+60,cc.tween(t).to(.5,{scale:1,opacity:255,y:e}).start()},t.prototype.playFlashLight=function(t){audioMgr.playSFX("common/sound07"),this.flashLight(t)},t.prototype.flashLight=function(t){var e=this;t.forEach(function(t){if(!t.getComponent(u.default)){if(t.getComponent(cc.Sprite)){var n=t.getComponent(l.default);n||(n=t.addComponent(l.default)),n.play()}t.children.length>0&&e.flashLight(t.children)}})},t.prototype.playFrameLight=function(t){var e=assetsMgr.getMaterial("FrameLight"),n=cc.Material.create(e._effectAsset);t.Component(cc.Sprite).setMaterial(0,n)},t.prototype.playZhuangHuang=function(t,e){return r(this,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return[4,c.resHelper.getNode("effect/ZHUANG_HUANG","_zhuang_huang_")];case 1:return n=o.sent(),t.isValid&&n.isValid?(n.parent=t,n.setPosition(e),[4,ut.wait(1.7)]):[3,3];case 2:return o.sent(),c.resHelper.putNode(n),[3,4];case 3:n.destroy(),o.label=4;case 4:return[2]}})})},t.prototype.playTenantRent=function(t,e,n,o){return r(this,void 0,void 0,function(){var n;return i(this,function(r){switch(r.label){case 0:return[4,c.resHelper.getNode("effect/TENANT_RENT","_tenant_rent_")];case 1:return n=r.sent(),t.isValid&&n.isValid?(n.parent=t,n.setPosition(e),[4,ut.wait(o)]):[3,3];case 2:return r.sent(),c.resHelper.putNode(n),[3,4];case 3:n.destroy(),r.label=4;case 4:return[2]}})})},t.prototype.playGardenJiancai=function(t,e){return r(this,void 0,void 0,function(){var n,o;return i(this,function(r){switch(r.label){case 0:return[4,c.resHelper.getNode("effect/ZHUANG_HUANG_GARDEN","_zhuang_huang_")];case 1:return n=r.sent(),t.isValid&&n.isValid?(n.parent=t,(o=n.FindChild("body",sp.Skeleton)).animation="animation",o.loop=!1,o.setCompleteListener(function(){e&&e(),c.resHelper.putNode(n)})):n.destroy(),[2]}})})},t.prototype.playUnlockAttrByMap=function(t,e,n,o){o?this.playUnlockHomeAttr(t,e,n,2-a.cameraCtrl.zoomRatio,100):this.playUnlockAttr(t,e,n,2-a.cameraCtrl.zoomRatio,100)},t.prototype.playUnlockAttr=function(t,e,n,o,a){return void 0===a&&(a=0),r(this,void 0,void 0,function(){var r,s,l,u,p,h,d,f,y,_;return i(this,function(g){switch(g.label){case 0:if(!t)return[2];if(r=[],t.income&&r.push({front:"",icon:0,val:"+"+t.income}),t.use_income&&r.push({front:"ui.interact",icon:0,val:"+"+t.use_income}),t.output&&r.push({front:"",icon:0,val:"+"+t.output+"/m"}),t.output_online&&(s=t.output_online.split(","),l=s[0],u=s[1],r.push({front:"ui.offline",icon:0,val:"+"+u+"/"+l+"s"})),t.heart&&r.push({front:"",icon:1,val:"+"+t.heart}),0===r.length)return[2];p=n.y-50+a,h=Math.floor(86*o),d=function(t,a){var s,l;return i(this,function(i){switch(i.label){case 0:return s=r[t],[4,c.resHelper.getNode("FLUTTER_ATTR_ADD")];case 1:return l=i.sent(),e.isValid?l&&l.isValid?(l.parent=e,l.scale=o,l.setPosition(n.x,p),l.Child("front").setLocaleKey(s.front),l.Child("val",cc.Label).string=s.val,l.Child("icon",cc.MultiFrame).setFrame(s.icon),l.opacity=255,cc.tween(l).to(.44,{y:p+h}).to(.44,{y:p+2*h}).to(.44,{y:p+3*h,opacity:0}).call(function(){return c.resHelper.putNode(l)}).start(),t<a-1?[4,ut.wait(.44)]:[3,3]):[2,{value:void 0}]:(c.resHelper.putNode(l),[2,{value:void 0}]);case 2:i.sent(),i.label=3;case 3:return[2]}})},f=0,y=r.length,g.label=1;case 1:return f<y?[5,d(f,y)]:[3,4];case 2:if("object"==typeof(_=g.sent()))return[2,_.value];g.label=3;case 3:return f++,[3,1];case 4:return[2]}})})},t.prototype.playUnlockHomeAttr=function(t,e,n,o,a){return void 0===a&&(a=0),r(this,void 0,void 0,function(){var r,s,l,u,p,h,d;return i(this,function(f){switch(f.label){case 0:if(!t)return[2];if(r=[],t.income&&r.push({front:"",icon:0,val:"+"+t.income}),t.use_income&&r.push({front:"ui.interact",icon:0,val:"+"+t.use_income}),t.home_output&&r.push({front:"ui.offline",icon:0,val:"+"+t.home_output+"/m"}),t.heart&&r.push({front:"",icon:1,val:"+"+t.heart}),0===r.length)return[2];s=n.y-50+a,l=Math.floor(86*o),u=function(t,a){var u,p;return i(this,function(i){switch(i.label){case 0:return u=r[t],[4,c.resHelper.getNode("FLUTTER_ATTR_ADD")];case 1:return p=i.sent(),e.isValid?p&&p.isValid?(p.parent=e,p.scale=o,p.setPosition(n.x,s),p.Child("front").setLocaleKey(u.front),p.Child("val",cc.Label).string=u.val,p.Child("icon",cc.MultiFrame).setFrame(u.icon),p.opacity=255,cc.tween(p).to(.44,{y:s+l}).to(.44,{y:s+2*l}).to(.44,{y:s+3*l,opacity:0}).call(function(){return c.resHelper.putNode(p)}).start(),t<a-1?[4,ut.wait(.44)]:[3,3]):[2,{value:void 0}]:(c.resHelper.putNode(p),[2,{value:void 0}]);case 2:i.sent(),i.label=3;case 3:return[2]}})},p=0,h=r.length,f.label=1;case 1:return p<h?[5,u(p,h)]:[3,4];case 2:if("object"==typeof(d=f.sent()))return[2,d.value];f.label=3;case 3:return p++,[3,1];case 4:return[2]}})})},t.prototype.playWeakGuideAniInWind=function(t,e){return r(this,void 0,void 0,function(){var n,o,r,s,c,l,u;return i(this,function(i){switch(i.label){case 0:return n=t.pos,o=t.angle,r=t.offset||cc.v2(0,0),s=null,n?[3,2]:(c=t.root,l=t.target,[4,p.gameHelper.findNode(c,l)]);case 1:if(!(s=i.sent()))return[2];n=ut.convertToNodeAR(s,e),i.label=2;case 2:return[4,this.loadWeakGuideFinger(e)];case 3:return i.sent(),this.weak_guide_finger&&this.weak_guide_finger.isValid?(this.weak_guide_finger.setPosition(n.addSelf(r)),this.weak_guide_finger.angle=o||0,(u=this.weak_guide_finger.Component(cc.Animation)).setCurrentTime(0),u.play(),this.weak_guide_finger.setScale(1),this.weak_guide_finger.active=!0,t.moveCamera&&(s?a.cameraCtrl.moveToByNode(.2,s):(n.subSelf(cc.v2(.5*cc.winSize.width,.5*cc.winSize.height)),a.cameraCtrl.moveTo(.2,n))),[2]):[2]}})})},t.prototype.playWeakGuideAniInWind2=function(t,e,n){return r(this,void 0,void 0,function(){var o,r,s;return i(this,function(i){switch(i.label){case 0:return[4,p.gameHelper.findNode(t,e)];case 1:return(o=i.sent())?(r=ut.convertToNodeAR(o,n),[4,this.loadWeakGuideFinger(n)]):[2];case 2:return i.sent(),this.weak_guide_finger&&this.weak_guide_finger.isValid?(this.weak_guide_finger.setPosition(r),(s=this.weak_guide_finger.Component(cc.Animation)).setCurrentTime(0),s.play(),this.weak_guide_finger.setScale(1),this.weak_guide_finger.active=!0,a.cameraCtrl.moveToByNode(.2,o),[2]):[2]}})})},t.prototype.playWeakGuideAniInPnl=function(t,e,n,o,a,s){return r(this,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,this.loadWeakGuideFinger(e)];case 1:return i.sent(),this.weak_guide_finger&&this.weak_guide_finger.isValid?(this.weak_guide_finger.setPosition(n.addSelf(a||cc.v2(0,0))),this.weak_guide_finger.angle=o||0,(r=this.weak_guide_finger.Component(cc.Animation)).setCurrentTime(0),r.play(),this.weak_guide_finger.setScale(.8*(s||1)),this.weak_guide_finger.active=!0,t&&t.isAutoRemove&&this.weak_guide_finger.getComponent(d.default).setAutoRemove(t.isAutoRemove),[2]):[2]}})})},t.prototype.playMoveWeakGuideAni=function(t,e,n,o){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return[4,this.loadWeakGuideFinger(t)];case 1:return r.sent(),this.weak_guide_finger&&this.weak_guide_finger.isValid?(this.weak_guide_finger.setPosition(e||cc.v2(0,0)),this.weak_guide_finger.angle=o||0,cc.Tween.stopAllByTarget(this.weak_guide_finger),cc.tween(this.weak_guide_finger).to(1.2,{position:n.toVec3()}).to(1.2,{position:e.toVec3()}).delay(.6).union().repeatForever().start(),this.weak_guide_finger.setScale(.6),this.weak_guide_finger.active=!0,[2]):[2]}})})},t.prototype.loadWeakGuideFinger=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return this.weak_guide_finger&&cc.isValid(this.weak_guide_finger)?(this.weak_guide_finger.parent=t,[3,3]):[3,1];case 1:return[4,assetsMgr.loadTempRes("guide/weak_guide_finger",cc.Prefab,"weakGuide")];case 2:e=n.sent(),t.isValid&&(this.weak_guide_finger=cc.instantiate2(e,t),this.weak_guide_finger.addComponent(f.default).init("guide/weak_guide_finger","weakGuide")),n.label=3;case 3:return[2]}})})},t.prototype.removeWeakGuideFinger=function(){this.weak_guide_finger&&(this.weak_guide_finger.isValid?(this.weak_guide_finger.destroy(),this.weak_guide_finger=null):this.weak_guide_finger=null)},t.prototype.hideWeakGuideFinger=function(t){this.weak_guide_finger&&this.weak_guide_finger.isValid&&(this.weak_guide_finger.active=!t)},t.prototype.playChatDengEff=function(t,e,n,o){return r(this,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("effect/CHAT_DENG")];case 1:return r=i.sent(),(null==t?void 0:t.isValid)&&r?(r.parent=t,r.active=!0,r.setPosition(e.x,e.y+s.ROLE_BUBBLE_OFFSETY),r.zIndex=o,r.Child("body",sp.Skeleton).animation="animation",ut.wait(n).then(function(){return c.resHelper.putNode(r)})):c.resHelper.putNode(r),[2]}})})},t.prototype.playFoodProgressEff=function(t,e,n){return r(this,void 0,void 0,function(){var o;return i(this,function(r){switch(r.label){case 0:return[4,c.resHelper.getNode("effect/SERVER_FOOD")];case 1:return(o=r.sent())&&t.isValid?(o.parent=t,o.active=!0,o.setPosition(n.x,n.y+s.ROLE_BUBBLE_OFFSETY/3),[4,ut.wait(.5)]):[2,c.resHelper.putNode(o)];case 2:return r.sent(),t.isValid?(o.setPosition(e.x,e.y+s.ROLE_BUBBLE_OFFSETY/3),o.Child("root/val",sp.Skeleton).animation="animation",[4,ut.wait(1.5)]):[2,c.resHelper.putNode(o)];case 3:return r.sent(),c.resHelper.putNode(o),[2]}})})},t.prototype.playFlutterCostCb=function(t,e,n,o,a){return r(this,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return mc.lockTouch(!0),[4,c.resHelper.getNode("FLUTTER_TEXT_5",o)];case 1:return r=i.sent(),e.isValid?r&&r.isValid?(r.parent=e,r.Child("val",cc.Label).string=ut.numberToString(t),r.setPosition(n.x-20,n.y),r.opacity=255,cc.tween(r).by(.2,{y:30},{easing:cc.easing.sineOut}).by(.8,{y:60,opacity:0},{easing:cc.easing.sineIn}).call(function(){mc.lockTouch(!1),c.resHelper.putNode(r),a&&a()}).start(),[2]):[2]:(c.resHelper.putNode(r),mc.lockTouch(!1),[2,lplog.info("playFlutterCostCb !root.isValid")])}})})},t.prototype.playFlutterCostCb2=function(t,e,n,o,a,s){return r(this,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode(t,a)];case 1:return r=i.sent(),n.isValid?r&&r.isValid?(r.parent=n,r.Child("val",cc.Label).string=ut.numberToString(e),r.setPosition(o.x-20,o.y),r.opacity=255,cc.tween(r).by(.2,{y:30},{easing:cc.easing.sineOut}).by(.8,{y:60,opacity:0},{easing:cc.easing.sineIn}).call(function(){c.resHelper.putNode(r),s&&s()}).start(),[2]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playFlutterCostCb2 !root.isValid")])}})})},t.prototype.playGaliAircraft=function(t,e,n,o){return void 0===o&&(o=!1),r(this,void 0,void 0,function(){return i(this,function(){return t&&t.isValid?[2,new Promise(function(r){audioMgr.playSFX("gali/gali_airplane"),t.setPosition(e),cc.tween(t).to(5,{x:n},{easing:cc.easing.sineIn}).call(function(){t.active=o,r()}).start()})]:[2]})})},t.prototype.playCaidanTx=function(t){return r(this,void 0,void 0,function(){var e,n,o;return i(this,function(r){switch(r.label){case 0:return t&&t.isValid&&cc.isValid(t)?[4,c.resHelper.getNode("effect/CAIDAN_TX","_caidan_tx_")]:[2];case 1:if(!(e=r.sent())||!e.isValid)return[2];for(e.parent=t,e.setPosition(0,0),n=t,o=1;n&&"Canvas"!==n.name;)o*=n.scale,n=n.parent;return e.scale=1/o,[4,e.Component(sp.Skeleton).playAsync("animation")];case 2:return r.sent(),c.resHelper.putNode(e),[2]}})})},t.prototype.playSolicitGuestAni=function(t){return r(this,void 0,void 0,function(){var e,n,o,r,a;return i(this,function(i){switch(i.label){case 0:return t&&t.isValid?(e="guide/SOLICIT_GUEST_ANI",n="guide/guide",[4,assetsMgr.loadTempRes(e,cc.Prefab,n)]):[2];case 1:return(o=i.sent())&&t&&t.isValid?((r=cc.instantiate2(o,t)).width=cc.winSize.width,r.height=cc.winSize.height,ut.wait(1).then(function(){r.Child("mask").off("click"),r.Child("mask").on("click",function(){return a()})}),ut.wait(2).then(function(){a()}),a=function(){cc.tween(r).to(.3,{opacity:0}).call(function(){r&&r.destroy(),assetsMgr.releaseTempRes(e,n)}).start()},[2]):(assetsMgr.releaseTempRes(e,n),[2])}})})},t.prototype.playFallingParticle=function(t,e,n,o){return r(this,void 0,void 0,function(){var r,a,s,l;return i(this,function(u){switch(u.label){case 0:if(!t)return[2];r=function(r,a){var s,l,u,p;return i(this,function(i){switch(i.label){case 0:return t[r]?[4,c.resHelper.getNode("falling",o)]:[2,"continue"];case 1:return s=i.sent(),e.isValid?s&&s.isValid?(s.parent=e,l=t[r],s.setPosition(l),s.z=10,s.Component(y.default).setFrame(n-1),(u=s.Component(cc.ParticleSystem)).resetSystem(),s.Child("star",y.default).setFrame(n-1),s.Child("star",cc.ParticleSystem).resetSystem(),p=u.life,ut.wait(p).then(function(){c.resHelper.putNode(s)}),r<a-1?[4,ut.wait(.02)]:[3,3]):[2,{value:void 0}]:(c.resHelper.putNode(s),[2,{value:lplog.info("playFallingParticle !root.isValid")}]);case 2:i.sent(),i.label=3;case 3:return[2]}})},a=0,s=t.length,u.label=1;case 1:return a<s?[5,r(a,s)]:[3,4];case 2:if("object"==typeof(l=u.sent()))return[2,l.value];u.label=3;case 3:return a++,[3,1];case 4:return[2]}})})},t.prototype.playLineAnim=function(t,e,n,o,a){return void 0===a&&(a=0),r(this,void 0,void 0,function(){return i(this,function(){return t?(t.forEach(function(t){c.resHelper.getNode("line",n).then(function(n){if(!e.isValid)return c.resHelper.putNode(n),lplog.info("playLineAnim !root.isValid");n&&n.isValid&&(n.parent=e,n.z=10,n.angle=a,n.setPosition(t),n.Component(sp.Skeleton).playAsync(""+o))})}),[2]):[2]})})},t.prototype.calculateSemiCirclePoints=function(t,e,n){for(var o=[],r=1;r<=n;r++){var i=180*r/(n+1),a=t.x+e*ut.cos(i),s=t.y+e*ut.sin(i);o.push(cc.v2(a,s))}return o},t.prototype.playDreamGemAnim=function(t,e,n,o,a){return r(this,void 0,void 0,function(){var r,s,l,u;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("DREAM_GEM",e)];case 1:return r=i.sent(),t.isValid?r&&r.isValid?(r.parent=t,r.setPosition(a),s=this.calculateSemiCirclePoints(a,150,o.length),audioMgr.playSFX("common/dream"),r.Child("dream",sp.Skeleton).playAsync("1").then(function(){r.destroy()}),[4,c.resHelper.getNode("targetGem",e)]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playCollectGemAnim !root.isValid")]);case 2:return l=i.sent(),u=o.map(function(e,o){var r=cc.instantiate2(l,t),i=r.Child("icon");r.setPosition(a),r.Child("icon",_.default).setFrame("target_"+e);var c=n[o],u=s[o],p=u.sub(c).len(),h=Math.floor((c.x-u.x)/3),d=Math.floor((c.y-u.y)/3),f=a.x>0?-200:200,y=a.x>0?360:-360,g=cc.v2(u.x+h-f,u.y+d),m=cc.v2(u.x+2*h-f,u.y+2*d),v=p/300;return new Promise(function(t){cc.tween(r).set({scale:0}).to(.2,{x:u.x,y:u.y,scale:1}).call(function(){cc.tween(i).to(.2,{scale:1.1},{easing:cc.easing.backOut}).to(.2,{scale:1}).start(),cc.tween(i).set({angle:0}).delay(.4+.2*v).to(.3+.1*v,{angle:y},{easing:cc.easing.sineIn}).start()}).delay(.4+.2*v).bezierTo(.3+.1*v,g,m,c).call(function(){i.stopAllActions(),r.destroy(),t(null)}).start()})}),[4,Promise.all(u)];case 3:return i.sent(),[2]}})})},t.prototype.playCollectGemAnim=function(t,e,n,o,a){return r(this,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,c.resHelper.getNode("targetGem",e)];case 1:return r=i.sent(),t.isValid?r&&r.isValid?(r.parent=t,r.setPosition(a),r.Child("icon",_.default).setFrame("target_"+o),[4,this.flyOneGem(r,n,r.Child("icon"))]):[2]:(c.resHelper.putNode(r),[2,lplog.info("playCollectGemAnim !root.isValid")]);case 2:return i.sent(),[2]}})})},t.prototype.flyOneGem=function(t,e,n,o){return r(this,void 0,void 0,function(){var r=this;return i(this,function(){return[2,new Promise(function(i){var a=t.getPosition(r.tempVec),s=a.sub(e).len(),c=Math.floor((e.x-a.x)/3),l=Math.floor((e.y-a.y)/3),u=a.x>0?-200:200,p=a.x>0?360:-360,h=cc.v2(a.x+c-u,a.y+l),d=cc.v2(a.x+2*c-u,a.y+2*l),f=s/300;t.z=Math.floor(s)+888,cc.tween(t).delay(.4).delay(.2*f).bezierTo(.3+.1*f,h,d,e).call(function(){i(),n.stopAllActions(),t.destroy(),o&&o()}).start(),cc.tween(n).set({scale:.6}).to(.2,{scale:1.1},{easing:cc.easing.backOut}).to(.2,{scale:1}).start(),cc.tween(n).set({angle:0}).delay(.4+.2*f).to(.3+.1*f,{angle:p},{easing:cc.easing.sineIn}).start()})]})})},t.prototype.flyOneTarget=function(t,e){return r(this,void 0,void 0,function(){var n=this;return i(this,function(){return[2,new Promise(function(o){var r=t.getPosition(n.tempVec),i=r.sub(e).len(),a=Math.floor((e.x-r.x)/3),s=Math.floor((e.y-r.y)/3),c=e.x-r.x>0?-180:180,l=cc.v2(r.x+a-c,r.y+s),u=cc.v2(r.x+2*a-c,r.y+2*s);t.z=Math.floor(i)+999,cc.tween(t).delay(.2).bezierTo(.4,l,u,e).call(function(){o()}).start(),cc.tween(t).delay(.2).to(.4,{scale:.4}).start()})]})})},t.prototype.playTargetReached=function(t,e,n){return r(this,void 0,void 0,function(){var o;return i(this,function(r){switch(r.label){case 0:return[4,c.resHelper.getNode("TARGET_REACHED",n)];case 1:return o=r.sent(),t.isValid?o&&o.isValid?(o.name="TARGET_REACHED",o.parent=t,o.setPosition(e),[4,o.Component(sp.Skeleton).playAsync("animation")]):[2]:(c.resHelper.putNode(o),[2,lplog.info("playTargetReached !root.isValid")]);case 2:return r.sent(),c.resHelper.putNode(o),[2]}})})},o([h.util.addLock],t.prototype,"playWeakGuideAniInWind",null),o([h.util.addLock],t.prototype,"playWeakGuideAniInWind2",null),o([h.util.addLock],t.prototype,"playWeakGuideAniInPnl",null),o([h.util.addLock],t.prototype,"playMoveWeakGuideAni",null),o([h.util.addLock],t.prototype,"loadWeakGuideFinger",null),t}();n.animHelper=new g,cc.sys.isBrowser&&(window.animHelper=n.animHelper),cc._RF.pop()},{"../../../core/component/MultiFrame":"MultiFrame","../../../core/component/MultiFrameParticle":"MultiFrameParticle","../../../core/utils/Utils":"Utils","../../../scene/CameraCtrl":"CameraCtrl","../../view/cmpt/component/IgnoreFlashLightCmpt":"IgnoreFlashLightCmpt","../../view/guide/WeakGuideFingerCmpt":"WeakGuideFingerCmpt","../component/AutoReleaseCmt":"AutoReleaseCmt","../constant/Constant":"Constant","../shader/FlashLightShaderCtrl":"FlashLightShaderCtrl","./GameHelper":"GameHelper","./ResHelper":"ResHelper"}],AppleHelper:[function(t,e,n){"use strict";cc._RF.push(e,"41129q+1BhDjo/l21oGfPW1","AppleHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.appleHelper=void 0;var i=t("../event/JsbEvent"),a=function(){function t(){}return t.prototype.nativeLogin=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return[4,jsbHelper.call(i.default.APPLE_LOGIN)];case 1:return"success"==(t=e.sent()||{}).result?[2,{code:t.code,nickName:t.nickname,token:t.token,userId:t.userId}]:"logined"==t.result?[2,{userId:t.userId,logined:!0}]:[2,{errcode:t.errcode||-10086}]}})})},t.prototype.isAttceptAtt=function(){return jsb.reflection.callStaticMethod("jsbHelp","isAcceptAtt")},t.prototype.requestAtt=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,jsbHelper.call(i.default.REQUEST_PERMISSION)];case 1:return[2,t.sent()]}})})},t.prototype.openAppSetting=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,jsbHelper.call(i.default.OPEN_APP_SETTING)];case 1:return[2,t.sent()]}})})},t.prototype.isShowAppleButton=function(){return jsb.reflection.callStaticMethod("jsbHelp","isAvailableIos13")},t}();n.appleHelper=new a,cc._RF.pop()},{"../event/JsbEvent":"JsbEvent"}],AppsFlyerHelper:[function(t,e,n){"use strict";cc._RF.push(e,"12118i4zHxAoLKKNpOO2Bt5","AppsFlyerHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.appsFlyerHelper=void 0;var o=t("../helper/GameHelper"),r=function(){function t(){}return t.prototype.getDeepLinkParams=function(){var t=null;if(!cc.sys.isNative||!o.gameHelper.isGLobal())return null;if(ut.isAndroid()){var e=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppsFlyerHelper","getDeepLinkParams","()Ljava/lang/String;"),n=JSON.parse(e);if(n.error)return null;t=n.param}else if(ut.isIos()){if(!(e=jsb.reflection.callStaticMethod("AppsflyerHelper","getDeepLinkParams"))||"error"==e)return null;t=e}if(!t)return null;var r=t.split("|"),i=r[0],a=r[1],s=r[2];return s&&(s=Number(s)),{uid:i,type:a,date:s}},t}();n.appsFlyerHelper=new r,cc._RF.pop()},{"../helper/GameHelper":"GameHelper"}],App:[function(t,e,n){"use strict";cc._RF.push(e,"38bbapTge9J8YJ/c+BspkLu","App");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../script/common/helper/ResHelper"),l=t("../script/common/helper/ViewHelper"),u=t("../script/common/net/netMgr"),p=t("../script/common/helper/GameHelper"),h=t("../script/common/LocalConfig"),d=t("../script/common/wx/WxHelper"),f=t("../script/common/constant/LocalLang"),y=t("../script/common/helper/ShareHelper"),_=t("../core/utils/ResLoader"),g=t("./LoginCmpt"),m=t("../script/common/constant/Enums"),v=t("../core/utils/Utils"),b=t("../script/view/cmpt/component/TopTouchCmpt"),w=t("../script/common/facebook/FBInstantHelper"),S=t("../../startScene/LangLabel"),C=t("../../startScene/LoadingCmpt"),T=t("../../startScene/StartHelper"),A=t("../../startScene/version"),E=cc._decorator,O=E.ccclass,P=E.property,R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.windName="",e.startLoadTime=0,e.loadingCmpt=null,e.loading=!1,e.curPercent=0,e.dstPercent=0,e.openState=-2,e.lastProgressText="",e.langText=null,e.state="login",e.waitLogin=!0,e.logined=!1,e.needSync=!1,e.alertNode=null,e.netLoadingNode=null,e.clientLanunchTime=-1,e.loginType=0,e.hotUpdateVersion=null,e.activityLogo=null,e.initTaFlag=!1,e.deblockStatus=504,e}return r(e,t),e.prototype.onLoad=function(){mc.currScene="loading",cc.macro.ENABLE_MULTI_TOUCH=!0,cc.debug.setDisplayStats(h.localConfig.showFps),ut.setKeepScreenOn(!0),lplog.open=h.localConfig.openLog,this.resize(),this.loadingCmpt=cc.find("wxLogo").getComponent(C.default),ut.isWechatOrQQ()?(assetsMgr.setDownloadConcurrency(8,30),this.loadingCmpt.reset()):cc.sys.isBrowser&&(assetsMgr.setPreloadConcurrency(3,3),assetsMgr.setDownloadConcurrency(20,10))},e.prototype.resize=function(){var t=cc.view.getDesignResolutionSize(),e=cc.view.getFrameSize(),n=e.width,o=e.height,r=n,i=o;if(n/o>.66){cc.view.setDesignResolutionSize(720,1500,cc.ResolutionPolicy.SHOW_ALL);var a=cc.find("Canvas");return a.width=720,void(a.height=1500)}n/o>t.width/t.height?r=(i=t.height)*n/o:i=o/n*(r=t.width),cc.view.setDesignResolutionSize(r,i,cc.ResolutionPolicy.UNKNOWN);var s=cc.find("Canvas");s.width=r,s.height=i},e.prototype.start=function(){h.localConfig.isTestServer?mc.init("block_debug_v1",this.node,A.default.getLocalLang(),!0,b.default):mc.init(mc.GameNameSpace,this.node,A.default.getLocalLang(),!0,b.default),this.clientLanunchTime=Date.now(),cc.game.setFrameRate(58),u.netMgr.init(),this.loading=!0,this.langText=f.default,p.gameHelper.appChannel=p.gameHelper.getChannel(),!p.gameHelper.isCheckUpdate&&ut.isMobile()?this.checkUpdate():cc.sys.isNative?this.appLoad():this.load()},e.prototype.setProgressText=function(t){this.isValid&&(this.lastProgressText=t,this.loadingCmpt.setDesc(t))},e.prototype.setPercent=function(t){this.isValid&&(this.curPercent=t,this.loadingCmpt.setProgressText(Math.floor(100*this.curPercent)+"%"))},e.prototype.initNativeListener=function(){ut.isAndroid()?this.addAndroidBackListener():ut.isIos()&&(jsbHelper.on("MEMORY_WARNING",function(t){"success"==t.result&&p.gameHelper.onMemoryWarning()}),jsbHelper.call("MEMORY_WARNING_INIT"))},e.prototype.addAndroidBackListener=function(){var t=this,e=this.loadingCmpt.node;if(!e.getChildByName("AndroidBackNode")){var n=new cc.Node("AndroidBackNode");n.parent=e,n.width=2,n.height=2,n.group="ui";var o=n.addComponent(cc.Widget);o.target=e,o.isAlignLeft=!0,o.isAlignTop=!0,o.left=-1,o.top=-1,n.addComponent(cc.Button);var r=!1;n.on("click",function(){return a(t,void 0,void 0,function(){var t,e,n,o;return s(this,function(i){switch(i.label){case 0:return r?[2]:(r=!0,[4,_.loader.loadRes("view/cmpt/MessageBoxCmpt",cc.Prefab)]);case 1:return t=i.sent(),r=!1,t&&cc.isValid(this.loadingCmpt.node)?(e=cc.instantiate2(t,this.loadingCmpt.node),n=function(){cc.game.end()},o=function(){},e.Component("MessageBoxCmpt").init({lang:this.langText,msg:this.langText.exit_game_tips,ok:n,cancel:o,clickToClose:!0}),[2]):[2]}})})},this)}},e.prototype.isNewUser=function(){if(!h.localConfig.openGuide)return!1;var t=storageMgr.loadObject("guide");if(!t||!t.guideInfoList)return!0;var e=t.guideInfoList.find(function(t){return 1===t.id});return!e||!e.finish&&e.progress<40},e.prototype.serverLogin=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,this.login()];case 1:return e.sent(),ut.isWechatOrQQ()&&d.wxHelper.init(),y.shareHelper.init(),this.dstPercent+=.02,this.dstPercent+=.02,this.isNewUser(),t=[],this.needSync&&t.push(this.syncLoginInfo()),[4,Promise.all(t)];case 2:return e.sent(),this.waitLogin=!1,this.dstPercent+=.01,[2]}})})},e.prototype.load=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.curPercent=0,this.dstPercent=0,cc.ButtonEx.DefaultClickPath="click",this.isNewUser()&&(this.dstPercent=0),p.gameHelper.ad.init(),p.gameHelper.ad.initCurrentAd(m.AdType.REWARD),this.setProgressText(this.langText.loading_1),this.serverLogin(),!this.isNewUser()||cc.sys.isNative?[3,2]:[4,this.startNewUserLoad()];case 1:return t.sent(),[3,4];case 2:return[4,this.startNormalUserLoad()];case 3:t.sent(),t.label=4;case 4:return this.dstPercent=1,this.setProgressText(this.langText.loading_5),this.state="startGame",[2]}})})},e.prototype.loadCommon=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,l=this;return s(this,function(s){switch(s.label){case 0:_.loader.startLoadBundle(m.Bundle.START),e=0,s.label=1;case 1:return _.loader.getBundleProgress(m.Bundle.START)<1?[4,ut.waitNextFrame()]:[3,3];case 2:return s.sent(),(n=_.loader.getBundleProgress(m.Bundle.START))>e&&(this.dstPercent+=(n-e)*t*.8,e=n),[3,1];case 3:return this.openState>=0?[4,ut.waitNextFrame()]:[3,5];case 4:return s.sent(),[3,3];case 5:return o=function(e){l.dstPercent+=e*t*.2},r={},i=function(t,e,n,i){var a=n;i&&(a=n/i);var s=r[t]||0;a>s&&(o(e*(a-s)),r[t]=a)},[4,assetsMgr.loadStartJsons(function(t,e){i("loadStartJsons",.38,t,e)})];case 6:return s.sent(),(a=[]).push(assetsMgr.loadMaterial(function(t,e){i("loadMaterial",.1,t,e)})),a.push(assetsMgr.loadAudio(function(t,e){i("loadAudio",.02,t,e)})),[4,Promise.all(a)];case 7:return s.sent(),a.length=0,[4,assetsMgr.loadImages(function(t,e){i("loadImages",.15,t,e)})];case 8:return s.sent(),a.push(assetsMgr.loadPrefabByPath("PNL_MASK").then(function(){o(.06)})),a.push(assetsMgr.loadPrefabByPath("CLICK_ANIM").then(function(){o(.06)})),this.isNewUser()||o(.18),[4,Promise.all(a)];case 9:s.sent(),a.length=0,audioMgr.init(),c.resHelper.init(),s.label=10;case 10:return this.waitLogin?[4,ut.waitNextFrame()]:[3,12];case 11:return s.sent(),[3,10];case 12:return o(.05),[2]}})})},e.prototype.loadWind=function(t){return a(this,void 0,void 0,function(){var e,n=this;return s(this,function(o){switch(o.label){case 0:return e=0,[4,this.loadAllNotice(function(o){o>e&&(n.dstPercent+=(o-e)*t*.3,e=o)})];case 1:return o.sent(),this.isNewUser()||assetsMgr.markInit(),assetsMgr.setDownloadConcurrency(4,8),e=0,[4,l.viewHelper.preloadWind(this.windName,function(o,r){var i=o/r;i>e&&(n.dstPercent+=(i-e)*t*.7,e=i)})];case 2:return o.sent(),assetsMgr.setDownloadConcurrency(8,30),[2]}})})},e.prototype.loadAssets=function(t){return a(this,void 0,void 0,function(){var e,n,o=this;return s(this,function(r){switch(r.label){case 0:_.loader.startLoadBundle(m.Bundle.RES),e=0,e=0,r.label=1;case 1:return _.loader.getBundleProgress(m.Bundle.RES)<1?[4,ut.waitNextFrame()]:[3,3];case 2:return r.sent(),(n=_.loader.getBundleProgress(m.Bundle.RES))>e&&(this.dstPercent+=(n-e)*t*.5,e=n),[3,1];case 3:return e=0,[4,assetsMgr.init(function(n){n>e&&(o.dstPercent+=(n-e)*t*.5,e=n)})];case 4:return r.sent(),ut.isMobile()?jsbHelper.initIAP():ut.isFBInstant()&&(w.fbInstantHelper.setSupportPay(),w.fbInstantHelper.setIAPCfg()),[2]}})})},e.prototype.startNewUserLoad=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.loadCommon(.6)];case 1:return t.sent(),this.isNewUser()?[3,4]:[4,this.loadAssets(.1)];case 2:return t.sent(),[4,this.loadWind(.15)];case 3:return t.sent(),[3,6];case 4:return[4,this.loadWind(.25)];case 5:t.sent(),t.label=6;case 6:return assetsMgr.preloadInGuide(),[2]}})})},e.prototype.startNormalUserLoad=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.loadCommon(.3)];case 1:return t.sent(),[4,this.loadAssets(.3)];case 2:t.sent(),t.label=3;case 3:return _.loader.isLoadResBundle()?[3,5]:[4,ut.waitNextFrame()];case 4:return t.sent(),[3,3];case 5:return[4,this.loadWind(.35)];case 6:return t.sent(),[2]}})})},e.prototype.startGame=function(){var t=this.isNewUser();eventMgr.emit(mc.Event.GOTO_WIND,this.windName),t&&!cc.sys.isNative||audioMgr.playBGM("common/bgm",.35),this.enabled=!1,T.startHelper.releaseAll(),this.releaseBundle("appFontSubpackage")},e.prototype.releaseBundle=function(t){var e=cc.assetManager.getBundle(t);e&&e.releaseAll()},e.prototype.checkUpdate=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,c,l,h;return s(this,function(s){switch(s.label){case 0:return this.loadingCmpt.onHotUpdate(),this.loadingCmpt.setDesc(this.langText.update_0),this.dstPercent=0,t=p.gameHelper.user,e=p.gameHelper.getVersion(),n=p.gameHelper.getPlatform(),p.gameHelper.appChannel!=m.ChannelType.OFFICIAL&&(n=p.gameHelper.appChannel),[4,u.netMgr.get("version/check",{uid:t.getUid(),platform:n,version:e})];case 1:return o=s.sent()||{},r=o.status,i=o.url,a=o.packageUrl,c=o.force,l=o.downloadUrl,h=o.newVer,0===r?(this.hotUpdateVersion=h,eventMgr.on(mc.Event.HOT_UPDATE_EVENT,this.onHotUpdateEvent,this),hotUpdateMgr.start(a,i,h)):1===r?this.onBigVersionUpdate(c,l):this.appLoad(),[2]}})})},e.prototype.checkVersionUpdate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return ut.isWechatGame()?(wx.getUpdateManager&&wx.getUpdateManager(),[2]):[2]})})},e.prototype.wxUpdateState=function(){var t=this;return new Promise(function(e){if("undefined"!=typeof wx&&wx.getUpdateManager()){var n=wx.getUpdateManager();n.onCheckForUpdate(function(o){return a(t,void 0,void 0,function(){var t,r,i,a,c;return s(this,function(s){switch(s.label){case 0:if(!o.hasUpdate)return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.all([this.onWxUpdateState(n),u.netMgr.get("version/check",{uid:p.gameHelper.user.getUid(),platform:p.gameHelper.getPlatform(),version:p.gameHelper.getVersion()})])];case 2:return t=s.sent(),r=t[0],i=t[1],a=i.status,c=i.force,e(0==r&&1==a?c?0:1:-1),[3,4];case 3:return s.sent(),e(-1),[3,4];case 4:return[3,6];case 5:e(-1),s.label=6;case 6:return[2]}})})})}else e(-1)}).catch(function(){return-1})},e.prototype.onWxUpdateState=function(t){return new Promise(function(e){t.onUpdateReady(function(){e(0)}),t.onUpdateFailed(function(){e(-1)})}).catch(function(){return-1})},e.prototype.onBigVersionUpdate=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i=this;return s(this,function(a){switch(a.label){case 0:return t||(n=function(){i.appLoad()}),o=function(){var n=e||p.gameHelper.getAppShopUrl();cc.sys.openURL(n),i.onBigVersionUpdate(t,e)},r=t?this.langText.update_must_appstore:this.langText.update_need_appstore,[4,this.showMessageBox({lang:this.langText,msg:r,ok:o,cancel:n,buttons:[this.langText.go]})];case 1:return a.sent(),[2]}})})},e.prototype.onHotUpdateEvent=function(t,e){if(e)this.onHotUpdateRetry();else switch(t.getEventCode()){case jsb.EventAssetsManager.NEW_VERSION_FOUND:this.loadingCmpt.setDesc(this.langText.update_1,0);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:this.appLoad();break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:if(t.getPercent()){var n=Math.floor(100*t.getPercent());this.loadingCmpt.setDesc(this.langText.update_1,n)}break;case jsb.EventAssetsManager.UPDATE_FINISHED:p.gameHelper.isCheckUpdate=!0,ut.wait(.2,this).then(function(){return p.gameHelper.gameRestart()})}},e.prototype.onHotUpdateRetry=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r=this;return s(this,function(i){switch(i.label){case 0:return[4,_.loader.loadRes("view/cmpt/MessageBoxCmpt",cc.Prefab)];case 1:return(t=i.sent())?(e=cc.instantiate2(t,this.loadingCmpt.node),n=function(){hotUpdateMgr.redownload()},o=function(){r.appLoad()},e.Component("MessageBoxCmpt").init({lang:this.langText,msg:this.langText.update_2,ok:n,cancel:o})):this.appLoad(),[2]}})})},e.prototype.login=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.logined?[2]:(this.logined=!0,[2])})})},e.prototype.getLoadingNode=function(){var t;return null===(t=this.loadingCmpt)||void 0===t?void 0:t.node},e.prototype.showMessageBox=function(t){return a(this,void 0,void 0,function(){var e,n,o;return s(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return[4,_.loader.loadRes("view/cmpt/MessageBoxCmpt",cc.Prefab)];case 2:return(e=r.sent())?[3,6]:[3,3];case 3:return[4,ut.wait(.5)];case 4:r.sent(),r.label=5;case 5:return[3,1];case 6:return n=cc.instantiate2(e,this.loadingCmpt.node),(o=n.Component("MessageBoxCmpt")).init(t),[2,o]}})})},e.prototype.showLoading=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return this.netLoadingNode?[3,2]:[4,_.loader.loadRes("view/cmpt/LoadingCmpt",cc.Prefab)];case 1:e=n.sent(),this.netLoadingNode||(this.netLoadingNode=cc.instantiate2(e,this.loadingCmpt.node)),n.label=2;case 2:return this.netLoadingNode.active=t,[2]}})})},e.prototype.onCloseAlert=function(){var t=this;this.alertNode&&(this.alertNode.stopAllActions(),cc.tween(this.alertNode).to(.18,{opacity:0}).call(function(){t.alertNode.active=!1}).start())},e.prototype.showAlert=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return a(this,void 0,void 0,function(){var n,o,r,i=this;return s(this,function(a){switch(a.label){case 0:return this.alertNode?[3,2]:[4,_.loader.loadRes("view/cmpt/AlertCmpt",cc.Prefab)];case 1:n=a.sent(),this.alertNode||(this.alertNode=cc.instantiate2(n,this.loadingCmpt.node)),a.label=2;case 2:return this.alertNode.opacity=0,this.alertNode.active=!0,this.alertNode.zIndex=1e4,o=this.alertNode.Child("root"),(r=o.Child("alertText",cc.Label)).getComponent(S.default).setLangKey(t,e),r._forceUpdateRenderData(),o.width=Math.max(600,r.node.width+200),cc.tween(this.alertNode).to(.2,{opacity:255}).delay(1).to(.18,{opacity:0}).call(function(){i.alertNode.active=!1}).start(),[2]}})})},e.prototype.syncLoginInfo=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.showSyncInfo=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return t.state!=m.LoginSyncState.VERSION_DIFF?[3,2]:[4,this.showVersionDiff(t.platform)];case 1:return e.sent(),[3,5];case 2:return t.state!=m.LoginSyncState.DEVICE_DIFF?[3,4]:[4,this.login()];case 3:return e.sent(),this.needSync=!0,[3,5];case 4:t.state==m.LoginSyncState.SYNC&&(this.needSync=!0),e.label=5;case 5:return[2]}})})},e.prototype.showVersionDiff=function(t){var e=this;return new Promise(function(){return a(e,void 0,void 0,function(){var e,n,o,r;return s(this,function(i){switch(i.label){case 0:return e=function(){cc.game.end()},"",o=this.getPlatormName(t),r=this.getPlatormName(p.gameHelper.getPlatform()),n=o==r?T.startHelper.lang(this.langText.version_diff_samePlat,[o]):T.startHelper.lang(this.langText.version_diff,[o,r]),[4,this.showMessageBox({lang:this.langText,msg:n,ok:e,buttons:[this.langText.version_diff_confirm]})];case 1:return i.sent().setTimeLock("ok",30),[2]}})})})},e.prototype.getPlatormName=function(t){return"wx"==t?this.langText.wx:"ios"==t?this.langText.ios_app:"android"==t?this.langText.android_app:t},e.prototype.showNetFail=function(t,e){var n=this;return new Promise(function(o){return a(n,void 0,void 0,function(){var n,r,i;return s(this,function(a){switch(a.label){case 0:return[4,_.loader.loadRes("view/cmpt/MessageBoxCmpt",cc.Prefab)];case 1:return(n=a.sent())?(r=cc.instantiate2(n,this.loadingCmpt.node),i=T.startHelper.lang(this.langText.net_fail,[t+":"+e]),r.Component("MessageBoxCmpt").init({lang:this.langText,msg:i,ok:o,buttons:[this.langText.retry]})):o(),[2]}})})})},e.prototype.showServerNotice=function(t){var e=this;return new Promise(function(n){return a(e,void 0,void 0,function(){var e,o,r;return s(this,function(i){switch(i.label){case 0:return[4,_.loader.loadRes("view/cmpt/MessageBoxCmpt",cc.Prefab)];case 1:return(e=i.sent())?(o=cc.instantiate2(e,this.loadingCmpt.node),r=t.split(".")[0].startsWith("app")?T.startHelper.lang(t):t,o.Component("MessageBoxCmpt").init({lang:this.langText,msg:r,ok:function(){return cc.game.end()}})):n(),[2]}})})})},e.prototype.loadAllNotice=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return[2,new Promise(function(e){return eventMgr.emit(mc.Event.LOAD_ALL_NOTICE,e,function(e,n){return t(e/n)})})]})})},e.prototype.go=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,ut.wait(.15,this)];case 1:return t.sent(),this.loading=!1,this.activityLogo&&this.activityLogo.isValid?[4,this.loadingCmpt.showActiveLogo(this.activityLogo,this.langText.guide_goon)]:[3,3];case 2:return t.sent(),assetsMgr.releaseTempResByTag(this.activityLogo.__resTag),[3,5];case 3:return[4,this.loadingCmpt.end()];case 4:t.sent(),t.label=5;case 5:return this.alertNode&&(this.alertNode.destroy(),this.alertNode=null),this.startGame(),[2]}})})},e.prototype.appLoad=function(){hotUpdateMgr.checkReport(),this.initNativeListener(),this.loadingCmpt.onNative(),p.gameHelper.user.getUid()?this.nativeLogin():this.initNative()},e.prototype.nativeLogin=function(t){t&&(this.logined=!0),this.loadingCmpt.reset(),this.load()},e.prototype.initNative=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return cc.resources.load("tmp/prefab/native/LOGIN",cc.Prefab,function(e,n){cc.instantiate2(n,t.loadingCmpt.node).Component(g.default).init(t,t.langText)}),[2]})})},e.prototype.update=function(t){if(0===this.deblockStatus&&p.gameHelper.gameRestart(),hotUpdateMgr.updateCostTime(t),this.startLoadTime+=t,this.loading){var e=this.dstPercent;this.waitLogin?this.curPercent>=.15&&this.setProgressText(this.langText.loading_5):this.curPercent<=.25?this.setProgressText(this.langText.loading_5):this.curPercent>.25&&this.curPercent<=.5?this.setProgressText(this.langText.loading_5):(this.curPercent>.5&&this.curPercent,this.setProgressText(this.langText.loading_5)),this.setPercent(Math.min(this.curPercent+.5*t,e)),hotUpdateMgr.isUpdating()||this.curPercent>=1&&-2===this.openState&&"startGame"===this.state&&(this.state="wait",this.go())}},i([P()],e.prototype,"windName",void 0),i([v.util.queueEvery],e.prototype,"showLoading",null),i([ut.addLock],e.prototype,"showAlert",null),i([O],e)}(cc.Component);n.default=R,cc._RF.pop()},{"../../startScene/LangLabel":void 0,"../../startScene/LoadingCmpt":void 0,"../../startScene/StartHelper":void 0,"../../startScene/version":void 0,"../core/utils/ResLoader":"ResLoader","../core/utils/Utils":"Utils","../script/common/LocalConfig":"LocalConfig","../script/common/constant/Enums":"Enums","../script/common/constant/LocalLang":"LocalLang","../script/common/facebook/FBInstantHelper":"FBInstantHelper","../script/common/helper/GameHelper":"GameHelper","../script/common/helper/ResHelper":"ResHelper","../script/common/helper/ShareHelper":"ShareHelper","../script/common/helper/ViewHelper":"ViewHelper","../script/common/net/netMgr":"netMgr","../script/common/wx/WxHelper":"WxHelper","../script/view/cmpt/component/TopTouchCmpt":"TopTouchCmpt","./LoginCmpt":"LoginCmpt"}],AssetsMgr:[function(t,e,n){"use strict";cc._RF.push(e,"8a068nxOatHYIc7NIDMmik1","AssetsMgr");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i=t("../utils/ResLoader"),a=t("../manage/LanguageMgr"),s=t("../event/CoreEventType"),c=t("../../script/common/helper/EncHelper"),l=t("../../script/common/event/EventType"),u=t("../../script/common/constant/Enums"),p=function(){function t(){this.images=new Map,this.jsons=new Map,this.prefabs=new Map,this.audios=new Map,this.materials=new Map,this.fonts=new Map,this.temps=new Map,this.loadTempQueueMap=new Map,this.__onProgessCallback=null,this.__totalProgess=0,this.__tempProgess=null,this.__lastProgess=null,this.__curPercent=0,this.tmpMemoryWarning=0,this.memoryWarning=0,this.initComplete=!1,this._enabledBMFontBef=!1}return t.prototype.init=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this.__onProgessCallback=t,this.temps.clear(),this.debug=!1,this.__curPercent=0,this.__lastProgess={},this.__tempProgess={},this.__totalProgess=.5,[4,this.loadJsons()];case 1:return e.sent(),this.setDownloadConcurrency(2,4),[4,this.loadPrefab()];case 2:return e.sent(),this.setDownloadConcurrency(8,30),this.__onProgessCallback=null,this.__tempProgess=null,this.memoryWarning=Number(storageMgr.getOrgItem("__@memoryWarning")),isNaN(this.memoryWarning)&&(this.memoryWarning=0),[2]}})})},t.prototype.markInit=function(){eventMgr.emit(l.default.EVENT_NOT_DELAY_INIT),this.initComplete=!0},t.prototype.isInit=function(){return this.initComplete},t.prototype.delayInit=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:if(this.isInit())return[2];t.label=1;case 1:return i.loader.getBundleProgress(u.Bundle.RES)<1?[4,ut.waitNextFrame()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[4,this.init(null)];case 4:return t.sent(),[4,i.loader.preload("tmp/prefab/publicity/BODY_SOLICIT_1",cc.Prefab)];case 5:return t.sent(),this.markInit(),[2]}})})},Object.defineProperty(t.prototype,"debug",{get:function(){return i.loader.debug},set:function(t){i.loader.debug=t},enumerable:!1,configurable:!0}),t.prototype.changeLangJson=function(t){return o(this,void 0,void 0,function(){return r(this,function(){return eventMgr.emit(s.default.SWITCH_LANGUAGE,t),[2]})})},t.prototype.onInitLoadProgess=function(t,e,n,o){if(void 0===o&&(o=1),this.__onProgessCallback){var r=this.__tempProgess[t];void 0===r&&(r=this.__tempProgess[t]=0);var i=e/n*o;if(!(this.__lastProgess[t]&&this.__lastProgess[t]>=i)){this.__lastProgess[t]=i;var a=i*this.__totalProgess,s=Math.max(a-r,0);this.__tempProgess[t]=a,this.__curPercent+=s,this.__curPercent>1&&(this.__curPercent=1),this.__onProgessCallback(this.__curPercent)}}},t.prototype.loadJsonByPath=function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),o(this,void 0,void 0,function(){var o,a,s,c;return r(this,function(r){switch(r.label){case 0:return o="",a=t.lastIndexOf("/"),o=-1!=a?t.substring(a+1):t,(s=this.jsons.get(o))?[2,s]:[4,i.loader.loadRes("common/json/"+t,cc.JsonAsset)];case 1:return(c=r.sent())?(s=this.initJson(c,e),n&&this.jsons.set(o,s),[2,s]):(console.error("json is not find",t,o),[2,null])}})})},t.prototype.loadJsonByName=function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),o(this,void 0,void 0,function(){return r(this,function(o){switch(o.label){case 0:return[4,this.loadJsonByPath(t,e,n)];case 1:return[2,o.sent()]}})})},t.prototype.loadStartJsons=function(t){return o(this,void 0,void 0,function(){var e,n;return r(this,function(o){switch(o.label){case 0:return e=i.loader.getBundle(u.Bundle.START),n=0,[4,this._loadJsons("cnJson",!1,e,function(e,o){var r=e/o;n>r&&t(.25*r)})];case 1:return o.sent(),n=0,[4,this._loadJsons("commonJson",!0,e,function(e,o){var r=e/o;n>r&&t(.25+.5*r)})];case 2:return o.sent(),n=0,[4,this._loadJsons("internalJson",!1,e,function(e,o){var r=e/o;n>r&&t(.75+.25*r)})];case 3:return o.sent(),[2]}})})},t.prototype.loadJsons=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,Promise.all([this._loadJsons("cnJson",!1),this._loadJsons("commonJson",!0),this._loadJsons("internalJson",!1)])];case 1:return t.sent(),[2]}})})},t.prototype._loadJsons=function(t,e,n,a){return o(this,void 0,void 0,function(){var o,s=this;return r(this,function(r){switch(r.label){case 0:return o="common/json/"+t,[4,i.loader.loadResDir(o,cc.JsonAsset,function(e,n){a?a(e,n):s.onInitLoadProgess(t,e,n,.33333)},n)];case 1:return r.sent().forEach(function(t){s.jsons.set(t.name,s.initJson(t,e)),i.loader.releaseRes(o+"/"+t.name,cc.JsonAsset)}),[2]}})})},t.prototype.initJson=function(t,e){var n={};return t.json.length>0&&void 0!==t.json[0].id&&t.json.forEach(function(t){n[t.id]||(n[t.id]=t)}),e&&c.encHelper.encJson(t.json),{datas:t.json,length:t.json.length,dataIdMap:n,getById:function(t){return this.dataIdMap[t]},get:function(t,e){return this.datas.filter(function(n){return n[t]===e})}}},t.prototype.loadJsonsByBundle=function(t,e){return o(this,void 0,void 0,function(){var n,o=this;return r(this,function(r){switch(r.label){case 0:return[4,i.loader.loadBundle(t)];case 1:return n=r.sent(),[4,i.loader.loadResDir("json",cc.JsonAsset,function(t,e){return o.onInitLoadProgess("json",t,e,.33333)},n)];case 2:return r.sent().forEach(function(t){o.jsons.set(t.name,o.initJson(t,e))}),n.releaseAll(),cc.assetManager.removeBundle(n),[2]}})})},t.prototype.loadImages=function(t){return o(this,void 0,void 0,function(){var e=this;return r(this,function(n){switch(n.label){case 0:return[4,i.loader.loadResDir("common/image",cc.SpriteFrame,function(n,o){t?t(n,o):e.onInitLoadProgess("image",n,o)},i.loader.getBundle(u.Bundle.START))];case 1:return n.sent().forEach(function(t){return e.images.set(t.name,t)}),[2]}})})},t.prototype.loadPrefab=function(){return o(this,void 0,void 0,function(){var t=this;return r(this,function(e){switch(e.label){case 0:return[4,i.loader.loadResDir("common/prefab",cc.Prefab,function(e,n){return t.onInitLoadProgess("prefab",e,n)})];case 1:return e.sent().forEach(function(e){return t.prefabs.set(e.name,e)}),[2]}})})},t.prototype.loadPrefabByPath=function(t){return o(this,void 0,void 0,function(){var e,n,o;return r(this,function(r){switch(r.label){case 0:return e="",n=t.lastIndexOf("/"),e=-1!=n?t.substring(n+1):t,(o=this.prefabs.get(e))&&o.isValid?[2,o]:[4,i.loader.loadRes("common/prefab/"+t,cc.Prefab)];case 1:return o=r.sent(),this.prefabs.set(e,o),[2,o]}})})},t.prototype.setTempPrefab=function(t,e){this.prefabs.set(t,e)},t.prototype.loadAudio=function(t){return o(this,void 0,void 0,function(){var e=this;return r(this,function(n){switch(n.label){case 0:return[4,i.loader.loadResDir("common/sound",cc.AudioClip,function(n,o){t?t(n,o):e.onInitLoadProgess("sound",n,o)},i.loader.getBundle(u.Bundle.START))];case 1:return n.sent().forEach(function(t){return e.audios.set(t.name,t)}),[2]}})})},t.prototype.loadMaterial=function(t){return o(this,void 0,void 0,function(){var e=this;return r(this,function(n){switch(n.label){case 0:return[4,i.loader.loadResDir("common/material",cc.Material,function(n,o){t?t(n,o):e.onInitLoadProgess("material",n,o)},i.loader.getBundle(u.Bundle.START))];case 1:return n.sent().forEach(function(t){return e.materials.set(t.name,t)}),[2]}})})},t.prototype.enabledBMFont=function(){if(cc.sys.isNative){if(this.tmpMemoryWarning>=20)return!1}else if(assetsMgr.isLowMemory(2))return!1;return this._enabledBMFontBef=!0,!0},t.prototype.loadFont=function(t){return o(this,void 0,void 0,function(){var e,n,o=this;return r(this,function(r){switch(r.label){case 0:return t=t||a.languageMgr.lang,[4,i.loader.loadResDir("common/font/"+t,cc.Font,function(t,e){return o.onInitLoadProgess("font",t,e)})];case 1:return e=r.sent(),n=this.getFontMapByAdd(t),e.forEach(function(t){return n.set(t.name,t)}),[2]}})})},t.prototype.getFontMapByAdd=function(t){t=t||a.languageMgr.lang;var e=this.fonts.get(t);return e||(e=new Map,this.fonts.set(t,e)),e},t.prototype.loadFontByName=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,this.loadFontByPath("common/font/"+a.languageMgr.lang+"/"+t)];case 1:return[2,e.sent()]}})})},t.prototype.releaseFont=function(t,e){var n=this.getFontMapByAdd(e),o=n.get(t);if(o){var r="common/font/"+e+"/"+t;i.loader.releaseRes(r,cc.Font),o.refCount<=0&&n.delete(t)}},t.prototype.loadFontByPath=function(t){return o(this,void 0,void 0,function(){var e,n,o,a;return r(this,function(r){switch(r.label){case 0:return e="",n=t.lastIndexOf("/"),e=-1!=n?t.substring(n+1):t,o=this.getFontMapByAdd(),[4,i.loader.loadRes(t,cc.Font)];case 1:return a=r.sent(),o.set(e,a),[2,a]}})})},t.prototype.getImage=function(t){return this.images.get(t)},t.prototype.getJson=function(t){return this.jsons.get(t)},t.prototype.getJsonData=function(t,e){var n;return null===(n=this.getJson(t))||void 0===n?void 0:n.getById(e)},t.prototype.getPrefab=function(t){return this.prefabs.get(t)},t.prototype.getAudio=function(t){return this.audios.get(t)},t.prototype.getMaterial=function(t){return this.materials.get(t)},t.prototype.getFontDynamic=function(t){return o(this,void 0,Promise,function(){return r(this,function(e){switch(e.label){case 0:return[4,this.loadFontByName(t)];case 1:return[2,e.sent()]}})})},t.prototype.lang=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!t)return"";var o=[];e.forEach(function(t){return Array.isArray(t)?o.pushArr(t):o.push(t)});var r=t.split("."),i=r[0],s=r[1],c=this.getJsonData(i,s)||{},l=c[a.languageMgr.lang];return void 0!==l?ut.stringFormat(l,this.updateParams(o,a.languageMgr.lang)):ut.stringFormat(t,this.updateParams(o,a.languageMgr.lang))},t.prototype.updateParams=function(t,e){var n=this;return t.map(function(t){if("string"==typeof t&&-1!==t.indexOf(".")){var o=t.split("."),r=o[0],i=o[1],a=(n.getJsonData(r,i)||{})[e];return void 0!==a?a:t}return t})},t.prototype.makeTypeName=function(t){var e=cc.js.getClassName(t);return"cc.Prefab"===e?"prefab/":"cc.SpriteFrame"===e?"image/":"cc.AudioClip"===e?"sound/":"sp.SkeletonData"===e?"spine/":"cc.JsonAsset"===e?"json/":""},t.prototype.loadTempRes=function(t,e,n,a){return o(this,void 0,Promise,function(){var o,s=this;return r(this,function(){return(o=this.temps.get(t))?[2,this.addTempResRefs(o,n)]:[2,new Promise(function(o){var r="tmp/"+s.makeTypeName(e)+t,c=s.loadTempQueueMap.get(r);if(c)return c.push({cb:o,tag:n});s.loadTempQueueMap.set(r,[{cb:o,tag:n}]),i.loader.load(r,e,a).then(function(n){var o=s.loadTempQueueMap.get(r);if(!o)return i.loader.printError("\u52a0\u8f7d\u9519\u8bef not funcs? url="+r);o.forEach(function(o){n?s.addTempRes(t,r,n,e,o.tag).then(function(){return o.cb(n)}):(console.error("loader \u52a0\u8f7d\u9519\u8bef",r),o.cb(n))}),s.loadTempQueueMap.delete(r)})})]})})},t.prototype.loadTempRseDir=function(t,e,n){return o(this,void 0,Promise,function(){var a,s,c=this;return r(this,function(){return a="tmp/"+this.makeTypeName(e),s=a+t+"__dir",[2,new Promise(function(l){return o(c,void 0,void 0,function(){var o,c,u,p,h,d,f,y,_,g;return r(this,function(r){switch(r.label){case 0:return(o=this.loadTempQueueMap.get(s))?[2,o.push({cb:l,tag:n})]:(this.loadTempQueueMap.set(s,[{cb:l,tag:n}]),[4,i.loader.loadDir(a+t,e)]);case 1:if(c=r.sent(),!(u=this.loadTempQueueMap.get(s)))return[2,i.loader.printError("\u52a0\u8f7d\u9519\u8bef not funcs? url="+a)];this.debug=!1,p=0,h=u.length,r.label=2;case 2:if(!(p<h))return[3,7];d=u[p],f=0,y=c.length,r.label=3;case 3:return f<y?(_=c[f],g=t+"/"+_.name,[4,this.addTempRes(g,a+g,_,e,d.tag)]):[3,6];case 4:r.sent(),r.label=5;case 5:return f++,[3,3];case 6:return p++,[3,2];case 7:return u.forEach(function(t){return t.cb(c)}),this.loadTempQueueMap.delete(s),[2]}})})})]})})},t.prototype.loadRemote=function(t,e,n){return o(this,void 0,Promise,function(){var o,a;return r(this,function(r){switch(r.label){case 0:return t?(o=this.temps.get(t))?[2,new cc.SpriteFrame(this.addTempResRefs(o,n))]:[4,i.loader.loadRemote(t,e)]:[2,Promise.resolve(null)];case 1:return(a=r.sent())?a instanceof cc.Texture2D?[4,this.addTempRes(t,t,a,cc.Texture2D,n)]:(i.loader.printError("\u52a0\u8f7d\u9519\u8bef \u683c\u5f0f\u4e0d\u5bf9 url="+t),[2,Promise.resolve(null)]):[2,Promise.resolve(null)];case 2:return r.sent(),[2,new cc.SpriteFrame(a)]}})})},t.prototype.addTempRes=function(t,e,n,a,s){return o(this,void 0,void 0,function(){var o;return r(this,function(r){switch(r.label){case 0:return(o=this.temps.get(t))?[3,2]:(o={name:t,asset:n,url:e,type:a,tagCount:0,refs:{}},this.temps.set(t,o),this.addTempResRefs(o,s),[4,i.loader.loadResComplete(0,e,n)]);case 1:return r.sent(),[3,3];case 2:this.addTempResRefs(o,s),r.label=3;case 3:return[2]}})})},t.prototype.addTempResRefs=function(t,e){return e=e||"",t.refs[e]?t.refs[e]++:(t.tagCount++,t.refs[e]=1),t.asset},t.prototype.removeTempResRef=function(t,e){void 0!==t.refs[e]&&(delete t.refs[e],t.tagCount--,t.tagCount<=0&&(this.temps.delete(t.name),i.loader.releaseRes(t.url,t.type)))},t.prototype.releaseTempRes=function(t,e){var n=this.temps.get(t);if(!n)return i.loader.printInfo("try release null res["+t+"]");e=e||"";var o=n.refs[e];if(!o)return i.loader.printError("release error not ref["+e+"] at "+n.url);(o=n.refs[e]=o-1)<=0&&this.removeTempResRef(n,e)},t.prototype.releaseTempAsset=function(t){var e=this.temps.get(t);if(!e)return i.loader.printInfo("try release null res["+t+"]");this.temps.delete(t),i.loader.releaseAsset(e.url,e.type)},t.prototype.releaseTempResByTag=function(t){var e=this;this.temps.forEach(function(n){return e.removeTempResRef(n,t)})},t.prototype.transform=function(t,e){return void 0===e&&(e={}),cc.assetManager._transform(t,e)},t.prototype.loadOnceRes=function(t,e){return o(this,void 0,void 0,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return n="tmp/"+this.makeTypeName(e)+t,[4,i.loader.load(n,e)];case 1:return(o=r.sent())&&o.addRef(),[2,o]}})})},t.prototype.releaseOnceRes=function(t,e){var n="tmp/"+this.makeTypeName(e)+t;i.loader.releaseRes(n,e)},t.prototype.onMemoryWarning=function(){this.memoryWarning++,this.tmpMemoryWarning++,storageMgr.setOrgItem("__@memoryWarning",this.memoryWarning+""),a.languageMgr.lang,!this.enabledBMFont()&&this._enabledBMFontBef&&(this._enabledBMFontBef=!1,eventMgr.emit(s.default.LANGUAGE_CLEAN))},t.prototype.isLowMemory=function(t){if(void 0===t&&(t=1),this.memoryWarning>=t)return!0;if(ut.isWechatOrQQ()&&wx.getSystemInfoSync)try{var e=wx.getSystemInfoSync();if(ut.isAndroid()&&e.benchmarkLevel&&e.benchmarkLevel>=1)return t<=1?e.benchmarkLevel<=10:t<=2?e.benchmarkLevel<=15:e.benchmarkLevel<=20;if(e.model&&["iphone x","iphone 8 plus","iphone 8","iphone 7 plus","iphone 7","iphone 6s plus","iphone se","iphone 6s","iphone 6","iphone 6 plus","iphone 5s","iPhone 5","iPhone 5c","iPhone 4S","iPhone 4"].has(e.model))return!0}catch(n){console.log(n)}return!1},t.prototype.preloadInGuide=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,i.loader.startLoadBundle(u.Bundle.RES)];case 1:return t.sent(),[4,i.loader.preloadDir("common/prefab",null)];case 2:t.sent(),t.label=3;case 3:return mc.currWindName&&"null"!==mc.currWindName?[3,5]:[4,ut.waitTimeout(100)];case 4:return t.sent(),[3,3];case 5:return[2]}})})},t.prototype.setPreloadConcurrency=function(t,e){var n=cc.assetManager.presets.preload;n.maxConcurrency=t,n.maxRequestsPerFrame=e},t.prototype.setDownloadConcurrency=function(t,e){cc.assetManager.downloader.maxConcurrency=t,cc.assetManager.downloader.maxRequestsPerFrame=e},t}();window.assetsMgr=new p,cc._RF.pop()},{"../../script/common/constant/Enums":"Enums","../../script/common/event/EventType":"EventType","../../script/common/helper/EncHelper":"EncHelper","../event/CoreEventType":"CoreEventType","../manage/LanguageMgr":"LanguageMgr","../utils/ResLoader":"ResLoader"}],AtomicLock:[function(t,e,n){"use strict";cc._RF.push(e,"2539ccnTEJOn6bHBnBdvO7w","AtomicLock"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../../script/common/helper/GameHelper"),r=function(){function t(){this.lockes={}}return t.prototype.getsetLock=function(t,e){for(var n in this.lockes)this.lockes[n].etime&&this.lockes[n].etime<o.gameHelper.now()&&this.deleteLock(n);var r=this.lockes[t];return null==r&&(this.lockes[t]={key:t,etime:e?o.gameHelper.now()+e:0}),r},t.prototype.deleteLock=function(t){delete this.lockes[t]},t}();n.default=r,window.atomicLock=new r,cc._RF.pop()},{"../../script/common/helper/GameHelper":"GameHelper"}],AudioMgr:[function(t,e,n){"use strict";cc._RF.push(e,"d4e27fQr8FOvbIoEipdjK2J","AudioMgr");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i=t("../utils/ResLoader"),a=function(){function t(){this.__bgmVolume=1,this.__sfxVolume=1,this.__isPause=!1,this.__bgmClip=null,this.__bgmUrl="",this.__bgmLastUrl="",this.__bgmVolumeRatio=1,this.__caches=[],this.__sfxs_infos=[],this.onAudioInterruptionBegin=null,this.onAudioInterruptionEnd=null}return t.prototype.init=function(){var t=this,e=storageMgr.loadNumber("bgm_volume");this.__bgmVolume=null!==e?e:1;var n=storageMgr.loadNumber("sfx_volume");if(this.__sfxVolume=null!==n?n:1,lplog.info("bgmVolume:",this.__bgmVolume," sfxVolume:",this.__sfxVolume),ut.isWechatOrQQ()){var o=function(){t.pauseAll(),cc.audioEngine.pauseMusic()},r=function(){t.resumeAll(),cc.audioEngine.resumeMusic()};wx.onAudioInterruptionBegin(o),this.onAudioInterruptionBegin=o,wx.onAudioInterruptionEnd(r),this.onAudioInterruptionEnd=r}},t.prototype.pauseAll=function(){this.__isPause=!0,this.__sfxs_infos.forEach(function(t){return void 0!==t.id&&cc.audioEngine.pause(t.id)}),cc.audioEngine.pauseMusic()},t.prototype.resumeAll=function(){this.__isPause=!1,this.__bgmVolume>0&&cc.audioEngine.resumeMusic(),this.__sfxVolume>0&&this.__sfxs_infos.forEach(function(t){return void 0!==t.id&&cc.audioEngine.resume(t.id)})},t.prototype.stopAll=function(){cc.audioEngine.stopAll()},Object.defineProperty(t.prototype,"bgmVolume",{get:function(){return this.__bgmVolume},set:function(t){this.__bgmVolume=t,storageMgr.saveNumber("bgm_volume",t),t<=0?this.stopBGM():this.playBGM(this.__bgmUrl)},enumerable:!1,configurable:!0}),t.prototype.setTempBgmVolume=function(t){cc.audioEngine.setMusicVolume(t*this.__bgmVolumeRatio)},Object.defineProperty(t.prototype,"sfxVolume",{get:function(){return this.__sfxVolume},set:function(t){this.__sfxVolume=t,storageMgr.saveNumber("sfx_volume",t),this.__sfxs_infos.forEach(function(e){return void 0!==e.id&&cc.audioEngine.setVolume(e.id,t)})},enumerable:!1,configurable:!0}),t.prototype.load=function(t){return o(this,void 0,void 0,function(){var e,n,o;return r(this,function(r){switch(r.label){case 0:t=Array.isArray(t)?t:[t],e=0,n=t.length,r.label=1;case 1:return e<n?[4,this.__load(t[e])]:[3,4];case 2:(o=r.sent())&&this.__addAudio(o.mod,o.url,o.audio),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.preload=function(t){return o(this,void 0,void 0,function(){var e;return r(this,function(n){switch(n.label){case 0:return[4,this.__load(t)];case 1:return(e=n.sent()).audio?this.__addAudio(e.mod,e.url,e.audio):lplog.error("load error url=",t),[2]}})})},t.prototype.loadByMod=function(t){return o(this,void 0,void 0,function(){var e,n=this;return r(this,function(o){switch(o.label){case 0:return t=t||mc.currWindName,e="sound/"+t,[4,i.loader.loadResDir(e,cc.AudioClip)];case 1:return o.sent().forEach(function(o){return n.__addAudio(t,e+"/"+o.name,o)}),[2]}})})},t.prototype.release=function(t){var e=this.__getForCache(t);e&&(this.__caches.remove("url",e.url),this.__sfxs_infos.remove("url",e.url)||this.__sfxs_infos.remove("url",e.audio.nativeUrl),i.loader.releaseRes(e.url,cc.AudioClip))},t.prototype.releaseByMod=function(t){t=t||mc.currWindName;for(var e=this.__caches.length-1;e>=0;e--){var n=this.__caches[e];n.mod===t&&(this.__caches.splice(e,1),this.__sfxs_infos.remove("url",n.url)||this.__sfxs_infos.remove("url",n.audio.nativeUrl),i.loader.releaseAsset(n.url,cc.AudioClip))}},t.prototype.releaseAll=function(){for(;this.__caches.length>0;)i.loader.releaseAsset(this.__caches.pop().url,cc.AudioClip);this.__sfxs_infos.length=0},t.prototype.__addAudio=function(t,e,n){this.__caches.some(function(t){return t.url===e})||this.__caches.push({mod:t,url:e,audio:n})},t.prototype.__load=function(t){return o(this,void 0,void 0,function(){var e,n,o,a,s,c;return r(this,function(r){switch(r.label){case 0:return e=t.split("/"),n=e[0],o=e[1],a=null,s="",c="",i.loader.error=!1,o?[3,4]:(s=mc.currWindName,c="sound/"+s+"/"+n,[4,i.loader.loadRes(c,cc.AudioClip)]);case 1:return(a=r.sent())?[3,3]:(c="sound/"+(s="common")+"/"+n,[4,i.loader.loadRes(c,cc.AudioClip)]);case 2:a=r.sent(),r.label=3;case 3:return[3,6];case 4:return c="sound/"+(s=n)+"/"+o,[4,i.loader.loadRes(c,cc.AudioClip)];case 5:a=r.sent(),r.label=6;case 6:return i.loader.error=!0,[2,{mod:s,url:c,audio:a}]}})})},t.prototype.__getForCache=function(t){var e=t.split("/"),n=e[0],o=e[1],r=null,i="";return o?(i="sound/"+n+"/"+o,r=this.__caches.find(function(t){return t.url===i})):(i="sound/"+mc.currWindName+"/"+n,(r=this.__caches.find(function(t){return t.url===i}))||(i="sound/common/"+n,r=this.__caches.find(function(t){return t.url===i}))),r},t.prototype.__getAudio=function(t){var e=assetsMgr.getAudio(t);if(e)return e;var n=this.__getForCache(t);return n?n.audio:null},t.prototype.playBGM=function(t,e){var n=this;if(void 0===e&&(e=1),t&&(this.stopBGM(),t instanceof cc.AudioClip?this.__bgmUrl=t.url:this.__bgmUrl=t,0!==this.__bgmVolume)){if(t instanceof cc.AudioClip)return this.__playBGM(t,e);var o=this.__getAudio(t);o?this.__playBGM(o,e):this.__load(t).then(function(o){o.audio?(n.__addAudio(o.mod,o.url,o.audio),n.__playBGM(o.audio,e)):lplog.error("playBGM error url=",t)})}},t.prototype.__playBGM=function(t,e){this.__bgmVolumeRatio=e,this.__bgmClip=t,cc.audioEngine.setMusicVolume(this.bgmVolume*this.__bgmVolumeRatio),cc.audioEngine.playMusic(t,!0)},t.prototype.stopBGM=function(){this.__bgmLastUrl=this.__bgmUrl,this.__bgmClip&&(cc.audioEngine.stopMusic(),this.release(this.__bgmLastUrl),this.__bgmClip=null)},t.prototype.playSFX=function(t,e){return o(this,void 0,void 0,function(){var n,o,i;return r(this,function(r){switch(r.label){case 0:return t?this.sfxVolume<=0&&!(null==e?void 0:e.loop)?[2,-1]:(n=(null==e?void 0:e.tag)||"",t instanceof cc.AudioClip?(this.__sfxs_infos.push({url:t.nativeUrl,tag:n}),[2,this.__playSFX(t,t.nativeUrl,e)]):(o=this.__getAudio(t))?(this.__sfxs_infos.push({url:t,tag:n}),[2,this.__playSFX(o,t,e)]):(this.__sfxs_infos.push({url:t,tag:n}),[4,this.__load(t)])):[2,-1];case 1:return(i=r.sent())?(this.__addAudio(i.mod,i.url,i.audio),[2,this.__playSFX(i.audio,t,e)]):(lplog.error("playSFX error url=",t),[2,-1])}})})},t.prototype.__playSFX=function(t,e,n){var o,r,i=this,a=(null==n?void 0:n.tag)||"",s=this.__sfxs_infos.find(function(t){return t.url===e&&t.tag===a});if(s){var c=!!(null==n?void 0:n.loop),l=null!==(o=null==n?void 0:n.volume)&&void 0!==o?o:1,u=null!==(r=null==n?void 0:n.startTime)&&void 0!==r?r:0,p=null==n?void 0:n.onComplete,h=s.id=cc.audioEngine.play(t,c,this.sfxVolume*l);return c||cc.audioEngine.setFinishCallback(h,function(){i.__sfxs_infos.remove("id",h),p&&p()}),u&&cc.audioEngine.setCurrentTime(h,u),this.__isPause&&cc.audioEngine.pause(h),h}},t.prototype.stopSFX=function(t,e){void 0===e&&(e=""),"number"==typeof t?(cc.audioEngine.stop(t),this.__sfxs_infos.remove("id",t)):"string"==typeof t?this.__sfxs_infos.delete(function(n){return n.url===t&&n.tag===e}).forEach(function(t){return cc.audioEngine.stop(t.id)}):t instanceof cc.AudioClip&&this.__sfxs_infos.delete(function(n){return n.url===t.url&&n.tag===e}).forEach(function(t){return cc.audioEngine.stop(t.id)})},t.prototype.clean=function(){this.onAudioInterruptionBegin&&(wx.offAudioInterruptionBegin(this.onAudioInterruptionBegin),this.onAudioInterruptionBegin=null),this.onAudioInterruptionEnd&&(wx.offAudioInterruptionEnd(this.onAudioInterruptionEnd),this.onAudioInterruptionEnd=null)},t}();window.audioMgr=new a,cc._RF.pop()},{"../utils/ResLoader":"ResLoader"}],AuthTipPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"6aef44O0OJK1Y2ud/fpdOvE","AuthTipPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../../startScene/version"),l=t("../../common/apple/AppleHelper"),u=t("../../common/helper/GameHelper"),p=cc._decorator.ccclass,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maskNode_=null,e.contentNode_=null,e.bgNode_=null,e.descNode_=null,e.nextNode_=null,e.cb=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.setParam({isMask:!1}),this.bgNode_.FindChild("val",cc.MultiFrame).setFrame("dl_attsqts_"+c.default.getLocalLang()),[2]})})},e.prototype.onEnter=function(t,e){var n,o=this;(null==t?void 0:t.isValid)&&(this.node.parent=t,this.node.zIndex=1e3),this.cb=e;var r="main"===mc.currScene,i=r?cc.LocaleLabel:cc.LangLabel;this.nextNode_.Child("val").addComponent(i).setLangKey(r?"ui.button_go":"app.button_go"),this.descNode_.children.forEach(function(t){t.addComponent(i).setLangKey(r?"ui.auth_tip_desc_"+t.name:"app.auth_tip_desc_"+t.name),t.getComponent(cc.Label)._forceUpdateRenderData()}),this.maskNode_.stopAllActions(),this.maskNode_.opacity=0,ut.wait(.1,this).then(function(){o.isValid&&cc.tween(o.maskNode_).to(.15,{opacity:150}).start()}),ut.waitNextFrame(2,this).then(function(){o.isValid&&(o.bgNode_.height=Math.ceil((o.descNode_.height+894)/2),o.bgNode_.children.forEach(function(t){var e;return null===(e=t.getComponent(cc.Widget))||void 0===e?void 0:e.updateAlignment()}),o.contentNode_.height=2*o.bgNode_.height)}),null===(n=u.gameHelper.global)||void 0===n||n.setShowAdAuthTip()},e.prototype.onRemove=function(){},e.prototype.onDispose=function(){this.cb=null},e.prototype.onClickNext=function(){var t=this;l.appleHelper.openAppSetting().then(function(){return t.cb&&t.cb()}),this.hide()},i([p],e)}(mc.BasePnlCmpt);n.default=h,cc._RF.pop()},{"../../../../startScene/version":void 0,"../../common/apple/AppleHelper":"AppleHelper","../../common/helper/GameHelper":"GameHelper"}],AutoReleaseCmt:[function(t,e,n){"use strict";cc._RF.push(e,"c0adaAO3FlLX4XAADY88zrt","AutoReleaseCmt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator.ccclass,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.url=null,e.tag=null,e}return r(e,t),e.prototype.init=function(t,e){this.url=t,this.tag=e},e.prototype.onDestroy=function(){this.url&&(assetsMgr.releaseTempRes(this.url,this.tag),this.url=null)},i([a],e)}(cc.Component);n.default=s,cc._RF.pop()},{}],BannerAdMgr:[function(t,e,n){"use strict";cc._RF.push(e,"8de170q5hFCm7rRf8rElhF8","BannerAdMgr"),Object.defineProperty(n,"__esModule",{value:!0}),n.bannerAdMgr=void 0;var o=t("../../script/common/helper/GameHelper"),r=function(){function t(){}return t.prototype.checkBannerAd=function(t,e){if(!o.gameHelper.ad.bannerAd)return{offsetY:0,maxAdaptScale:1.2};var n=!1,r=1.2,i=0;if(ut.isWechatOrQQ())if(e.getContentSize().height<1250){i=150;var a=o.gameHelper.ad.bannerAd.getBoundary().yMax,s=e.scale;e.scale=1;var c=e.getBoundingBoxToWorld(),l=c.yMin,u=c.height;e.scale=s;var p=l-a-.3*a;p<0?n=!1:(n=!0,r=Math.min(1.2,(p+u)/u))}else n=!1;return n?o.gameHelper.ad.showBannerAd():o.gameHelper.ad.hideAllBannerAd(),{offsetY:i,maxAdaptScale:r}},t.prototype.hide=function(){o.gameHelper.ad.hideAllBannerAd()},t}();n.bannerAdMgr=new r,cc._RF.pop()},{"../../script/common/helper/GameHelper":"GameHelper"}],BannerAd:[function(t,e,n){"use strict";cc._RF.push(e,"0221cxR8txCBayGWbD0Tqf+","BannerAd");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.FBInstantBannerAd=n.NativeBannerAd=n.WxBannerAd=void 0;var i,a=t("../constant/Enums"),s=t("../event/JsbEvent"),c=t("../wx/WxHelper"),l=t("../helper/GameHelper");(function(t){t[t.BANNER=0]="BANNER",t[t.GAME_BANNER=1]="GAME_BANNER",t[t.GRID_BANNER=2]="GRID_BANNER"})(i||(i={}));var u=function(){function t(){this.bannerAdMap={},this._adList=null}return Object.defineProperty(t.prototype,"adList",{get:function(){return this._adList||("undefined"!=typeof qq?this._adList=[]:this._adList=[{id:"adunit-b35911ad12b9a367",type:i.BANNER}]),this._adList},enumerable:!1,configurable:!0}),t.prototype.load=function(t){for(var e=0,n=this.adList;e<n.length;e++){var o=n[e],r=o.id,a=o.type;this.bannerAdMap[r]?this.updateAdInfo(r,t):a==i.BANNER&&this.loadBannerAd(r)}},t.prototype.loadBannerAd=function(t){var e=wx.createBannerAd({adUnitId:t,style:this.getStyle(),adIntervals:60}),n={type:i.BANNER,hide:!0,state:a.AdState.LOADING,showTime:0,reloadDelay:ut.random(30,60),adIns:e,lock:!1};this.bannerAdMap[t]=n,this.initListener(n,t)},t.prototype.loadGridAd=function(){},t.prototype.loadGameBanner=function(){},t.prototype.initListener=function(t,e){var n=t.adIns;n.onError(function(n){lplog.error("loadBanner error",e,n),t.state=a.AdState.LOAD_FAIL,n&&("no Banner"==n.errMsg||0==n.errCode||1004==n.errCode?t.reloadDelay+=120:t.reloadDelay+=60)}),n.onLoad(function(){t.state=a.AdState.LOAD_SUCCESS})},t.prototype.updateAdInfo=function(t,e){var n=this.bannerAdMap[t];if(n.state!=a.AdState.LOADING&&!n.lock)return n.hide?void(n.state==a.AdState.LOAD_FAIL&&(n.reloadDelay-=e,n.reloadDelay<=0&&this.destroy(t))):(n.showTime+=e,void(n.showTime>90&&this.hide(t)))},t.prototype.randomAd=function(){var t=this,e=this.adList.filter(function(e){var n=e.id,o=t.bannerAdMap[n];return o&&!o.lock&&o.state==a.AdState.LOAD_SUCCESS});if(!(e.length<=0))return e[ut.random(0,e.length-1)]},t.prototype.isShow=function(){for(var t in this.bannerAdMap)if(0==this.bannerAdMap[t].hide)return!0;return!1},t.prototype.show=function(){var t=this;if(!this.isShow()){var e=this.randomAd();if(e){var n=e.id,o=this.bannerAdMap[n];o.lock=!0,o.hide=!1,o.adIns.show().then(function(){o.lock=null,o.hide&&t.hide(n)}).catch(function(t){lplog.error("showBanner error",n,t),o.lock=null,o.hide=!0})}}},t.prototype.hide=function(t){var e=this.bannerAdMap[t];if(e&&!e.lock&&!e.hide&&e.state==a.AdState.LOAD_SUCCESS){var n=function(){e.showTime=0,e.hide=!0,e.lock=null};e.lock=!0;var o=e.adIns.hide();o?o.then(function(){n()}).catch(function(n){lplog.error("hideBanner error",t,n),e.lock=null}):n()}},t.prototype.hideAll=function(){for(var t in this.bannerAdMap)this.hide(t)},t.prototype.destroy=function(t){try{var e=this.bannerAdMap[t];e&&e.adIns&&e.adIns.destroy(),delete this.bannerAdMap[t]}catch(n){lplog.error("destoryBanner error",t,n)}},t.prototype.getResSize=function(){return cc.size(960,334)},t.prototype.getStyle=function(){var t=c.wxHelper.getSystemInfo(),e=t.screenWidth,n=t.screenHeight,o=400/Math.min(cc.winSize.width/e,cc.winSize.height/n),r=this.getResSize(),i=r.width,a=r.height,s=cc.misc.clampf(o/a*i,300,e);return{left:(e-s)/2,top:n-(o=s/i*a)-12,width:s,height:o}},t.prototype.getBoundary=function(){var t=c.wxHelper.getSystemInfo(),e=t.screenWidth,n=t.screenHeight,o=Math.min(cc.winSize.width/e,cc.winSize.height/n),r=this.getStyle();return cc.rect(r.left*o,(n-r.top-r.height)*o,r.width*o,r.height*o)},t}();n.WxBannerAd=u;var p=function(){function t(){this.waitTime=0,this.isSecDayLoad=!1,this.secDayLoadTime=0}return t.prototype.load=function(t){var e=this;this.state!==a.AdState.LOADING&&this.state!==a.AdState.LOAD_SUCCESS&&this.state!==a.AdState.WAIT?(this.state=a.AdState.LOADING,jsbHelper.cast(s.default.LOAD_BANNER_AD,function(t){var n=t.status;"0"===n?e.state=a.AdState.LOAD_SUCCESS:"-1"===n?e.state=a.AdState.LOAD_FAIL:"-3"===n?e.state=a.AdState.WAIT:"-5"===n?(e.state=a.AdState.WAIT,e.isSecDayLoad=!0,e.secDayLoadTime=120):"-6"===n?(e.state=a.AdState.WAIT,e.isSecDayLoad=!0,e.secDayLoadTime=6e3):"-7"===n?(e.state=a.AdState.WAIT,e.isSecDayLoad=!0,e.secDayLoadTime=120+l.gameHelper.getFixTimeSurplyTime((new Date).getTime(),-8)):(lplog.info("load Banner unknow code is "+n+" "+typeof n),e.state=a.AdState.WAIT)})):this.state===a.AdState.WAIT&&(this.isSecDayLoad&&this.secDayLoadTime?(this.waitTime+=t,this.waitTime>=this.secDayLoadTime&&(this.waitTime=0,this.state=a.AdState.LOAD_FAIL,this.isSecDayLoad=!1,this.secDayLoadTime=0)):(this.waitTime+=t,this.waitTime>=30&&(this.waitTime=0,this.state=a.AdState.LOAD_FAIL)))},t.prototype.isReady=function(){return this.state==a.AdState.LOAD_SUCCESS},t.prototype.show=function(){this.isReady()&&jsbHelper.cast(s.default.SHOW_BANNER_AD)},t.prototype.hide=function(){this.isReady()&&jsbHelper.cast(s.default.HIDE_BANNER_AD)},t.prototype.getBoundary=function(){return cc.rect(0,0,0,0)},t.prototype.hideAll=function(){this.isReady()&&jsbHelper.cast(s.default.HIDE_BANNER_AD)},t}();n.NativeBannerAd=p;var h=function(){function t(){this.waitTime=0,this.isSecDayLoad=!1,this.secDayLoadTime=0,this.my_placement_id="186451227433565_216344301110924"}return t.prototype.load=function(t){this.state!==a.AdState.LOADING&&this.state!==a.AdState.LOAD_SUCCESS&&this.state!==a.AdState.WAIT?(this.state=a.AdState.LOADING,this.isSupportBannerAd()&&(this.state=a.AdState.LOAD_SUCCESS)):this.state===a.AdState.WAIT&&(this.isSecDayLoad&&this.secDayLoadTime?(this.waitTime+=t,this.waitTime>=this.secDayLoadTime&&(this.waitTime=0,this.state=a.AdState.LOAD_FAIL,this.isSecDayLoad=!1,this.secDayLoadTime=0)):(this.waitTime+=t,this.waitTime>=30&&(this.waitTime=0,this.state=a.AdState.LOAD_FAIL)))},t.prototype.isSupportBannerAd=function(){return-1!==FBInstant.getSupportedAPIs().indexOf("loadBannerAdAsync")},t.prototype.isReady=function(){return this.state==a.AdState.LOAD_SUCCESS},t.prototype.show=function(){var t=this;if(this.isReady()&&this.bannerState!=a.AdState.PLAYING){var e=function(){t.state=a.AdState.WAIT,t.isSecDayLoad=!0,t.secDayLoadTime=45};this.bannerState=a.AdState.PLAYING,FBInstant.loadBannerAdAsync(this.my_placement_id).then(function(){e(),t.bannerState=a.AdState.PLAY_SUCCESS,lplog.info("[banner ad] load success")}).catch(function(n){lplog.info("[banner ad] load fail: ",n),e(),t.bannerState=a.AdState.PLAY_FAIL})}},t.prototype.hide=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return this.bannerState!=a.AdState.PLAY_SUCCESS&&this.bannerState!=a.AdState.PLAY_FAIL?[3,1]:(this.bannerState=null,FBInstant.hideBannerAdAsync().then(function(){lplog.info("[hideBannerAdAsync success: ]")}).catch(function(t){lplog.error("[hideBannerAdAsync error: ]",t)}),[3,3]);case 1:return this.bannerState!=a.AdState.PLAYING?[3,3]:[4,ut.wait(.2)];case 2:t.sent(),this.hide(),t.label=3;case 3:return[2]}})})},t.prototype.hideAll=function(){this.hide()},t.prototype.getBoundary=function(){return cc.rect(0,0,0,0)},t}();n.FBInstantBannerAd=h,cc._RF.pop()},{"../constant/Enums":"Enums","../event/JsbEvent":"JsbEvent","../helper/GameHelper":"GameHelper","../wx/WxHelper":"WxHelper"}],BaseCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"8d545J61E9Fx6WfMj/0j8P2","BaseCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i={n:{fix:"Node_",type:cc.Node},l:{fix:"Lbl_",type:cc.Label},s:{fix:"Spr_",type:cc.Sprite},b:{fix:"Btn_",type:cc.Button},t:{fix:"Tge_",type:cc.Toggle},a:{fix:"Ani_",type:cc.Animation},sv:{fix:"Sv_",type:cc.ScrollView},rt:{fix:"Rt_",type:cc.RichText},tc:{fix:"Tc_",type:cc.ToggleContainer},sp:{fix:"Sp_",type:null===sp||void 0===sp?void 0:sp.Skeleton},eb:{fix:"Eb_",type:cc.EditBox}},a={be:cc.Button,te:cc.Toggle,se:cc.Slider,tce:cc.ToggleContainer,nbe:cc.Button},s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isLoadedProperty=!1,e}return r(e,t),e.prototype.__preload=function(){this.loadProperty()},e.prototype.loadProperty=function(){if(!this._isLoadedProperty){for(var t=this.node.children,e=0;e<t.length;e++)this.__assembleFuckNodes(t[e]);this._isLoadedProperty=!0}},e.prototype.__areYouEvent=function(t){return!!a[t.split("@")[0]]},e.prototype.__isCmpt=function(t){return i[t]||"w"===t||"wg"===t},e.prototype.__getFirstCmpt=function(t){var e=t[0];for(t.shift();t.length>0;){var n=t[0];if(this.__isCmpt(n)||this.__areYouEvent(n))break;e+=ut.initialUpperCase(n),t.shift()}return e},e.prototype.__assembleFuckNodes=function(t){var e=this,n=t.name.split("_"),o=!1;if(n.length>=2&&n[0])for(var r=this.__getFirstCmpt(n),s=!!n.remove("w"),c=function(c){var u=n[c],p=i[u];if(p){var h=r+p.fix;if(void 0!==l[h])if("Node_"===p.fix)l[h]=t;else{var d=t.getComponent(p.type);d?l[h]=d:lplog.error(h+" no fuck cmpt at="+l.__classname__)}else lplog.error(h+" no fuck propert at="+l.__classname__)}else if("wg"===u){var f=l.__addFuckDiyCmpt(t,ut.initialUpperCase(r)+"WdtCtrl");s&&void 0!==l[h=r+"Wdt_"]&&(l[h]=f),o=!0}else{var y=u.split("@"),_=y[0],g=y[1],m=a[_];m&&("nbe"===_?t.children.forEach(function(t){return e.__fuckClickHandler(t,r,m,g)}):l.__fuckClickHandler(t,r,m,g))}},l=this,u=0,p=n.length;u<p;u++)c(u);if(!o){var h=t.children;for(u=0,p=h.length;u<p;u++)this.__assembleFuckNodes(h[u])}},e.prototype.__fuckClickHandler=function(t,e,n,o){var r="onClick"+ut.initialUpperCase(e);if(this[r]&&"function"==typeof this[r]){var i=t.getComponent(n);if(i){var a=this.__getFuckEvents(i);a?a[0]=this.__newFuckEventHandler(r,o):lplog.error(r+" no fuck events at="+this.__classname__+"."+t.name)}else lplog.error(r+" no fuck cmpt at="+this.__classname__+"."+t.name)}else lplog.error(r+" no fuck function at="+this.__classname__+"."+t.name)},e.prototype.__getFuckEvents=function(t){return t instanceof cc.Toggle||t instanceof cc.ToggleContainer?t.checkEvents:t instanceof cc.Button?t.clickEvents:t instanceof cc.Slider?t.slideEvents:null},e.prototype.__newFuckEventHandler=function(t,e){var n=new cc.Component.EventHandler;return n.target=this.node,n.component=this.__classname__,n.handler=t,n.customEventData=e||"",n},e.prototype.__addFuckDiyCmpt=function(t,e){if(!cc.js.getClassByName(e))return lplog.error("addWdtComponent error! not found class "+e),null;var n=t.getComponent(e);return n||(n=t.addComponent(e)),n},e.prototype.__assembleListenerDict=function(t,e,n){return t.forEach(function(t){var o={type:"",cb:null,target:n,tag:"create"};for(var r in t){var i=t[r];"function"==typeof i?(o.type=r,o.cb=i):"enter"===r&&(o.tag=r)}e.push(o)}),e},e}(cc.Component);n.default=s,cc._RF.pop()},{}],BaseLanguage:[function(t,e,n){"use strict";cc._RF.push(e,"ea9a5lSWaJDLYR4254ZFqk9","BaseLanguage");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setLangKey=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n]},e}(cc.Component);n.default=i,cc._RF.pop()},{}],BaseLayerCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"48fd8/2hLZDV5lgkdfjvYCM","BaseLayerCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__listens=[],e}return r(e,t),e.prototype.__preload=function(){},e.prototype.__init=function(t){return this.setControllers(t),this.__assembleListenerDict(this.listenEventMaps(),this.__listens,this).forEach(function(t){var e=t.type,n=t.cb,o=t.target;return eventMgr.on(e,n,o)}),this.onCreate(),this},e.prototype.__clean=function(){this.__listens.forEach(function(t){var e=t.type,n=t.cb,o=t.target;return eventMgr.off(e,n,o)}),this.onClean()},e.prototype.onCreate=function(){},e.prototype.onClean=function(){},e.prototype.listenEventMaps=function(){return[]},e.prototype.setControllers=function(){},e}(t("./BaseCmpt").default);n.default=i,cc._RF.pop()},{"./BaseCmpt":"BaseCmpt"}],BaseLogger:[function(t,e,n){"use strict";cc._RF.push(e,"497dbAy22lOkrsQ/MUOBgh1","BaseLogger");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../event/CoreEventType"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.node.zIndex=100,this.node.group="ui",eventMgr.on(i.default.MVC_LOGGER_PRINT,this.onPrintLogger,this),this.onCreate()},e.prototype.onDestroy=function(){eventMgr.off(i.default.MVC_LOGGER_PRINT,this.onPrintLogger,this),this.onClean()},e.prototype.close=function(){this.node.destroy()},e.prototype.onCreate=function(){},e.prototype.onClean=function(){},e.prototype.onPrintLogger=function(){},e}(cc.Component);n.default=a,cc._RF.pop()},{"../event/CoreEventType":"CoreEventType"}],BaseModel:[function(t,e,n){"use strict";cc._RF.push(e,"44cfchvVG1Acr/mH8G0uhwX","BaseModel");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t){this.type="",this.type=t}return t.prototype.__create=function(){this.onCreate()},t.prototype.__clean=function(){this.onClean()},t.prototype.onCreate=function(){},t.prototype.onClean=function(){},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];eventMgr.emit.apply(eventMgr,o([t],e))},t.prototype.getModel=function(t){return mc.modelMgr.get(t)},t}();n.default=r,cc._RF.pop()},{}],BaseNoticeCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"f2b67CXO9dHDLPSKBWnpai9","BaseNoticeCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.__create=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this._curStatus="create",this.node.group="ui",this.__eventMaps(),this.__addEvents("create"),[4,this.onCreate()];case 1:return t.sent(),[2]}})})},e.prototype.open=function(){"enter"!==this._curStatus&&(this._curStatus="enter",this.node.active=!0,this.__addEvents("enter"))},e.prototype.hide=function(){"remove"!==this._curStatus&&(this._curStatus="remove",this.node.active=!1,this.__removeEvents("enter"))},e.prototype.onDestroy=function(){this._curStatus="clean",this.__removeEvents(),this.onClean()},e.prototype.onCreate=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.onClean=function(){},e}(t("./BaseViewCmpt").default);n.default=s,cc._RF.pop()},{"./BaseViewCmpt":"BaseViewCmpt"}],BasePnlCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"ac82dl82NJFw6AsL5cnnj0I","BasePnlCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("./BaseViewCmpt"),c=t("../event/CoreEventType"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e.moudleName="",e.url="",e.isClean=!0,e.needAction=!0,e.needDark=!0,e.Index=0,e.adaptHeight=600,e.adIndex=-1,e.isHideClean=!0,e.nextDelete=!1,e.mask=null,e}return r(e,t),e.prototype.__create=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this._curStatus="create",this.node.group="ui",this.__eventMaps(),this.__addEvents("create"),[4,this.onCreate()];case 1:return t.sent(),[2]}})})},e.prototype.__enter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];"enter"!==this._curStatus&&(this._curStatus="enter",this.__addEvents("enter")),this.onEnter.apply(this,t)},e.prototype.__remove=function(){this._curStatus="remove",this.__removeEvents("enter"),this.onRemove()},e.prototype.__clean=function(){this._curStatus="clean",this.__removeEvents(),this.onDispose()},e.prototype.checkValid=function(){return"clean"!==this._curStatus},e.prototype.__rootScaleChange=function(){this.onRootScaleChange()},e.prototype.onCreate=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.onEnter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onRemove=function(){},e.prototype.onDispose=function(){},e.prototype.onRootScaleChange=function(){},e.prototype.hide=function(){this.emit(c.default.HIDE_PNL,this)},e.prototype.close=function(){this.emit(c.default.CLOSE_PNL,this)},e.prototype.setOpacity=function(t){this.node.opacity=t,this.mask&&(this.mask.opacity=Math.min(t,150))},e.prototype.setParam=function(t){this.isClean=void 0===t.isClean?this.isClean:t.isClean,this.needAction=void 0===t.isAct?this.needAction:t.isAct,this.needDark=void 0===t.isMask?this.needDark:t.isMask,this.Index=void 0===t.Index?this.Index:t.Index,this.adaptHeight=void 0===t.adaptHeight?this.adaptHeight:t.adaptHeight,this.adIndex=void 0===t.adIndex?this.adIndex:t.adIndex,this.isHideClean=void 0===t.isHideClean?this.isHideClean:t.isHideClean},e}(s.default);n.default=l,cc._RF.pop()},{"../event/CoreEventType":"CoreEventType","./BaseViewCmpt":"BaseViewCmpt"}],BaseViewCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"9dd9605ZkVAuaxsfu+GIqb6","BaseViewCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../utils/ResLoader"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curStatus="none",e.__eventList=[],e.__needLoadSprite=!1,e.prefab=null,e}return r(e,t),e.prototype.initPrefab=function(t){this.prefab=t},e.prototype.whenSpritesLoaded=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,c.loader.retainSpriteFrame(this.prefab)];case 1:return t.sent(),[2]}})})},e.prototype.disposeAllSprites=function(){c.loader.releaseCacheSpriteFrame(this.prefab)},e.prototype.resotreAllSprites=function(){c.loader.resotreSpriteFrame(this.prefab)},e.prototype.__addEvents=function(t){this.__eventList.forEach(function(e){var n=e.type,o=e.cb,r=e.target,i=e.tag;return(!t||t===i)&&eventMgr.on(n,o,r)})},e.prototype.__removeEvents=function(t){this.__eventList.forEach(function(e){var n=e.type,o=e.cb,r=e.target,i=e.tag;return(!t||t===i)&&eventMgr.off(n,o,r)})},e.prototype.__eventMaps=function(){this.__assembleListenerDict(this.eventMaps(),this.__eventList,this)},e.prototype.addEvent=function(t,e,n){this.__eventList.push({type:t,cb:e,target:n}),"enter"===this._curStatus&&eventMgr.on(t,e,n)},e.prototype.removeEvent=function(t){var e=this.__eventList.remove("type",t);e&&eventMgr.off(e.type,e.cb,e.target)},e.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];eventMgr.emit.apply(eventMgr,s([t],e))},e.prototype.addClickEvent=function(t,e,n){if(t){if(!this[e]||"function"!=typeof this[e])return lplog.error(e+" \u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u7684\u65b9\u6cd5\u540d at="+this.__classname__);var o=this.__getFuckEvents(t);if(!o)return lplog.error(e+" \u6ca1\u6709\u5bf9\u5e94\u7684events at="+t.name);o[0]=this.__newFuckEventHandler(e,n)}},e.prototype.eventMaps=function(){return[]},e.prototype.getModel=function(t){return mc.modelMgr.get(t)},e}(t("./BaseCmpt").default);n.default=l,cc._RF.pop()},{"../utils/ResLoader":"ResLoader","./BaseCmpt":"BaseCmpt"}],BaseWdtCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"c59828ob2BH04URgN8OsUfN","BaseWdtCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this._curStatus="create",this.__eventMaps(),this.__addEvents(),this.onCreate()},e.prototype.onDestroy=function(){this._curStatus="clean",this.__removeEvents(),this.onClean()},e.prototype.onCreate=function(){},e.prototype.onClean=function(){},e}(t("./BaseViewCmpt").default);n.default=i,cc._RF.pop()},{"./BaseViewCmpt":"BaseViewCmpt"}],BaseWindCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"19f54troT1DkpCNBbt1m17j","BaseWindCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e.isClean=!0,e.isAutoReleaseSprite=!1,e}return r(e,t),e.prototype.__create=function(t){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this._curStatus="create",this.__eventMaps(),[4,this.onCreate(t)];case 1:return e.sent(),this.__addEvents("create"),[2]}})})},e.prototype.__ready=function(){return i(this,void 0,void 0,function(){return a(this,function(){return this._curStatus="ready",[2,this.onReady()]})})},e.prototype.__enter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];"enter"!==this._curStatus?(this._curStatus="enter",this.__addEvents("enter"),this.onEnter.apply(this,t)):console.error("__enter multi")},e.prototype.__leave=function(){this._curStatus="leave",this.__removeEvents("enter"),this.onLeave()},e.prototype.__clean=function(){this._curStatus="clean",this.__removeEvents(),this.onClean()},e.prototype.onCreate=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.onReady=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2]})})},e.prototype.onEnter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.onLeave=function(){},e.prototype.onClean=function(){},e.prototype.setParam=function(t){var e,n;this.isClean=null!==(e=t.isClean)&&void 0!==e?e:this.isClean,this.isAutoReleaseSprite=!this.isClean&&(null!==(n=t.isAutoReleaseSprite)&&void 0!==n?n:this.isAutoReleaseSprite)},e.prototype.onBack=function(){eventMgr.emit(mc.Event.GOTO_WIND,"main")},e}(t("./BaseViewCmpt").default);n.default=s,cc._RF.pop()},{"./BaseViewCmpt":"BaseViewCmpt"}],BlockCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"905258IkatB2rk8UwMHufFw","BlockCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../../core/component/MultiFrame"),s=t("../../../common/constant/Constant"),c=t("../../../common/constant/Enums"),l=t("../../../common/helper/ViewHelper"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){return this.soul=t,this.body=this.Child("body",cc.Sprite),this.gray=this.Child("gray",cc.Sprite),this},e.prototype.initView=function(){this.setGray(!1);var t=this.soul.color;return t==c.ColorType.DreamGem?(this.Child("dream").active=!0,this.Child("body").active=!1):(this.Child("dream").active=!1,this.Child("body").active=!0,this.body.Component(a.default).setFrame(t-1),this.gray.Component(a.default).setFrame(t-1)),this},e.prototype.setGray=function(t){this.soul.color==c.ColorType.DreamGem?(this.gray.setActive(!1),this.Child("dream/val",sp.Skeleton).play(t?"grey_1":"color_1"),l.viewHelper.setGrayMaterial(this.Child("dream"),!t)):this.gray.setActive(t)},e.prototype.isMe=function(t){return this.soul.isMe(t)},e.prototype.getColor=function(){return this.soul.color},e.prototype.changeSkin=function(t,e){var n=this.Child("skin"),o=this.Child("slected"),r=s.COLOR_LIST.has(this.soul.color);n.setActive(e&&r),o.setActive(e),e&&r&&n.Component(a.default).setFrame(t-1)},i([p],e)}(cc.Component));n.default=h,cc._RF.pop()},{"../../../../core/component/MultiFrame":"MultiFrame","../../../common/constant/Constant":"Constant","../../../common/constant/Enums":"Enums","../../../common/helper/ViewHelper":"ViewHelper"}],BlockObj:[function(t,e,n){"use strict";cc._RF.push(e,"ad821fuNdpOE7iGsuEPCANc","BlockObj"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.prototype.init=function(t,e){return this.color=t,this.coord=e,this},t.prototype.isMe=function(t){return this.coord.every(function(e,n){return t[n]==e})},t}();n.default=o,cc._RF.pop()},{}],BonusPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"3cc07a+WTdH5I9Aj2srOoGC","BonusPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator.ccclass,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardNode_=null,e.titleLbl_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("BonusPnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){cc.log("BonusPnlCtrl onEnter")},e.prototype.onRemove=function(){cc.log("BonusPnlCtrl onRemove")},e.prototype.onDispose=function(){cc.log("BonusPnlCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e)},i([c],e)}(mc.BasePnlCmpt);n.default=l,cc._RF.pop()},{}],ButtonEx:[function(t,e,n){"use strict";cc._RF.push(e,"356cc80BMlDxpmbLcfx1E6c","ButtonEx");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c,l,u=t("../base/BasePnlCmpt"),p=t("../event/CoreEventType"),h=cc._decorator,d=h.ccclass,f=h.property,y=h.menu,_=h.requireComponent,g=h.executeInEditMode;(function(t){t[t.NONE=0]="NONE",t[t.DEFAULT=1]="DEFAULT",t[t.CUSTOM=2]="CUSTOM"})(c||(c={})),function(t){t[t.NONE=0]="NONE",t[t.OPEN_PNL=1]="OPEN_PNL",t[t.HIDE_PNL=2]="HIDE_PNL",t[t.GOTO_WIND=3]="GOTO_WIND",t[t.CUSTOM=4]="CUSTOM"}(l||(l={}));var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=.1,e.positionOffset=cc.v2(),e.angleOffset=0,e.sound=c.NONE,e.soundPath="",e.soundVolume=1,e.event=l.NONE,e.eventName="",e.eventParams="",e.button=null,e.target=null,e.__originalPosition=null,e.__originalAngle=null,e.isPlayAct=!0,e.isDown=!1,e.touchId=-1,e.tempPnl=null,e.__pressedFlag=!1,e}var n;return r(e,t),n=e,e.prototype.onLoad=function(){this.button=this.getComponent(cc.Button),this.target=this.button.target?this.button.target:this.node,this.isPlayAct=!this.positionOffset.equals(cc.Vec2.ZERO),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},Object.defineProperty(e.prototype,"originalPosition",{get:function(){return this.__originalPosition||(this.__originalPosition=this.target.getPosition()),this.__originalPosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalAngle",{get:function(){return null===this.__originalAngle&&(this.__originalAngle=this.target.angle),this.__originalAngle},enumerable:!1,configurable:!0}),e.prototype.onEnable=function(){this.isPlayAct&&(this.target.stopAllActions(),this.__originalPosition&&this.target.setPosition(this.__originalPosition),null!==this.__originalAngle&&(this.target.angle=this.__originalAngle))},Object.defineProperty(e.prototype,"interactable",{get:function(){return this.button.interactable},set:function(t){this.button.interactable=t},enumerable:!1,configurable:!0}),e.prototype.onTouchStart=function(t){!this.interactable||1e4!==t.getID()&&-1!==this.touchId||(this.touchId=t.getID(),this.down())},e.prototype.onTouchMove=function(t){this.interactable&&this.touchId===t.getID()&&(this.node._hitTest(t.getLocation())?this.isDown||this.down():this.isDown&&this.restore())},e.prototype.onTouchEnd=function(t){this.__pressedFlag||!this.interactable||1e4!==t.getID()&&this.touchId!==t.getID()||(this.touchId=-1,this.restore(),this.playSound(),this.emit(),this.__pressedFlag=!0,a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,ut.waitNextFrame()];case 1:return t.sent(),this.isValid&&(this.__pressedFlag=null),[2]}})}))},e.prototype.onTouchCancel=function(t){this.interactable&&this.touchId===t.getID()&&(this.touchId=-1,this.restore())},e.prototype.down=function(){this.isDown=!0,this.isPlayAct&&(this.target.setPosition(this.originalPosition),this.target.angle=this.originalAngle,cc.tween(this.target).by(this.duration,{x:this.positionOffset.x,y:this.positionOffset.y,angle:this.angleOffset}).start())},e.prototype.restore=function(){this.isDown=!1,this.isPlayAct&&cc.tween(this.target).to(this.duration,{x:this.originalPosition.x,y:this.originalPosition.y,angle:this.originalAngle}).start()},e.prototype.playSound=function(){if(this.sound!==c.NONE){var t=this.sound===c.DEFAULT?n.DefaultClickPath:this.soundPath;t&&audioMgr.playSFX(t,{volume:this.soundVolume})}},e.prototype.emit=function(){if(this.event!==l.NONE)if(this.event===l.HIDE_PNL){if(this.eventParams)return eventMgr.emit(p.default.HIDE_PNL,this.eventParams);if(this.tempPnl)return eventMgr.emit(p.default.HIDE_PNL,this.tempPnl);var t=this.node;for(this.tempPnl=t.getComponent(u.default);!this.tempPnl;)t=t.parent,this.tempPnl=t&&t.getComponent(u.default);this.tempPnl?eventMgr.emit(p.default.HIDE_PNL,this.tempPnl):lplog.error("button event [HIDE_PNL] not pnl?")}else this.event===l.CUSTOM?eventMgr.emit(this.eventName,this.eventParams||this.target):this.event===l.OPEN_PNL?eventMgr.emit(p.default.OPEN_PNL,this.eventParams):this.event===l.GOTO_WIND?eventMgr.emit(p.default.GOTO_WIND,this.eventParams):lplog.error("button event not "+this.event)},e.DefaultClickPath="",i([f({range:[0,10]})],e.prototype,"duration",void 0),i([f(cc.Vec2)],e.prototype,"positionOffset",void 0),i([f()],e.prototype,"angleOffset",void 0),i([f({type:cc.Enum(c)})],e.prototype,"sound",void 0),i([f({visible:function(){return this.sound===c.CUSTOM}})],e.prototype,"soundPath",void 0),i([f({visible:function(){return this.sound===c.CUSTOM}})],e.prototype,"soundVolume",void 0),i([f({type:cc.Enum(l)})],e.prototype,"event",void 0),i([f({visible:function(){return this.event===l.CUSTOM}})],e.prototype,"eventName",void 0),i([f({visible:function(){return this.event!==l.NONE}})],e.prototype,"eventParams",void 0),n=i([d,g,_(cc.Button),y("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/ButtonEx")],e)}(cc.Component);n.default=m,cc.ButtonEx=m,cc._RF.pop()},{"../base/BasePnlCmpt":"BasePnlCmpt","../event/CoreEventType":"CoreEventType"}],ButtonLongPress:[function(t,e,n){"use strict";cc._RF.push(e,"1ba2d5UJ0lGD5GVQbTrAwaO","ButtonLongPress");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../script/common/helper/GameHelper"),s=cc._decorator,c=s.ccclass,l=s.property,u=s.executeInEditMode,p=(s.requireComponent,s.menu),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=null,e.touchEvent=null,e.clickTime=0,e.clickInterval=0,e.callback=null,e}return r(e,t),e.prototype.onLoad=function(){this.initButtonEvent(this.Child(0)),this.initButtonEvent(this.Child(1)),this.text||console.error(" text content is empty of "+this.__classname__)},e.prototype.init=function(t){return this.callback=t,this},e.prototype.initButtonEvent=function(t){t.on(cc.Node.EventType.TOUCH_START,this.onClickStart,this),t.on(cc.Node.EventType.TOUCH_END,this.onClickEnd,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickEnd,this)},e.prototype.onClickStart=function(t){if(-1===a.gameHelper.buttonLongTouchId){this.touchEvent=t,a.gameHelper.buttonLongTouchId=t.getID(),this.clickTime=0,this.clickInterval=.5;var e=t.target;e.stopAllActions(),e.scale=1,cc.tween(t.target).to(.1,{scale:1.05}).start()}},e.prototype.onClickEnd=function(t){if(a.gameHelper.buttonLongTouchId===t.getID()){this.touchEvent&&.5===this.clickInterval&&this.onClickButton(this.touchEvent),this.touchEvent=null,a.gameHelper.buttonLongTouchId=-1;var e=t.target;e.stopAllActions(),cc.tween(e).to(.1,{scale:1}).start()}},e.prototype.onClickButton=function(t){var e="0"===t.target.name?-1:1;if(this.callback){var n=this.callback(e);this.text.string=n+""}},e.prototype.update=function(t){this.touchEvent&&a.gameHelper.buttonLongTouchId===this.touchEvent.getID()&&(this.clickTime+=t,this.clickTime>=this.clickInterval&&(this.clickTime=0,this.clickInterval=.1,this.onClickButton(this.touchEvent)))},i([l(cc.Label)],e.prototype,"text",void 0),i([c,u,p("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/ButtonLongPress")],e)}(cc.Component);n.default=h,cc.ButtonLongPress=h,cc._RF.pop()},{"../../script/common/helper/GameHelper":"GameHelper"}],ByteArrayMD5:[function(t,e,n){"use strict";cc._RF.push(e,"4453er/RaZAULyJxfcSkSO5","ByteArrayMD5"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){function e(t,e,n){return t&e|~t&n}function n(t,e,n){return n&t|~n&e}function o(t,e,n){return t^e^n}function r(t,e,n){return e^(t|~n)}function i(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}if(!(t instanceof Uint8Array))return function(){try{console.log("input data type mismatch only support Uint8Array")}catch(t){}}(),null;for(var a=[],s=0;s<t.byteLength;s++)a.push(t[s]);var c=a.length;a.push(128);var l=a.length%64;if(l>56){for(s=0;s<64-l;s++)a.push(0);l=a.length%64}for(s=0;s<56-l;s++)a.push(0);for(var u=0,p=function(t){for(var e=[],n=0;n<8;n++)e.push(255&t),t>>>=8;return e}(8*c);u<p.length;u++){var h=p[u];a.push(h)}var d=1732584193,f=4023233417,y=2562383102,_=271733878,g=0,m=0,v=0,b=0;function w(t,e){return 4294967295&t+e}var S=function(t,e,n,o){var r,i,a=b;b=v,v=m,m=w(m,(r=w(g,w(t,w(e,n))))<<(i=o)&4294967295|r>>>32-i),g=a};for(s=0;s<a.length/64;s++){g=d;var C=64*s;S(e(m=f,v=y,b=_),3614090360,i(a,C),7),S(e(m,v,b),3905402710,i(a,C+4),12),S(e(m,v,b),606105819,i(a,C+8),17),S(e(m,v,b),3250441966,i(a,C+12),22),S(e(m,v,b),4118548399,i(a,C+16),7),S(e(m,v,b),1200080426,i(a,C+20),12),S(e(m,v,b),2821735955,i(a,C+24),17),S(e(m,v,b),4249261313,i(a,C+28),22),S(e(m,v,b),1770035416,i(a,C+32),7),S(e(m,v,b),2336552879,i(a,C+36),12),S(e(m,v,b),4294925233,i(a,C+40),17),S(e(m,v,b),2304563134,i(a,C+44),22),S(e(m,v,b),1804603682,i(a,C+48),7),S(e(m,v,b),4254626195,i(a,C+52),12),S(e(m,v,b),2792965006,i(a,C+56),17),S(e(m,v,b),1236535329,i(a,C+60),22),S(n(m,v,b),4129170786,i(a,C+4),5),S(n(m,v,b),3225465664,i(a,C+24),9),S(n(m,v,b),643717713,i(a,C+44),14),S(n(m,v,b),3921069994,i(a,C),20),S(n(m,v,b),3593408605,i(a,C+20),5),S(n(m,v,b),38016083,i(a,C+40),9),S(n(m,v,b),3634488961,i(a,C+60),14),S(n(m,v,b),3889429448,i(a,C+16),20),S(n(m,v,b),568446438,i(a,C+36),5),S(n(m,v,b),3275163606,i(a,C+56),9),S(n(m,v,b),4107603335,i(a,C+12),14),S(n(m,v,b),1163531501,i(a,C+32),20),S(n(m,v,b),2850285829,i(a,C+52),5),S(n(m,v,b),4243563512,i(a,C+8),9),S(n(m,v,b),1735328473,i(a,C+28),14),S(n(m,v,b),2368359562,i(a,C+48),20),S(o(m,v,b),4294588738,i(a,C+20),4),S(o(m,v,b),2272392833,i(a,C+32),11),S(o(m,v,b),1839030562,i(a,C+44),16),S(o(m,v,b),4259657740,i(a,C+56),23),S(o(m,v,b),2763975236,i(a,C+4),4),S(o(m,v,b),1272893353,i(a,C+16),11),S(o(m,v,b),4139469664,i(a,C+28),16),S(o(m,v,b),3200236656,i(a,C+40),23),S(o(m,v,b),681279174,i(a,C+52),4),S(o(m,v,b),3936430074,i(a,C),11),S(o(m,v,b),3572445317,i(a,C+12),16),S(o(m,v,b),76029189,i(a,C+24),23),S(o(m,v,b),3654602809,i(a,C+36),4),S(o(m,v,b),3873151461,i(a,C+48),11),S(o(m,v,b),530742520,i(a,C+60),16),S(o(m,v,b),3299628645,i(a,C+8),23),S(r(m,v,b),4096336452,i(a,C),6),S(r(m,v,b),1126891415,i(a,C+28),10),S(r(m,v,b),2878612391,i(a,C+56),15),S(r(m,v,b),4237533241,i(a,C+20),21),S(r(m,v,b),1700485571,i(a,C+48),6),S(r(m,v,b),2399980690,i(a,C+12),10),S(r(m,v,b),4293915773,i(a,C+40),15),S(r(m,v,b),2240044497,i(a,C+4),21),S(r(m,v,b),1873313359,i(a,C+32),6),S(r(m,v,b),4264355552,i(a,C+60),10),S(r(m,v,b),2734768916,i(a,C+24),15),S(r(m,v,b),1309151649,i(a,C+52),21),S(r(m,v,b),4149444226,i(a,C+16),6),S(r(m,v,b),3174756917,i(a,C+44),10),S(r(m,v,b),718787259,i(a,C+8),15),S(r(m,v,b),3951481745,i(a,C+36),21),d=w(d,g),f=w(f,m),y=w(y,v),_=w(_,b)}return function(t,e,n,o){for(var r,i,a,s="",c=0,l=0,u=3;u>=0;u--)c=255&(l=arguments[u]),c<<=8,c|=255&(l>>>=8),c<<=8,c|=255&(l>>>=8),c<<=8,s+=(i=void 0,a=void 0,i=((r=c|=l>>>=8)>>>24).toString(16),a=(16777215&r).toString(16),"00".substr(0,2-i.length)+i+"000000".substr(0,6-a.length)+a);return s}(_,y,f,d).toLowerCase()},cc._RF.pop()},{}],CCMvc:[function(t,e,n){"use strict";cc._RF.push(e,"e78017TERpL9LG2QZMd7vPD","CCMvc"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("./base/BasePnlCmpt"),r=t("./base/BaseWindCmpt"),i=t("./base/BaseNoticeCmpt"),a=t("./base/BaseWdtCmpt"),s=t("./base/BaseLogger"),c=t("./base/BaseModel"),l=t("./manage/WindCtrlMgr"),u=t("./manage/ViewCtrlMgr"),p=t("./manage/ModelMgr"),h=t("./event/CoreEventType"),d=t("./layer/RKViewRootCmpt"),f=t("./layer/RKWindRootCmpt"),y=t("./layer/RKNoticeRootCmpt"),_=t("./manage/NoticeCtrlMgr"),g=t("./manage/LanguageMgr"),m=function(){function t(){this.GameNameSpace="RICK_BLOCK_PUZZLE",this.BasePnlCmpt=o.default,this.BaseWindCtrl=r.default,this.BaseNoticeCtrl=i.default,this.BaseWdtCtrl=a.default,this.BaseLogCtrl=s.default,this.BaseModel=c.default,this.modelMgr=null,this.Event=null,this.__windLayerCtrl=null,this.__viewLayerCtrl=null,this.__noticeLayerCtrl=null,this.__lockNode=null,this.__topTouchNode=null,this.__temp_models={},this.__lockTouchTimeoutId=-1}return t.prototype.init=function(t,e,n,o,r){this.GameNameSpace=t||"game",g.languageMgr.init(n,o),eventMgr.dispose(),this.__windLayerCtrl=this.newNode("Wind","default",e,1).addComponent(f.default).__init(new l.default),this.__viewLayerCtrl=this.newNode("View","ui",e,2).addComponent(d.default).__init(new u.default),this.__noticeLayerCtrl=this.newNode("Notice","ui",e,3).addComponent(y.default).__init(new _.default),this.__lockNode=this.newNode("LockNode","ui",e,4),this.__lockNode.addComponent(cc.BlockInputEvents),this.__lockNode.active=!1,r&&(this.__topTouchNode=this.newNode("TopTouch","ui",e,5),this.__topTouchNode.addComponent(r)),this.Event=h.default,this.__temp_models?(this.modelMgr=new p.default,this.modelMgr.init(this.__temp_models),this.modelMgr.create(),this.__temp_models=void 0):this.modelMgr&&this.modelMgr.create(),lplog.info("fuck inited!")},t.prototype.newNode=function(t,e,n,o){var r=n.FindChild(t);return r&&r.destroy(),(r=new cc.Node(t)).parent=n,r.zIndex=o,r.width=cc.winSize.width,r.height=cc.winSize.height,r.group=e,r},t.prototype.getWindNode=function(){return this.__windLayerCtrl.node},t.prototype.getViewNode=function(){return this.__viewLayerCtrl.node},t.prototype.getNoticeNode=function(){return this.__noticeLayerCtrl.node},Object.defineProperty(t.prototype,"currWind",{get:function(){return this.__windLayerCtrl.getCurrWind()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currWindName",{get:function(){var t=this.__windLayerCtrl.getCurrWind();return t?t.key:"null"},enumerable:!1,configurable:!0}),t.prototype.lockTouch=function(t){this.__lockNode.active=t,clearTimeout(this.__lockTouchTimeoutId),t&&(this.__lockTouchTimeoutId=setTimeout(function(){return console.error("\u8d85\u8fc710\u79d2\u6ca1\u6709\u64cd\u4f5c\u4e86")},1e4))},t.prototype.isLockTouch=function(){return this.__lockNode.active},t.prototype.addmodel=function(t){var e=this;return function(n){e.__temp_models[t]=n}},Object.defineProperty(t.prototype,"lang",{get:function(){return g.languageMgr.lang},set:function(t){g.languageMgr.lang=t},enumerable:!1,configurable:!0}),t.prototype.getOpenPnls=function(){return this.__viewLayerCtrl.getOpenPnls()},t}();window.mc=new m,cc._RF.pop()},{"./base/BaseLogger":"BaseLogger","./base/BaseModel":"BaseModel","./base/BaseNoticeCmpt":"BaseNoticeCmpt","./base/BasePnlCmpt":"BasePnlCmpt","./base/BaseWdtCmpt":"BaseWdtCmpt","./base/BaseWindCmpt":"BaseWindCmpt","./event/CoreEventType":"CoreEventType","./layer/RKNoticeRootCmpt":"RKNoticeRootCmpt","./layer/RKViewRootCmpt":"RKViewRootCmpt","./layer/RKWindRootCmpt":"RKWindRootCmpt","./manage/LanguageMgr":"LanguageMgr","./manage/ModelMgr":"ModelMgr","./manage/NoticeCtrlMgr":"NoticeCtrlMgr","./manage/ViewCtrlMgr":"ViewCtrlMgr","./manage/WindCtrlMgr":"WindCtrlMgr"}],CameraCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"5cfb4cxw05FgJw5VNSR0eWt","CameraCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.cameraCtrl=void 0;var c=t("../script/view/cmpt/component/CameraInertiaCmpt"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camera=null,e.ZOOM_RATIO_MAXRANGE=cc.v2(.48,.8),e.INIT_ZOOM_RATIO=.55,e.CONFIG={},e.smoothing=10,e.targetNode=null,e.targetPositionOgn=cc.v2(),e.targetPositionCam=cc.v2(),e.followCallback=null,e.isFollowBottom=!1,e.followOffset=cc.v2(),e.camPosition=cc.v2(),e.preZoomRatio=-1,e.mapSize=cc.v2(),e.tempMapSize=cc.v2(),e.tempOrigin=cc.v2(),e.maxRange=cc.v2(),e.minRange=cc.v2(),e.worldMapSize=cc.v2(),e.worldWinSize=cc.v2(),e.zoomRatioRange=cc.v2(),e.isLockBorder=!1,e.tempVec=cc.v2(),e.tempVec2=cc.v2(),e.tempVec3=cc.v2(),e.tempVec4=cc.v2(),e.tempVec5=cc.v2(),e.tempPos=cc.v2(),e.tempPosition=cc.v2(),e.tempPoint=cc.v2(),e.winSize=cc.v2(),e.winSizeHalf=cc.v2(),e.recordPos=cc.v2(),e.dragSpeed=1,e.moveing=!1,e.moveCallback=null,e.scaleTime=0,e.scaleSpeed=0,e.scaleVal=0,e.startScalePoint=cc.v2(),e.startScaleWorldPoint=cc.v2(),e.scaleCallback=null,e.scaleMoveSpeed=null,e.cameraInertiaCmpt=null,e}return r(e,t),e.prototype.onLoad=function(){window.cameraCtrl=this,n.cameraCtrl=this,this.camera=this.getComponent(cc.Camera),this.cameraInertiaCmpt=this.getComponent(c.default),this.recordPosition(),this.winSize.x=cc.winSize.width,this.winSize.y=cc.winSize.height,this.winSizeHalf.x=.5*cc.winSize.width,this.winSizeHalf.y=.5*cc.winSize.height},e.prototype.init=function(t,e,n,o){return this.stopMove(),this.setMaxRange(cc.v2(t.width,t.height)),this.setTarget(null),this.updateZoomRatioRange(o),this.zoomRatio=-1===n?this.initZoomRatioByMapId(o):n,this.setLocationByBottom(e),this.cameraInertiaCmpt&&this.cameraInertiaCmpt.stopAutoScroll(),this},e.prototype.init2=function(t,e,n,o){return this.stopMove(),this.setMaxRange(cc.v2(t.width,t.height)),this.node.setPosition(e),this.setTarget(null),this.updateZoomRatioRange(o),this.zoomRatio=n,this.cameraInertiaCmpt&&this.cameraInertiaCmpt.stopAutoScroll(),this},e.prototype.initZoomRatioByMapId=function(t){var e;return(null===(e=this.CONFIG[t])||void 0===e?void 0:e.INIT_ZOOM_RATIO)||this.INIT_ZOOM_RATIO},e.prototype.setLockBorder=function(t){return this.isLockBorder=t,this},e.prototype.reset=function(t){this.stopMove(),this.setTarget(null),this.setMaxRange(null),this.preZoomRatio=this.camera.zoomRatio=1,t?this.node.setPosition(t):this.node.setPosition(0,0),this.cameraInertiaCmpt&&this.cameraInertiaCmpt.stopAutoScroll()},e.prototype.getCamera=function(){return this.camera},e.prototype.getPosition=function(){return this.node.getPosition(this.tempPosition)},e.prototype.getWinSizeHalf=function(){return this.winSizeHalf},e.prototype.getZoomRatioRange=function(){return this.zoomRatioRange},e.prototype.getScreenToWorldPoint=function(t,e){return e=e||this.tempPoint,this.camera.getScreenToWorldPoint(t,e)},e.prototype.getWorldToScreenPoint=function(t,e){return e=e||this.tempPoint,this.camera.getWorldToScreenPoint(t,e)},Object.defineProperty(e.prototype,"zoomRatio",{get:function(){return this.camera.zoomRatio},set:function(t){this.scaleTime>0||(t=cc.misc.clampf(t,this.zoomRatioRange.x,this.zoomRatioRange.y),this.preZoomRatio!==t&&(this.camera.zoomRatio=this.preZoomRatio=t,this.updateWorldSize(),this.updateZoomRatioInfo()))},enumerable:!1,configurable:!0}),e.prototype.setZoomRatio=function(t){this.camera.zoomRatio=this.preZoomRatio=t,this.updateWorldSize(),this.updateZoomRatioInfo()},e.prototype.updateZoomRatioRange=function(t){var e,n=(null===(e=this.CONFIG[t])||void 0===e?void 0:e.ZOOM_RATIO_MAXRANGE)||this.ZOOM_RATIO_MAXRANGE;if(this.isLockBorder){var o=this.winSize.x/this.mapSize.x;this.mapSize.y*o<this.winSize.y&&(o=this.winSize.y/this.mapSize.y),this.zoomRatioRange.set2(Math.max(o,n.x),n.y)}else this.zoomRatioRange.set(n)},e.prototype.updateZoomRatioInfo=function(){this.getScreenToWorldPoint(cc.Vec2.ZERO).sub(this.getPosition(),this.minRange),this.setPosition(this.getPosition())},e.prototype.zoomRatioRestore=function(){},e.prototype.scaleIsMinOrMax=function(){var t=this.zoomRatio;return t===this.zoomRatioRange.x||t===this.zoomRatioRange.y},e.prototype.updateWorldSize=function(){this.getWorldToScreenPoint(this.mapSize,this.tempMapSize),this.getWorldToScreenPoint(cc.Vec2.ZERO,this.tempOrigin),this.tempMapSize.subSelf(this.tempOrigin),this.getScreenToWorldPoint(this.tempMapSize).sub(this.getPosition(),this.worldMapSize),this.getScreenToWorldPoint(this.winSize).sub(this.getPosition(),this.worldWinSize)},e.prototype.getMaxRange=function(){return this.maxRange},e.prototype.setMaxRange=function(t){t?(this.mapSize.set(t),this.maxRange.x=Math.max(0,t.x-cc.winSize.width),this.maxRange.y=Math.max(0,t.y-cc.winSize.height),this.updateWorldSize()):(this.mapSize.set2(0,0),this.maxRange.set2(0,0))},e.prototype.setSmoothing=function(t){this.smoothing=t},e.prototype.setLocationByBottom=function(t){var e=t.getPosition();e.x-=this.winSizeHalf.x,e.y+=this.worldWinSize.y-this.winSize.y,this.setPosition(e)},e.prototype.setLocationByBottom2=function(t){var e=t.convertToWorldSpaceAR(cc.Vec2.ZERO,this.tempVec3);e.x-=this.winSizeHalf.x,e.y+=this.worldWinSize.y-this.winSize.y,this.setPosition(e)},e.prototype.setLocationTarget=function(t){var e=t instanceof cc.Node?ut.convertToNodeAR(t,this.node.parent,this.tempVec4):t;this.setPosition(e.subSelf(this.winSizeHalf))},e.prototype.setPosition=function(t){this.node.setPosition(this.clampPosition(t))},e.prototype.checkNotInScreenRange=function(t){if(!t||!cc.isValid(t))return!1;var e=null==t?void 0:t.convertToWorldSpaceAR(cc.v2(0,0),this.tempVec2),o=n.cameraCtrl.getWorldToScreenPoint(e,e);return o.x<0||o.y<0||o.x>cc.winSize.width||o.y>cc.winSize.height},e.prototype.getScreenDelat=function(t){if(t&&cc.isValid(t)){var e=t.convertToWorldSpaceAR(cc.v2(0,0),this.tempVec2),o=n.cameraCtrl.getWorldToScreenPoint(e,e);return{x:o.x-cc.winSize.width,y:o.y-cc.winSize.height}}},e.prototype.isOutOfBoudary=function(t){if(t=t||this.getPosition(),!this.maxRange.equals(cc.Vec2.ZERO)){var e=this.worldMapSize.x<this.worldWinSize.x,n=this.worldMapSize.y<this.worldWinSize.y,o=t.x<-this.minRange.x||t.x>this.maxRange.x+this.minRange.x,r=t.y<-this.minRange.y||t.y>this.maxRange.y+this.minRange.y;if(!this.isLockBorder)return!(!e||!n)||(e?r:n?o:o||r);if(e||n)return!0;if(o||r)return!0}return!1},e.prototype.clampPosition=function(t){return this.maxRange.equals(cc.Vec2.ZERO)||(this.worldMapSize.x<this.worldWinSize.x?t.x=-this.minRange.x-.5*(this.worldWinSize.x-this.worldMapSize.x):t.x=cc.misc.clampf(t.x,-this.minRange.x,this.maxRange.x+this.minRange.x),this.worldMapSize.y<this.worldWinSize.y?t.y=-this.minRange.y-.5*(this.worldWinSize.y-this.worldMapSize.y):t.y=cc.misc.clampf(t.y,-this.minRange.y,this.maxRange.y+this.minRange.y)),t},e.prototype.recordPosition=function(){this.node.getPosition(this.recordPos)},e.prototype.drag=function(t){this.targetNode||this.moveing||this.scaleTime>0||(this.recordPos.add(t.mulSelf(this.dragSpeed),this.tempPos),this.setPosition(this.tempPos))},e.prototype.dragStart=function(){this.recordPosition(),this.cameraInertiaCmpt&&this.cameraInertiaCmpt.dragStart()},e.prototype.dragByTouch=function(t,e,n){var o=this.convertWorldSub(t,e);o.mag()>7&&this.drag(o),this.cameraInertiaCmpt&&this.cameraInertiaCmpt.drag(n)},e.prototype.dragEnd=function(t){this.cameraInertiaCmpt&&this.cameraInertiaCmpt.dragEnd(t)},e.prototype.convertWorldSub=function(t,e){return this.camera.getScreenToWorldPoint(t,this.tempVec2),this.camera.getScreenToWorldPoint(e,this.tempPos),this.tempVec2.subSelf(this.tempPos)},e.prototype.convertScreenSub=function(t,e){return this.camera.getWorldToScreenPoint(t,this.tempVec2),this.camera.getWorldToScreenPoint(e,this.tempPos),this.tempVec2.subSelf(this.tempPos)},e.prototype.setTarget=function(t,e){var n;return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return this.moveing?[2]:[3,1];case 1:return t?[4,ut.waitNextFrame(1,this)]:[3,3];case 2:o.sent(),t.isValid||(t=null),o.label=3;case 3:return t?(null===(n=this.cameraInertiaCmpt)||void 0===n||n.stopAutoScroll(),this.targetPositionOgn.set(t.getPosition(this.tempVec2)),this.targetPositionCam=this.getTargetPosition(t),this.camPosition.set(this.getPosition())):(this.targetPositionOgn.set2(-1,-1),this.isFollowBottom=!1,this.followOffset.set2(0,0)),this.targetNode=t,this.followCallback=e,e&&this.camPosition.equals(this.targetPositionCam)&&e(),[2]}})})},e.prototype.setFollowBottom=function(t){return this.isFollowBottom=t,this},e.prototype.setFollowOffset=function(t,e){return this.followOffset.set2(t,e),this},e.prototype.setTargetOnce=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){e.setTarget(t,function(){e.setTarget(null),n()})})]})})},e.prototype.getTargetPosition=function(t){if(!t||!t.isValid)return this.getPosition();var e=t.convertToWorldSpaceAR(this.followOffset,this.tempVec3);return this.isFollowBottom?(e.x-=this.winSizeHalf.x,e.y+=this.worldWinSize.y-this.winSize.y):e.subSelf(this.winSizeHalf),this.clampPosition(e)},e.prototype.moveTo=function(t,e){var n;return a(this,void 0,void 0,function(){var o=this;return s(this,function(){return this.targetNode?(this.moveing=!1,[2]):(this.moveing=!0,null===(n=this.cameraInertiaCmpt)||void 0===n||n.stopAutoScroll(),[2,new Promise(function(n){o.moveCallback=n,e=o.clampPosition(e),cc.tween(o.node).to(t,{x:e.x,y:e.y},{easing:cc.easing.quadOut}).call(function(){o.moveing=!1,o.moveCallback=null,n()}).start()})])})})},e.prototype.moveToByNode=function(t,e,n,o){return a(this,void 0,void 0,function(){var r;return s(this,function(i){switch(i.label){case 0:return e&&e.isValid?(this.moveing=!0,[4,ut.waitNextFrame()]):[2];case 1:return i.sent(),r=e.convertToWorldSpaceAR(n||cc.v2(0,0),this.tempVec3),o?(r.x-=this.winSizeHalf.x,r.y+=this.worldWinSize.y-this.winSize.y):r.subSelf(this.winSizeHalf),[2,this.moveTo(t,r)]}})})},e.prototype.stopMove=function(){this.node.stopAllActions(),this.moveing=!1,this.moveCallback=null},e.prototype.zoomRatioTo=function(t,e,n,o){return a(this,void 0,void 0,function(){var r=this;return s(this,function(){return e=cc.misc.clampf(e,this.zoomRatioRange.x,this.zoomRatioRange.y),this.scaleTime>0||e===this.zoomRatio?[2]:(this.scaleMoveSpeed=(null==o?void 0:o.clone())||null,[2,new Promise(function(o){var i;null===(i=r.cameraInertiaCmpt)||void 0===i||i.stopAutoScroll(),r.scaleVal=e,r.scaleTime=t,r.scaleSpeed=(e-r.zoomRatio)/t,r.startScalePoint.set(n||r.winSizeHalf),r.startScaleWorldPoint.set(r.getScreenToWorldPoint(r.startScalePoint)),r.scaleCallback=o})])})})},e.prototype.updateZoomRatioTo=function(t){this.scaleTime-=t;var e=this.scaleVal;this.scaleTime<=0?(this.scaleTime=0,this.scaleCallback&&this.scaleCallback(),this.scaleCallback=null):e=this.zoomRatio+t*this.scaleSpeed;var n=this.preZoomRatio!==e;if(n&&(this.camera.zoomRatio=this.preZoomRatio=e,this.updateWorldSize(),this.updateZoomRatioInfo()),this.scaleMoveSpeed){var o=this.scaleMoveSpeed.mul(t,this.tempVec).addSelf(this.getPosition());this.setPosition(o),0===this.scaleTime&&(this.scaleMoveSpeed=null)}else if(n&&!this.scaleIsMinOrMax()){var r=this.getScreenToWorldPoint(this.startScalePoint).subSelf(this.startScaleWorldPoint);this.setPosition(this.getPosition().subSelf(r))}},e.prototype.update=function(t){this.scaleTime>0&&this.updateZoomRatioTo(t)},e.prototype.lateUpdate=function(t){if(this.targetNode&&!this.moveing&&!this.scaleMoveSpeed){if(!this.targetNode.isValid)return this.setTarget(null);var e=this.targetNode.getPosition(this.tempVec2);this.targetPositionOgn.equals(e)||(this.targetPositionOgn.set(e),this.targetPositionCam=this.getTargetPosition(this.targetNode),this.camPosition.set(this.getPosition())),this.camPosition.equals(this.targetPositionCam)||(this.smoothing>0?(this.camPosition.sub(this.targetPositionCam,this.tempVec).mag()<2?(this.camPosition.set(this.targetPositionCam),this.followCallback&&this.followCallback()):this.camPosition.set(this.camPosition.lerp(this.targetPositionCam,this.smoothing*t,this.tempVec5)),this.tempVec.set2(Math.round(this.camPosition.x),Math.round(this.camPosition.y)),this.setPosition(this.tempVec)):(this.camPosition.set(this.targetPositionCam),this.followCallback&&this.followCallback(),this.setPosition(this.camPosition)))}},i([u],e)}(cc.Component));n.default=p,n.cameraCtrl=null,cc._RF.pop()},{"../script/view/cmpt/component/CameraInertiaCmpt":"CameraInertiaCmpt"}],CameraInertiaCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"21ebalTjV1MIrzZ97JMGe9/","CameraInertiaCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../../scene/CameraCtrl"),s=cc._decorator,c=s.ccclass,l=s.property,u=(cc.v2(0,0),function(){return(new Date).getMilliseconds()}),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.brake=.7,e._touchMoveDisplacements=[],e._touchMoveTimeDeltas=[],e._autoScrolling=!1,e._tempPoint=cc.v2(),e._tempPrevPoint=cc.v2(),e}return r(e,t),e.prototype.dragStart=function(){this._autoScrolling=!1,this._touchMovePreviousTimestamp=u(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0},e.prototype.drag=function(t){var e=this._getLocalAxisAlignDelta(t);this._gatherTouchMove(e)},e.prototype.dragEnd=function(t){this._handleReleaseLogic(t)},e.prototype.stopAutoScroll=function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},e.prototype._handleReleaseLogic=function(t){var e=this._getLocalAxisAlignDelta(t);this._gatherTouchMove(e),this._processInertiaScroll()},e.prototype._processInertiaScroll=function(){var t=this._calculateTouchMoveVelocity();t.mag()>7&&this.brake<1&&this._startInertiaScroll(t)},e.prototype._startInertiaScroll=function(t){var e=t.mul(.7);this._startAttenuatingAutoScroll(e,t)},e.prototype._calculateAttenuatedFactor=function(t){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9))},e.prototype._calculateAutoScrollTimeByInitalSpeed=function(t){return Math.sqrt(Math.sqrt(t/5))},e.prototype._startAttenuatingAutoScroll=function(t,e){var n=this._calculateAutoScrollTimeByInitalSpeed(e.mag()),o=t.normalize(),r=a.cameraCtrl.getMaxRange(),i=r.x,s=r.y,c=this._calculateAttenuatedFactor(i),l=this._calculateAttenuatedFactor(s);o=cc.v2(o.x*i*(1-this.brake)*c,o.y*s*l*(1-this.brake));var u=t.mag(),p=o.mag()/u;o=o.add(t),this.brake>0&&p>7&&(p=Math.sqrt(p),o=t.mul(p).add(t)),this.brake>0&&p>3&&(n*=p=3),0===this.brake&&p>1&&(n*=p),this._startAutoScroll(o,n,!0)},e.prototype._startAutoScroll=function(t,e,n){var o=t;this._autoScrolling=!0,this._autoScrollTargetDelta=o,this._autoScrollAttenuate=n,this._autoScrollStartPosition=cc.v2(a.cameraCtrl.getPosition()),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0},e.prototype.update=function(t){this._autoScrolling&&this._processAutoScrolling(t)},e.prototype._processAutoScrolling=function(t){this._autoScrollAccumulatedTime+=t;var e,n=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(e=n,n=(e-=1)*e*e*e*e+1);var o=this._autoScrollStartPosition.add(this._autoScrollTargetDelta.mul(n)),r=Math.abs(n-1)<=1e-4;a.cameraCtrl.isOutOfBoudary(o)?r=!0:a.cameraCtrl.setPosition(o),r&&(a.cameraCtrl.recordPosition(),this._autoScrolling=!1)},e.prototype._getLocalAxisAlignDelta=function(t){return a.cameraCtrl.getScreenToWorldPoint(t.getLocation(),this._tempPoint),a.cameraCtrl.getScreenToWorldPoint(t.getPreviousLocation(),this._tempPrevPoint),this._tempPrevPoint.sub(this._tempPoint)},e.prototype._gatherTouchMove=function(t){for(;this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(t);var e=u();this._touchMoveTimeDeltas.push((e-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=e},e.prototype._calculateTouchMoveVelocity=function(){var t=0;if((t=this._touchMoveTimeDeltas.reduce(function(t,e){return t+e},t))<=0||t>=.5)return cc.v2(0,0);var e=cc.v2(0,0);e=this._touchMoveDisplacements.reduce(function(t,e){return t.add(e)},e);var n=cc.v2(e.x*(1-this.brake)/t,e.y*(1-this.brake)/t),o=Math.abs(n.x),r=Math.abs(n.y);return o>3*r?n.y=0:r>3*o&&(n.x=0),n},i([l(cc.Float)],e.prototype,"brake",void 0),i([c],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../../../../scene/CameraCtrl":"CameraCtrl"}],CheckPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"7c1e2GYGE1EeKIl0U+AvETf","CheckPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Constant"),l=t("../../common/constant/Enums"),u=t("../../common/helper/GameHelper"),p=t("../../common/helper/ReddotHelper"),h=cc._decorator.ccclass,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tag="CheckPnlCtrl",e.adStatusNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("CheckPnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){cc.log("CheckPnlCtrl onEnter"),u.gameHelper.ad.initCurrentAd(l.AdType.REWARD),this.refreshView();var t=u.gameHelper.ad.isAdReady();this.adStatusNode_.Component(cc.MultiFrame).setFrame(t?0:1)},e.prototype.onRemove=function(){cc.log("CheckPnlCtrl onRemove")},e.prototype.onDispose=function(){cc.log("CheckPnlCtrl onClean"),assetsMgr.releaseTempResByTag(this.tag)},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close()},e.prototype.onClickAd=function(t,e){cc.log("onClickAd",e),this.btnADHandler()},e.prototype.onClickGet=function(t,e){cc.log("onClickGet",e);var n=new Array(7).findIndex(function(t,e){return u.gameHelper.global.getDailyRewardState(e+1)==l.DailyRewardState.canGet})+1;n>0&&this.checked(n,1)},e.prototype.btnADHandler=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return[4,u.gameHelper.ad.showAd(l.AdPropType.Check)];case 1:return n.sent().status!==l.RewardAdStatus.SUCCESS?[2]:(t=new Array(7).findIndex(function(t,e){return u.gameHelper.global.getDailyRewardState(e+1)==l.DailyRewardState.canGet}),(e=t+1)>0&&this.checked(e,2),[2])}})})},e.prototype.checked=function(t,e){u.gameHelper.global.setDaily(t),u.gameHelper.global.setLastDailyGetTime(Date.now());var n=c.DAILY_REWARDS[t].split("|").map(function(t){var n=ut.stringToNumbers(t,"="),o=n[0],r=n[1];return{id:o,count:e*r}});u.gameHelper.getRewards(n),this.refreshView(),p.reddotHelper.check("check")},e.prototype.refreshView=function(){var t=this.node.Child("root");t.Child("Layout").children.map(function(t,e){var n=e+1,o=c.DAILY_REWARDS[n];if(e<6){var r=ut.stringToNumbers(o,"="),i=(r[0],r[1]);t.Child("reward/val",cc.Label).string="x"+i}else{var a=o.split("|").map(function(t){var e=ut.stringToNumbers(t,"=");return{id:e[0],count:e[1]}});t.Child("layout/reward0/val",cc.Label).string="x"+a[0].count,t.Child("layout/reward1/val",cc.Label).string="x"+a[1].count}var s=t.Child("BonusLight"),p=t.Child("got"),h=t.Child("bg1"),d=t.Child("bg2"),f=u.gameHelper.global.getDailyRewardState(n);s.active=f==l.DailyRewardState.canGet,f==l.DailyRewardState.Got?(p.active=!0,h.active=!0,d.active=!1):f==l.DailyRewardState.canGet?(h.active=!1,d.active=!0,p.active=!1):(h.active=!0,d.active=!1,p.active=!1)});var e=t.Child("get_be",cc.Button),n=t.Child("ad_be",cc.Button),o=new Array(7).findIndex(function(t,e){return u.gameHelper.global.getDailyRewardState(e+1)==l.DailyRewardState.canGet})>-1;n.setActive(o),e.setActive(o),t.Child("gotTip").active=!o},i([ut.addLock],e.prototype,"btnADHandler",null),i([h],e)}(mc.BasePnlCmpt);n.default=d,cc._RF.pop()},{"../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/helper/GameHelper":"GameHelper","../../common/helper/ReddotHelper":"ReddotHelper"}],ChitchatBoxCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"8f0d32hkr1OAprBauIr589n","ChitchatBoxCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.TEXT_MAX_WIDTH=282,e.root=null,e.label=null,e}return r(e,t),e.prototype.onLoad=function(){this.load()},e.prototype.load=function(){this.root||(this.root=this.FindChild("root"),this.label=this.FindChild("root/val",cc.Label))},e.prototype.setText=function(t){var e=this;this.load(),this.node.opacity=0,this.node.scaleX=1;var n=cc.Label.Overflow;this.label.overflow=n.NONE,this.label.setLocaleKey(t||"error"),this.label._forceUpdateRenderData();var o=this.label.node.width;o>this.TEXT_MAX_WIDTH&&(o=this.TEXT_MAX_WIDTH,this.label.overflow=n.RESIZE_HEIGHT,this.label.node.width=this.TEXT_MAX_WIDTH),ut.waitNextFrame(1,this).then(function(){e.isValid&&(e.root.width=o+24,cc.tween(e.node).to(.1,{opacity:255}).start())})},i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],ClickTouchCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"bbd10wW3W9L45oi1sFxI2Dw","ClickTouchCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../../scene/CameraCtrl"),s=t("../../../common/constant/Constant"),c=t("../../../common/helper/GameHelper"),l=t("../../../common/helper/TouchHelper"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPlayAction=!1,e.isDown=!1,e._target=null,e._node=null,e._originalScale=void 0,e._interactable=!0,e.downCallback=null,e.clickCallback=null,e.clickTarget=null,e.data=null,e.tempVec=cc.v2(),e}return r(e,t),e.prototype.onDestroy=function(){this.clean()},e.prototype.on=function(t,e){return this.off(),this.clickCallback=t,this.clickTarget=e,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.node.SetSwallowTouches(!1),l.touchHelper.addClickInfo(this.node),this},e.prototype.off=function(){this.clean(),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.clean=function(){l.touchHelper.removeClickInfo(this.node),this.downCallback=null,this.clickCallback=null,this.clickTarget=null,this._node=null,this._target=null,this.data=null,this.isDown&&(this.isDown=!1,c.gameHelper.clickTouchId=-1)},e.prototype.setPlayAction=function(t){return this.isPlayAction=t,this},e.prototype.setTarget=function(t){return this._target=t,this},e.prototype.setNode=function(t){return this._node=t,this},e.prototype.setData=function(t){return this.data=t,this},e.prototype.setDownCallback=function(t){return this.downCallback=t,this},Object.defineProperty(e.prototype,"target",{get:function(){return this._target||(this._target=this.node),this._target},enumerable:!1,configurable:!0}),e.prototype.getNode=function(){return this._node||(this._node=this.node),this._node},Object.defineProperty(e.prototype,"originalScale",{get:function(){return void 0===this._originalScale&&(this._originalScale=this.node.scale),this._originalScale},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"interactable",{get:function(){return this._interactable},set:function(t){this._interactable=t},enumerable:!1,configurable:!0}),e.prototype.onTouchStart=function(t){this.interactable&&-1===c.gameHelper.clickTouchId&&(c.gameHelper.clickTouchId=t.getID(),this.down())},e.prototype.onTouchMove=function(t){this.interactable&&c.gameHelper.clickTouchId===t.getID()&&(this.node._hitTest(t.getLocation())?this.isDown||this.down():this.isDown&&this.restore())},e.prototype.onTouchEnd=function(t){if(c.gameHelper.clickTouchId===t.getID()&&(c.gameHelper.clickTouchId=-1,this.restore(),this.interactable)){var e=t.getLocation();a.cameraCtrl.convertWorldSub(t.getStartLocation(),e).mag()<=s.CLICK_SPACE&&this.emit(e)}},e.prototype.onTouchCancel=function(t){c.gameHelper.clickTouchId===t.getID()&&(c.gameHelper.clickTouchId=-1,this.restore())},e.prototype.down=function(){this.isDown=!0,this.downCallback?this.downCallback(!0):this.isPlayAction&&cc.tween(this.target).to(.1,{scale:1.05*this.originalScale}).start()},e.prototype.restore=function(){this.isDown=!1,this.downCallback?this.downCallback(!1):this.isPlayAction&&cc.tween(this.target).to(.1,{scale:this.originalScale}).start()},e.prototype.emit=function(t){var e=a.cameraCtrl.getScreenToWorldPoint(t,this.tempVec);this.clickTarget?this.clickCallback.call(this.clickTarget,this.getNode(),this.data,e,t):this.clickCallback(this.getNode(),this.data,e,t)},i([p],e)}(cc.Component));n.default=h,cc._RF.pop()},{"../../../../scene/CameraCtrl":"CameraCtrl","../../../common/constant/Constant":"Constant","../../../common/helper/GameHelper":"GameHelper","../../../common/helper/TouchHelper":"TouchHelper"}],CocosAssembler2D:[function(t,e,n){"use strict";cc._RF.push(e,"45b34Fpp0hHA5CXDY6nzHCx","CocosAssembler2D");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colors=[],e}return r(e,t),e.prototype.onEnable=function(){cc.director.once(cc.Director.EVENT_AFTER_DRAW,this._updateColors,this)},e.prototype._updateColors=function(){var t=this.getComponent(cc.RenderComponent);if(t){var e=t._assembler;if(e instanceof cc.Assembler2D){var n=e._renderData.uintVDatas[0];if(n)for(var o=this.node.color,r=e.floatsPerVert,i=0,a=e.colorOffset,s=n.length;a<s;a+=r)n[a]=(this.colors[i++]||o)._val}}},e.prototype.onDisable=function(){cc.director.off(cc.Director.EVENT_AFTER_DRAW,this._updateColors,this),this.node._renderFlag|=cc.RenderFlow.FLAG_COLOR},i([c([cc.Color])],e.prototype,"colors",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],CollectNode:[function(t,e,n){"use strict";cc._RF.push(e,"151b2ZbD5dCt5bOIA1YSwxZ","CollectNode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.widget=null,e.tip=null,e}return r(e,t),e.prototype.start=function(){this.tip.active=!1},e.prototype.onShow=function(){this.adapterPos()},e.prototype.onHide=function(){this.tip.active=!1},e.prototype.adapterPos=function(){if(cc.sys.platform==cc.sys.WECHAT_GAME){var t=wx.getMenuButtonBoundingClientRect(),e=wx.getSystemInfoSync(),n=this.node.parent.height*(t.bottom/e.screenHeight),o=this.node.parent.width*(1-(t.left+.6*t.width)/e.screenWidth);this.widget.top=n,this.widget.right=o,this.widget.isAbsoluteTop=!0,this.widget.isAlignTop=!0,this.widget.updateAlignment(),this.tip.active=!0}else this.tip.active=!1},i([c(cc.Widget)],e.prototype,"widget",void 0),i([c(cc.Node)],e.prototype,"tip",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],CollectWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"da8d9GjqtpMNINAHKIT53V2","CollectWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/event/NotEvent"),l=t("../../common/helper/GameHelper"),u=t("../../common/helper/ResHelper"),p=t("../../common/helper/ViewHelper"),h=cc._decorator.ccclass,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.flagRightNode_=null,e.flagLeftNode_=null,e.targetLayoutNode_=null,e.rewardsNode_=null,e.rewardLayoutNode_=null,e.continueNode_=null,e.animNode_=null,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("CollectWindCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){cc.log("CollectWindCtrl onEnter");var e=t.data,n=t.level,o=e.questList,r=o.some(function(t){return 0==t.type});this.animNode_.active=r,this.targetLayoutNode_.active=!r,r?(this.animNode_.Child("content/text",cc.Label).string=""+o[0].count,cc.tween(this.animNode_).set({scale:0}).to(.5,{scale:.4},{easing:cc.easing.backOut}).start()):this.targetLayoutNode_.Items(e.questList,function(t,e){u.resHelper.loadTargetIcon(t,"level_item_gem_"+e.type,"level"),cc.tween(t).set({scale:0}).to(.5,{scale:1},{easing:cc.easing.backOut}).start()});var i=n%5==0;this.flagLeftNode_.Component(cc.MultiFrame).setFrame(i?1:0),this.flagRightNode_.Component(cc.MultiFrame).setFrame(i?1:0);var a=l.gameHelper.getLevelRewardBy(n);this.rewardLayoutNode_.Items(a,function(t,e){u.resHelper.loadTempIcon(t,""+e.id,"level"),t.Child("text",cc.Label).string=""+e.count}),l.gameHelper.getRewards(a,!1),l.gameHelper.global.addLevel(),cc.tween(this.rewardsNode_).set({opacity:0}).delay(.3).to(.5,{opacity:255}).start(),audioMgr.playSFX("common/level_complete"),l.gameHelper.ad.showInterstitialAd(),eventMgr.emit(c.default.SHOW_ADD)},e.prototype.onClean=function(){cc.log("CollectWindCtrl onClean"),audioMgr.stopSFX("common/level_complete"),eventMgr.emit(c.default.HIDE_ADD)},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),p.viewHelper.gotoWind("main")},i([h],e)}(mc.BaseWindCtrl);n.default=d,cc._RF.pop()},{"../../common/event/NotEvent":"NotEvent","../../common/helper/GameHelper":"GameHelper","../../common/helper/ResHelper":"ResHelper","../../common/helper/ViewHelper":"ViewHelper"}],ColorGemShapeObj:[function(t,e,n){"use strict";cc._RF.push(e,"04efcGhCwVIHqo/XZ6KuUSa","ColorGemShapeObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.add=!1,e}return r(e,t),e.prototype.initGemType=function(t,e){return this.gemType=t,this.add=e,this},e}(t("./ColorShapeObj").default);n.default=i,cc._RF.pop()},{"./ColorShapeObj":"ColorShapeObj"}],ColorShapeObj:[function(t,e,n){"use strict";cc._RF.push(e,"58e9dcpP2xPGKfjKwlbfX91","ColorShapeObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.initColor=function(t){this.color=t},e.prototype.initDegree=function(t){this.degree=t},e.prototype.fromDB=function(t){if(t){var e=assetsMgr.getJsonData("ShapeConfig",t.id);this.init(e.id,e.coords,e.headPos),this.initColor(t.color),this.initDegree(0)}return this},e.prototype.toDB=function(){return{id:this.id,color:this.color}},e}(t("./ShapeObj").default);n.default=i,cc._RF.pop()},{"./ShapeObj":"ShapeObj"}],Constant:[function(t,e,n){"use strict";cc._RF.push(e,"479ff5A9XFA/Zmr6hM7rR5U","Constant"),Object.defineProperty(n,"__esModule",{value:!0}),n.GEM_LIST=n.CONTAINER_POS_LIST=n.LITTLE_COIN_ID=n.SPIN_REWARDS=n.ROTATE_ID=n.COIN_ID=n.DAILY_REWARDS=n.ROTATE_COST=n.DEFAULT_FONT=n.COMBO_SCORE=n.REVIVE_COST=n.ItemType=n.SHAPE_SCALE=n.TAB_SKIN_LIST=n.SHAPE_COUNT=n.MAX_Y=n.MAX_X=n.TIME_LANG=n.COMPARE_RECROD_STATE=n.FRIST_TOPUP_STATE=n.FRIST_CUSTOMER=n.FRIST_AD_REWARD=n.DAILY_ONLINE_REWARD=n.QQSubscribeId=n.WxSubscribeId=n.CHITCHAT_DURATION=n.AD_CD=n.DELAY_CLOSE_PNL_TIME=n.PNL_ZINDEX=n.MAX_ZINDEX=n.SCENE_BG_COLOR=n.TOUCH_TIME_ON_HOOK=n.ROLE_BUBBLE_OFFSETY=n.LONG_PRESS_TIME=n.MAX_LAYOUT_HEIGHT=n.DATA_CHANGE_TIME=n.SKEW_LEN=n.SKEW_SIZE_HALF=n.SKEW_SIZE=n.SKEW_ANGLE=n.TILE_SIZE_HALF=n.TILE_SIZE=n.CLICK_SPACE=n.DIR_POINTS_8=n.DIR_POINTS_4=n.COLOR_LIST=n.GAME_SHAPE_LIST=n.SHAPE_CONTAINER_POS_LIST=n.TOUCH_OFFSET_Y=n.GRID_WIDTH=void 0;var o=t("../../../core/utils/EncValue"),r=t("./Enums"),i=[];n.DIR_POINTS_4=i;for(var a=-1;a<=1;a++)for(var s=-1;s<=1;s++)1===(l=Math.abs(a)+Math.abs(s))&&i.push({point:cc.v2(a,s),tag:1});var c=[];for(n.DIR_POINTS_8=c,a=-1;a<=1;a++)for(s=-1;s<=1;s++)if(0!==a||0!==s){var l=Math.abs(a)+Math.abs(s);c.push({point:cc.v2(a,s),tag:1===l?l:1.414})}n.CLICK_SPACE=14,n.TILE_SIZE=120;var u=cc.v2(60,60);n.TILE_SIZE_HALF=u,n.SKEW_ANGLE=30;var p=cc.size(118,70);n.SKEW_SIZE=p;var h=cc.size(.5*p.width,.5*p.height);n.SKEW_SIZE_HALF=h;var d=Math.sqrt(h.width*h.width+h.height*h.height);n.SKEW_LEN=d,n.DATA_CHANGE_TIME="offlineChangeTime",n.MAX_LAYOUT_HEIGHT=200,n.MAX_ZINDEX=1e4,n.LONG_PRESS_TIME=.4,n.ROLE_BUBBLE_OFFSETY=320,n.TOUCH_TIME_ON_HOOK=36e5,n.SCENE_BG_COLOR={1:"#FFFFFF",2:"#94F4FF",3:"#F1D1AB",5:"#FFD37A",6:"#7567A2",7:"#FFD37A",8:"#EFBCF2",9:"#FFC45F",11:"#ffbfab",201:"#FFD37A",202:"#7567A2",301:"#FFD37A",302:"#7567A2",401:"#FFD37A",402:"#7567A2"},n.PNL_ZINDEX={_Max:3276,FristTopup:347,Cartoon:303,Story:302,Guide:301,Default:300,Top:100,UI:-1,Bottom:-2},n.DELAY_CLOSE_PNL_TIME=.4,n.CHITCHAT_DURATION=5,n.AD_CD=6e4;var f=[{duration:18e4,reward:new o.default("1,-1,300")}];n.DAILY_ONLINE_REWARD=f;var y=[new o.default("2,-1,20"),new o.default("1,-1,5000"),new o.default("18,-1,30")];n.FRIST_AD_REWARD=y;var _=new o.default("8,68,1");n.FRIST_CUSTOMER=_,n.FRIST_TOPUP_STATE={CLAIM:0,CLAIMED:1,UNOPENED:2,COUNT_DOWN:3},n.COMPARE_RECROD_STATE={REDUCE:"reduce",INCREASE:"increase",CHANGE:"change"},n.WxSubscribeId={},n.QQSubscribeId={},n.TAB_SKIN_LIST=["Set","Classic","Advanced","Rank"],n.TIME_LANG={d:{cn:"\u5929",en:"d",kr:"\uc77c",jp:"\u65e5",tc:"\u5929"},h:{cn:"\u5c0f\u65f6",en:"h",kr:"\uc2dc\uac04",jp:"\u6642\u9593",tc:"\u5c0f\u6642"},m:{cn:"\u5206",en:"m",kr:"\ubd84",jp:"\u5206",tc:"\u5206"},s:{cn:"\u79d2",en:"s",kr:"\ucd08",jp:"\u79d2",tc:"\u79d2"}},n.MAX_X=8,n.MAX_Y=8,n.SHAPE_COUNT=3,n.GRID_WIDTH=80,n.SHAPE_SCALE=.3;var g=[r.ColorType.Red,r.ColorType.EnhanceBlue,r.ColorType.Blue,r.ColorType.Green,r.ColorType.Pink,r.ColorType.Pule,r.ColorType.Yellow];n.COLOR_LIST=g,n.TOUCH_OFFSET_Y=250;var m=[cc.v2(-270,0),cc.v2(-100,0),cc.v2(70,0),cc.v2(260,0)];n.SHAPE_CONTAINER_POS_LIST=m;var v,b=[cc.v2(-200,0),cc.v2(0,0),cc.v2(200,0)];n.CONTAINER_POS_LIST=b,function(t){t[t.COIN_ID=1001]="COIN_ID",t[t.ROTATE_ID=1002]="ROTATE_ID",t[t.COINS_ID=1003]="COINS_ID",t[t.MANY_COINS_ID=1004]="MANY_COINS_ID",t[t.FLASH=1005]="FLASH",t[t.Heart=1006]="Heart"}(v||(v={})),n.ItemType=v,n.REVIVE_COST=200,n.ROTATE_COST=150,n.GAME_SHAPE_LIST=[{id:1,weight:30},{id:2,weight:30},{id:3,weight:10},{id:4,weight:10},{id:5,weight:10},{id:6,weight:10},{id:7,weight:40},{id:8,weight:40},{id:9,weight:40},{id:10,weight:30},{id:11,weight:30},{id:12,weight:15},{id:13,weight:15},{id:14,weight:40},{id:15,weight:40},{id:16,weight:40},{id:17,weight:40},{id:18,weight:5},{id:19,weight:30},{id:20,weight:30},{id:21,weight:30},{id:22,weight:30},{id:23,weight:30},{id:24,weight:30},{id:25,weight:30},{id:26,weight:30},{id:27,weight:8},{id:28,weight:8},{id:29,weight:8},{id:30,weight:8},{id:31,weight:6},{id:32,weight:6},{id:33,weight:6},{id:34,weight:6},{id:35,weight:6},{id:36,weight:6},{id:37,weight:6},{id:38,weight:6},{id:39,weight:6},{id:40,weight:6},{id:41,weight:6},{id:42,weight:6},{id:43,weight:3},{id:44,weight:3},{id:45,weight:4},{id:46,weight:4},{id:47,weight:6},{id:48,weight:40},{id:49,weight:40},{id:50,weight:3},{id:51,weight:3}],n.COMBO_SCORE=[0,10,30,60,100,150,210],n.DEFAULT_FONT="font",n.LITTLE_COIN_ID=1001,n.COIN_ID=1003,n.ROTATE_ID=1002;var w;n.DAILY_REWARDS={1:"1003=20",2:"1003=30",3:"1003=40",4:"1003=50",5:"1003=60",6:"1003=80",7:"1003=100|1002=2"},n.SPIN_REWARDS=[{id:0,reward:"1003=20",weight:50},{id:1,reward:"1003=30",weight:25},{id:2,reward:"1003=40",weight:10},{id:3,reward:"1003=50",weight:5},{id:4,reward:"1002=2",weight:2},{id:5,reward:"1006=1",weight:5},{id:6,reward:"1002=1",weight:10},{id:7,reward:"1003=80",weight:3}],function(t){t[t.Gem1=8]="Gem1",t[t.Gem2=9]="Gem2",t[t.Gem3=10]="Gem3",t[t.Gem4=11]="Gem4",t[t.Gem5=12]="Gem5",t[t.Gem6=13]="Gem6",t[t.Gem7=14]="Gem7",t[t.Gem8=15]="Gem8"}(w||(w={}));var S=[w.Gem1,w.Gem2,w.Gem3,w.Gem4,w.Gem5,w.Gem6,w.Gem7,w.Gem8];n.GEM_LIST=S,cc._RF.pop()},{"../../../core/utils/EncValue":"EncValue","./Enums":"Enums"}],CoreEventType:[function(t,e,n){"use strict";cc._RF.push(e,"c7974bEysVJJoSwzvizrpPA","CoreEventType"),Object.defineProperty(n,"__esModule",{value:!0}),n.default={MVC_LOGGER_PRINT:"MVC_LOGGER_PRINT_101",MVC_ERROR_MSG:"MVC_ERROR_MSG_102",SWITCH_LANGUAGE:"SWITCH_LANGUAGE",LANGUAGE_CLEAN:"LANGUAGE_CLEAN",OPEN_PNL:"OPEN_PNL_201",HIDE_PNL:"HIDE_PNL_202",HIDE_ALL_PNL:"HIDE_ALL_PNL_203",CLOSE_PNL:"CLOSE_PNL_204",CLOSE_ALL_PNL:"CLOSE_ALL_PNL_205",CLOSE_MOD_PNL:"CLOSE_MOD_PNL_206",PRELOAD_PNL:"PRELOAD_PNL_207",LOAD_BEGIN_PNL:"LOAD_BEGIN_PNL_208",LOAD_END_PNL:"LOAD_END_PNL_209",PNL_ENTER:"PNL_ENTER_210",PNL_LEAVE:"PNL_LEAVE_211",CLEAN_ALL_UNUSED:"CLEAN_ALL_UNUSED_212",GIVEUP_LOAD_PNL:"GIVEUP_LOAD_PNL_213",SET_PNL_OPTS:"SET_PNL_OPTS_214",GOTO_WIND:"GOTO_WIND_301",PRELOAD_WIND:"PRELOAD_WIND_302",WIND_ENTER:"WIND_ENTER_303",CLEAN_CACHE_WIND:"CLEAN_CACHE_WIND_304",LOAD_BEGIN_WIND:"LOAD_BEGIN_WIND_305",LOAD_END_WIND:"LOAD_END_WIND_306",LOAD_ALL_NOTICE:"LOAD_ALL_NOTICE_401",LOAD_BEGIN_SPRITE:"LOAD_BEGIN_SPRITE_601",LOAD_END_SPRITE:"LOAD_END_SPRITE_602",HOT_UPDATE_EVENT:"HOT_UPDATE_EVENT_501",HOT_UPDATE_END:"HOT_UPDATE_END_502"},cc._RF.pop()},{}],CosHelper:[function(t,e,n){"use strict";cc._RF.push(e,"6e9f7X3CA1LfJmRNucGdyLc","CosHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.cosHelper=void 0,t("../cos-wx-sdk-v5.js");var i=t("./GameHelper"),a=function(){function t(){this.cos=null}return t.prototype.init=function(){},t.prototype.uploadWXFile=function(t,e){return o(this,void 0,void 0,function(){var n,o,a,s,c,l,u,p,h,d,f,y,_,g;return r(this,function(r){switch(r.label){case 0:n="debug/wxFile/"+i.gameHelper.user.getUid(),o=wx.env.USER_DATA_PATH+"/gamecaches/",a=0,s=[],c=0,e&&e(0,t.length),l=0,r.label=1;case 1:return l<t.length?(u=t[l],(p=u.split(o))[0],h=p[1],d=n+"/"+h,f=this.uploadFile(d,u),s.push(f),l-a>10||l==t.length-1?[4,Promise.all(s)]:[3,3]):[3,4];case 2:for(y=r.sent(),_=0,g=y;_<g.length;_++)!0===g[_]&&c++;a=l,e&&e(c,t.length),s=[],r.label=3;case 3:return l++,[3,1];case 4:return[2]}})})},t.prototype.getWXFile=function(t){return o(this,void 0,void 0,function(){var e,n,i,a,s=this;return r(this,function(c){switch(c.label){case 0:return e=wx.getFileSystemManager(),n=[],i=function(t){return o(s,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(n){e.stat({path:t,success:function(t){n(t.stats.isDirectory())},fail:function(e){console.error("isDir fail",t,e)}})})]})})},[4,(a=function(c){return new Promise(function(l){e.readdir({dirPath:c,success:function(e){return o(s,void 0,void 0,function(){var o,s,u,p;return r(this,function(r){switch(r.label){case 0:o=0,s=e.files,r.label=1;case 1:return o<s.length?(u=s[o],[4,i(p=c+"/"+u)]):[3,6];case 2:return r.sent()?[4,a(p)]:[3,4];case 3:return r.sent(),[3,5];case 4:n.push(p),t(n.length),r.label=5;case 5:return o++,[3,1];case 6:return l(0),[2]}})})},fail:function(t){console.error("readdir fail",c,t),l(0)}})})})(wx.env.USER_DATA_PATH+"/gamecaches")];case 1:return c.sent(),[2,n]}})})},t.prototype.uploadFile=function(t,e){return o(this,void 0,void 0,function(){var n,o=this;return r(this,function(){return n=function(t,e){return new Promise(function(n){o.cos.postObject({Bucket:"twgame-hotel-1257666530",Region:"ap-shanghai",Key:t,FilePath:e},function(t,o){n(!t||{err:t,data:o,filePath:e})})})},[2,this.retry(n,t,e)]})})},t.prototype.retry=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return o(this,void 0,void 0,function(){var n,o,i;return r(this,function(r){switch(r.label){case 0:n=1e3,r.label=1;case 1:return n>0?(n--,[4,t.apply(void 0,e)]):[3,7];case 2:return!0!==(o=r.sent())?[3,3]:[2,!0];case 3:return i=o.err,n>0&&i&&503==i.statusCode?[4,ut.wait(.5)]:[3,5];case 4:return r.sent(),[3,6];case 5:return console.error("uploadFile fail",o),[2,!1];case 6:return[3,1];case 7:return[2]}})})},t}();n.default=a,n.cosHelper=new a,window.cosHelper=n.cosHelper,cc._RF.pop()},{"../cos-wx-sdk-v5.js":"cos-wx-sdk-v5","./GameHelper":"GameHelper"}],CryptoHelper:[function(t,e,n){"use strict";cc._RF.push(e,"c8721omtfFKcJPWIrgMwS6z","CryptoHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.cryptoHelper=void 0,t("../../../../startScene/version");var o=t("./ByteArrayMD5"),r=t("./CryptoJS"),i=t("./JSEncrypt"),a="\n-----BEGIN PUBLIC KEY-----\nMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAMJ85/CKgzbKiJXVz+N29h8ejG/PaqDm\nXwc/x5oER7nNt55tYK4G3MG8NzfKrAiyTA5I5czk667MF3e9F+8bb8cCAwEAAQ==\n-----END PUBLIC KEY-----\n",s=function(){function t(){this.publicCrypt=null,this.publicCrypt=new i.default,this.publicCrypt.setPublicKey(a)}return t.prototype.pkEncrypt=function(t,e){if(void 0===e&&(e=!0),e){var n=ut.getRandomString(16);return{encryStr:r.default.AES.encrypt(t,n).toString(),encryKey:this.publicCrypt.encrypt(n)}}return this.publicCrypt.encrypt(t)},t.prototype.pkVerify=function(t,e){return this.publicCrypt.verify(t,e,r.default.MD5)},t.prototype.md5=function(t){return t instanceof Uint8Array?o.default(t):r.default.MD5(t).toString()},t.prototype.aseDecrypt=function(t,e){return r.default.AES.decrypt(t,e).toString(r.default.enc.Utf8)},t}();n.cryptoHelper=new s,cc._RF.pop()},{"../../../../startScene/version":void 0,"./ByteArrayMD5":"ByteArrayMD5","./CryptoJS":"CryptoJS","./JSEncrypt":"JSEncrypt"}],CryptoJS:[function(t,e,n){"use strict";cc._RF.push(e,"5bfb2oN9vdB+owcmygWKW7O","CryptoJS"),Object.defineProperty(n,"__esModule",{value:!0});var o,r,i=i||function(t){var e={},n=e.lib={},o=function(){},r=n.Base={extend:function(t){o.prototype=this;var e=new o;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},i=n.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,n=t.words,o=this.sigBytes;if(t=t.sigBytes,this.clamp(),o%4)for(var r=0;r<t;r++)e[o+r>>>2]|=(n[r>>>2]>>>24-r%4*8&255)<<24-(o+r)%4*8;else if(65535<n.length)for(r=0;r<t;r+=4)e[o+r>>>2]=n[r>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],o=0;o<e;o+=4)n.push(4294967296*t.random()|0);return new i.init(n,e)}}),a=e.enc={},s=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],o=0;o<t;o++){var r=e[o>>>2]>>>24-o%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],o=0;o<e;o+=2)n[o>>>3]|=parseInt(t.substr(o,2),16)<<24-o%8*4;return new i.init(n,e/2)}},c=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],o=0;o<t;o++)n.push(String.fromCharCode(e[o>>>2]>>>24-o%4*8&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],o=0;o<e;o++)n[o>>>2]|=(255&t.charCodeAt(o))<<24-o%4*8;return new i.init(n,e)}},l=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},u=n.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,o=n.words,r=n.sigBytes,a=this.blockSize,s=r/(4*a);if(e=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*a,r=t.min(4*e,r),e){for(var c=0;c<e;c+=a)this._doProcessBlock(o,c);c=o.splice(0,e),n.sigBytes-=r}return new i.init(c,r)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=u.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new p.HMAC.init(t,n).finalize(e)}}});var p=e.algo={};return e}(Math);r=(o=i).lib.WordArray,o.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,o=this._map;t.clamp(),t=[];for(var r=0;r<n;r+=3)for(var i=(e[r>>>2]>>>24-r%4*8&255)<<16|(e[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|e[r+2>>>2]>>>24-(r+2)%4*8&255,a=0;4>a&&r+.75*a<n;a++)t.push(o.charAt(i>>>6*(3-a)&63));if(e=o.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var e=t.length,n=this._map;(o=n.charAt(64))&&-1!=(o=t.indexOf(o))&&(e=o);for(var o=[],i=0,a=0;a<e;a++)if(a%4){var s=n.indexOf(t.charAt(a-1))<<a%4*2,c=n.indexOf(t.charAt(a))>>>6-a%4*2;o[i>>>2]|=(s|c)<<24-i%4*8,i++}return r.create(o,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(t){function e(t,e,n,o,r,i,a){return((t=t+(e&n|~e&o)+r+a)<<i|t>>>32-i)+e}function n(t,e,n,o,r,i,a){return((t=t+(e&o|n&~o)+r+a)<<i|t>>>32-i)+e}function o(t,e,n,o,r,i,a){return((t=t+(e^n^o)+r+a)<<i|t>>>32-i)+e}function r(t,e,n,o,r,i,a){return((t=t+(n^(e|~o))+r+a)<<i|t>>>32-i)+e}for(var a=i,s=(l=a.lib).WordArray,c=l.Hasher,l=a.algo,u=[],p=0;64>p;p++)u[p]=4294967296*t.abs(t.sin(p+1))|0;l=l.MD5=c.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,i){for(var a=0;16>a;a++){var s=t[c=i+a];t[c]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}a=this._hash.words;var c=t[i+0],l=(s=t[i+1],t[i+2]),p=t[i+3],h=t[i+4],d=t[i+5],f=t[i+6],y=t[i+7],_=t[i+8],g=t[i+9],m=t[i+10],v=t[i+11],b=t[i+12],w=t[i+13],S=t[i+14],C=t[i+15],T=e(T=a[0],O=a[1],E=a[2],A=a[3],c,7,u[0]),A=e(A,T,O,E,s,12,u[1]),E=e(E,A,T,O,l,17,u[2]),O=e(O,E,A,T,p,22,u[3]);T=e(T,O,E,A,h,7,u[4]),A=e(A,T,O,E,d,12,u[5]),E=e(E,A,T,O,f,17,u[6]),O=e(O,E,A,T,y,22,u[7]),T=e(T,O,E,A,_,7,u[8]),A=e(A,T,O,E,g,12,u[9]),E=e(E,A,T,O,m,17,u[10]),O=e(O,E,A,T,v,22,u[11]),T=e(T,O,E,A,b,7,u[12]),A=e(A,T,O,E,w,12,u[13]),E=e(E,A,T,O,S,17,u[14]),T=n(T,O=e(O,E,A,T,C,22,u[15]),E,A,s,5,u[16]),A=n(A,T,O,E,f,9,u[17]),E=n(E,A,T,O,v,14,u[18]),O=n(O,E,A,T,c,20,u[19]),T=n(T,O,E,A,d,5,u[20]),A=n(A,T,O,E,m,9,u[21]),E=n(E,A,T,O,C,14,u[22]),O=n(O,E,A,T,h,20,u[23]),T=n(T,O,E,A,g,5,u[24]),A=n(A,T,O,E,S,9,u[25]),E=n(E,A,T,O,p,14,u[26]),O=n(O,E,A,T,_,20,u[27]),T=n(T,O,E,A,w,5,u[28]),A=n(A,T,O,E,l,9,u[29]),E=n(E,A,T,O,y,14,u[30]),T=o(T,O=n(O,E,A,T,b,20,u[31]),E,A,d,4,u[32]),A=o(A,T,O,E,_,11,u[33]),E=o(E,A,T,O,v,16,u[34]),O=o(O,E,A,T,S,23,u[35]),T=o(T,O,E,A,s,4,u[36]),A=o(A,T,O,E,h,11,u[37]),E=o(E,A,T,O,y,16,u[38]),O=o(O,E,A,T,m,23,u[39]),T=o(T,O,E,A,w,4,u[40]),A=o(A,T,O,E,c,11,u[41]),E=o(E,A,T,O,p,16,u[42]),O=o(O,E,A,T,f,23,u[43]),T=o(T,O,E,A,g,4,u[44]),A=o(A,T,O,E,b,11,u[45]),E=o(E,A,T,O,C,16,u[46]),T=r(T,O=o(O,E,A,T,l,23,u[47]),E,A,c,6,u[48]),A=r(A,T,O,E,y,10,u[49]),E=r(E,A,T,O,S,15,u[50]),O=r(O,E,A,T,d,21,u[51]),T=r(T,O,E,A,b,6,u[52]),A=r(A,T,O,E,p,10,u[53]),E=r(E,A,T,O,m,15,u[54]),O=r(O,E,A,T,s,21,u[55]),T=r(T,O,E,A,_,6,u[56]),A=r(A,T,O,E,C,10,u[57]),E=r(E,A,T,O,f,15,u[58]),O=r(O,E,A,T,w,21,u[59]),T=r(T,O,E,A,h,6,u[60]),A=r(A,T,O,E,v,10,u[61]),E=r(E,A,T,O,l,15,u[62]),O=r(O,E,A,T,g,21,u[63]),a[0]=a[0]+T|0,a[1]=a[1]+O|0,a[2]=a[2]+E|0,a[3]=a[3]+A|0},_doFinalize:function(){var e=this._data,n=e.words,o=8*this._nDataBytes,r=8*e.sigBytes;n[r>>>5]|=128<<24-r%32;var i=t.floor(o/4294967296);for(n[15+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(n.length+1),this._process(),n=(e=this._hash).words,o=0;4>o;o++)r=n[o],n[o]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},clone:function(){var t=c.clone.call(this);return t._hash=this._hash.clone(),t}}),a.MD5=c._createHelper(l),a.HmacMD5=c._createHmacHelper(l)}(Math),function(){var t,e=i,n=(t=e.lib).Base,o=t.WordArray,r=(t=e.algo).EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n=(s=this.cfg).hasher.create(),r=o.create(),i=r.words,a=s.keySize,s=s.iterations;i.length<a;){c&&n.update(c);var c=n.update(t).finalize(e);n.reset();for(var l=1;l<s;l++)c=n.finalize(c),n.reset();r.concat(c)}return r.sigBytes=4*a,r}});e.EvpKDF=function(t,e,n){return r.create(n).compute(t,e)}}(),i.lib.Cipher||function(){var t=(d=i).lib,e=t.Base,n=t.WordArray,o=t.BufferedBlockAlgorithm,r=d.enc.Base64,a=d.algo.EvpKDF,s=t.Cipher=o.extend({cfg:e.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,n,o){return("string"==typeof n?f:h).encrypt(t,e,n,o)},decrypt:function(e,n,o){return("string"==typeof n?f:h).decrypt(t,e,n,o)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=d.mode={},l=function(t,e,n){var o=this._iv;o?this._iv=void 0:o=this._prevBlock;for(var r=0;r<n;r++)t[e+r]^=o[r]},u=(t.BlockCipherMode=e.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();u.Encryptor=u.extend({processBlock:function(t,e){var n=this._cipher,o=n.blockSize;l.call(this,t,e,o),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+o)}}),u.Decryptor=u.extend({processBlock:function(t,e){var n=this._cipher,o=n.blockSize,r=t.slice(e,e+o);n.decryptBlock(t,e),l.call(this,t,e,o),this._prevBlock=r}}),c=c.CBC=u,u=(d.pad={}).Pkcs7={pad:function(t,e){for(var o,r=(o=(o=4*e)-t.sigBytes%o)<<24|o<<16|o<<8|o,i=[],a=0;a<o;a+=4)i.push(r);o=n.create(i,o),t.concat(o)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:c,padding:u}),reset:function(){s.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var p=t.CipherParams=e.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),h=(c=(d.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?n.create([1398893684,1701076831]).concat(t).concat(e):e).toString(r)},parse:function(t){var e=(t=r.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var o=n.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return p.create({ciphertext:t,salt:o})}},t.SerializableCipher=e.extend({cfg:e.extend({format:c}),encrypt:function(t,e,n,o){o=this.cfg.extend(o);var r=t.createEncryptor(n,o);return e=r.finalize(e),r=r.cfg,p.create({ciphertext:e,key:n,iv:r.iv,algorithm:t,mode:r.mode,padding:r.padding,blockSize:t.blockSize,formatter:o.format})},decrypt:function(t,e,n,o){return o=this.cfg.extend(o),e=this._parse(e,o.format),t.createDecryptor(n,o).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),d=(d.kdf={}).OpenSSL={execute:function(t,e,o,r){return r||(r=n.random(8)),t=a.create({keySize:e+o}).compute(t,r),o=n.create(t.words.slice(e),4*o),t.sigBytes=4*e,p.create({key:t,iv:o,salt:r})}},f=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:d}),encrypt:function(t,e,n,o){return n=(o=this.cfg.extend(o)).kdf.execute(n,t.keySize,t.ivSize),o.iv=n.iv,(t=h.encrypt.call(this,t,e,n.key,o)).mixIn(n),t},decrypt:function(t,e,n,o){return o=this.cfg.extend(o),e=this._parse(e,o.format),n=o.kdf.execute(n,t.keySize,t.ivSize,e.salt),o.iv=n.iv,h.decrypt.call(this,t,e,n.key,o)}})}(),function(){for(var t=i,e=t.lib.BlockCipher,n=t.algo,o=[],r=[],a=[],s=[],c=[],l=[],u=[],p=[],h=[],d=[],f=[],y=0;256>y;y++)f[y]=128>y?y<<1:y<<1^283;var _=0,g=0;for(y=0;256>y;y++){var m=(m=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&m^99;o[_]=m,r[m]=_;var v=f[_],b=f[v],w=f[b],S=257*f[m]^16843008*m;a[_]=S<<24|S>>>8,s[_]=S<<16|S>>>16,c[_]=S<<8|S>>>24,l[_]=S,S=16843009*w^65537*b^257*v^16843008*_,u[m]=S<<24|S>>>8,p[m]=S<<16|S>>>16,h[m]=S<<8|S>>>24,d[m]=S,_?(_=v^f[f[f[w^v]]],g^=f[f[g]]):_=g=1}var C=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=e.extend({_doReset:function(){for(var t=(n=this._key).words,e=n.sigBytes/4,n=4*((this._nRounds=e+6)+1),r=this._keySchedule=[],i=0;i<n;i++)if(i<e)r[i]=t[i];else{var a=r[i-1];i%e?6<e&&4==i%e&&(a=o[a>>>24]<<24|o[a>>>16&255]<<16|o[a>>>8&255]<<8|o[255&a]):(a=o[(a=a<<8|a>>>24)>>>24]<<24|o[a>>>16&255]<<16|o[a>>>8&255]<<8|o[255&a],a^=C[i/e|0]<<24),r[i]=r[i-e]^a}for(t=this._invKeySchedule=[],e=0;e<n;e++)i=n-e,a=e%4?r[i]:r[i-4],t[e]=4>e||4>=i?a:u[o[a>>>24]]^p[o[a>>>16&255]]^h[o[a>>>8&255]]^d[o[255&a]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,a,s,c,l,o)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,u,p,h,d,r),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,o,r,i,a,s){for(var c=this._nRounds,l=t[e]^n[0],u=t[e+1]^n[1],p=t[e+2]^n[2],h=t[e+3]^n[3],d=4,f=1;f<c;f++){var y=o[l>>>24]^r[u>>>16&255]^i[p>>>8&255]^a[255&h]^n[d++],_=o[u>>>24]^r[p>>>16&255]^i[h>>>8&255]^a[255&l]^n[d++],g=o[p>>>24]^r[h>>>16&255]^i[l>>>8&255]^a[255&u]^n[d++];h=o[h>>>24]^r[l>>>16&255]^i[u>>>8&255]^a[255&p]^n[d++],l=y,u=_,p=g}y=(s[l>>>24]<<24|s[u>>>16&255]<<16|s[p>>>8&255]<<8|s[255&h])^n[d++],_=(s[u>>>24]<<24|s[p>>>16&255]<<16|s[h>>>8&255]<<8|s[255&l])^n[d++],g=(s[p>>>24]<<24|s[h>>>16&255]<<16|s[l>>>8&255]<<8|s[255&u])^n[d++],h=(s[h>>>24]<<24|s[l>>>16&255]<<16|s[u>>>8&255]<<8|s[255&p])^n[d++],t[e]=y,t[e+1]=_,t[e+2]=g,t[e+3]=h},keySize:8}),t.AES=e._createHelper(n)}(),i.pad.ZeroPadding={pad:function(t,e){var n=4*e;t.clamp(),t.sigBytes+=n-(t.sigBytes%n||n)},unpad:function(t){for(var e=t.words,n=t.sigBytes-1;!(e[n>>>2]>>>24-n%4*8&255);)n--;t.sigBytes=n+1}},n.default=i,cc._RF.pop()},{}],DBCompat:[function(t,e,n){"use strict";cc._RF.push(e,"58d00VqhwlP9rKNZn6CCziW","DBCompat"),Object.defineProperty(n,"__esModule",{value:!0}),n.SOUP_TODAY_COMP2=n.WIND_CHANGE_HEI_WIND_402=n.SOUP_TODAY_COMP=n.GUIDE_TASK_PREIDS=n.GUIDE_TASK_PROGRESS_EMPTY=n.EVEYDAY_TASK_ID_DONE=n.SHOWER_ACHIEVE_TASK_REWARD=n.SHOWER_MATERIAL_REWARD=n.SHOWER_SOUP_REWARD=n.SHOWER_SOUP_CONVERSION=n.SHOWER_ADDITIVE_CONVERSION=n.COMPAT_UNLOCK_WIND=n.ROLE_OLD_MAX_EXP=n.WISH_ID_CHANGE=n.WIND_CHANGE_HEI_WIND=void 0,n.WIND_CHANGE_HEI_WIND={PENDANT_040:"PENDANT_051",PENDANT_041:"PENDANT_052",PENDANT_018:"PENDANT_053",PENDANT_042:"PENDANT_054",PENDANT_019:"PENDANT_055",PENDANT_020:"PENDANT_056",PENDANT_021:"PENDANT_057",PENDANT_022:"PENDANT_058",PENDANT_023:"PENDANT_059",PENDANT_024:"PENDANT_060",PENDANT_025:"PENDANT_061",PENDANT_043:"PENDANT_062",DECORATE_014:"DECORATE_028",DECORATE_015:"DECORATE_029",DECORATE_017:"DECORATE_030"},n.WISH_ID_CHANGE={"1_1":1001,"2_1":1002,"3_1":1003,"4_1":1004,"5_2":2001,"6_2":2002,"7_2":2003,"8_2":2004,"9_3":3001,"10_3":3002,"11_3":3003,"12_3":3004,"17_12":12001,"18_12":12002,"19_12":12003,"20_12":12004,"13_4":4001,"14_4":4002,"15_4":4003,"16_4":4004,"29_8":8001,"30_8":8002,"31_8":8003,"32_8":8004,"37_10":10001,"38_10":10002,"39_10":10003,"40_10":10004,"41_11":11001,"42_11":11002,"43_11":11003,"44_11":11004,"13_51":51001,"14_51":51002,"15_51":51003,"16_51":51004,"25_37":37001,"26_37":37002,"27_37":37003,"28_37":37004,"49_13":13001,"50_13":13002,"51_13":13003,"52_13":13004,"53_14":14001,"54_14":14002,"55_14":14003,"56_14":14004,"109_28":28001,"110_28":28002,"111_28":28003,"112_28":28004,"57_15":15001,"58_15":15002,"59_15":15003,"60_15":15004,"61_16":16001,"62_16":16002,"63_16":16003,"64_16":16004,"33_31":31001,"34_31":31002,"35_31":31003,"36_31":31004,"45_5":5001,"46_5":5002,"47_5":5003,"48_5":5004,"65_17":17001,"66_17":17002,"67_17":17003,"68_17":17004,"69_18":18001,"70_18":18002,"71_18":18003,"72_18":18004,"73_19":19001,"74_19":19002,"75_19":19003,"76_19":19004,"81_21":21001,"82_21":21002,"83_21":21003,"84_21":21004,"77_20":20001,"78_20":20002,"79_20":20003,"80_20":20004,"93_24":24001,"94_24":24002,"95_24":24003,"96_24":24004,"85_22":22001,"86_22":22002,"87_22":22003,"88_22":22004,"89_23":23001,"90_23":23002,"91_23":23003,"92_23":23004,"105_27":27001,"106_27":27002,"107_27":27003,"108_27":27004,"97_25":25001,"98_25":25002,"99_25":25003,"100_25":25004,"101_26":26001,"102_26":26002,"103_26":26003,"104_26":26004,"117_30":30001,"118_30":30002,"119_30":30003,"120_30":30004,"21_6":6001,"22_6":6002,"23_6":6003,"24_6":6004,"113_29":29001,"114_29":29002,"115_29":29003,"116_29":29004,"129_33":33001,"130_33":33002,"131_33":33003,"132_33":33004,"121_9":9001,"122_9":9002,"123_9":9003,"124_9":9004,"125_32":32001,"126_32":32002,"127_32":32003,"128_32":32004,"141_36":36001,"142_36":36002,"143_36":36003,"144_36":36004,"133_34":34001,"134_34":34002,"135_34":34003,"136_34":34004,"137_35":35001,"138_35":35002,"139_35":35003,"140_35":35004,"145_7":7001,"146_7":7002,"147_7":7003,"148_7":7004,"157_40":40001,"158_40":40002,"159_40":40003,"160_40":40004,"149_38":38001,"150_38":38002,"151_38":38003,"152_38":38004,"153_39":39001,"154_39":39002,"155_39":39003,"156_39":39004,"157_41":41001,"158_41":41002,"159_41":41003,"160_41":41004,"157_42":42001,"158_42":42002,"159_42":42003,"160_42":42004,"157_43":43001,"158_43":43002,"159_43":43003,"160_43":43004,"157_44":44001,"158_44":44002,"159_44":44003,"160_44":44004,"157_45":45001,"158_45":45002,"159_45":45003,"160_45":45004,"157_46":46001,"158_46":46002,"159_46":46003,"160_46":46004,"157_47":47001,"158_47":47002,"159_47":47003,"160_47":47004,"157_48":48001,"158_48":48002,"159_48":48003,"160_48":48004,"157_49":49001,"158_49":49002,"159_49":49003,"160_49":49004,"157_50":50001,"158_50":50002,"159_50":50003,"160_50":50004},n.ROLE_OLD_MAX_EXP={"1_1":{lv:2,stage:1,isMaxExp:!1},"2_1":{lv:3,stage:1,isMaxExp:!1},"3_1":{lv:4,stage:1,isMaxExp:!1},"4_1":{lv:5,stage:1,isMaxExp:!0},"4_2":{lv:7,stage:2,isMaxExp:!1},"5_2":{lv:8,stage:2,isMaxExp:!1},"6_2":{lv:9,stage:2,isMaxExp:!1},"7_2":{lv:10,stage:2,isMaxExp:!0},"7_3":{lv:12,stage:3,isMaxExp:!1},"8_3":{lv:13,stage:3,isMaxExp:!1},"9_3":{lv:14,stage:3,isMaxExp:!1},"10_3":{lv:15,stage:3,isMaxExp:!0},"10_4":{lv:17,stage:4,isMaxExp:!1},"11_4":{lv:18,stage:4,isMaxExp:!1},"12_4":{lv:19,stage:4,isMaxExp:!1},"13_4":{lv:20,stage:4,isMaxExp:!0},"13_5":{lv:21,stage:5,isMaxExp:!1}},n.COMPAT_UNLOCK_WIND={PENDANT_019:"PENDANT_040",PENDANT_022:"PENDANT_041",PENDANT_020:"PENDANT_018",PENDANT_021:"PENDANT_042",PENDANT_055:"PENDANT_051",PENDANT_058:"PENDANT_052",PENDANT_056:"PENDANT_053",PENDANT_057:"PENDANT_054",PENDANT_023:"PENDANT_019",PENDANT_024:"PENDANT_022",PENDANT_025:"PENDANT_020",PENDANT_043:"PENDANT_021",PENDANT_059:"PENDANT_055",PENDANT_060:"PENDANT_058",PENDANT_061:"PENDANT_056",PENDANT_062:"PENDANT_057"},n.SHOWER_ADDITIVE_CONVERSION=[{id:1001,effe:5,num:10},{id:1002,effe:9,num:20},{id:1003,effe:13,num:45},{id:1004,effe:17,num:80},{id:1005,effe:21,num:135},{id:1006,effe:26,num:180},{id:1007,effe:30,num:270},{id:1008,effe:34,num:450},{id:1009,effe:38,num:675},{id:1010,effe:43,num:940},{id:1011,effe:47,num:1145},{id:1012,effe:51,num:1245},{id:1013,effe:55,num:1610},{id:1014,effe:60,num:1865},{id:1015,effe:64,num:2190},{id:1016,effe:68,num:2585},{id:1017,effe:72,num:2940},{id:1018,effe:77,num:3410},{id:1019,effe:81,num:3825},{id:1020,effe:85,num:4330},{id:1021,effe:89,num:4675},{id:1022,effe:94,num:5355},{id:1023,effe:98,num:5935},{id:1024,effe:102,num:6380},{id:1025,effe:106,num:7070},{id:1026,effe:111,num:7585},{id:1027,effe:115,num:8155},{id:1028,effe:119,num:8795},{id:1029,effe:123,num:9610},{id:1030,effe:128,num:10390},{id:1031,effe:132,num:11225},{id:1032,effe:136,num:11900},{id:1033,effe:140,num:12525},{id:1034,effe:145,num:13110},{id:1035,effe:149,num:13755},{id:1036,effe:153,num:14775},{id:1037,effe:157,num:15405},{id:1038,effe:161,num:16370},{id:1039,effe:166,num:17220},{id:1040,effe:170,num:18230},{id:1041,effe:174,num:19190},{id:1042,effe:178,num:20010},{id:1043,effe:183,num:20800},{id:1044,effe:187,num:21505},{id:1045,effe:191,num:22680},{id:1046,effe:195,num:23985},{id:1047,effe:200,num:25305},{id:1048,effe:204,num:26180},{id:1049,effe:208,num:28020},{id:1050,effe:212,num:29330},{id:1051,effe:217,num:30445},{id:1052,effe:221,num:32145},{id:1053,effe:225,num:33055},{id:1054,effe:229,num:34695},{id:1055,effe:234,num:36495},{id:1056,effe:238,num:37895},{id:1057,effe:242,num:39410},{id:1058,effe:246,num:41210},{id:1059,effe:251,num:42900},{id:1060,effe:255,num:44760},{id:1061,effe:259,num:46065},{id:1062,effe:263,num:47645},{id:1063,effe:268,num:49545},{id:1064,effe:272,num:50750},{id:1065,effe:276,num:52715},{id:1066,effe:280,num:54130},{id:1067,effe:285,num:55970},{id:1068,effe:289,num:57255},{id:1069,effe:293,num:59005},{id:1070,effe:297,num:60185},{id:1071,effe:302,num:61765}],n.SHOWER_SOUP_CONVERSION=[{id:1,soup:3001,lv:1,income:100},{id:2,soup:3002,lv:1,income:114},{id:3,soup:3001,lv:2,income:127},{id:4,soup:3003,lv:1,income:138},{id:5,soup:3002,lv:2,income:148},{id:6,soup:3003,lv:2,income:159},{id:7,soup:3004,lv:1,income:169},{id:8,soup:3005,lv:1,income:183},{id:9,soup:3001,lv:3,income:189},{id:10,soup:3004,lv:2,income:196},{id:11,soup:3002,lv:3,income:202},{id:12,soup:3006,lv:1,income:217},{id:13,soup:3005,lv:2,income:223},{id:14,soup:3007,lv:1,income:240},{id:15,soup:3003,lv:3,income:245},{id:16,soup:3006,lv:2,income:251},{id:17,soup:3004,lv:3,income:256},{id:18,soup:3007,lv:2,income:262},{id:19,soup:3008,lv:1,income:279},{id:20,soup:3009,lv:1,income:300},{id:21,soup:3005,lv:3,income:304},{id:22,soup:3008,lv:2,income:309},{id:23,soup:3001,lv:4,income:313},{id:24,soup:3002,lv:4,income:316},{id:25,soup:3006,lv:3,income:321},{id:26,soup:3009,lv:2,income:326},{id:27,soup:3010,lv:1,income:347},{id:28,soup:3011,lv:1,income:370},{id:29,soup:3003,lv:4,income:373},{id:30,soup:3007,lv:3,income:377},{id:31,soup:3010,lv:2,income:382},{id:32,soup:3012,lv:1,income:407},{id:33,soup:3004,lv:4,income:410},{id:34,soup:3008,lv:3,income:414},{id:35,soup:3005,lv:4,income:418},{id:36,soup:3006,lv:4,income:421},{id:37,soup:3011,lv:2,income:426},{id:38,soup:3009,lv:3,income:430},{id:39,soup:3010,lv:3,income:435},{id:40,soup:3012,lv:2,income:440},{id:41,soup:3007,lv:4,income:444},{id:42,soup:3013,lv:1,income:468},{id:43,soup:3014,lv:1,income:496},{id:44,soup:3013,lv:2,income:500},{id:45,soup:3015,lv:1,income:530},{id:46,soup:3002,lv:5,income:532},{id:47,soup:3008,lv:4,income:535},{id:48,soup:3011,lv:3,income:539},{id:49,soup:3014,lv:2,income:544},{id:50,soup:3001,lv:5,income:546},{id:51,soup:3003,lv:5,income:548},{id:52,soup:3004,lv:5,income:550},{id:53,soup:3009,lv:4,income:554},{id:54,soup:3012,lv:3,income:558},{id:55,soup:3015,lv:2,income:562},{id:56,soup:3005,lv:5,income:565},{id:57,soup:3006,lv:5,income:568},{id:58,soup:3010,lv:4,income:572},{id:59,soup:3013,lv:3,income:576},{id:60,soup:3011,lv:4,income:580},{id:61,soup:3014,lv:3,income:584},{id:62,soup:3016,lv:1,income:613},{id:63,soup:3017,lv:1,income:644},{id:64,soup:3016,lv:2,income:649},{id:65,soup:3017,lv:2,income:653},{id:66,soup:3018,lv:1,income:687},{id:67,soup:3007,lv:5,income:689},{id:68,soup:3008,lv:5,income:692},{id:69,soup:3012,lv:4,income:695},{id:70,soup:3015,lv:3,income:699},{id:71,soup:3009,lv:5,income:702},{id:72,soup:3010,lv:5,income:705},{id:73,soup:3013,lv:4,income:709},{id:74,soup:3014,lv:4,income:712},{id:75,soup:3016,lv:3,income:716},{id:76,soup:3018,lv:2,income:721},{id:77,soup:3011,lv:5,income:724},{id:78,soup:3017,lv:3,income:728},{id:79,soup:3012,lv:5,income:732},{id:80,soup:3015,lv:4,income:736},{id:81,soup:3016,lv:4,income:740},{id:82,soup:3018,lv:3,income:744},{id:83,soup:3019,lv:1,income:777},{id:84,soup:3020,lv:1,income:812},{id:85,soup:3019,lv:2,income:816},{id:86,soup:3020,lv:2,income:820},{id:87,soup:3013,lv:5,income:824},{id:88,soup:3017,lv:4,income:828},{id:89,soup:3019,lv:3,income:832},{id:90,soup:3020,lv:3,income:836},{id:91,soup:3014,lv:5,income:839},{id:92,soup:3015,lv:5,income:843},{id:93,soup:3018,lv:4,income:847},{id:94,soup:3016,lv:5,income:850},{id:95,soup:3019,lv:4,income:854},{id:96,soup:3020,lv:4,income:859},{id:97,soup:3017,lv:5,income:863},{id:98,soup:3018,lv:5,income:867},{id:99,soup:3019,lv:5,income:871},{id:100,soup:3020,lv:5,income:875}],n.SHOWER_MATERIAL_REWARD=[{id:1001,val:800},{id:1002,val:1e3},{id:1003,val:1200},{id:1004,val:3e3},{id:1005,val:6e3},{id:1006,val:4500},{id:1007,val:11e3},{id:1008,val:16e3}],n.SHOWER_SOUP_REWARD=[{id:3001,val:4557},{id:3002,val:2817},{id:3003,val:16567},{id:3004,val:4482},{id:3005,val:8452},{id:3006,val:20370},{id:3007,val:6986},{id:3008,val:32972},{id:3009,val:17600}],n.SHOWER_ACHIEVE_TASK_REWARD=[{id:16001,reward:"2,-1,5"},{id:16002,reward:"2,-1,5"},{id:16003,reward:"2,-1,5"},{id:16004,reward:"2,-1,10"},{id:16005,reward:"2,-1,10"},{id:16006,reward:"2,-1,15"},{id:16007,reward:"2,-1,30"},{id:16008,reward:"2,-1,30"},{id:16009,reward:"2,-1,50"},{id:16010,reward:"2,-1,100"},{id:6001,reward:"1,-1,560"},{id:6002,reward:"1,-1,2400"},{id:6003,reward:"1,-1,2800"},{id:6004,reward:"1,-1,4000"},{id:6005,reward:"1,-1,6000"},{id:6006,reward:"1,-1,16000"},{id:6007,reward:"1,-1,20000"},{id:6008,reward:"1,-1,36000"},{id:6009,reward:"1,-1,52000"},{id:6010,reward:"1,-1,80000"}],n.EVEYDAY_TASK_ID_DONE=[3001,3002,3003,13001],n.GUIDE_TASK_PROGRESS_EMPTY=[1026,1028,1043,1044,1045,1030,1029],n.GUIDE_TASK_PREIDS={1046:1001,1002:1046,1003:1002,1004:1003,1048:1004,1005:1048,1047:1005,1037:1047,1006:1037,1009:1006,1010:1009,1032:1010,1007:1032,1008:1007,1033:1008,1034:1033,1049:1034,1011:1049,1035:1011,1012:1035,1013:1012,1014:1013,1017:1014,1018:1017,1015:1018,1019:1015,1036:1019,1020:1036,1031:1020,1016:1031,1021:1016,1038:1021,1039:1038,1040:1039,1041:1040,1042:1041,1050:1042,1051:1050,1052:1051,1053:1052,1022:1053,1023:1022,1024:1023,1054:1024,1055:1054,1056:1055,1065:1056,1066:1065,1057:1066,1067:1057,1058:1067,1068:1058,1059:1068,1069:1059,1060:1069,1061:1060,1062:1061,1063:1062,1064:1063,1025:1064,1026:1025,1027:1026,1028:1027,1043:1028,1044:1043,1045:1044,1030:1045,1029:1030},n.SOUP_TODAY_COMP=[6,7,8,9,10],n.SOUP_TODAY_COMP2=[14,15,16,17,18],n.WIND_CHANGE_HEI_WIND_402={PENDANT_105:"PENDANT_108",PENDANT_106:"PENDANT_109",PENDANT_107:"PENDANT_110"},cc._RF.pop()},{}],DataType:[function(t,e,n){"use strict";cc._RF.push(e,"9cbc7VRzmhOEpLsDiUCld/1","DataType"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],DatabaseHelperOld:[function(t,e,n){"use strict";cc._RF.push(e,"cf321Ly8LJEY4x0+w4ZcJvc","DatabaseHelperOld"),Object.defineProperty(n,"__esModule",{value:!0}),n.dbHelperOld=void 0;var o=function(){function t(){this.map=new Map,this.delay=0}return t.prototype.register=function(t,e,n,o,r){var i,a=null!==(i=storageMgr.loadString(t))&&void 0!==i?i:"",s=a?JSON.parse(a):null;return this.map.set(t,{cb:o.debugToDB||n,target:o,data:a,json:null,_ver:e||1,saveByDirty:r}),s},t.prototype.get=function(t){var e=storageMgr.loadString(t);return e?JSON.parse(e):null},t.prototype.save=function(t,e){storageMgr.saveString(t,JSON.stringify(e))},t.prototype.forceSave=function(t){var e=this.map.get(t);if(e){var n=e.cb.call(e.target,0);if(n){var o=JSON.stringify(n);e.data=o,storageMgr.saveString(t,o),storageMgr.save()}}},t.prototype.update=function(t){this.delay>0?this.delay-=t:(this.delay=.1,this.map.forEach(function(e,n){var o=e.cb.call(e.target,t);if(o){o._ver=e._ver||1;var r=JSON.stringify(o);e.data!==r&&(e.data=r,storageMgr.saveString(n,r))}}),this.map.forEach(function(t,e){if("__net"!=e){var n=storageMgr.loadString(e),o=storageMgr.loadObject(e.substring(2));o=JSON.stringify(o);for(var r=[],i=2;i<=4;i++)r.push("__elevator"+i+"_map");r.has(e)&&(delete(n=JSON.parse(n)).zoomRatio,n=JSON.stringify(n),delete(o=JSON.parse(o)).zoomRatio,o=JSON.stringify(o));var a=-1;for(i=0;i<Math.max(n.length,o.length);i++)n[i]!=o[i]&&-1==a&&(a=i);if(a>=0){var s=Math.max(0,a-20),c=s+100;console.error("diff_fragment",e,n.substring(s,c),"\n"+s+" -> "+c+"\n",o.substring(s,c))}}}))},t.prototype.clear=function(){this.map.clear()},t}();n.dbHelperOld=new o,cc._RF.pop()},{}],DatabaseHelper:[function(t,e,n){"use strict";cc._RF.push(e,"4dd43iJx/9LU52ApU3NtAKM","DatabaseHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.dbHelper=void 0;var o=t("../../../core/utils/Observer"),r=t("../LocalConfig"),i=t("./DatabaseHelperOld"),a=function(){function t(){this.map=new Map,this.dirtyMap=new Map,this.saveFreCheck=new Map,this.saveFreFields={},this.delay=.1,this.forceUpdateList=["main"]}return t.prototype.register=function(t,e,n,a,s){var c=this,l=this.load(t,e),u=l._ver,p=new o.default(function(e,n,o){p.debug&&lplog.info("ob-----",e,o,"->",n),r.localConfig.debugDBHelper&&(c.saveFreFields[t]=e),c.setDirty(t)});return p.debug=r.localConfig.debugDBHelper,p.observe(a,s),this.map.set(t,{cb:n,target:a,_ver:e||1,data:JSON.stringify(l)}),this.setDirty(t),r.localConfig.debugDBHelper&&i.dbHelperOld.register("__"+t,e,n,a),u!==l._ver&&(l._ver=u),l},t.prototype.forceSave=function(t){if(this.map.get(t)){var e=this.map.get(t),n=e.cb.call(e.target);n._ver=e._ver,this.save(t,n),storageMgr.save(),this.dirtyMap.set(t,!1)}},t.prototype.update=function(t){var e=this;this.dirtyMap.forEach(function(t,n){if(t){var o=e.map.get(n);if(o){var i=o.cb.call(o.target);i._ver=o._ver,e.save(n,i),lplog.info("dirtyUpdate ",n),e.dirtyMap.set(n,!1),r.localConfig.debugDBHelper&&e.freqCheck(n)}}}),r.localConfig.debugDBHelper&&i.dbHelperOld.update(t)},t.prototype.clear=function(){this.map.clear(),this.dirtyMap.clear(),r.localConfig.debugDBHelper&&i.dbHelperOld.clear(),storageMgr.clear()},t.prototype.setDirty=function(t){this.dirtyMap.set(t,!0)},t.prototype.save=function(t,e){r.localConfig.debugDBHelper&&(e=ut.deepClone(e)),storageMgr.saveObject(t,e)},t.prototype.load=function(t,e){var n=storageMgr.loadObject(t)||{_ver:e};return"string"==typeof n&&(n=JSON.parse(n),this.save(t,n)),r.localConfig.debugDBHelper&&(n=ut.deepClone(n)),n},t.prototype.freqCheck=function(t){var e=this.saveFreCheck.get(t),n=Date.now();e?(n-e.lastTime<5e3?(e.count++,e.count>20&&(!t.includes("_map")&&lplog.error("dbHelper \u6301\u4e45\u5316\u8fc7\u4e8e\u9891\u7e41",t,this.saveFreFields[t]),e.count=0)):e.count=0,e.lastTime=n,this.saveFreCheck.set(t,e)):this.saveFreCheck.set(t,{lastTime:n,count:1})},t}();n.dbHelper=new a,cc._RF.pop()},{"../../../core/utils/Observer":"Observer","../LocalConfig":"LocalConfig","./DatabaseHelperOld":"DatabaseHelperOld"}],DebugWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"16a89hZ+FNG5q4hysRqwxfV","DebugWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/ViewHelper"),l=t("../../model/common/ColorShapeObj"),u=t("../cmpt/game/ShapeCmpt"),p=cc._decorator.ccclass,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listSv_=null,e.prefab=null,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return cc.log("DebugWindCtrl onCreate"),t=this,[4,assetsMgr.loadTempRes("shape",cc.Prefab,"block")];case 1:return t.prefab=e.sent(),[2]}})})},e.prototype.onEnter=function(){var t=this;cc.log("DebugWindCtrl onEnter");var e=assetsMgr.getJson("ShapeConfig").datas;this.listSv_.List(e.length,function(n,o){var r=e[o],i=(new l.default).init(r.id,r.coords,r.headPos);i.initColor(1),i.initDegree(0),n.Child("text",cc.Label).string=""+r.id,n.Child("content").destroyAllChildren();var a=t.prefab,s=n.Child("content"),c=cc.instantiate2(a,s);c.addComponent(u.default).init(i),c.setScale(.5),c.name="shape",c.Component(u.default).setGray(!1),n.height=100*r.rowCount})},e.prototype.onClean=function(){cc.log("DebugWindCtrl onClean")},e.prototype.onClickBack=function(t,e){cc.log("onClickBack",e),c.viewHelper.gotoWind("main")},i([p],e)}(mc.BaseWindCtrl);n.default=h,cc._RF.pop()},{"../../common/helper/ViewHelper":"ViewHelper","../../model/common/ColorShapeObj":"ColorShapeObj","../cmpt/game/ShapeCmpt":"ShapeCmpt"}],Decorator:[function(t,e,n){"use strict";cc._RF.push(e,"74f3cTC+sNAOKVQYl/de78Y","Decorator"),Object.defineProperty(n,"__esModule",{value:!0}),n.throttle=n.debounce=void 0,n.debounce=function(t){return function(e,n,o){var r,i=o.value;return o.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=this;clearTimeout(r),r=setTimeout(function(){try{return i.apply(o,e)}catch(t){return null}},t)},o}},n.throttle=function(t){return function(e,n,o){var r=0,i=o.value;return o.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=this,a=Date.now();if(a-r>=t)return r=a,i.apply(o,e)},o}},cc._RF.pop()},{}],DigModel:[function(t,e,n){"use strict";cc._RF.push(e,"6189bnPZ3xF3ZpnlHHNONg0","DigModel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../common/event/EventType"),s=t("../../common/helper/DatabaseHelper"),c=t("../../common/helper/ReddotHelper"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activityId=0,e.lastMiles=0,e.flash=0,e.endTime=0,e.inited=!1,e}return r(e,t),e.prototype.init=function(){var t,e,n,o=s.dbHelper.register("dig",1,this.toDB,this,Object.keys(this.toDB()))||{};this.lastMiles=null!==(t=o.lastMiles)&&void 0!==t?t:0,this.flash=null!==(e=o.flash)&&void 0!==e?e:0,this.endTime=null!==(n=o.endTime)&&void 0!==n?n:this.getNextMondayTimestamp(),c.reddotHelper.register("drill",this.getDrillRedDot,this)},e.prototype.clean=function(){this.lastMiles=0,this.flash=0,this.endTime=this.getNextMondayTimestamp(),eventMgr.emit(a.default.DIG_FINISH),c.reddotHelper.check("drill")},e.prototype.getFlash=function(){return this.flash},e.prototype.addFlash=function(t){this.flash+=t,c.reddotHelper.check("drill"),eventMgr.emit(a.default.UPDATE_FLASH)},e.prototype.setFlash=function(t){this.flash=t,c.reddotHelper.check("drill"),eventMgr.emit(a.default.UPDATE_FLASH)},e.prototype.getMiles=function(){return this.lastMiles},e.prototype.addMiles=function(t){this.lastMiles+=t},e.prototype.setMiles=function(t){this.lastMiles=t},e.prototype.toDB=function(){return{lastMiles:this.lastMiles,flash:this.flash,endTime:this.endTime}},e.prototype.update=function(){this.init&&Date.now()>=this.endTime&&this.clean()},e.prototype.getDrillRedDot=function(){return this.flash>0},e.prototype.getNextMondayTimestamp=function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=e.getDay(),o=1===n?7:(1-n+7)%7;return new Date(e.getTime()+864e5*o).getTime()},i([mc.addmodel("dig")],e)}(mc.BaseModel);n.default=l,cc._RF.pop()},{"../../common/event/EventType":"EventType","../../common/helper/DatabaseHelper":"DatabaseHelper","../../common/helper/ReddotHelper":"ReddotHelper"}],DigWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"372caLR9yNPUqXlIRcGNR+S","DigWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Enums"),l=t("../../common/event/EventType"),u=t("../../common/helper/AnimHelper"),p=t("../../common/helper/GameHelper"),h=t("../../common/helper/GotoHelper"),d=t("../../common/helper/ResHelper"),f=t("../../common/helper/ViewHelper"),y=cc._decorator.ccclass,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapSv_=null,e.backgroundsNode_=null,e.barBGNode_=null,e.barNode_=null,e.pathNode_=null,e.diggerNode_=null,e.excavatorSp_=null,e.valSpr_=null,e.curMilesLbl_=null,e.particleNode_=null,e.blockNode_=null,e.titleLbl_=null,e.timeLbl_=null,e.adStatusNode_=null,e.moving=!1,e.diff=0,e}return r(e,t),e.prototype.eventMaps=function(){var t;return[(t={},t[l.default.DIG_FINISH]=this.digFinish,t)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return cc.log("DigWindCtrl onCreate"),[4,this.initMap()];case 1:return t.sent(),[2]}})})},e.prototype.onEnter=function(){cc.log("DigWindCtrl onEnter"),p.gameHelper.ad.initCurrentAd(c.AdType.REWARD);var t=p.gameHelper.ad.isAdReady();this.adStatusNode_.Component(cc.MultiFrame).setFrame(t?0:1),this.setDigger()},e.prototype.onClean=function(){cc.log("DigWindCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),audioMgr.stopSFX("common/dig"),h.gotoHelper.gotoWind("main")},e.prototype.onClickAd=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return cc.log("onClickAd",e),this.moving?(f.viewHelper.showAlert("dig_tips"),[2]):[4,p.gameHelper.ad.showAd(c.AdPropType.Dig)];case 1:return t.sent().status!==c.RewardAdStatus.SUCCESS?[2]:(p.gameHelper.dig.addFlash(5e3),this.moveDiggerTo(),[2])}})})},e.prototype.initMap=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t=assetsMgr.getJson("Easter").datas,this.barNode_.Items(t.length+1,function(e,n,o){var r=0==o?1:o==t.length?2:0;e.Component(cc.MultiFrame).setFrame(r)}),[4,ut.waitNextFrame(2)];case 1:return n.sent(),this.pathNode_.Items(t,function(t,e){t.Child("content/miles",cc.Label).string=e.progress+"m";var n=ut.stringToNumbers(e.reward,":"),o=n[0],r=n[1],i=t.Child("content/rewardItem");d.resHelper.loadTempIcon(i,""+o,"dig"),i.Child("val",cc.Label).string="x"+r}),[4,ut.waitNextFrame(2)];case 2:return n.sent(),e=Math.ceil(353*t.length/1280),this.backgroundsNode_.Items(e),this.mapSv_.content.height=1280*e,this.barBGNode_.height=353*(t.length+1),[2]}})})},e.prototype.setDigger=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a;return s(this,function(s){switch(s.label){case 0:return t=p.gameHelper.dig.getMiles(),e=p.gameHelper.dig.getFlash(),n=this.milesToY(t),this.diggerNode_.y=n,o=this.toIndex(t),r=o.index,i=o.diffMiles,a=o.distance,this.barNode_.children.map(function(t,e){t.Component(cc.Sprite).fillRange=e<r?0:e==r?1-i/a:1}),this.valSpr_.fillRange=e>0?1:0,[4,ut.waitNextFrame(1)];case 1:return s.sent(),this.mapSv_.scrollToOffset(cc.v2(0,-n-500)),this.updateDigBar(t),this.initRewardBar(n),this.excavatorSp_.play("idle"),this.particleNode_.active=!1,this.curMilesLbl_.string=t+"m",this.moveDiggerTo(),[2]}})})},e.prototype.moveDiggerTo=function(){var t=this,e=p.gameHelper.dig.getFlash(),n=p.gameHelper.dig.getMiles();p.gameHelper.dig.setFlash(0);var o=assetsMgr.getJson("Easter").datas,r=o.last().progress,i=Math.min(e+n,r);if(p.gameHelper.dig.setMiles(i),!(e<=0||n>=r)){for(var a=[],s=0;s<o.length;++s){var c=o[s].progress;if(c>n&&c<=i){var l=ut.stringToNumbers(o[s].reward,":"),u=l[0],h=l[1];a.push({id:u,count:h})}}p.gameHelper.getRewards(a,!1),this.moving=!0,this.blockNode_.active=!0;var d=this.milesToY(i);this.excavatorSp_.play("move"),this.particleNode_.active=!0,this.particleNode_.Component(cc.ParticleSystem).resetSystem(),Math.abs(d-this.diggerNode_.y),audioMgr.playSFX("common/dig",{loop:!0}),cc.tween(this.diggerNode_).to(3,{y:d},{onUpdate:function(e,n){var o=Math.ceil(t.yToMiles(e.y));t.curMilesLbl_.string=o+"m",t.mapSv_.scrollToOffset(cc.v2(0,-e.y-500)),t.valSpr_.fillRange=1-n,t.updateDigBar(o),t.updateRewardBar(e.y)}}).delay(.1).call(function(){t.moving=!1,audioMgr.stopSFX("common/dig"),t.blockNode_.active=!1,t.updateDigBar(i),t.updateRewardBar(d),t.excavatorSp_.play("idle"),t.particleNode_.active=!1,t.curMilesLbl_.string=i+"m"}).start()}},e.prototype.updateDigBar=function(t){var e=this.toIndex(t),n=e.index,o=e.diffMiles,r=e.distance;this.barNode_.children.map(function(t,e){t.Component(cc.Sprite).fillRange=e<n?0:e==n?1-o/r:1})},e.prototype.initRewardBar=function(t){var e=this;this.pathNode_.children.map(function(n){var o,r=n.Child("content/drill_path_bar",cc.Sprite),i=r.node.convertToWorldSpaceAR(cc.v2(0,r.node.height/2)),a=e.diggerNode_.parent.convertToNodeSpaceAR(i),s=a.y-r.node.height,c=a.y;o=t>c?1:t<=s?0:1-(c-t)/r.node.height,r.fillRange=o;var l=n.Child("content/got"),u=n.Child("content/spine",sp.Skeleton);l.Data=o<=0;var p=o<=0?"#FEF574":"#FFFFFF";n.Child("content/miles",cc.Label).SetColor(p),l.active=u.node.active=o<=0})},e.prototype.updateRewardBar=function(t){var e=this;this.pathNode_.children.map(function(n,o){var r,i=n.Child("content/drill_path_bar",cc.Sprite),a=i.node.convertToWorldSpaceAR(cc.v2(0,i.node.height/2)),s=e.diggerNode_.parent.convertToNodeSpaceAR(a),c=s.y-i.node.height,l=s.y;r=t>l?1:t<=c?0:1-(l-t)/i.node.height,i.fillRange=r;var u=n.Child("content/got"),p=n.Child("content/spine",sp.Skeleton);if(!u.Data&&r<=0){u.Data=!0;var h=assetsMgr.getJson("Easter").datas;e.playGotRewardAnim(n,h[o])}var d=r<=0?"#FEF574":"#FFFFFF";n.Child("content/miles",cc.Label).SetColor(d),u.active=p.node.active=r<=0})},e.prototype.playGotRewardAnim=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a,c,l;return s(this,function(s){switch(s.label){case 0:return n=t.Child("content/rewardItem"),o=t.Child("content/spine",sp.Skeleton),r=ut.stringToNumbers(e.reward,":"),i=r[0],a=r[1],c=n.convertToWorldSpaceAR(cc.Vec2.ZERO),l=this.node.convertToNodeSpaceAR(c),audioMgr.playSFX("common/get_reward"),u.animHelper.playFlutterItem(i,a,this.node,l,"dig"),[4,o.playAsync("animation")];case 1:return s.sent(),o.play("idle"),[2]}})})},e.prototype.toIndex=function(t){var e,n,o=assetsMgr.getJson("Easter").datas,r=o.last().progress;t=Math.min(r,t);for(var i=-1,a=0,s=0,c=0;c<o.length;++c){var l=null!==(n=null===(e=o[c-1])||void 0===e?void 0:e.progress)&&void 0!==n?n:0,u=o[c].progress;if(t>l&&t<=u){i=c,a=t-l,s=u-l;break}}return{index:i,diffMiles:a,distance:s}},e.prototype.milesToY=function(t){var e,n;if(t<=0)return-300;var o=assetsMgr.getJson("Easter").datas,r=o.last().progress;t=Math.min(r,t);for(var i=-1,a=0,s=1,c=0;c<o.length;++c){var l=null!==(n=null===(e=o[c-1])||void 0===e?void 0:e.progress)&&void 0!==n?n:0,u=o[c].progress;if(t>l&&t<=u){i=c,a=t-l,s=u-l;break}}return-(353*i+a/s*353)-300},e.prototype.yToMiles=function(t){var e,n,o=0;if(t>=-300)return o;var r=assetsMgr.getJson("Easter").datas,i=Math.min(Math.floor((-300-t)/353),r.length-1),a=(-300-t-353*i)/353,s=null!==(n=null===(e=r[i-1])||void 0===e?void 0:e.progress)&&void 0!==n?n:0;return(r[i].progress-s)*a+s},e.prototype.update=function(t){if(this.diff-=t,this.diff<=0){this.diff=1;var e=p.gameHelper.dig.endTime,n=Date.now();this.timeLbl_.string=ut.millisecondFormat(Math.max(e-n,0),"hh:mm:ss")}},e.prototype.digFinish=function(){f.viewHelper.showAlert("activity_finished"),h.gotoHelper.gotoWind("main")},i([y],e)}(mc.BaseWindCtrl);n.default=_,cc._RF.pop()},{"../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/AnimHelper":"AnimHelper","../../common/helper/GameHelper":"GameHelper","../../common/helper/GotoHelper":"GotoHelper","../../common/helper/ResHelper":"ResHelper","../../common/helper/ViewHelper":"ViewHelper"}],DoubleEranAnimCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"b23aavqFCpGcaMH0caLvejK","DoubleEranAnimCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.playing=!1,e.speed=120,e}return r(e,t),e.prototype.play=function(){this.playing=!0,this.anim.y=-100},e.prototype.stop=function(){this.playing=!1,this.anim.y=-4},e.prototype.update=function(t){this.playing&&(this.anim.y+=t*this.speed,this.anim.y>=100&&(this.anim.y=-100))},e.prototype.updateMove=function(t,e,n){e.y+=t*this.speed,e.y>=70&&(e.y=n.y-70)},i([c(cc.Node)],e.prototype,"anim",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],DrillWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"4aac2k5EiVMtqbJ/GhI5Mn/","DrillWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/GotoHelper"),l=cc._decorator.ccclass,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapSv_=null,e.barNode_=null,e.pathNode_=null,e.titleLbl_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("DrillWindCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){this.initMap(),cc.log("DrillWindCtrl onEnter")},e.prototype.onClean=function(){cc.log("DrillWindCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),c.gotoHelper.gotoWind("main")},e.prototype.initMap=function(){var t=assetsMgr.getJson("Easter").datas;this.barNode_.Items(t,function(e,n,o){var r=0==o?1:o==t.length-1?2:0;e.Component(cc.MultiFrame).setFrame(r)}),t.map(function(){})},i([l],e)}(mc.BaseWindCtrl);n.default=u,cc._RF.pop()},{"../../common/helper/GotoHelper":"GotoHelper"}],EcpmLevelAd:[function(t,e,n){"use strict";cc._RF.push(e,"d3eb0GyB1tDw6VHeY6WsWs2","EcpmLevelAd");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.EcpmLevelAd=void 0;var i=t("./RewardAd"),a=t("./InterstitialAd"),s=t("../constant/Enums"),c=function(){function t(t){this.rewardAd=null,this.interstitialAd=null,this.startInterFlag=!1,this.continShowCount=0,this.continShowInterCount=0,this.currentState=null,this.noSuitAdCount=0,this.ecpmHighType=null,this.rewardAd=new i.NativeRewardAd(t),this.interstitialAd=new a.NativeInterstitialAd}return t.prototype.load=function(t){this.rewardAd.load(t),!this.startInterFlag&&this.rewardAd.noSuitAdCount>=40?this.startInterFlag=!0:this.rewardAd.isReady()&&this.rewardAd.getEcpmLevel()>7&&this.interstitialAd&&!this.interstitialAd.isReady()?(this.startInterFlag=!0,this.rewardAd.isEcpmHigh||(this.rewardAd.ecpmCount+=1,this.rewardAd.ecpmCount>9&&(this.rewardAd.ecpmCount=0,this.rewardAd.isEcpmHigh=!0))):this.isInterstitialAdReady()&&this.rewardAd.isReady()&&(this.rewardAd.isEcpmHigh=!0,this.rewardAd.ecpmCount=0),this.startInterFlag&&this.interstitialAd.load(t)},t.prototype.isReady=function(){return this.isRewardReady()||this.isInterstitialAdReady()},t.prototype.isCanShare=function(){return!1},t.prototype.initiativeLoad=function(){},t.prototype.destroy=function(){},t.prototype.reportShareBehavior=function(){},t.prototype.getPlanBAD=function(){},t.prototype.isRewardReady=function(){return this.rewardAd&&this.rewardAd.isReady()&&this.rewardAd.isEcpmHigh},t.prototype.isInterstitialAdReady=function(){return this.interstitialAd&&this.interstitialAd.isReady()&&(this.interstitialAd.noAdTime<=0||this.rewardAd&&this.rewardAd.isReady())},t.prototype.show=function(){return o(this,void 0,Promise,function(){return r(this,function(){return this.currentState==s.AdType.REWARD?(this.ecpmHighType==s.AdType.REWARD&&(this.continShowCount+=1,this.continShowCount>=4&&(this.startInterFlag=!1,this.interstitialAd.giveUpAd(),this.continShowCount=0)),this.continShowInterCount=0,[2,this.rewardAd.show()]):this.currentState==s.AdType.INTERSTITIAL?(this.ecpmHighType==s.AdType.INTERSTITIAL&&(this.continShowInterCount+=1,this.continShowInterCount>=2&&(this.rewardAd.reLoad(),this.continShowInterCount=0)),this.continShowCount=0,[2,this.interstitialAd.show()]):[2,!1]})})},t.prototype.getFailTime=function(){return 10*this.rewardAd.noSuitAdCount*ut.Time.Second},t.prototype.toDB=function(){return{noSuitAdCount:this.rewardAd.noSuitAdCount}},t.prototype.waitCacheReady=function(){return o(this,void 0,void 0,function(){return r(this,function(){return this.ecpmHighType=null,this.rewardAd.isReady()&&this.interstitialAd&&this.interstitialAd.isReady()?this.rewardAd.getEcpmLevel()<=this.interstitialAd.getEcpmLevel()?(this.ecpmHighType=s.AdType.REWARD,this.currentState=s.AdType.REWARD,[2,this.rewardAd.waitCacheReady()]):(this.ecpmHighType=s.AdType.INTERSTITIAL,this.currentState=s.AdType.INTERSTITIAL,[2,this.interstitialAd.waitCacheReady()]):this.rewardAd.isReady()?(this.currentState=s.AdType.REWARD,[2,this.rewardAd.waitCacheReady()]):this.interstitialAd&&this.interstitialAd.isReady()?(this.currentState=s.AdType.INTERSTITIAL,[2,this.interstitialAd.waitCacheReady()]):(this.currentState=null,[2,!1])})})},t}();n.EcpmLevelAd=c,cc._RF.pop()},{"../constant/Enums":"Enums","./InterstitialAd":"InterstitialAd","./RewardAd":"RewardAd"}],EditBoxMaxLength:[function(t,e,n){"use strict";cc._RF.push(e,"7d34feKGZNBQpn6E8gC4GWG","EditBoxMaxLength");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.menu,u=a.requireComponent,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxLength=10,e.preText="",e}return r(e,t),e.prototype.onTextChanged=function(t,e){var n;if(this.getTextLength(t)>this.maxLength){e.string=this.preText;var o=null===(n=e._impl)||void 0===n?void 0:n._elem;o&&(o.value=this.preText)}else this.preText=t},e.prototype.getTextLength=function(t){for(var e=0,n=0;n<t.length;n++)e+=t.charCodeAt(n)>255?2:1;return e},i([c],e.prototype,"maxLength",void 0),i([s,l("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/EditBoxMaxLength"),u(cc.EditBox)],e)}(cc.Component);n.default=p,cc._RF.pop()},{}],EncHelper:[function(t,e,n){"use strict";cc._RF.push(e,"8cf84VrXS5DAI2MgQxl5mx9","EncHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.encHelper=void 0;var o=t("../../../core/utils/EncValue"),r=function(){function t(){this.weakSet=new WeakSet}return t.prototype.encJson=function(t){if(t&&"object"==typeof t&&!this.weakSet.has(t)){this.weakSet.add(t);var e=function(e){var r=t[e],i=typeof r;if("number"==i||"string"==i){var a=new o.default(r);r=null,i=null,Object.defineProperty(t,e,{get:function(){return a.value},set:function(t){t!=a.value&&(lplog.error("\u4e0d\u8981\u5199\uff0c\u8c22\u8c22"),a.value=t)},enumerable:!0,configurable:!0})}else n.encJson(t[e])},n=this;for(var r in t)e(r);t=null}},t}();n.default=r,n.encHelper=new r,cc._RF.pop()},{"../../../core/utils/EncValue":"EncValue"}],EncValue:[function(t,e,n){"use strict";cc._RF.push(e,"966d8+4+5pBn5/KK4V0ar1R","EncValue"),Object.defineProperty(n,"__esModule",{value:!0});var o="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",r=o.length,i=1+Math.floor(3*Math.random()),a=function(){function t(t){this._value=null,this._isNum=null,this.value=t}return Object.defineProperty(t.prototype,"value",{get:function(){if(null!=this._value){var t=this.decodeData(this._value);return this._isNum?Number(t):t}},set:function(t){this._isNum="number"==typeof t,this._value=this.encryptData(t)},enumerable:!1,configurable:!0}),t.prototype.getRandomString=function(t){for(var e="",n=0;n<t;n++)e+=o.charAt(Math.floor(Math.random()*r));return e},t.prototype.encryptData=function(t){var e=Math.floor(10*Math.random());return this.getRandomString(i)+t+e+this.getRandomString(i-1)},t.prototype.decodeData=function(t){return t.substring(i,t.length-i)},t.prototype.toString=function(){return this._value.substring(3,this._value.length-3)},t}();n.default=a,cc._RF.pop()},{}],Enums:[function(t,e,n){"use strict";var o,r,i,a,s,c,l,u,p,h,d,f,y,_,g,m,v,b,w,S,C,T,A,E;cc._RF.push(e,"911122p36BFeJcaqiT9JFE9","Enums"),Object.defineProperty(n,"__esModule",{value:!0}),n.TaskConditionType=n.DailyRewardState=n.ColorType=n.PlatformType=n.InlandSharePlatform=n.GlobalSharePlatform=n.UserType=n.RewardUIType=n.StarHotelTaskStatus=n.Bundle=n.SubscribeType=n.ChannelType=n.ShareType=n.AdType=n.LoginSyncState=n.RewardAdStatus=n.AdShowState=n.AuthorizeType=n.RankType=n.AdABTestType=n.AdPropType=n.AdState=n.RecordState=n.TaskState=n.GardenBuildType=n.MapSceneType=n.MapType=void 0,function(t){t[t.RECT=0]="RECT",t[t.SKEW=1]="SKEW",t[t.SKEW_L=2]="SKEW_L",t[t.SKEW_R=3]="SKEW_R",t[t.SKEW_REVERT=4]="SKEW_REVERT"}(o||(o={})),n.MapType=o,function(t){t[t.MAIN=1]="MAIN"}(r||(r={})),n.MapSceneType=r,function(t){t[t.NONE=0]="NONE"}(i||(i={})),n.GardenBuildType=i,function(t){t[t.NONE=0]="NONE",t[t.UNDONE=1]="UNDONE",t[t.CANGET=2]="CANGET",t[t.FINISH=3]="FINISH"}(a||(a={})),n.TaskState=a,function(t){t[t.SAME=0]="SAME",t[t.DOWNLOAD=1]="DOWNLOAD",t[t.UPLOAD=2]="UPLOAD",t[t.CD=3]="CD",t[t.RECHECK=4]="RECHECK",t[t.LOG_OFF=5]="LOG_OFF"}(s||(s={})),n.RecordState=s,function(t){t[t.WAIT=-3]="WAIT",t[t.PLAY_FAIL=-2]="PLAY_FAIL",t[t.LOAD_FAIL=-1]="LOAD_FAIL",t[t.LOADING=0]="LOADING",t[t.LOAD_SUCCESS=1]="LOAD_SUCCESS",t[t.PLAY_SUCCESS=2]="PLAY_SUCCESS",t[t.PLAYING=3]="PLAYING"}(c||(c={})),n.AdState=c,function(t){t[t.NONE=0]="NONE",t[t.Spin=1]="Spin",t[t.Dig=2]="Dig",t[t.Revive=3]="Revive",t[t.Check=4]="Check",t[t.Shop=5]="Shop",t[t.Heart=6]="Heart"}(l||(l={})),n.AdPropType=l,function(t){t[t.NONE=0]="NONE",t[t.AD_REWARD_LIMIT_1=1]="AD_REWARD_LIMIT_1",t[t.AD_REWARD_LIMIT_2=2]="AD_REWARD_LIMIT_2",t[t.AD_LIMIT=3]="AD_LIMIT"}(u||(u={})),n.AdABTestType=u,function(t){t[t.FRIEND=0]="FRIEND",t[t.NPC=1]="NPC",t[t.WORLD=2]="WORLD"}(p||(p={})),n.RankType=p,function(t){t[t.RECORD=0]="RECORD",t[t.WORLD_RANK=1]="WORLD_RANK",t[t.FRIEND=2]="FRIEND"}(h||(h={})),n.AuthorizeType=h,function(t){t[t.NONE=0]="NONE",t[t.READY=1]="READY",t[t.NOT_READY=2]="NOT_READY"}(d||(d={})),n.AdShowState=d,function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAIL=1]="FAIL",t[t.LOAD_CACHE_FAIL=2]="LOAD_CACHE_FAIL",t[t.SHARE_FAIL=3]="SHARE_FAIL"}(f||(f={})),n.RewardAdStatus=f,function(t){t[t.SAME=0]="SAME",t[t.DEVICE_DIFF=1]="DEVICE_DIFF",t[t.VERSION_DIFF=2]="VERSION_DIFF",t[t.SYNC=3]="SYNC"}(y||(y={})),n.LoginSyncState=y,function(t){t[t.REWARD=1]="REWARD",t[t.INTERSTITIAL=2]="INTERSTITIAL",t[t.SHARE=3]="SHARE",t[t.NATIVE=4]="NATIVE"}(_||(_={})),n.AdType=_,function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.UNLOCK_CUSTOMER=1]="UNLOCK_CUSTOMER",t[t.RANK=2]="RANK",t[t.DAILY_TASK=3]="DAILY_TASK",t[t.AD=4]="AD",t[t.ON_SHARE_APP_MESSAGE=5]="ON_SHARE_APP_MESSAGE",t[t.ON_SHARE_TIMELINE=6]="ON_SHARE_TIMELINE"}(g||(g={})),n.ShareType=g,function(t){t[t.Combo=1]="Combo",t[t.Lines=2]="Lines",t[t.Score=3]="Score"}(m||(m={})),n.TaskConditionType=m,function(t){t.OFFICIAL="official",t.HYKB="HYKB",t.DY="DY",t.JL="JL"}(v||(v={})),n.ChannelType=v,function(t){t.GALI_EXPLORE="GALI_EXPLORE"}(b||(b={})),n.SubscribeType=b,function(t){t.RES="RESOURCE",t.START="bootPack"}(w||(w={})),n.Bundle=w,function(t){t[t.UNLOCK=1]="UNLOCK",t[t.GET=2]="GET",t[t.UP=3]="UP",t[t.NEW_PRODUCT=4]="NEW_PRODUCT",t[t.HEIGHER=5]="HEIGHER"}(S||(S={})),n.RewardUIType=S,function(t){t[t.NONE=0]="NONE",t[t.DOING=1]="DOING",t[t.FAIL=2]="FAIL",t[t.SUCC=3]="SUCC"}(C||(C={})),n.StarHotelTaskStatus=C,n.UserType={APP_WX:"app_wx",APPLE:"app_apple",GUEST:"app_guest",WX:null,QQ:"qq",FB:"app_fb",TWITTER:"app_twitter",GOOGLE:"app_google",FB_INSTANT:"fb_instant"},n.GlobalSharePlatform={INS:"app_ins",FB:"app_fb",TWITTER:"app_twitter"},n.InlandSharePlatform={APP_WX:"app_wx",WEIBO:"app_wb",WX_PYQ:"wx_pyq"},function(t){t[t.NONE=0]="NONE",t[t.WX=1]="WX",t[t.QQ=2]="QQ",t[t.IOS=3]="IOS",t[t.ANDROID=4]="ANDROID"}(T||(T={})),n.PlatformType=T,function(t){t[t.Red=1]="Red",t[t.Yellow=2]="Yellow",t[t.Green=3]="Green",t[t.Blue=4]="Blue",t[t.EnhanceBlue=5]="EnhanceBlue",t[t.Pule=6]="Pule",t[t.Pink=7]="Pink",t[t.DreamGem=100]="DreamGem"}(A||(A={})),n.ColorType=A,function(t){t[t.Lock=0]="Lock",t[t.canGet=1]="canGet",t[t.Got=2]="Got"}(E||(E={})),n.DailyRewardState=E,cc._RF.pop()},{}],EventManager:[function(t,e,n){"use strict";cc._RF.push(e,"57767NCEixLsY9PHb0/MDMT","EventManager");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(){this.__events=new Map,this.__emit_types=[],this.__off_types=[]}return t.prototype.emit=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];t=String(t);var r=this.__events.get(t);if(r&&0!==r.length){this.__emit_types.push(t);for(var a=0,s=r.length;a<s;a++){var c=r[a];c&&(e=c.callback).call.apply(e,i([c.target],n))}if(this.__off_types.length>0&&this.__off_types.remove(t)){for(a=r.length-1;a>=0;a--)r[a]||r.splice(a,1);0===r.length&&this.__events.delete(t)}this.__emit_types.remove(t)}},t.prototype.get=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r=this.__events.get(String(t));if(!r||0===r.length)return null;r.length>1&&lplog.error("req event length > 1, the default index is 0, type="+t);var a=r[0];return a?(e=a.callback).call.apply(e,i([a.target],n)):null},t.prototype.req=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return o(this,void 0,void 0,function(){return r(this,function(){return[2,this.get.apply(this,i([t],e))]})})},t.prototype.on=function(t,e,n){t=String(t);var o=this.__events.get(t);if(o||(o=[],this.__events.set(t,o)),o.some(function(t){return t&&t.callback.toString()==e.toString()&&t.target==n}))return lplog.error("repeat listen",t,(n?n.name:"null")+"."+e.name);o.push({callback:e,target:n})},t.prototype.once=function(t,e,n){t=String(t);var o=!1,r=this;this.on(t,function a(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];r.off(t,a),o||(o=!0,e.call.apply(e,i([n],s)))})},t.prototype.wait=function(t){return o(this,void 0,void 0,function(){var e=this;return r(this,function(){return t=String(t),this.off(t),[2,new Promise(function(n){var o=!1,r=e;e.on(t,function e(i){r.off(t,e),o||(o=!0,n(i))})})]})})},t.prototype.off=function(t,e,n){t=String(t);var o=this.__events.get(t);if(o)if(e){for(var r=o.length-1;r>=0;r--){var i=o[r];if(i&&i.target==n&&i.callback.toString()==e.toString()){this.__emit_types.has(t)?(o[r]=null,this.__off_types.push(t)):o.splice(r,1);break}}0===o.length&&this.__events.delete(t)}else this.__events.delete(t)},t.prototype.fuckLog=function(){cc.log("events:",this.__events)},t.prototype.dispose=function(){this.__events.clear()},t}();n.default=a,window.eventMgr=new a,cc._RF.pop()},{}],EventNotCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"967abt64fxAGo/eoVf5cVfY","EventNotCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/ReddotHelper"),l=cc._decorator.ccclass,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loop=0,e}return r(e,t),e.prototype.eventMaps=function(){var t;return[(t={},t[mc.Event.WIND_ENTER]=this.onWindEnter,t)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("EventNotCtrl onCreate"),this.global=this.getModel("global"),this.dig=this.getModel("dig"),this.global.init(),this.dig.init(),[2]})})},e.prototype.onWindEnter=function(){"main"==mc.currWindName&&(this.global.firstEnterMain||(this.global.firstEnterMain=!0,this.open()))},e.prototype.update=function(t){this.global.update(t),this.dig.update(t),this.loopUpdate(t)},e.prototype.loopUpdate=function(t){this.loop-=t,this.loop<=0&&(this.loop=1,c.reddotHelper.update(t))},i([l],e)}(mc.BaseNoticeCtrl);n.default=u,cc._RF.pop()},{"../../common/helper/ReddotHelper":"ReddotHelper"}],EventType:[function(t,e,n){"use strict";cc._RF.push(e,"031c3QT3MxAQoQ2ctIF+k/c","EventType"),Object.defineProperty(n,"__esModule",{value:!0}),n.default={MAP_TOUCH_START:"MAP_TOUCH_START",MAP_TOUCH_END:"MAP_TOUCH_END",ENTER_ON_HOOK_STATE:"ENTER_ON_HOOK_STATE",LOW_MEMORY_WARN:"LOW_MEMORY_WARN",APP_LOAINDG_ALL:"APP_LOAINDG_ALL",GUIDE_OPENING_COMPLETE:"GUIDE_OPENING_COMPLETE",EVENT_NOT_DELAY_INIT:"EVENT_NOT_DELAY_INIT",CERTIFICATION_COMPLETE:"CERTIFICATION_COMPLETE",UPDATE_GM_OFFSET_TIME:"UPDATE_GM_OFFSET_TIME",UPDATE_LAYOUT_HEIGHT:"UPDATE_LAYOUT_HEIGHT",UPDATE_USER_BASE_INFO:"UPDATE_USER_BASE_INFO",UPDATE_INVITE_COUNT:"UPDATE_INVITE_COUNT",UPDATE_BISCUITS:"UPDATE_BISCUITS",UPDATE_CANDIES:"UPDATE_CANDIES",UPDATE_HEART:"UPDATE_HEART",EVENT_HEART_CHANGE:"EVENT_HEART_CHANGE",UPDATE_WINDMILL:"UPDATE_WINDMILL",UPDATE_SCISSOR:"UPDATE_SCISSOR",UPDATE_AD_SKIP_CARD:"UPDATE_AD_SKIP_CARD",UPDATE_STAMINA:"UPDATE_STAMINA",GET_UI_TOP_LAYER:"GET_UI_TOP_LAYER",GET_UI_MONEY_ICON:"GET_UI_MONEY_ICON",GET_NOT_TOP_LAYER:"GET_NOT_TOP_LAYER",SHOW_ACHIEVE_TIP:"SHOW_ACHIEVE_TIP",SHOW_CAN_UNLOCK_ROLE_TIP:"SHOW_CAN_UNLOCK_ROLE_TIP",SHOW_ROLE_AD_TIP:"SHOW_ROLE_AD_TIP",UPDATE_PROP_COUNT:"UPDATE_PROP_COUNT",BUY_PORP:"BUY_PORP",UPDATE_SUM_PEOPLE:"UPDATE_SUM_PEOPLE",SHOW_OFFLINE_PNL:"SHOW_OFFLINE_PNL",ADD_MESSAGE:"ADD_MESSAGE",DEL_MESSAGE:"DEL_MESSAGE",PLAY_LIHUA:"PLAY_LIHUA",PLAY_GALI_AIRCRAFT:"PLAY_GALI_AIRCRAFT",UNLOCK_SCENE:"UNLOCK_SCENE",SCENE_OUTPUT:"SCENE_OUTPUT",UPDATE_GUIDE_TASK:"UPDATE_GUIDE_TASK",SHARE_NPC_COMPLETE:"SHARE_NPC_COMPLETE",SHARE_ROLE_COMPLETE:"SHARE_ROLE_COMPLETE",PLAY_MAMA_HELICOPTER:"PLAY_MAMA_HELICOPTER",PLAY_MAMA_DROP:"PLAY_MAMA_DROP",PLAY_MAMA_FIREWORK:"PLAY_MAMA_FIREWORK",SHOW_MAMA_NEWYEAR_GIFT:"SHOW_MAMA_NEWYEAR_GIFT",BUY_HEAD_COMPLETE:"BUY_HEAD_COMPLETE",CHANGE_MAP_EDIT:"CHANGE_MAP_EDIT",CHANGE_SCREEN_UI:"CHANGE_SCREEN_UI",CHANGE_MAP_TOUCH:"CHANGE_MAP_TOUCH",LONG_PRESS_FURNITURE:"LONG_PRESS_FURNITURE",CLICK_FURNITURE:"CLICK_FURNITURE",MOVE_FURNITURE:"MOVE_FURNITURE",ADD_FURNITURE:"ADD_FURNITURE",MAP_ADD_FURNITURE:"MAP_ADD_FURNITURE",ADD_FURNITURE_CANCEL:"ADD_FURNITURE_CANCEL",ADD_FURNITURE_COMPLETE:"ADD_FURNITURE_COMPLETE",RESET_FURNITURE:"RESET_FURNITURE",HIDE_FURNITURE:"HIDE_FURNITURE",SHOW_MAP_GRID:"SHOW_MAP_GRID",CHANGE_FURN_SAVE:"CHANGE_FURN_SAVE",ITEM_TOUCH_MOVE_EVENT:"ITEM_TOUCH_MOVE_EVENT",UNLOCK_FURN:"UNLOCK_FURN",DEL_FURNITURE:"DEL_FURNITURE",REQ_BED_NODE:"REQ_BED_NODE",SHOW_EDITFURN_JIANTOU:"SHOW_EDITFURN_JIANTOU",RESET_PREVIEW_KEFANG:"RESET_PREVIEW_KEFANG",WAIT_PREVIEW_KEFANG_CLOSE:"WAIT_PREVIEW_KEFANG_CLOSE",UPDATE_FURN_STATE:"UPDATE_FURN_STATE",MOVE_HOMESPACE:"MOVE_HOMESPACE",LONG_PRESS_HOMESPACE:"LONG_PRESS_HOMESPACE",SHOW_EDIT_HOMESPACE_JIANTOU:"SHOW_EDIT_HOMESPACE_JIANTOU",REQ_NEW_HOME_PARENT_INFO:"REQ_NEW_HOME_PARENT_INFO",UPDATE_FURNITURE_PARENT:"UPDATE_FURNITURE_PARENT",MULTI_ADD_FURNITURES:"MULTI_ADD_FURNITURES",UPDATE_FURNITURES_SERIES:"UPDATE_FURNITURES_SERIES",REFRESH_TENANT_TASKS:"REFRESH_TENANT_TASKS",RESET_TENANT_TASK:"RESET_TENANT_TASK",FOCUS_TENANT_ROLE:"FOCUS_TENANT_ROLE",CLEAN_SLEEP_EFFECT:"CLEAN_SLEEP_EFFECT",UNLOCK_FOOD:"UNLOCK_FOOD",UPGRADE_FOOD:"UPGRADE_FOOD",START_COOK:"START_COOK",UNLOCK_DINING_BUILD:"UNLOCK_DINING_BUILD",CHANGE_DINING_BUILD:"CHANGE_DINING_BUILD",UPDATE_DESSERT_STOCK:"UPDATE_DESSERT_STOCK",DINING_ORDER_FOOD:"DINING_ORDER_FOOD",DINING_SHOW_DISH:"DINING_SHOW_DISH",UPDATE_FOODMINING_COUNT:"UPDATE_FOODMINING_COUNT",UPDATE_FOOD_STAMINA:"UPDATE_FOOD_STAMINA",SHOW_TECH_ANI:"SHOW_TECH_ANI",ADD_FOODMINING_PLAY_LIST:"ADD_FOODMINING_PLAY_LIST",PLAY_MINING_GEM_ANI:"PLAY_MINING_GEM_ANI",RESET_ALL_MINING_GEM:"RESET_ALL_MINING_GEM",SHOW_FOOD_REDDOT:"SHOW_FOOD_REDDOT",UDPATE_TAITAN_ANI:"UDPATE_TAITAN_ANI",UPDATE_RANK_STAR_HOTEL:"UPDATE_RANK_STAR_HOTEL",MAIN_ADD_ELF_EGG:"MAIN_ADD_ELF_EGG",SHOW_EDIT_ELFEGG_ARROW:"SHOW_EDIT_ELFEGG_ARROW",LONG_PRESS_ELFEGG:"LONG_PRESS_ELFEGG",MOVE_ELFEGG:"MOVE_ELFEGG",UPDATE_ELFFEGG_MGR:"UPDATE_ELFFEGG_MGR",RESET_ALL_ELFEGG:"RESET_ALL_ELFEGG",SHOW_MAIN_BLOCK:"SHOW_MAIN_BLOCK",CLICK_TIP_MONEY:"CLICK_TIP_MONEY",SHOW_ELFEGG_FLIGHT:"SHOW_ELFEGG_FLIGHT",RANK_CHANGE_SCREEN_UI:"RANK_CHANGE_SCREEN_UI",UPDATE_RANK_CHALLENGE_PROGRESS:"UPDATE_RANK_CHALLENGE_PROGRESS",SHOW_RANK_CHALLENGE_RESULT:"SHOW_RANK_CHALLENGE_RESULT",START_RANK_STAR_HOTEL:"START_RANK_STAR_HOTEL",UNLOCK_DRINK:"UNLOCK_DRINK",UPGRADE_DRINK:"UPGRADE_DRINK",UNLOCK_SHOWER_BUILD:"UNLOCK_SHOWER_BUILD",CHANGE_SHOWER_BUILD:"CHANGE_SHOWER_BUILD",UPDATE_BUILD_DUR:"UPDATE_BUILD_DUR",USE_SHOWER_BUILD_BEGIN:"USE_SHOWER_BUILD_BEGIN",REQ_BATH_NODE:"REQ_BATH_NODE",UPDATE_HOTSPR_SOUPBASE:"UPDATE_HOTSPR_SOUPBASE",UPDATE_SOUP_STAMINA:"UPDATE_SOUP_STAMINA",CREATE_COMP_STUFF:"CREATE_COMP_STUFF",UPDATE_COMP_STUFF_PROFICIENCY:"UPDATE_COMP_STUFF_PROFICIENCY",OPEN_TODAY_COMP:"OPEN_TODAY_COMP",UPDATE_TODAY_COMP:"UPDATE_TODAY_COMP",UPGRADE_SOUP:"UPGRADE_SOUP",UNLOCK_SOUP:"UNLOCK_SOUP",SHOW_SOUP_REDDOT:"SHOW_SOUP_REDDOT",SOUP_STUFF_COMP_END:"SOUP_STUFF_COMP_END",AUTO_STUFF:"AUTO_STUFF",SHOW_STUFF_WEAK_GUIDE:"SHOW_STUFF_WEAK_GUIDE",UPDATE_SOUP_STUFF_INFO:"UPDATE_SOUP_STUFF_INFO",SHOW_SOUP_TMP_STUFF:"SHOW_SOUP_TMP_STUFF",SHOW_STUFF_LIGHT_EFFECT:"SHOW_STUFF_LIGHT_EFFECT",DRAG_SOUP_STUFF_END:"DRAG_SOUP_STUFF_END",USE_SOUP_STUFF_PROP:"USE_SOUP_STUFF_PROP",SHOW_SOUP_TREASURE_MAP:"SHOW_SOUP_TREASURE_MAP",SHOW_SOUP_STAMINA_ANI:"SHOW_SOUP_STAMINA_ANI",ADD_TREASURE_MAP_STUFF:"ADD_TREASURE_MAP_STUFF",UPDATE_PAOPAO_SKILL_ANI:"UPDATE_PAOPAO_SKILL_ANI",SHOW_PAOPAO_CRIT_ANI:"SHOW_PAOPAO_CRIT_ANI",SHOW_PAOPAO_CRIT_KUANG:"SHOW_PAOPAO_CRIT_KUANG",PLAY_PAOPAO_AUTO_COMP_ANI:"PLAY_PAOPAO_AUTO_COMP_ANI",SHOW_EXPEND_STUFF_ANI:"SHOW_EXPEND_STUFF_ANI",MULTI_CHANGE_BUILDS:"MULTI_CHANGE_BUILDS",MULTI_UNLOCK_BUILDS:"MULTI_UNLOCK_BUILDS",CHANGE_MINI_GAME:"CHANGE_MINI_GAME",MGAME_MAZE_START:"MGAME_MAZE_START",MGAME_MAZE_CLICK_ITEM:"MGAME_MAZE_CLICK_ITEM",RESTART_EXPLORE:"RESTART_EXPLORE",STOP_EXPLORE:"STOP_EXPLORE",ADD_GAME_MAP:"ADD_GAME_MAP",PASS_MINI_GAME:"PASS_MINI_GAME",PLAY_GALI_EFFECT:"JUMP_EFFECT",SHOW_GALI_FIX_AWARD:"SHOW_GALI_FIX_AWARD",UPDATE_EVENT_TIME:"UPDATE_EVENT_TIME",SOLICIT_CREATE_GUEST:"SOLICIT_CREATE_GUEST",SOLICIT_RECYCLE_GUEST:"SOLICIT_RECYCLE_GUEST",SOLICIT_CREATE_DEVIL:"SOLICIT_CREATE_DEVIL",SOLICIT_GUEST_AUTO:"SOLICIT_GUEST_AUTO",SOLICIT_TURN_AROUND:"SOLICIT_TURN_AROUND",SOLICIT_TURN_AROUND_DEVIL:"SOLICIT_TURN_AROUND_DEVIL",SOLICIT_EAT_BISCUIT:"SOLICIT_EAT_BISCUIT",SOLICIT_PLAY_DEVIL:"SOLICIT_PLAY_DEVIL",SOLICIT_HIT_DEVIL:"SOLICIT_HIT_DEVIL",SOLICIT_CREATE_ROLE_CAR:"SOLICIT_CREATE_ROLE_CAR",SOLICIT_RECYCLE_ROLE_CAR:"SOLICIT_RECYCLE_ROLE_CAR",UPDATE_STAFF_SOLICIT_GUEST_ANI:"UPDATE_STAFF_SOLICIT_GUEST_ANI",UPDATE_STAFF_SOLICIT_GUEST_ANI2:"UPDATE_STAFF_SOLICIT_GUEST_ANI2",UPDATE_STAFF_SOLICIT_GUEST_ANI3:"UPDATE_STAFF_SOLICIT_GUEST_ANI3",STAFF_SOLICIT_GUEST_SUCC:"STAFF_SOLICIT_GUEST_SUCC",SHOW_MENGLU_EFFECT:"SHOW_MENGLU_EFFECT",SHOOT_OPEN:"SHOOT_OPEN",SHOOT_CLOSE:"SHOOT_CLOSE",START_GUIDE:"START_GUIDE",CHANGE_GUIDE_PROGRESS:"CHANGE_GUIDE_PROGRESS",END_GUIDE:"END_GUIDE",CLEAN_GUIDE:"CLEAN_GUIDE",SHOW_SKIP_GUIDE:"SHOW_SKIP_GUIDE",DELAY_SHOW_SKIP:"DELAY_SHOW_SKIP",ADD_CLICK_EVENT:"ADD_CLICK_EVENT",SHOW_GUIDE_NODE_DESC:"SHOW_GUIDE_NODE_DESC",HIDE_GUIDE_FINGER:"HIDE_GUIDE_FINGER",CHANGE_GUIDE_FINGER_ANI:"CHANGE_GUIDE_FINGER_ANI",START_STORY:"START_STORY",CHANGE_STORY:"CHANGE_STORY",END_STORY:"END_STORY",PROCEED_STORY:"PROCEED_STORY",GUIDE_COMMON_CLICK_EVENT:"GUIDE_COMMON_CLICK_EVENT",GUIDE_SHOW_GALI:"GUIDE_SHOW_GALI",GUIDE_MOVE_CAMERA:"GUIDE_MOVE_CAMERA",GUIDE_ZOOM_CAMERA:"GUIDE_ZOOM_CAMERA",GUIDE_SHOW_FINGER:"GUIDE_SHOW_FINGER",GUIDE_CHANGE_FINGER:"GUIDE_CHANGE_FINGER",UPDATE_HUAMAO_STATE:"UPDATE_HUAMAO_STATE",UPDATE_QIANTAI_STATE:"UPDATE_QIANTAI_STATE",GUIDE_DRAK_SCREEN:"GUIDE_DRAK_SCREEN",GUIDE_FLIP_FOOD_MINING:"GUIDE_FLIP_FOOD_MINING",GUIDE_SHOW_PAOPAO:"GUIDE_SHOW_PAOPAO",GUIDE_FURN_SWITCH:"GUIDE_FURN_SWITCH",GUIDE_FURN_USE:"GUIDE_FURN_USE",GUIDE_CLOSE_SIGNED_REWARD:"GUIDE_CLOSE_SIGNED_REWARD",GUIDE_ELF_EGG_USE:"GUIDE_ELF_EGG_USE",GUIDE_PLAY_MOVE_FURN_ANI:"GUIDE_PLAY_MOVE_FURN_ANI",GUIDE_HIDE_MOVE_FURN_ANI:"GUIDE_HIDE_MOVE_FURN_ANI",GUIDE_NEED_CREATE_TAXI:"GUIDE_NEED_CREATE_TAXI",GUIDE_WAIT_CREATE_TAXI:"GUIDE_WAIT_CREATE_TAXI",GUIDE_STAFF_ASSIGN:"GUIDE_STAFF_ASSIGN",GUIDE_STAFF_SWITCH_TAB:"GUIDE_STAFF_SWITCH_TAB",GUIDE_STAFF_PAOPAO_FINGER:"GUIDE_STAFF_PAOPAO_FINGER",GUIDE_BEAUTY_STYLINGEND:"GUIDE_BEAUTY_STYLINGEND",GUIDE_BEAUTY_DESIGN:"GUIDE_BEAUTY_DESIGN",GUIDE_SPECIAL_DRAK_SCREEN:"GUIDE_SPECIAL_DRAK_SCREEN",GUIDE_PLAY_ZHUANGHUANG_ANI:"GUIDE_PLAY_ZHUANGHUANG_ANI",GUIDE_CLICK_ADD_GROUND:"GUIDE_CLICK_ADD_GROUND",GUIDE_CLICK_TENANT_PUBLISH:"GUIDE_CLICK_TENANT_PUBLISH",GUIDE_CLICK_TENANT_END:"GUIDE_CLICK_TENANT_END",GUIDE_UPDATE_MAMA_HAIR:"GUIDE_UPDATE_MAMA_HAIR",GUIDE_SHOW_MOTHER_ACT_BTN:"GUIDE_SHOW_MOTHER_ACT_BTN",WEAK_GUIDE_SHOW_FINGER:"WEAK_GUIDE_SHOW_FINGER",WEAK_GUIDE_MOVE_CAMERA:"WEAK_GUIDE_MOVE_CAMERA",WEAK_GUIDE_SHOW_SOLICIT_ANI:"WEAK_GUIDE_SHOW_SOLICIT_ANI",WEAK_GUIDE_SHOW_GRANDMA:"WEAK_GUIDE_SHOW_GRANDMA",OPENID_CHANGE:"OPENID_CHANGE",GAME_SHOW:"GAME_SHOW",GAME_HIDE:"GAME_HIDE",YOYO_LOTTERY_COMPLETE:"YOYO_LOTTERY_COMPLETE",UNLOCK_ROLE_CLOSE:"UNLOCK_ROLE_CLOSE",FIREND_MAMMON_LEAVE:"FIREND_MAMMON_LEAVE",ACTIVITY_FINISH:"ACTIVITY_FINISH",HOLIDAY_UPDATE_LIST:"HOLIDAY_UPDATE_LIST",HOLIDAY_UPDATE_REDEEM_PROP:"HOLIDAY_UPDATE_REDEEM_PROP",UPDATE_HOLIDAY_TAB:"UPDATE_HOLIDAY_TAB",HOLIDAY_NEWYEAR_ADD_FLOW:"HOLIDAY_NEWYEAR_ADD_FLOW",HOLIDAY_UPDATE_GAME_PROP:"HOLIDAY_UPDATE_GAME_PROP",START_NEWYEAR_FIREWORKS:"START_NEWYEAR_FIREWORKS",UPDATE_LIMITED_OFFER_FREE:"UPDATE_LIMITED_OFFER_FREE",UPDATE_LIMITED_OFFER_UI:"UPDATE_LIMITED_OFFER_UI",UPDATE_WINDMILL_CONSUME_LIST:"UPDATE_WINDMILL_CONSUME_LIST",UPDATE_AD_LIMIT_TIME_TIP:"UPDATE_AD_LIMIT_TIME_TIP",UPDATE_SHOP_TAB:"UPDATE_SHOP_TAB",UPDATE_PNL_OPEN:"UPDATE_PNL_OPEN",UPDATE_WEATHER:"UPDATE_WEATHER",CREATE_WEATHER:"CREATE_WEATHER",RECYCLE_WEATHER:"RECYCLE_WEATHER",CREATE_WEATHER_THUNDER:"CREATE_WEATHER_THUNDER",PLAY_WEATHER_THUNDER_HACK:"PLAY_WEATHER_THUNDER_HACK",THUNDER_GUEST_AUTO:"THUNDER_GUEST_AUTO",UPDATE_WEATHER_VIEW:"UPDATE_WEATHER_VIEW",REVERT_WEATHER:"REVERT_WEATHER",UNLOCK_STAFF:"UNLOCK_STAFF",UPDATE_STAFF_EXP:"UPDATE_STAFF_EXP",STAFF_ASSIGN:"STAFF_ASSIGN",STAFF_REST:"STAFF_REST",UPDATE_STAFF_FREE_LOTTERY_COUNT:"UPDATE_STAFF_FREE_LOTTERY_COUNT",SHARE_SOUVENIR_COMPLETE:"SHARE_SOUVENIR_COMPLETE",SET_UI_FOCUS_TARGET_ID:"SET_UI_FOCUS_TARGET_ID",WEAR_SOUVENIR:"WEAR_SOUVENIR",FRINED_BACK_TO_MAIN:"FRINED_BACK_TO_MAIN",UPDATE_DAILY_FREE:"UPDATE_DAILY_FREE",UPDATE_SPIN:"UPDATE_SPIN",UPDATE_DAILY_PAY:"UPDATE_DAILY_PAY",UPDATE_BUY_STAFF:"UPDATE_BUY_STAFF",CLOSE_SHOPPOPPNL:"CLOSE_SHOPPOPPNL",SHOW_MAINWIND_SHOP_PACKAGE:"SHOW_MAINWIND_SHOP_PACKAGE",BUY_MAINWIND_SHOP_PACKAGE_FINISH:"BUY_MAINWIND_SHOP_PACKAGE_FINISH",GAME_CAPTURE_SCREEN:"GAME_CAPTURE_SCREEN",UPDATE_SCORE:"UPDATE_SCORE",UPDATE_BEST_SCORE:"UPDATE_BEST_SCORE",UPDATE_COIN:"UPDATE_COIN",UPDATE_ROTATE:"UPDATE_ROTATE",UPDATE_FLASH:"UPDATE_FLASH",DIG_FINISH:"DIG_FINISH"},cc._RF.pop()},{}],ExString:[function(t,e){"use strict";cc._RF.push(e,"add0c85dFZIrrT9aExZ5ww8","ExString"),String.prototype.replaceAll||(String.prototype.replaceAll=function(t,e){return"[object regexp]"===Object.prototype.toString.call(t).toLowerCase()?this.replace(t,e):this.replace(new RegExp(t,"g"),e)}),cc._RF.pop()},{}],ExtendAnimation:[function(t,e){"use strict";cc._RF.push(e,"021836F5Q5NLI7eb5cdYCT5","ExtendAnimation");var n=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};cc.Animation.prototype.playAsync=function(t){return n(this,void 0,void 0,function(){var e=this;return o(this,function(){return[2,new Promise(function(n){e.once("finished",n),e.play(t)})]})})},cc.Animation.prototype.playToFinished=function(t,e){return this.off("finished"),this.once("finished",t),this.play(e)},cc.Animation.prototype.setCompleteListener=function(t){this.off("finished"),t&&this.on("finished",t)},sp.Skeleton.prototype.playAsync=function(t){var e=this;return new Promise(function(n){e.setCompleteListener(function(){e.isValid&&e.setCompleteListener(null),n()}),e.animation=t})},sp.Skeleton.prototype.play=function(t){this.animation=t},cc._RF.pop()},{}],ExtendArray:[function(t,e){"use strict";cc._RF.push(e,"3eff8OyVlxED5YHzgpf6MC+","ExtendArray"),Array.prototype.remove||Object.defineProperty(Array.prototype,"remove",{value:function(t,e){var n=void 0!==e?this.findIndex(function(n){return!!n&&n[t]===e}):this.indexOf(t);return-1===n?null:this.splice(n,1)[0]},enumerable:!1}),Array.prototype.delete||Object.defineProperty(Array.prototype,"delete",{value:function(t){for(var e=[],n=this.length-1;n>=0;n--)t(this[n],n)&&e.push(this.splice(n,1)[0]);return e},enumerable:!1}),Array.prototype.random||Object.defineProperty(Array.prototype,"random",{value:function(){if(0!==this.length)return this[Math.floor(Math.random()*this.length)]},enumerable:!1}),Array.prototype.randomRemove||Object.defineProperty(Array.prototype,"randomRemove",{value:function(){if(0!==this.length){var t=Math.floor(Math.random()*this.length);return this.splice(t,1)[0]}},enumerable:!1}),Array.prototype.has||Object.defineProperty(Array.prototype,"has",{value:function(t,e){return void 0!==e?this.some(function(n){return n[t]===e}):-1!==this.indexOf(t)},enumerable:!1}),Array.prototype.append||Object.defineProperty(Array.prototype,"append",{value:function(t){return this.push(t),this},enumerable:!1}),Array.prototype.add||Object.defineProperty(Array.prototype,"add",{value:function(t){return this.push(t),t},enumerable:!1}),Array.prototype.last||Object.defineProperty(Array.prototype,"last",{value:function(){return this[this.length-1]},enumerable:!1}),Array.prototype.join2||Object.defineProperty(Array.prototype,"join2",{value:function(t,e){return void 0===e&&(e=","),this.map(function(e,n){return t(e,n)||""}).join(e)},enumerable:!1}),Array.prototype.pushArr||Object.defineProperty(Array.prototype,"pushArr",{value:function(t){if(!t||0===t.length)return this.length;for(var e=0,n=t;e<n.length;e++){var o=n[e];this.push(o)}return this.length},enumerable:!1}),Array.prototype.pushNoHas||Object.defineProperty(Array.prototype,"pushNoHas",{value:function(t,e,n){return void 0===e&&(e=t),!this.has(e,n)&&(this.push(t),!0)},enumerable:!1}),Array.prototype.set||Object.defineProperty(Array.prototype,"set",{value:function(t){return this.length=0,Array.prototype.push.apply(this,t)},enumerable:!1}),Array.prototype.findLastIndex||Object.defineProperty(Array.prototype,"findLastIndex",{value:function(t){for(var e=this.length-1;e>=0;e--)if(t(this[e],e))return e;return-1},enumerable:!1}),Array.prototype.findLast||Object.defineProperty(Array.prototype,"findLast",{value:function(t){for(var e=this.length-1;e>=0;e--){var n=this[e];if(t(n,e))return n}return null},enumerable:!1}),Array.prototype.unique||Object.defineProperty(Array.prototype,"unique",{value:function(t){for(var e=this,n={},o=function(o){var i=void 0;null==t?i=r[o]:"string"==typeof t?i=r[o][t]:Array.isArray(t)?i=t.map(function(t){return e[o][t]}).join("_"):"function"==typeof t&&(i=t()),n[i]=r[o]},r=this,i=0;i<this.length;i++)o(i);return Object.values(n)},enumerable:!1}),Object.values||(Object.values=function(t){if(t!==Object(t))throw new TypeError("Object.values called on a non-object");var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(t[e]);return n}),cc._RF.pop()},{}],ExtendButton:[function(t,e){"use strict";cc._RF.push(e,"ebf5bsVTV9Olos+Zs12UxDX","ExtendButton"),cc.Button.prototype._onTouchEnded=function(t){var e=this;!this.__pressedFlag&&this.interactable&&this.enabledInHierarchy&&(this._pressed&&(this.__pressedFlag=!0,cc.Component.EventHandler.emitEvents(this.clickEvents,t),this.node.emit("click",this),ut.waitNextFrame().then(function(){return e.isValid&&(e.__pressedFlag=!1)})),this._pressed=!1,this._updateState(),t.stopPropagation())},cc._RF.pop()},{}],ExtendCC:[function(t,e){"use strict";cc._RF.push(e,"c951fafNy1DJbnVJhNAVgV/","ExtendCC"),cc.instantiate2=function(t,e){if(!(null==t?void 0:t.isValid)||!(null==e?void 0:e.isValid))return null;var n=cc.instantiate(t);return n.parent=e instanceof cc.Component?e.node:e,n},cc._RF.pop()},{}],ExtendComponent:[function(t,e){"use strict";cc._RF.push(e,"1113bA/Q5dG8alsW5XyU5Vl","ExtendComponent"),cc.Component.prototype.getActive=function(){return this.node.active},cc.Component.prototype.setActive=function(t){this.node.active=t},cc.Component.prototype.getPosition=function(t){return this.node.getPosition(t)},cc.Component.prototype.FindChild=function(t,e){return this.node.FindChild(t,e)},cc.Component.prototype.Child=function(t,e){return this.node.Child(t,e)},cc.Component.prototype.Component=function(t){return this.node.Component(t)},cc.Component.prototype.SetColor=function(t){return this.node.SetColor(t),this},cc.Component.prototype.GetColor=function(){return this.node.color},cc._RF.pop()},{}],ExtendLabel:[function(t,e){"use strict";cc._RF.push(e,"a3e7bcIQTZGoYq9aaTNrOx0","ExtendLabel");var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};cc.Label.prototype.setLocaleKey=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var r=this.Component(cc.LocaleLabel);r?r.setLangKey.apply(r,n([t],e)):this.string=t},cc.RichText.prototype.setLocaleKey=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var r=this.Component(cc.LocaleRichText);r?r.setLangKey.apply(r,n([t],e)):this.string=t},cc._RF.pop()},{}],ExtendNode:[function(t,e,n){"use strict";cc._RF.push(e,"7e32fdwd6lBTYmLyFEjsuGu","ExtendNode");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../base/BaseLanguage");function i(t,e,n,o,r){o&&(r?o.call(r,t,e,n):o(t,e,n))}cc.Node.prototype.Data=null,cc.Node.prototype.setActive=function(t){return this.active=t,this},cc.Node.prototype.FindChild=function(t,e){for(var n=this,o=(t=String(t)).split("/"),r=0,i=o.length;r<i;r++){if(!n.isValid)return null;if(!(n=n.getChildByName(o[r])))return null}return e&&(n=n.getComponent(e)),n},cc.Node.prototype.Child=function(t,e){t=String(t);var n="function"==typeof e?"_"+cc.js.getClassName(e).replace(".",""):e?"_"+e:"",o="$_"+t.replace(/\//g,"_")+n,r=this[o];if(void 0===r){if(!(r=this).isValid)return null;for(var i=t.split("/"),a=0,s=i.length;a<s&&(r=r.getChildByName(i[a]));a++);r&&e&&(r=r.getComponent(e)),this[o]=r||null}return r},cc.Node.prototype.Component=function(t){if(!t)return null;var e="$_"+("function"==typeof t?cc.js.getClassName(t).replace(".",""):t),n=this[e];return void 0===n&&(n=this.getComponent(t),this[e]=n),n},cc.Node.prototype.Items=function(t,e,n,o){if(!this.isValid)return lplog.error("Items error, !this.isValid");var r=0,a=this.children,s=a[0],c=0;if("number"==typeof t?(c=t,t=null):c=t.length,"function"==typeof e?(o=n,n=e):(e instanceof cc.Node||e instanceof cc.Prefab)&&(s=e),!s)return lplog.error("Items error, not item");for(var l=this.childrenCount;r<l;r++){var u=a[r];r<c?(u.active=!0,i(u,t?t[r]:void 0,r,n,o)):(u.Data=null,u.active=!1)}for(;r<c;r++)(u=cc.instantiate2(s,this)).active=!0,i(u,t?t[r]:void 0,r,n,o)},cc.Node.prototype.AddItem=function(t,e,n){if(!this.isValid)return lplog.error("AddItem error, !this.isValid");var o=null;"function"==typeof t?(n=e,e=t):(t instanceof cc.Node||t instanceof cc.Prefab)&&(o=t);var r=this.children.findIndex(function(t){return!t.active}),a=null;(a=o?cc.instantiate2(o,this):-1!==r?this.children[r]:cc.instantiate2(this.children[0],this)).active=!0,i(a,-1===r?this.childrenCount:r,void 0,e,n)},cc.Node.prototype.Swih=function(t,e){var n,o;if("function"==typeof t)o=t;else{if("number"!=typeof t&&"string"!=typeof t)return[];n=String(t)}for(var r=[],i=0,a=this.childrenCount;i<a;i++){var s=this.children[i];s.active=e?o?!o(s):s.name!==n:o?!!o(s):s.name===n,s.active&&r.push(s)}return r},cc.Node.prototype.SetColor=function(t){return t&&(t instanceof cc.Color?this.color=t:this.color=cc.Color.WHITE.fromHEX(t)),this},cc.Node.prototype.SetSwallowTouches=function(t){this._touchListener&&this._touchListener.setSwallowTouches(t)},cc.Node.prototype.IsSwallowTouches=function(){return this._touchListener&&this._touchListener.isSwallowTouches()},cc.Node.prototype.setLocaleKey=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=this.Component(r.default);i?i.setKey.apply(i,o([t],e)):lplog.error("setLocaleKey error, not LocaleComponent!")},cc.Node.prototype.getWorldBox=function(){var t=this._contentSize.width,e=this._contentSize.height,n=cc.rect(-this._anchorPoint.x*t,-this._anchorPoint.y*e,t,e);return this._calculWorldMatrix(),n.transformMat4(n,this._worldMatrix),n},cc.Node.prototype.cleanAllChildren=function(t){void 0===t&&(t=!0),t&&this.destroyAllChildren(),this.removeAllChildren()},cc._RF.pop()},{"../base/BaseLanguage":"BaseLanguage"}],ExtendPromise:[function(t,e){"use strict";cc._RF.push(e,"d8879CL8MRBj7Mj6mIOkL/C","ExtendPromise"),Promise.any||(Promise.any=function(t){var e=Array.from(t),n=e.length,o=new Array(n),r=0;return new Promise(function(t,i){e.forEach(function(e,a){Promise.resolve(e).then(function(e){return t(e)}).catch(function(t){o[a]=t,++r===n&&i(o)})})})}),cc._RF.pop()},{}],ExtendScrollView:[function(t,e){"use strict";function n(t,e,n,o,r){o&&(r?o.call(r,t,e,n):o(t,e,n))}cc._RF.push(e,"ccd865NbQ1ADY4HhxKJM0PV","ExtendScrollView"),cc.ScrollView.prototype.Items=function(t,e,o){var r=0,i=this.content.children[0],a=0;if("number"==typeof t?(a=t,t=null):a=t.length,!i)return lplog.error("\u5fc5\u987b\u6ee1\u8db3content\u4e2d\u6709\u4e00\u4e2a\u53ef\u62f7\u8d1d\u7684\u8282\u70b9");for(var s=this.content.children,c=this.content.childrenCount;r<c;r++){var l=s[r];r<a?(l.active=!0,n(l,t&&t[r],r,e,o)):(l.Data=null,l.active=!1)}for(;r<a;r++)(l=cc.instantiate2(i,this.content)).active=!0,n(l,t&&t[r],r,e,o)},cc.ScrollView.prototype.AddItem=function(t,e){var o=this.content.children.findIndex(function(t){return!t.active}),r=null;-1!==o?r=this.content.children[o]:(o=this.content.childrenCount,r=cc.instantiate2(this.content.children[0],this.content)),r.active=!0,n(r,o,void 0,t,e)},cc.ScrollView.prototype.Find=function(t,e){return this.content.children.find(t,e)},cc.ScrollView.prototype.IsEmpty=function(){return!this.content.children.some(function(t){return t.active})},cc.ScrollView.prototype.List=function(t,e,n){var o=this.Component(cc.ScrollViewEx);if(o)return o.list(t,e,n);lplog.error("List error, not ScrollViewEx!")},cc.ScrollView.prototype.GetItemNode=function(){var t;return(null===(t=this.Component(cc.ScrollViewEx))||void 0===t?void 0:t.getItemNode())||this.content.children[0]},cc._RF.pop()},{}],ExtendSprite:[function(t,e){"use strict";cc._RF.push(e,"0ef00uyA4pDK4BsdgnbvPEj","ExtendSprite"),cc.Sprite.prototype.setLocaleKey=function(t){var e=this.Component(cc.LocaleSprite);e&&e.setKey(t)},cc._RF.pop()},{}],ExtendToggleContainer:[function(t,e){"use strict";cc._RF.push(e,"540c3/gv5JOeK6P2kCRMUo6","ExtendToggleContainer"),cc.ToggleContainer.prototype.Swih=function(t){var e=this,n="",o=null;if("function"==typeof t)o=t;else{if("number"!=typeof t&&"string"!=typeof t)return[];n=String(t)}var r=[];return this.toggleItems.forEach(function(t){if(o?o(t):t.node.name===n){var i=e.checkEvents.shift();t.isChecked=!0,i&&e.checkEvents.push(i),r.push(t)}else t.isChecked&&(t.isChecked=!1)}),r},cc.ToggleContainer.prototype.Tabs=function(t){var e=this,n="",o=null,r=null;if("function"==typeof t)r=t;else{if("number"!=typeof t&&"string"!=typeof t)return o;n=String(t)}return this.toggleItems.forEach(function(t){if(r?r(t):t.node.name===n){o=t;var i=e.checkEvents.shift();t.isChecked=!0,i&&(i.emit([t,"true"]),e.checkEvents.push(i))}else t.isChecked&&(t.isChecked=!1)}),o},cc._RF.pop()},{}],ExtendVec:[function(t,e){"use strict";cc._RF.push(e,"847a6lbbhlF9rHKISg5L822","ExtendVec"),cc.Vec2.prototype.set2=function(t,e){return this.x=t,this.y=e,this},cc.Vec2.prototype.equals2=function(t,e){return this.x===t&&this.y===e},cc.Vec2.prototype.Join=function(t){return void 0===t&&(t=","),this.x+t+this.y},cc.Vec2.prototype.toVec3=function(){return this.z=0,this},cc.Vec2.prototype.newVec3=function(){return cc.v3(this.x,this.y,0)},cc.Vec2.prototype.toJson=function(){return{x:this.x,y:this.y}},cc.Vec2.prototype.FlipX=function(){var t=this.x;return this.x=this.y,this.y=t,this},cc.Vec2.prototype.toDB=function(){return{x:this.x,y:this.y}},cc.Vec3.prototype.set2=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},cc.Vec3.prototype.equals2=function(t,e,n){return this.x===t&&this.y===e&&(void 0===n||this.z===n)},cc.Vec3.prototype.Join=function(t){return void 0===t&&(t=","),this.x+t+this.y+t+this.z},cc.Vec3.prototype.toVec2=function(){return this},cc.Vec3.prototype.newVec2=function(){return cc.v2(this.x,this.y)},cc.Vec3.prototype.toDB=function(){return{x:this.x,y:this.y}},cc._RF.pop()},{}],FBInstantHelper:[function(t,e,n){"use strict";cc._RF.push(e,"ca6488m06RIfpNnMwbxHihc","FBInstantHelper");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.fbInstantHelper=void 0;var a=t("../../../core/utils/Utils"),s=function(){function t(){this.supportPay=!1,this.fbIAPCfg={}}return t.prototype.login=function(){var t=FBInstant.player.getID(),e=FBInstant.player.getName(),n=FBInstant.player.getPhoto();return t?{userId:t,nickName:e,avatarUrl:n}:{errcode:-10086,msg:"userid is null"}},t.prototype.share=function(t,e){return r(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return t?[4,this.invite(e)]:[3,2];case 1:return[2,n.sent()];case 2:return[4,this.normalShare(e)];case 3:return[2,n.sent()]}})})},t.prototype.getPlatform=function(){return FBInstant.getPlatform()},t.prototype.setSupportPay=function(){var t=this;FBInstant.payments.onReady(function(){"WEB"===t.getPlatform()&&(lplog.info("Payments Ready!"),t.supportPay=!0)})},t.prototype.getAwakeParams=function(){var t=FBInstant.getEntryPointData();return lplog.info("getEntryPointData: ",t),t},t.prototype.normalShare=function(t){return r(this,void 0,Promise,function(){var e;return i(this,function(n){switch(n.label){case 0:return[4,this.getBase64Image(t.imgUrl)];case 1:return(e=n.sent())?[4,this.shareWithBase64(e,t)]:(lplog.error("[no base64]",t),[2,!1]);case 2:return[2,n.sent()]}})})},t.prototype.shareWithBase64=function(t,e){return r(this,void 0,Promise,function(){return i(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){FBInstant.shareAsync({image:t,text:e.title||"",data:e.queryInfo||{},shareDestination:["NEWSFEED","GROUP","COPY_LINK"],switchContext:!1}).then(function(){n(!0)}).catch(function(){n(!1)})})];case 1:return[2,n.sent()]}})})},t.prototype.invite=function(t){return r(this,void 0,Promise,function(){var e;return i(this,function(n){switch(n.label){case 0:return[4,this.getBase64Image(t.imgUrl)];case 1:return(e=n.sent())?[4,new Promise(function(n){FBInstant.inviteAsync({image:e,text:t.title,data:t.queryInfo}).then(function(){n(!0)}).catch(function(t){lplog.error("invite: ",t),n(!1)})})]:(lplog.error("[no base64]",t),[2,!1]);case 2:return[2,n.sent()]}})})},t.prototype.getBase64Image=function(t,e){return void 0===e&&(e="png"),r(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return t?t.startsWith("http")?[4,this.urlToBase64(t)]:[2,t]:(lplog.error("[share without imgUrl]"),[2,null]);case 1:return[2,e.sent()]}})})},t.prototype.setIAPCfg=function(){return r(this,void 0,void 0,function(){var t=this;return i(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){FBInstant.payments.getCatalogAsync().then(function(n){n.forEach(function(e){var n={productId:e.productID,price:e.priceCurrencyCode+" "+e.priceAmount,currency_pay:e.priceCurrencyCode,currency_price:e.priceAmount};t.fbIAPCfg[e.productID]=n}),e(!0)}).catch(function(t){lplog.error("[getCatalogAsync fail: ]",t),e(!1)})})];case 1:return[2,e.sent()]}})})},t.prototype.getIAPCfg=function(){return this.fbIAPCfg},t.prototype.facebookPay=function(t){return r(this,void 0,void 0,function(){var e,n;return i(this,function(o){switch(o.label){case 0:return[4,new Promise(function(e){FBInstant.payments.purchaseAsync({productID:t,developerPayload:"foobar"}).then(function(t){lplog.info("[purchaseAsync: ]",t),e({purchase:t})}).catch(function(t){lplog.info("[purchaseAsync error: ]",t),e({error:t})})})];case 1:return e=o.sent(),(n=e.purchase)&&n.purchaseToken?[2,{result:e.purchase}]:[2,{error:e.error?JSON.stringify(e.error):"no purcahseToken"+n}]}})})},t.prototype.consumOrder=function(t){return r(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){FBInstant.payments.consumePurchaseAsync(t).then(function(){e(!0)}).catch(function(t){e(!1),lplog.error("[consumePurchaseAsync fail: ]",t)})})];case 1:return[2,e.sent()]}})})},t.prototype.getLostOrderList=function(){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){FBInstant.payments.getPurchasesAsync().then(function(e){t({result:e||[]})}).catch(function(e){t({error:JSON.stringify(e)})})})];case 1:return[2,t.sent()]}})})},t.prototype.copyText=function(t){if("function"!=typeof document.execCommand)return alert("\u590d\u5236\u5931\u8d25!"),!1;var e=document.createElement("textarea");e.value=t,e.setAttribute("style","display: block;width: 1px;height: 1px;"),document.body.appendChild(e),e.select();var n=document.execCommand("copy");if(document.body.removeChild(e),n)return!0;if("function"!=typeof document.createRange)return alert("\u590d\u5236\u5931\u8d25!"),!1;var o=document.createRange(),r=document.createElement("div");r.innerHTML=t,r.setAttribute("style","height: 1px;fontSize: 1px;overflow: hidden;"),document.body.appendChild(r),o.selectNode(r);var i=window.getSelection();return i.rangeCount>0&&i.removeAllRanges(),i.addRange(o),document.execCommand("copy"),!0},t.prototype.urlToBase64=function(t){return new Promise(function(e){var n=new Image;n.onload=function(){var t=document.createElement("canvas");t.width=n.width,t.height=n.height,t.getContext("2d").drawImage(n,0,0);var o=t.toDataURL("image/png");t.remove(),e(o)},n.setAttribute("crossOrigin","Anonymous"),n.src=t,n.onerror=function(){e(null)}})},o([a.util.callOnce],t.prototype,"setIAPCfg",null),t}();n.fbInstantHelper=new s,cc._RF.pop()},{"../../../core/utils/Utils":"Utils"}],FacebookHelper:[function(t,e,n){"use strict";cc._RF.push(e,"b74b3VuK+5LqKDahMXLQJrJ","FacebookHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.facebookHelper=void 0;var i=t("../event/JsbEvent"),a=function(){function t(){}return t.prototype.nativeLogin=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return[4,jsbHelper.call(i.default.FACEBOOK_LOGIN)];case 1:return"success"==(t=e.sent()||{}).result?[2,{fbId:t.uid,fbToken:t.token}]:[2,{errcode:t.errcode||-10086}]}})})},t.prototype.shareLink=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,jsbHelper.call(i.default.FACEBOOK_SHARE_LINK,t)];case 1:return"success"==e.sent().result?[2,!0]:[2,!1]}})})},t.prototype.sharePhoto=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,jsbHelper.call(i.default.FACEBOOK_SHARE_PHOTO,t)];case 1:return"success"==e.sent().result?[2,!0]:[2,!1]}})})},t.prototype.share=function(t){return o(this,void 0,void 0,function(){return r(this,function(){return t.imgUrl&&!t.imgUrl.startsWith("http")?[2,this.sharePhoto({path:t.imgUrl,title:t.title})]:[2,this.shareLink(t)]})})},t}();n.facebookHelper=new a,cc._RF.pop()},{"../event/JsbEvent":"JsbEvent"}],FailWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"1fb790pSF9PnoLls9lD1v26","FailWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/event/NotEvent"),l=t("../../common/helper/GameHelper"),u=t("../../common/helper/ResHelper"),p=t("../../common/helper/ViewHelper"),h=cc._decorator.ccclass,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetLayoutNode_=null,e.rewardsNode_=null,e.rewardLayoutNode_=null,e.continueNode_=null,e.animNode_=null,e.targets=[],e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("FailWindCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){cc.log("FailWindCtrl onEnter"),this.targets=t.data,this.targetLayoutNode_.Items(this.targets,function(t,e){u.resHelper.loadTargetIcon(t,"level_item_gem_"+e.type,"level"),t.Child("text",cc.Label).string=""+e.count});var e=t.level,n=this.targets.some(function(t){return 0==t.type});this.animNode_.active=n,this.targetLayoutNode_.active=!n,n?(this.animNode_.Child("content/text",cc.Label).string=""+this.targets[0].count,cc.tween(this.animNode_).set({scale:0}).to(.5,{scale:.4},{easing:cc.easing.backOut}).start()):this.targetLayoutNode_.Items(this.targets,function(t,e){u.resHelper.loadTargetIcon(t,"level_item_gem_"+e.type,"level"),cc.tween(t).set({scale:0}).to(.5,{scale:1},{easing:cc.easing.backOut}).start(),t.Child("check").active=e.count<=0,t.Child("text").active=e.count>0});var o=l.gameHelper.getLevelRewardBy(e);this.rewardLayoutNode_.Items(o,function(t,e){u.resHelper.loadTempIcon(t,""+e.id,"level"),t.Child("text",cc.Label).string=""+e.count}),cc.tween(this.rewardsNode_).set({opacity:0}).delay(.3).to(.5,{opacity:255}).start(),cc.tween(this.continueNode_).set({scale:0}).delay(.8).to(.3,{scale:1},{easing:cc.easing.backOut}).start(),cc.tween(this.node.Child("root/close_be")).set({scale:0}).delay(.8).to(.3,{scale:1},{easing:cc.easing.backOut}).start(),l.gameHelper.ad.showInterstitialAd(),eventMgr.emit(c.default.SHOW_ADD)},e.prototype.onClean=function(){cc.log("FailWindCtrl onClean"),eventMgr.emit(c.default.HIDE_ADD)},e.prototype.onClickPlay=function(t,e){cc.log("onClickPlay",e),this.levelHandler()},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),p.viewHelper.gotoWind("main")},e.prototype.levelHandler=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t=l.gameHelper.global.level,[4,assetsMgr.loadJsonByName(""+t)];case 1:return(e=n.sent())?p.viewHelper.showPnl("level/LevelBoot",{data:e.datas}):p.viewHelper.showAlert("no_more_level"),[2]}})})},i([ut.addLock],e.prototype,"levelHandler",null),i([h],e)}(mc.BaseWindCtrl);n.default=d,cc._RF.pop()},{"../../common/event/NotEvent":"NotEvent","../../common/helper/GameHelper":"GameHelper","../../common/helper/ResHelper":"ResHelper","../../common/helper/ViewHelper":"ViewHelper"}],FeedbackCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"e3affAyiQNCX7nsbTviYgzN","FeedbackCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../../../startScene/LangLabel"),l=t("../../../../../startScene/version"),u=t("../../../common/constant/Enums"),p=t("../../../common/helper/GameHelper"),h=t("../../../common/net/netMgr"),d=cc._decorator,f=d.ccclass,y=d.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputEb_=null,e.title=null,e.okLb=null,e.type=null,e.uid=null,e.lang=null,e.app=null,e.ok=null,e}return r(e,t),e.prototype.init=function(t,e,n,o,r){void 0===n&&(n=u.FeedBackType.GENERAL),this.type=n,this.uid=t,this.lang=o,this.inputEb_.string="",this.ok=e,this.app=r},e.prototype.start=function(){this.title.setLangKey(this.lang.feedback),this.okLb.setLangKey(this.lang.send)},e.prototype.onClickOk=function(){var t=this.inputEb_.string.trim();t?this.post(t):this.showAlert(this.lang.send_failed)},e.prototype.post=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,h.netMgr.post("feedback/sendMsg",{uid:this.uid,version:l.default.VERSION,platform:p.gameHelper.getPlatform(),content:t,type:this.type,lang:mc.lang},null,1)];case 1:return 0===e.sent().status?(this.showAlert(this.lang.feedback_send_success),this.node.destroy(),this.ok&&this.ok()):this.showAlert(this.lang.send_failed),[2]}})})},e.prototype.showAlert=function(t){this.app.showAlert(t)},i([y(cc.EditBox)],e.prototype,"inputEb_",void 0),i([y(c.default)],e.prototype,"title",void 0),i([y(c.default)],e.prototype,"okLb",void 0),i([ut.addLock],e.prototype,"post",null),i([f],e)}(cc.Component);n.default=_,cc._RF.pop()},{"../../../../../startScene/LangLabel":void 0,"../../../../../startScene/version":void 0,"../../../common/constant/Enums":"Enums","../../../common/helper/GameHelper":"GameHelper","../../../common/net/netMgr":"netMgr"}],FinishWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"b43ad2gA0hAMIJKFFvLM6CT","FinishWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/ViewHelper"),l=cc._decorator.ccclass,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetLayoutNode_=null,e.rewardsNode_=null,e.rewardLayoutNode_=null,e.continueNode_=null,e.flagRightNode_=null,e.flagLeftNode_=null,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("FinishWindCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){cc.log("FinishWindCtrl onEnter")},e.prototype.onClean=function(){cc.log("FinishWindCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),c.viewHelper.gotoWind("main")},e.prototype.showTarget=function(){},e.prototype.showRewards=function(){},i([l],e)}(mc.BasePnlCmpt);n.default=u,cc._RF.pop()},{"../../common/helper/ViewHelper":"ViewHelper"}],FlashLightCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"fee0cxS7f5KMpsGU3eUwz7Q","FlashLightCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./IgnoreFlashLightCmpt"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.runing=!1,e.maxTime=1.3,e.interval=1,e.delay=0,e.elapsed=0,e.count=-1,e.infos=null,e}return r(e,t),e.prototype.onLoad=function(){this.load()},e.prototype.onDestroy=function(){this.infos=null},e.prototype.load=function(){this.infos||this.updateInfo()},e.prototype.find=function(t){var e=this;if(!t.getComponent(a.default)){var n=t.getComponent(cc.Sprite);n&&this.infos.push({sprite:n,preMaterial:n.getMaterial(0),material:cc.Material.create(assetsMgr.getMaterial("FlashLight")._effectAsset)}),t.children.forEach(function(t){return e.find(t)})}},e.prototype.updateInfo=function(){return this.infos=[],this.find(this.node),this},e.prototype.play=function(t,e,n,o){var r=this;void 0===t&&(t=-1),this.load(),this.infos.forEach(function(t){var e,i;t.sprite.setMaterial(0,t.material),t.material.setProperty("rotated",(null===(i=null===(e=t.sprite)||void 0===e?void 0:e.spriteFrame)||void 0===i?void 0:i.isRotated())?1:0),n&&t.material.setProperty("lightAngle",n),o&&t.material.setProperty("lightWidth",o),r.setMaterialProperty(t,0)}),this.maxTime=null!=e?e:this.maxTime,this.elapsed=0,this.delay=0,this.runing=this.infos.length>0,this.count=t},e.prototype.setMaterialProperty=function(t,e){var n,o,r=(null===(o=null===(n=t.sprite)||void 0===n?void 0:n.spriteFrame)||void 0===o?void 0:o.uv)||[];1==t.sprite.spriteFrame.isRotated()?t.material.setProperty("u_lrbt",[r[1],r[7],r[0],r[6]]):t.material.setProperty("u_lrbt",[r[0],r[6],r[7],r[1]]),t.material.setProperty("time",e)},e.prototype.stop=function(){this.runing=!1,this.infos.forEach(function(t){t.sprite.setMaterial(0,t.preMaterial)})},e.prototype.update=function(t){var e=this;if(this.runing)if(this.delay>0)this.delay-=t;else if(this.elapsed+=t,this.elapsed<this.maxTime){var n=this.elapsed/this.maxTime;this.infos.forEach(function(t){return e.setMaterialProperty(t,n)})}else this.delay=this.interval,this.elapsed=0,-1!==this.count&&(this.count-=1,this.count<=0&&this.stop())},i([c],e)}(cc.Component));n.default=l,cc._RF.pop()},{"./IgnoreFlashLightCmpt":"IgnoreFlashLightCmpt"}],FlashLightShaderCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"76b24Szj/BIoLVAqFqRsWe3","FlashLightShaderCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,a.requireComponent),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxTime=1.3,e.maxCount=2,e.interval=1,e.delay=0,e.elapsed=0,e.count=0,e.material=null,e.preMaterial=null,e.sprite=null,e}return r(e,t),e.prototype.onLoad=function(){this.sprite=this.getComponent(cc.Sprite),this.preMaterial=this.sprite.getMaterial(0);var t=assetsMgr.getMaterial("FlashLight");this.material=cc.Material.create(t._effectAsset)},e.prototype.play=function(){this.sprite&&(this.sprite.setMaterial(0,this.material),this.material.setProperty("time",0),this.elapsed=0,this.delay=0,this.count=this.maxCount,this.sprite.spriteFrame&&1==this.sprite.spriteFrame.isRotated()?this.material.setProperty("rotated",1):this.material.setProperty("rotated",0),this.setMaterialProperty())},e.prototype.setMaterialProperty=function(){var t;if((null===(t=this.sprite)||void 0===t?void 0:t.spriteFrame)&&this.sprite.spriteFrame.isValid){var e=this.sprite.spriteFrame.uv;e&&e.length>1&&(1==this.sprite.spriteFrame.isRotated()?this.material.setProperty("u_lrbt",[e[1],e[7],e[0],e[6]]):this.material.setProperty("u_lrbt",[e[0],e[6],e[7],e[1]]))}},e.prototype.stop=function(){this.count=0,this.sprite.setMaterial(0,this.preMaterial)},e.prototype.update=function(t){0!==this.count&&(this.delay>0?this.delay-=t:(this.elapsed+=t,this.elapsed<this.maxTime?(this.setMaterialProperty(),this.material.setProperty("time",this.elapsed/this.maxTime)):(this.delay=this.interval,this.count-=1,this.elapsed=0,this.count<=0&&this.stop())))},i([s,c(cc.Sprite)],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],FollowCameraScaleCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"b59e8Mh4T9E2583REF7sMSa","FollowCameraScaleCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../../scene/CameraCtrl"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.initScale=1,e.maxScale=2,e.preZoomRatio=1,e.preScale=1,e}return r(e,t),e.prototype.onLoad=function(){this.preZoomRatio=a.cameraCtrl.zoomRatio,this.preScale=this.node.scale=this.initScale*(this.maxScale-this.preZoomRatio)},e.prototype.update=function(){this.preZoomRatio===a.cameraCtrl.zoomRatio&&this.preScale===this.node.scale||(this.preZoomRatio=a.cameraCtrl.zoomRatio,this.preScale=this.node.scale=this.initScale*(this.maxScale-this.preZoomRatio))},i([l],e.prototype,"initScale",void 0),i([l],e.prototype,"maxScale",void 0),i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../../scene/CameraCtrl":"CameraCtrl"}],GameHelper:[function(t,e,n){"use strict";cc._RF.push(e,"d0dcfzM0kRKy61yn68vsuPt","GameHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.gameHelper=void 0;var i=t("../../../../startScene/version"),a=t("../../../core/utils/ResLoader"),s=t("../constant/Enums"),c=t("../LocalConfig"),l=t("../net/netMgr"),u=t("../wx/WxHelper"),p=t("./ViewHelper"),h=t("./DatabaseHelper"),d=t("./ResHelper"),f=t("../crypto/CryptoHelper"),y=t("../event/JsbEvent"),_=t("../event/EventType"),g=t("../shareParams/ShareParamsHelper"),m=t("../facebook/FBInstantHelper"),v=t("../../model/common/ColorShapeObj"),b=t("../constant/Constant"),w=function(){function t(){this._global=null,this._user=null,this._ad=null,this._adSkipCard=null,this._dig=null,this.clickTouchId=-1,this.roleTouchId=-1,this.stuffTouchId=-1,this.buttonLongTouchId=-1,this.lastTopTouchTime=0,this.isCheckUpdate=!1,this.NETRETRY_MAX_COUNT=3,this.netRetryCount=this.NETRETRY_MAX_COUNT,this.netErrorTipCount=0,this.deviceId="",this.isNewDevice=!1,this.appChannel=s.ChannelType.OFFICIAL,this.isFirstEnterMain=!1,this.waitUnlockTips=[],this.isOpenTipPnl=!1,this.reqServerTimeQueue=[],this.isShowLoading=!1,this.timeoutIdMap={},this.intervalIdMap={},this.lastSceneInfo=null,this.stop=!1}return Object.defineProperty(t.prototype,"global",{get:function(){return this._global||(this._global=mc.modelMgr.get("global"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"user",{get:function(){return this._user||(this._user=mc.modelMgr.get("user"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ad",{get:function(){return this._ad||(this._ad=mc.modelMgr.get("ad"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"adSkipCard",{get:function(){return this._adSkipCard||(this._adSkipCard=mc.modelMgr.get("adSkipCard"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dig",{get:function(){return this._dig||(this._dig=mc.modelMgr.get("dig"))},enumerable:!1,configurable:!0}),t.prototype.getLeaves=function(){return this.global.getCoin()},t.prototype.getTempHeart=function(){return this.global.getTempHeart()},t.prototype.getHeart=function(){var t=this.global.getHeart();if(!t){var e=storageMgr.loadObject("global")||{};"string"==typeof e&&(e=JSON.stringify(e)),e&&(t=e.heart)}return t||0},t.prototype.getVersion=function(){return i.default.VERSION},t.prototype.getApptype=function(){return i.default.getAppType()},t.prototype.isInland=function(){return"inland"===i.default.getAppType()},t.prototype.isGLobal=function(){return"global"===i.default.getAppType()},t.prototype.isInlandApp=function(){return this.isInland()&&cc.sys.isNative},t.prototype.setLastSceneInfo=function(t){this.lastSceneInfo=t},t.prototype.getLastSceneInfo=function(){return this.lastSceneInfo},t.prototype.getGlobalDefaultSharePlatform=function(){return this.user.getAppUserType()===s.UserType.TWITTER?s.UserType.TWITTER:(s.UserType.FB,s.UserType.FB)},t.prototype.now=function(){return l.netMgr.getServerTime()},t.prototype.isTimeGoBack=function(){return l.netMgr.isTimeGoBack()},t.prototype.getToDaySurpluTime=function(t,e){if(void 0===e&&(e=1),t<=0)return 0;var n=2*ut.Time.Hour,o=this.now()+n,r=new Date(t+n),i=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),0).getTime();return i-=r.getTimezoneOffset()*ut.Time.Minute,i+=ut.Time.Day*e,Math.floor(.001*(i-o))},t.prototype.getNextDayTime=function(t){void 0===t&&(t=1);var e=this.now();return(e-=e%ut.Time.Second)+this.getToDaySurpluTime(e,t)*ut.Time.Second},t.prototype.getFixTimeSurplyTime=function(t,e,n){if(void 0===n&&(n=1),t<=0)return 0;var o=2*ut.Time.Hour,r=this.now()+o,i=new Date(t+o),a=new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),0).getTime();return a-=i.getTimezoneOffset()*ut.Time.Minute,a+=e*ut.Time.Hour+o,a+=ut.Time.Day*n,Math.floor(.001*(a-r))},t.prototype.getMondaySurplyTime=function(t){if(t<=0)return 0;var e=2*ut.Time.Hour,n=this.now()+e,o=new Date(t+e),r=(o.getDay()||7)-7,i=o.getTime()-(r-1)*ut.Time.Day,a=new Date(i),s=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),0).getTime();return s-=o.getTimezoneOffset()*ut.Time.Minute,Math.floor(.001*(s-n))},t.prototype.getTargetTimestamp=function(t,e,n,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),o=null!=o?o:this.now();var r=2*ut.Time.Hour,i=new Date(o+r),a=new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),0).getTime();return new Date(a+1e3*(3600*t+60*e+n)).getTime()},t.prototype.getPlatform=function(){return ut.isMobile()?ut.isAndroid()?"android":"ios":ut.isWechatOrQQ()?"undefined"!=typeof qq?"qq":"wx":ut.isFBInstant()?"fb_instant":"none"},t.prototype.getOs=function(){return ut.isAndroid()?"android":ut.isIos()?"ios":"none"},t.prototype.getPlatformType=function(){return ut.isMobile()?ut.isAndroid()?s.PlatformType.ANDROID:s.PlatformType.IOS:ut.isWechatOrQQ()?"undefined"!=typeof qq?s.PlatformType.QQ:s.PlatformType.WX:s.PlatformType.NONE},t.prototype.getLocaleParam=function(t){if("string"==typeof t){if(t.includes(","))return t.split(",");if(t.includes("|"))return t.split("|")}return t},t.prototype.gameRestart=function(){var t,e;audioMgr.stopAll(),audioMgr.releaseAll(),audioMgr.clean(),u.wxHelper.destroyAllButton(),h.dbHelper.update(1),storageMgr.syncSaveLazy(),storageMgr.reset(),a.loader.clean(),this.clean(),null===(t=this.ad)||void 0===t||t.closeNativeAd(),null===(e=this.ad)||void 0===e||e.hideAllBannerAd(),this.isFirstEnterMain=!1,this.stop=!1,ut.isWechatOrQQ()&&ut.compareVersion("2.22.1",wx.getSystemInfoSync().SDKVersion)?wx.restartMiniProgram():cc.game.restart(),cc.sys.isBrowser&&location.reload()},t.prototype.gameExit=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:if(!ut.isWechatGame())return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,wx.exitMiniProgram()];case 2:return t.sent(),[2,!0];case 3:return t.sent(),p.viewHelper.showAlert("\u9000\u51fa\u6e38\u620f\u5931\u8d25\uff0c\u8bf7\u624b\u52a8\u9000\u51fa\u6e38\u620f"),[2,!1];case 4:return[3,6];case 5:if(!ut.isFBInstant())return cc.game.end(),[2,!0];FBInstant.quit(),t.label=6;case 6:return[2]}})})},t.prototype.gameStop=function(){this.stop=!0},t.prototype.isStop=function(){return this.stop},t.prototype.clean=function(){for(var t in this.timeoutIdMap){var e=this.timeoutIdMap[t];clearTimeout(e)}for(var t in this.timeoutIdMap={},this.intervalIdMap)e=this.intervalIdMap[t],clearInterval(e);this.intervalIdMap={}},t.prototype.cleanByMemoryWarning=function(t){eventMgr.emit(mc.Event.CLEAN_ALL_UNUSED,t),eventMgr.emit(mc.Event.CLEAN_CACHE_WIND)},t.prototype.checkActivityAutoDate=function(t,e){var n=new Date(this.now()).getFullYear();return 4!==((null==t?void 0:t.split("-")[0])||"").length&&(t=n+"-"+t),4!==((null==e?void 0:e.split("-")[0])||"").length&&(e=n+"-"+e),this.checkActivityDate(t,e)},t.prototype.checkActivityDate=function(t,e){return!!(t&&e&&l.netMgr.getCacheTime(6e5))&&this.checkCommunityActivityDate(t)&&!this.checkCommunityActivityDate(e)},t.prototype.checkCommunityActivityDate=function(t,e){void 0===e&&(e=0);var n=t.split("-");if(n.length<2||!l.netMgr.getCacheTime(6e5))return!1;var o=this.now(),r=n[0],i=n[1],a=n[2],s=n[3],c=n[4],u=n[5];return 2===n.length?(a=i,i=r,r=new Date(o).getFullYear()+""):r&&"y"!==r||(r=new Date(o).getFullYear()+""),t=r+"/"+i+"/"+a+" "+(s=s||"00")+":"+(c=c||"00")+":"+(u=u||"00"),o>=new Date(t).getTime()+e*ut.Time.Day},t.prototype.wrapDateText=function(t){var e=t.split("-"),n=e.length;return e.slice(n-2,n).join(".")},t.prototype.getDateOffset=function(t){var e=t.split("-");if(e.length<2)return-1;var n=this.now(),o=e[0],r=e[1],i=e[2],a=e[3],s=e[4],c=e[5];2===e.length?(i=r,r=o,o=new Date(n).getFullYear()+""):o&&"y"!==o||(o=new Date(n).getFullYear()+""),t=o+"/"+r+"/"+i+" "+(a=a||"00")+":"+(s=s||"00")+":"+(c=c||"00");var l=new Date(t).getTime();return n>l?n-l:l-n},t.prototype.getTimeByString=function(t){if(!t)return 0;var e=t.split("-"),n=e[0],o=e[1],r=e[2],i=e[3],a=e[4],s=e[5];return o=o||"00",r=r||"00",i=i||"00",a=a||"00",s=s||"00",new Date(n+"/"+o+"/"+r+" "+i+":"+a+":"+s).getTime()},t.prototype.getTimeStrByDate=function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+e.getDate()},t.prototype.clearDB=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return t=this.user.getUid(),[4,l.netMgr.get("record/clear",{uid:t})];case 1:return 0!=(e.sent()||{}).status?[3,3]:(h.dbHelper.clear(),[4,ut.wait(.05)]);case 2:return e.sent(),this.gameRestart(),[3,4];case 3:p.viewHelper.showAlert("\u5220\u6863\u5931\u8d25"),e.label=4;case 4:return[2]}})})},t.prototype.getAppShopUrl=function(){return""},t.prototype.getGaliOutputPropCount=function(){var t=this.getHeart(),e=assetsMgr.getJson("adventureExplore").datas;return(e.find(function(e){var n=ut.stringToNumbers(e.heart,","),o=n[0],r=n[1];return t>=o&&t<=r})||e.last()).task_item_num},t.prototype.randomBagItem=function(t){if(0===t.length)return null;for(var e=t.reduce(function(t,e){return e.count+t},0),n=t.length,o=ut.random(0,e-1),r=0;r<n;r++){var i=t[r];if(o<i.count)return t.splice(r,1),i;o-=i.count}return null},t.prototype.isGm=function(){return c.localConfig.isGm||this.user.isGM()},t.prototype.getChannel=function(){var t;return cc.sys.isNative&&this.isInland()&&(ut.isIos()?t=jsb.reflection.callStaticMethod("jsbHelp","getChannel"):ut.isAndroid()&&(t=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsbHelper","getChannel","()Ljava/lang/String;"))),t||(t=s.ChannelType.OFFICIAL),t},t.prototype.changeParent=function(t,e){if(cc.isValid(t)&&cc.isValid(e)){var n=e.convertToWorldSpaceAR(cc.Vec2.ZERO),o=t.convertToNodeSpaceAR(n);e.parent=t,e.setPosition(o)}},t.prototype.findNode=function(t,e,n){return void 0===n&&(n=10),o(this,void 0,void 0,function(){var o,i;return r(this,function(r){switch(r.label){case 0:if((o=cc.Canvas.instance.FindChild(t))&&o.active){if(!e)return[2,o];if((i=this.recursionFind(o,e))&&i.active)return[2,i]}return(n-=1)<=0?[2,null]:[4,ut.wait(.2)];case 1:return r.sent(),[2,this.findNode(t,e,n)]}})})},t.prototype.recursionFind=function(t,e){if(t.name===e)return t;for(var n=0;n<t.children.length;n++){var o=t.children[n],r=this.recursionFind(o,e);if(r)return r}},t.prototype.findChild=function(t,e,n){return void 0===n&&(n=30),o(this,void 0,void 0,function(){var o;return r(this,function(r){switch(r.label){case 0:return t.isValid?(o=t.FindChild(e))?[2,o]:(n-=1)<=0?[2,null]:[4,ut.wait(.2)]:[2,null];case 1:return r.sent(),[2,this.findChild(t,e,n)]}})})},t.prototype.isOpenedPnlByKey=function(t){return mc.getOpenPnls().has("key",t)},t.prototype.getEnterQuery=function(){var t=null;if(ut.isWechatOrQQ()){var e=u.wxHelper.getEnterInfo();t=null==e?void 0:e.query}else t=g.shareParamsHelper.getAwakeParams();return t&&Object.keys(t).length>0?t:null},t.prototype.getShareEnterQuery=function(){var t,e=null;if(ut.isFBInstant())e=m.fbInstantHelper.getAwakeParams();else if(ut.isWechatOrQQ()){var n=u.wxHelper.getEnterInfo();(!(e=null==n?void 0:n.query)||Object.keys(e).length<=0)&&(e=null===(t=wx.getLaunchOptionsSync())||void 0===t?void 0:t.query)}else e=g.shareParamsHelper.getAwakeParams()||g.shareParamsHelper.getInstallParams();return e&&Object.keys(e).length>0?e:null},t.prototype.nextWaitUnlockTips=function(){if(this.waitUnlockTips.shift(),this.waitUnlockTips.length>0){this.isOpenTipPnl=!0;var t=this.waitUnlockTips[0];p.viewHelper.showPnl(t.pnl,t.data)}else this.isOpenTipPnl=!1},t.prototype.setTimeout=function(t,e){for(var n=this,o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=setTimeout(function(){delete n.timeoutIdMap[i],"function"==typeof t&&t()},e,o);return this.timeoutIdMap[i]=i,i},t.prototype.clearTimeout=function(t){delete this.timeoutIdMap[t],clearTimeout(t)},t.prototype.setInterval=function(t,e){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var r=setInterval(t,e,n);return this.intervalIdMap[r]=r,r},t.prototype.clearInterval=function(t){delete this.intervalIdMap[t],clearInterval(t)},t.prototype.dumpMemory=function(t){void 0===t&&(t=!1);var e={},n=cc.assetManager.assets._map,o=0;for(var r in n)if((l=n[r])instanceof cc.SpriteFrame){var i=l;(u=i.getTexture())&&i.name&&""!==i.name&&(e[u.nativeUrl]=i.name)}var a=function(t){var o=n[t];if(o instanceof sp.SkeletonData){var r=o;r.textures.forEach(function(t){r.name&&""!==r.name&&(e[t.nativeUrl]=r.name)})}};for(var r in n)a(r);var s={customer_1:!0,f_500w:!0,f_600w:!0,f_700w:!0,f_700w_out:!0,f_700w_orange:!0,byun_3:!0,byun_4:!0,byun_5:!0,yuangong:!0},c=0;for(var r in n){var l;if((l=n[r])instanceof cc.Texture2D){var u,p=(u=l).width*u.height;o+=32*p;var h=e[u.nativeUrl]||u.nativeUrl;s[h]||(p>=1048576?console.error("[1024 TEX]: ",h,u.width+"x"+u.height):p>=64e4?console.warn("[800 TEX]: ",h,u.width+"x"+u.height):p>=262144?console.log("[512 TEX]: ",h,u.width+"x"+u.height):console.log("[OTHER TEX]: ",h,u.width+"x"+u.height)),c++}}var d=o/1024/1024;d=Math.ceil(100*d)/100,console.log("memory cost",d+"m"),t&&console.log("how much =",c)},t.prototype.onMemoryWarning=function(){assetsMgr.onMemoryWarning(),d.resHelper.onMemoryWarning(),this.cleanByMemoryWarning()},t.prototype.logPassTime=function(t){var e="testTime"+(t||""),n=(new Date).getTime();window[e]&&console.log("passTime",t,window.testTimeCount,n-window[e]),window[e]=n,window.testTimeCount=(window.testTimeCount||0)+1},t.prototype.copyUid=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(){return t=f.cryptoHelper.pkEncrypt(this.user.getUid(),!1),[2,this.copyToClipboard(t,"toast.copy_uid_complete")]})})},t.prototype.copyToClipboard=function(t,e){return o(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return t?[3,1]:[3,12];case 1:return ut.isFBInstant()?m.fbInstantHelper.copyText(t)?[3,12]:[2]:[3,2];case 2:return cc.sys.isBrowser?(null===navigator||void 0===navigator?void 0:navigator.clipboard)?[4,navigator.clipboard.writeText(t)]:[3,4]:[3,6];case 3:return n.sent(),[3,5];case 4:return[2];case 5:return[3,12];case 6:return ut.isQQ()?(qq.setClipboardData({data:t,success:function(){qq.getClipboardData({success:function(){e&&p.viewHelper.showAlert(e)},fail:function(){p.viewHelper.showAlert("toast.copy_fail")}})},fail:function(){p.viewHelper.showAlert("toast.copy_fail")}}),[2]):[3,7];case 7:return ut.isWechatOrQQ()?[4,wxPro.setClipboardData({data:t})]:[3,9];case 8:return n.sent(),[3,12];case 9:return ut.isMobile()?[4,jsbHelper.call(y.default.COPY_TO_CLIPBOARD,{data:t})]:[3,11];case 10:return n.sent(),[3,12];case 11:return[2];case 12:return e&&p.viewHelper.showAlert(e),[2]}})})},t.prototype.getBundleId=function(){},t.prototype.onShow=function(){return new Promise(function(t){var e=function(){cc.game.off(cc.game.EVENT_SHOW,e),t()};cc.game.on(cc.game.EVENT_SHOW,e)})},t.prototype.hasNet=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return p.viewHelper.showLoadingWait(!0),[4,l.netMgr.reqServerTime()];case 1:return t=e.sent(),p.viewHelper.showLoadingWait(!1),0==t&&p.viewHelper.showMessageBox("toast.net_error"),[2,t>0]}})})},t.prototype.getPurchaseDatas=function(){var t=assetsMgr.getJson("shop").datas,e=assetsMgr.getJson("limitOfferGifts").datas,n=[].concat(t,e),o=this.isInland()?"in_purchase":"purchase";return n.filter(function(t){return!!t[o]})},t.prototype.getMapNameById=function(t){return"global.map_name_"+t},t.prototype.gotoWind=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return eventMgr.emit(mc.Event.LOAD_BEGIN_WIND),[4,p.viewHelper.preloadWind(t)];case 1:return e.sent(),eventMgr.emit(mc.Event.LOAD_END_WIND),eventMgr.emit(mc.Event.GOTO_WIND,t),[2]}})})},t.prototype.getAdTime=function(){var t;return(null===(t=this.ad)||void 0===t?void 0:t.getAdTime())||0},t.prototype.resetAdTime=function(){var t;null===(t=this.ad)||void 0===t||t.resetAdTime()},t.prototype.testGameCaptureScreen=function(){eventMgr.emit(_.default.GAME_CAPTURE_SCREEN)},t.prototype.checkWordSenstive=function(t,e){return o(this,void 0,void 0,function(){var n,o,i,a;return r(this,function(r){switch(r.label){case 0:return this.isGLobal()?(e(!0),[3,3]):[3,1];case 1:return n=this.user.getUid(),o=t,i=ut.isWechatGame()?1:0,[4,l.netMgr.get("isValidContent",{uid:n,content:o,isWx:i})];case 2:0==(a=(r.sent()||{status:-504}).status)?e(!0):-504==a?p.viewHelper.showAlert("toast.net_error"):e(!1),r.label=3;case 3:return[2]}})})},t.prototype.setLogoutTimeForTest=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,l.netMgr.get("debug_change_logoutTime",{uid:this.user.getUid(),timestamp:this.now()-t*ut.Time.Day})];case 1:return(e.sent()||{status:-504}).status,[2]}})})},t.prototype.resetLogoutTimeForTest=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,l.netMgr.get("debug_change_logoutTime",{uid:this.user.getUid(),timestamp:this.now()})];case 1:return(t.sent()||{status:-504}).status,[2]}})})},t.prototype.isCurSouvenirRewardPnlOpend=function(){var t=this;return["common/SouvenirReward"].some(function(e){return t.isOpenedPnlByKey(e)})},t.prototype.checkDurTime=function(t,e){var n=new Date(this.now()),o=new Date(n),r=new Date(n),i=t.lastIndexOf(":"),a=t.substring(0,i),s=t.substring(i+1,t.length);o.setHours(Number(a),Number(s),0,0);var c=e.lastIndexOf(":"),l=e.substring(0,c),u=e.substring(c+1,e.length);return r.setHours(Number(l),Number(u),0,0),n.getTime()-o.getTime()>=0&&n.getTime()<=r.getTime()},t.prototype.getRandomNum=function(t,e){for(var n=[],o=e,r=0,i=0;i<t-1;i++){var a=Math.ceil(Math.random()*(o/2));n.push(a),o-=a,r=a}return n.push(e-r),n},t.prototype.supportPay=function(){return ut.isFBInstant()?m.fbInstantHelper.supportPay:this.isGLobal()},t.prototype.getSceneBgColor=function(){return this.checkDurTime("8:30","18:30")?"#fed27a":"#7567A3"},t.prototype.getShapesFromCache=function(){},t.prototype.getColorShapes=function(){var t=ut.deepClone(b.COLOR_LIST);return ut.randomNoRepeat(t,b.SHAPE_COUNT).map(function(t){var e=ut.randomIndexByWeight(b.GAME_SHAPE_LIST,"weight"),n=b.GAME_SHAPE_LIST[e],o=assetsMgr.getJsonData("ShapeConfig",n.id),r=(new v.default).init(n.id,o.coords,o.headPos);return r.initColor(t),r.initDegree(0),r})},t.prototype.getReviveShapes=function(){for(var t=ut.deepClone(b.COLOR_LIST),e=[],n=0;n<3;++n){var o=assetsMgr.getJsonData("ShapeConfig",0),r=(new v.default).init(0,o.coords,o.headPos);r.initColor(t.random()),r.initDegree(0),e.push(r)}return e},t.prototype.resizeParentToFitChildren=function(t,e){void 0===e&&(e=0);var n=Number.MAX_VALUE,o=Number.MAX_VALUE,r=Number.MIN_VALUE,i=Number.MIN_VALUE;t.children.forEach(function(t){var e=t.getBoundingBox(),a=t.x-e.width/2,s=t.x+e.width/2,c=t.y-e.height/2,l=t.y+e.height/2;n=Math.min(n,a),o=Math.min(o,c),r=Math.max(r,s),i=Math.max(i,l)});var a=r-n,s=i-o;e/90%2==1?(t.width=s,t.height=a):(t.width=a,t.height=s);var c=-a/2,l=s/2;t.children.forEach(function(t){var e=n-c,o=i-l;t.setPosition(t.x-e,t.y-o)})},t.prototype.getBoardXYBy=function(t){return[Math.floor(t.x/b.GRID_WIDTH),Math.floor(-t.y/b.GRID_WIDTH)]},t.prototype.getBoardPosBy=function(t,e){var n=(t+.5)*b.GRID_WIDTH,o=-(e+.5)*b.GRID_WIDTH;return cc.v2(n,o)},t.prototype.isVaildXY=function(t,e){return t>=0&&t<b.MAX_X&&e>=0&&e<b.MAX_Y},t.prototype.loadItems=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,assetsMgr.loadTempRes(t,cc.SpriteFrame)];case 1:return[2,e.sent()]}})})},t.prototype.getRewards=function(t,e){return void 0===e&&(e=!0),o(this,void 0,void 0,function(){var n,o=this;return r(this,function(r){switch(r.label){case 0:return n={rewards:t},t.forEach(function(t){switch(t.id){case b.LITTLE_COIN_ID:case b.COIN_ID:case b.ItemType.MANY_COINS_ID:o.global.addCoin(t.count);break;case b.ROTATE_ID:o.global.addRotate(t.count);break;case b.ItemType.FLASH:o.dig.addFlash(t.count);break;case b.ItemType.Heart:o.global.addHeart(t.count,!0,!0)}}),e?[4,p.viewHelper.showPnl("common/Reward",n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.getCenterBy=function(t){var e=0,n=0;return t.map(function(t){e+=t.x,n+=t.y}),cc.v2(e/t.length,n/t.length)},t.prototype.getLevelRewardBy=function(t){return t%5==0?[{id:b.ItemType.MANY_COINS_ID,count:10*Math.ceil(t/100)+40},{id:b.ItemType.ROTATE_ID,count:1},{id:b.ItemType.FLASH,count:490+5*Math.ceil(t/10)}]:[{id:b.ItemType.MANY_COINS_ID,count:10*Math.ceil(t/100)},{id:b.ItemType.FLASH,count:490+5*Math.ceil(t/10)}]},t.prototype.exchange=function(t,e,n){return!(n>this.global.getCoin()||(this.global.addCoin(-n),this.getRewards([{id:t,count:e}],!0),0))},t}();n.gameHelper=new w,(c.localConfig.isTestServer||c.localConfig.isGm)&&(window.gameHelper=n.gameHelper),cc._RF.pop()},{"../../../../startScene/version":void 0,"../../../core/utils/ResLoader":"ResLoader","../../model/common/ColorShapeObj":"ColorShapeObj","../LocalConfig":"LocalConfig","../constant/Constant":"Constant","../constant/Enums":"Enums","../crypto/CryptoHelper":"CryptoHelper","../event/EventType":"EventType","../event/JsbEvent":"JsbEvent","../facebook/FBInstantHelper":"FBInstantHelper","../net/netMgr":"netMgr","../shareParams/ShareParamsHelper":"ShareParamsHelper","../wx/WxHelper":"WxHelper","./DatabaseHelper":"DatabaseHelper","./ResHelper":"ResHelper","./ViewHelper":"ViewHelper"}],GamePortalAd:[function(t,e,n){"use strict";cc._RF.push(e,"b4ee4tcABRDLpgI+kD5Wdbk","GamePortalAd");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.GamePortalAd=void 0;var i=function(){function t(){this.isReady=!1}return t.prototype.load=function(){return o(this,void 0,void 0,function(){var t,e,n,o;return r(this,function(r){switch(r.label){case 0:if(!ut.isWechatOrQQ()||!wx.createGamePortal||this.ad)return[2];t=(new Date).getTime(),e=wx.createGamePortal({adUnitId:"PBgAA5LEaGYg5c9M"}),lplog.info("initGamePort cost: ",(new Date).getTime()-t),r.label=1;case 1:return r.trys.push([1,3,,4]),n=this,[4,e.load()];case 2:return n.isReady=r.sent(),[3,4];case 3:return o=r.sent(),lplog.error(o),[3,4];case 4:return this.ad=e,[2]}})})},t.prototype.show=function(){return o(this,void 0,Promise,function(){var t;return r(this,function(e){switch(e.label){case 0:if(!this.isReady)return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.ad.show()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),lplog.error(t),[3,4];case 4:return[2,!0];case 5:return[2,!1]}})})},t}();n.GamePortalAd=i,cc._RF.pop()},{}],GameWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"97f71xlIAdA2oggFsJoNo78","GameWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../core/component/MultiFrame"),l=t("../../common/constant/Constant"),u=t("../../common/constant/Enums"),p=t("../../common/event/EventType"),h=t("../../common/helper/AnimHelper"),d=t("../../common/helper/GameHelper"),f=t("../../common/helper/GotoHelper"),y=t("../../common/helper/ResHelper"),_=t("../../common/helper/ViewHelper"),g=t("../cmpt/game/BlockCmpt"),m=t("../cmpt/game/ShapeCmpt"),v=cc._decorator.ccclass,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxLbl_=null,e.comCoinNode_=null,e.countLbl_=null,e.coinNode_=null,e.comTaskNode_=null,e.rankSp_=null,e.scoreLbl_=null,e.holdNode_=null,e.rotateNode_=null,e.rotationSp_=null,e.rotationLbl_=null,e.costNode_=null,e.costLbl_=null,e.gridsNode_=null,e.shadowsNode_=null,e.hintsNode_=null,e.blocksNode_=null,e.shapesNode_=null,e.rotatesNode_=null,e.topShapesNode_=null,e.blockList=[],e.shapeList=[],e.shapeContainers=[],e.shadowList=[],e.hintsList=[],e.holderShapeContainer=null,e.rotateHints_=[],e.moved=!1,e.up=!1,e.tag="GameWindCtrl",e}return r(e,t),e.prototype.eventMaps=function(){var t,e,n,o;return[(t={},t[p.default.UPDATE_SCORE]=this.onUpdateScore,t),(e={},e[p.default.UPDATE_COIN]=this.onUpdateCoin,e),(n={},n[p.default.UPDATE_ROTATE]=this.onUpdateRotate,n),(o={},o[p.default.UPDATE_GUIDE_TASK]=this.refreshComTask,o)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("..................................GameWindCtrl onCreate.................................."),this.initGridAndShadow(),[2]})})},e.prototype.onEnter=function(){cc.log("GameWindCtrl onEnter"),this.initRotate(),this.refreshScore(),this.startGame(),this.initRotateAnim(),this.costLbl_.string=""+l.ROTATE_COST,this.countLbl_.string=this.model.getCoin()},e.prototype.onClean=function(){cc.log("GameWindCtrl onClean"),this.closeRotate(),this.rotateHints_.forEach(function(t){return null==t?void 0:t.destroy()}),this.rotateHints_=[],assetsMgr.releaseTempResByTag("block")},e.prototype.onClickCoin=function(t,e){cc.log("onClickCoin",e),_.viewHelper.showPnl("common/Shop")},e.prototype.onClickRotate=function(t,e){cc.log("onClickRotate",e),0==this.model.getRotation()&&this.model.getCoin()<l.ROTATE_COST?(this.rotationSp_.play("idle"),this.model.getCoin()<l.ROTATE_COST&&_.viewHelper.showPnl("common/Shop")):(this.switchRotate(),audioMgr.playSFX("audio_start_rotate"))},e.prototype.onClickBack=function(){f.gotoHelper.gotoWind("main")},Object.defineProperty(e.prototype,"model",{get:function(){return d.gameHelper.global},enumerable:!1,configurable:!0}),e.prototype.refreshScore=function(){var t=this.scoreLbl_.getComponent(cc.LabelRollNumber);t||(t=this.scoreLbl_.addComponent(cc.LabelRollNumber)),t.set(this.model.getScore()),this.maxLbl_.string=""+this.model.getBestScore()},e.prototype.onUpdateRotate=function(){this.model.getRotation()>0?(this.costNode_.active=!1,this.rotationLbl_.string=""+this.model.getRotation()):(this.costNode_.active=!0,this.rotationLbl_.string=""),this.rotationSp_.play("idle")},e.prototype.onUpdateScore=function(){var t=this.scoreLbl_.getComponent(cc.LabelRollNumber);t||(t=this.scoreLbl_.addComponent(cc.LabelRollNumber)),t.to(this.model.getScore()),this.maxLbl_.string=""+this.model.getBestScore()},e.prototype.onUpdateCoin=function(){this.countLbl_.string=this.model.getCoin()},e.prototype.initGridAndShadow=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(){return t=[],this.gridsNode_.children.map(function(e){t.push(e.getPosition())}),this.shadowsNode_.Items(l.MAX_X*l.MAX_Y,function(n,o,r){n.setPosition(t[r]),n.setActive(!1),e.shadowList[r]=n}),this.hintsNode_.Items(l.MAX_X*l.MAX_Y,function(n,o,r){n.setPosition(t[r]),n.setActive(!1),e.hintsList[r]=n}),[2]})})},e.prototype.switchRotate=function(){var t=this;if("ues"!=this.rotationSp_.animation){if(this.rotationSp_.play("ues"),this.shapeContainers.forEach(function(e,n){if(cc.isValid(e)){var o=t.rotateHints_[n];o&&t.setRotateHintActive(o)}}),this.isHolderTaken()){var e=this.rotateHints_[3];e&&this.setRotateHintActive(e)}}else this.closeRotate()},e.prototype.shapesRotateToZero=function(){this.shapesNode_.children.forEach(function(t){var e=null==t?void 0:t.Child("shape",m.default);e&&e.isRotated()&&e.rotateToZero()})},e.prototype.setRotateHintActive=function(t,e){void 0===e&&(e=!0),t.active=e;var n=t.Child("icon");n&&e&&(cc.Tween.stopAllByTarget(n),n.angle=0,cc.tween(n).by(2,{angle:-180}).repeatForever().start())},e.prototype.hideAllRotateHints=function(){this.rotateHints_.forEach(function(t){t&&cc.isValid(t)&&(t.active=!1)})},e.prototype.closeRotate=function(){this.rotationSp_.play("idle"),this.hideAllRotateHints(),this.shapesRotateToZero()},e.prototype.isRotateUsing=function(){return"ues"==this.rotationSp_.animation},Object.defineProperty(e.prototype,"globalModel",{get:function(){return d.gameHelper.global},enumerable:!1,configurable:!0}),e.prototype.initRotate=function(){this.model.getRotation()>0?(this.costNode_.active=!1,this.rotationLbl_.string=""+this.model.getRotation()):(this.costNode_.active=!0,this.rotationLbl_.string=""),this.rotationSp_.play("idle"),this.rotationSp_.loop=!0},e.prototype.initRotateAnim=function(){var t=this;this.rotatesNode_.children[0]&&(this.rotateHints_.forEach(function(t){return null==t?void 0:t.destroy()}),this.rotateHints_=[],this.rotatesNode_.Items(4,function(e,n,o){var r=e;r.active=!1;var i=l.SHAPE_CONTAINER_POS_LIST[o];r.setPosition(i.x,i.y),r.Child("icon"),t.rotateHints_[o]=r}))},e.prototype.startGame=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return mc.lockTouch(!0),this.model.setRevive(0),this.refreshScore(),this.hideHoldLight(),this.shapesNode_.destroyAllChildren(),this.blocksNode_.cleanAllChildren(),this.initShapeContainers(),this.shapeList.length=0,t=d.gameHelper.global,this.refreshComTask(!1),e=this,[4,t.initBlockList(this.blocksNode_)];case 1:return e.blockList=n.sent(),[4,this.resumeShapes()];case 2:return n.sent(),this.addEvents(),mc.lockTouch(!1),[2]}})})},e.prototype.resumeShapes=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,c,l=this;return s(this,function(s){switch(s.label){case 0:if(t=this.model.getColorShapes(),e=[],t.some(function(t){return!!t})){for(n=0;n<3;++n)(o=t[n])?e.push(this.createShape(o,n)):this.shapeContainers[n]=null;(r=t[3])&&e.push(this.createShape(r,3))}else d.gameHelper.getColorShapes().map(function(t,n){e.push(l.createShape(t,n))});return[4,Promise.all(e)];case 1:return s.sent(),i=this.checkOverOrTip(),a=i.over,c=i.tipHolder,a?[4,this.gameOver()]:[3,3];case 2:s.sent(),s.label=3;case 3:return c?[4,this.showTipHolder()]:[3,5];case 4:s.sent(),s.label=5;case 5:return this.saveShapes(),[2]}})})},e.prototype.createShape=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a;return s(this,function(s){switch(s.label){case 0:return[4,assetsMgr.loadTempRes("shape",cc.Prefab,"block")];case 1:return n=s.sent(),o=3==e?this.holderShapeContainer:this.shapeContainers[e],(r=cc.instantiate2(n,o)).addComponent(m.default).init(t),r.setScale(0),r.Data=e,r.name="shape",i=r.Component(m.default),a=this.checkShapeGray(i),i.setGray(a),[4,new Promise(function(t){cc.tween(r).to(.2,{scale:l.SHAPE_SCALE}).call(t).start()})];case 2:return s.sent(),[2]}})})},e.prototype.saveShapes=function(){for(var t=[],e=0;e<3;++e){var n=this.shapeContainers[e],o=null==n?void 0:n.Child("shape",m.default);t[e]=o?o.soul:null}var r=this.holderShapeContainer.Child("shape",m.default);t[3]=r?r.soul:null,this.model.setShapeList(t)},e.prototype.addEvents=function(){var t=this.shapesNode_;t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){return a(this,void 0,void 0,function(){var e,n,o=this;return s(this,function(r){switch(r.label){case 0:return e=t.getLocation(),d.gameHelper.lastTopTouchTime=d.gameHelper.now(),this.shapeContainer?[2]:(this.shapeContainer=this.findTouchedShapeContainer(e),this.shapeContainer?(this.moved=!1,this.up=!1,(n=this.shapeContainer.Child("shape",m.default))?this.isRotateUsing()?(this.scheduleOnce(function(){return o.goUp(e,n)},.18),[3,3]):[3,1]:(this.shapeContainer=null,[2])):[2]);case 1:return[4,this.goUp(e,n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.findTouchedShapeContainer=function(t){var e=this.shapeContainers.find(function(e){if(e&&e.isValid)return e.convertToWorldSpaceAR(cc.Vec2.ZERO).sub(t).mag()<84});return!e&&this.holderShapeContainer&&this.holdNode_.getBoundingBoxToWorld().contains(t)&&(e=this.holderShapeContainer),e},e.prototype.goUp=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a,c,u=this;return s(this,function(s){switch(s.label){case 0:return!this.shapeContainer||this.moved||this.up?[2]:(this.unscheduleAllCallbacks(),this.up=!0,n=this.shapeContainer.Data,(o=this.rotateHints_[n])&&(o.active=!1),d.gameHelper.changeParent(this.topShapesNode_,this.shapeContainer),r=t.add(cc.v2(0,l.TOUCH_OFFSET_Y)),i=this.topShapesNode_.convertToNodeSpaceAR(r),a=i.x,c=i.y,this.showOnlyPlaceHint(e),[4,new Promise(function(t){var e=u.shapeContainer.Child("shape");e.children.forEach(function(t){cc.tween(t).to(.02,{scale:.8}).start()}),cc.tween(e).to(.02,{scale:1}).call(t).start(),cc.tween(u.shapeContainer).to(.02,{x:a,y:c}).start()})]);case 1:return s.sent(),[2]}})})},e.prototype.onTouchMove=function(t){if(this.shapeContainer){var e=t.getLocation(),n=e.add(cc.v2(0,l.TOUCH_OFFSET_Y));if(!this.up){var o=this.shapeContainer.Child("shape",m.default);if(!o)return;this.goUp(e,o)}this.moved=!0;var r=this.topShapesNode_.convertToNodeSpaceAR(n);this.shapeContainer.setPosition(r),this.hideAllShadow();var i=this.getShapeToBoardXYList(),a=i.xyList,s=i.color,c=this.placeShapeShadow(a,s);this.hideAllSkin(),this.hideHoldLight(),c?(this.checkColSkin(a,s),this.checkRowSkin(a,s)):this.checkCanPlaceToHolder()&&this.showHoldLight()}},e.prototype.onTouchEnd=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,c,l,u;return s(this,function(s){switch(s.label){case 0:return this.shapeContainer?(this.unscheduleAllCallbacks(),mc.lockTouch(!0),t=this.shapeContainer,(e=t.Child("shape",m.default))?!this.isRotateUsing()||this.up||this.moved?[3,2]:(this.shapeContainer=null,[4,e.rotate()]):(mc.lockTouch(!1),[2])):[2];case 1:return s.sent(),n=this.checkShapeGray(e),e.setGray(n),n||h.animHelper.hideWeakGuideFinger(!0),[3,15];case 2:return o=this.checkCanPlaceShapeToBoard()&&this.moved,this.hideAllShadow(),this.hideAllHint(),this.hideHoldLight(),r=e.isRotated(),!o&&this.hideAllSkin(),o?(this.checkConductRotate(r),[4,this.placeShapeToBoard()]):[3,5];case 3:return i=s.sent(),this.closeRotate(),a=this.checkClearBlocks(),this.addScore(i,a),this.checkPlayClearAnim(i,a),this.refreshHolder(),[4,this.checkCreateShapes()];case 4:return s.sent(),[3,10];case 5:return this.checkCanPlaceToHolder()?(h.animHelper.hideWeakGuideFinger(!0),[4,this.putShapeToHolder(this.shapeContainer)]):[3,8];case 6:return s.sent(),[4,this.checkCreateShapes()];case 7:return s.sent(),this.closeRotate(),[3,10];case 8:return[4,this.putBackShapeToContainer(this.shapeContainer)];case 9:s.sent(),s.label=10;case 10:return this.refreshShapes(),this.shapeContainer=null,c=this.checkOverOrTip(),l=c.over,u=c.tipHolder,l?[4,this.gameOver()]:[3,12];case 11:s.sent(),s.label=12;case 12:return u?[4,this.showTipHolder()]:[3,14];case 13:s.sent(),s.label=14;case 14:s.label=15;case 15:return mc.lockTouch(!1),[2]}})})},e.prototype.checkConductRotate=function(t){if(t)if(this.model.getRotation()>0)this.model.addRotate(-1);else{var e=l.ROTATE_COST,n=this.model.getCoin();n>=e&&this.model.setCoin(Math.max(n-e,0))}},e.prototype.gameOver=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(n){switch(n.label){case 0:return audioMgr.playSFX("game_over"),[4,this.playBoardBlocksGrayAnim()];case 1:return n.sent(),d.gameHelper.global.getRevive()>=1?[4,f.gotoHelper.gotoWind("result")]:[3,3];case 2:return n.sent(),this.model.gameover(),[3,5];case 3:return d.gameHelper.global.addRevive(1),t={cb:function(t){return a(e,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return e="game/Revive",eventMgr.emit(mc.Event.CLOSE_PNL,e),_.viewHelper.readyShowPnls.remove(e),t?(mc.lockTouch(!0),audioMgr.playSFX("game_revive"),[4,Promise.all([this.playBoardBlocksColorAnim(),this.createReviveShapes()])]):[3,2];case 1:return n.sent(),mc.lockTouch(!1),[3,4];case 2:return[4,f.gotoHelper.gotoWind("result")];case 3:n.sent(),this.model.gameover(),n.label=4;case 4:return[2]}})})}},[4,_.viewHelper.showPnl("game/Revive",t)];case 4:n.sent(),n.label=5;case 5:return[2]}})})},e.prototype.playBoardBlocksGrayAnim=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r;return s(this,function(i){switch(i.label){case 0:for(t=[],e=0;e<l.MAX_X;++e)for(n=0;n<l.MAX_Y;++n)(o=this.blockList[e][n])&&t.push(o);return r=t.map(function(t){return new Promise(function(e){var n=t.Child("gray");n.active=!0,n.opacity=0;var o=.1*ut.random(4,12);cc.tween(n).delay(o).to(.8,{opacity:255}).call(e).start()})}),[4,Promise.all(r)];case 1:return i.sent(),[2]}})})},e.prototype.playBoardBlocksColorAnim=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r;return s(this,function(i){switch(i.label){case 0:for(t=[],e=0;e<l.MAX_X;++e)for(n=0;n<l.MAX_Y;++n)(o=this.blockList[e][n])&&t.push(o);return r=t.map(function(t){return new Promise(function(e){var n=t.Child("gray");n.active=!0,n.opacity=255,cc.tween(n).delay(.1*ut.random(1,5)).to(.4,{opacity:0}).call(function(){n.active=!1,e(null)}).start()})}),[4,Promise.all(r)];case 1:return i.sent(),[2]}})})},e.prototype.showTipHolder=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r;return s(this,function(i){switch(i.label){case 0:return t=this.node.Child("effect"),e=this.shapeContainers.find(function(t){return cc.isValid(t)}),n=this.holdNode_,o=t.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.Vec2.ZERO)),r=t.convertToNodeSpaceAR(n.convertToWorldSpaceAR(cc.Vec2.ZERO)),[4,h.animHelper.playMoveWeakGuideAni(t,o,r)];case 1:return i.sent(),[2]}})})},e.prototype.addScore=function(t,e){var n,o,r=null!==(n=null==e?void 0:e.combo)&&void 0!==n?n:0,i=null!==(o=l.COMBO_SCORE[r])&&void 0!==o?o:l.COMBO_SCORE.last(),a=t.score+i;r>=2&&this.model.addTaskProgress(u.TaskConditionType.Combo,1),r>=3&&this.model.addTaskProgress(u.TaskConditionType.Lines,1),this.model.addScore(a)},e.prototype.checkOverOrTip=function(){var t=this,e=!1,n=!1,o=this.shapeContainers.filter(function(t){return cc.isValid(t)}),r=o.every(function(e){var n=e.Child("shape",m.default);return t.checkShapeGray(n)});if(this.isHolderTaken()){var i=this.holderShapeContainer.Child("shape",m.default);e=o.length>0&&r&&this.checkShapeGray(i)}else e=o.length>1&&r,n=1==o.length&&r;return{over:e,tipHolder:n}},e.prototype.refreshShapes=function(){var t=this;this.shapesNode_.children.forEach(function(e){var n=null==e?void 0:e.Child("shape",m.default);if(n){var o=t.checkShapeGray(n);n.setGray(o)}})},e.prototype.checkPlayClearAnim=function(t,e){var n,o=e.colClearList,r=e.rowClearList,i=e.fallPosList,a=e.combo,s=t.posList,c=t.color,u=this.node.Child("effect"),p="_game_wind_";o.length>0&&h.animHelper.playLineAnim(o,u,p,c,90),r.length>0&&h.animHelper.playLineAnim(r,u,p,c,0),i.length>0&&h.animHelper.playFallingParticle(i,u,c,p);var f=null!=a?a:0,y=null!==(n=l.COMBO_SCORE[f])&&void 0!==n?n:l.COMBO_SCORE.last(),_=d.gameHelper.getCenterBy(s);if(h.animHelper.playFlutterText([y],u,_,p),2==f?audioMgr.playSFX("good"):3==f?audioMgr.playSFX("great"):f>3&&audioMgr.playSFX("amazing"),f>=1){var g=this.model.addGameCombo(f);audioMgr.playSFX("clear_"+g)}else this.model.clearGameCombo()},e.prototype.putBackShapeToContainer=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c=this;return s(this,function(s){switch(s.label){case 0:return e=l.SHAPE_CONTAINER_POS_LIST[t.Data],n=e.x,o=e.y,r=this.shapeContainer.Child("shape"),[4,new Promise(function(e){cc.tween(c.shapeContainer).to(.032,{x:n},{easing:cc.easing.sineOut}).start(),cc.tween(c.shapeContainer).to(.04,{y:o},{easing:cc.easing.sineInOut}).call(function(){t.setParent(c.shapesNode_),t.setPosition(n,o),e(null)}).start(),cc.tween(r).to(.04,{scale:l.SHAPE_SCALE}).start(),r.children.forEach(function(t){cc.tween(t).to(.04,{scale:1}).start()})})];case 1:return s.sent(),audioMgr.playSFX("drop_back"),i=t.Data,(a=this.rotateHints_[i])&&this.setRotateHintActive(a,this.isRotateUsing()),[2]}})})},e.prototype.isHolderTaken=function(){var t,e=null===(t=this.holderShapeContainer)||void 0===t?void 0:t.Child("shape");return cc.isValid(e)},e.prototype.putShapeToHolder=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c,u=this;return s(this,function(s){switch(s.label){case 0:return e=l.SHAPE_CONTAINER_POS_LIST[3],n=e.x,o=e.y,r=t.Child("shape"),[4,new Promise(function(e){cc.tween(t).to(.032,{x:n},{easing:cc.easing.sineOut}).start(),cc.tween(t).to(.04,{y:o},{easing:cc.easing.sineInOut}).call(function(){t.name="shape_3",t.setParent(u.shapesNode_),t.setPosition(n,o),e(null)}).start(),cc.tween(r).to(.04,{scale:l.SHAPE_SCALE}).start(),r.children.forEach(function(t){cc.tween(t).to(.04,{scale:1}).start()})})];case 1:return s.sent(),(i=r.Component(m.default)).isRotated()&&i.rotateToZero(),audioMgr.playSFX("drop_back"),t.Data<3&&(this.shapeContainers[t.Data]=null),t.Data=3,this.holderShapeContainer=t,a=t.Data,(c=this.rotateHints_[a])&&this.setRotateHintActive(c,this.isRotateUsing()),[2]}})})},e.prototype.hideAllShadow=function(){this.shadowList.forEach(function(t){return t.setActive(!1)})},e.prototype.hideAllHint=function(){this.hintsList.forEach(function(t){return t.setActive(!1)})},e.prototype.hideAllSkin=function(){this.blockList.forEach(function(t){return t.forEach(function(t){return t&&t.Component(g.default).changeSkin(null,!1)})})},e.prototype.hideHoldLight=function(){this.holdNode_.Child("light").setActive(!1)},e.prototype.showHoldLight=function(){this.holdNode_.Child("light").setActive(!0)},e.prototype.checkCanPlaceToHolder=function(){if(this.isHolderTaken())return!1;var t=this.shapeContainer,e=this.holdNode_.getBoundingBoxToWorld();return t.Child("shape").children.some(function(t){var n=t.convertToWorldSpaceAR(cc.Vec2.ZERO);return e.contains(n)})},e.prototype.checkCanPlaceShapeToBoard=function(){var t=this;return this.shapeContainer.Child("shape",m.default).getBlocksXY(this.blocksNode_).every(function(e){var n=e[0],o=e[1];return d.gameHelper.isVaildXY(n,o)&&!t.blockList[n][o]})},e.prototype.getShapeToBoardXYList=function(){var t=this.shapeContainer.Child("shape",m.default),e=t.soul.color;return{xyList:t.getBlocksXY(this.blocksNode_),color:e}},e.prototype.placeShapeShadow=function(t,e){var n=this;return!!t.every(function(t){var e=t[0],o=t[1];return d.gameHelper.isVaildXY(e,o)&&!n.blockList[e][o]})&&(t.map(function(t){var e=t[0];return t[1]*l.MAX_X+e}).forEach(function(t){var o=n.shadowList[t];o.setActive(!0),o.Component(c.default).setFrame(e-1)}),!0)},e.prototype.showOnlyPlaceHint=function(t){var e=this,n=this.getOnlyXYListToPlace(t);this.hideAllHint(),n.length>0&&n.map(function(t){var e=t[0];return t[1]*l.MAX_X+e}).forEach(function(t){var n=e.hintsList[t];n.setActive(!0),n.opacity=255,cc.Tween.stopAllByTarget(n),cc.tween(n).sequence(cc.fadeOut(.5),cc.fadeIn(.5)).repeatForever().start()})},e.prototype.checkColSkin=function(t,e){var n=this,o=[];t.forEach(function(t){var e=t[0];t[1],o.pushNoHas(e)}),o.forEach(function(o){for(var r=!0,i=function(e){var i=n.blockList[o][e];if(!cc.isValid(i)&&!t.find(function(t){var n=t[0],r=t[1];return n===o&&r===e}))return r=!1,"break"},a=0;a<l.MAX_Y&&"break"!==i(a);++a);r&&n.changeColSkin(o,e,r)})},e.prototype.checkRowSkin=function(t,e){var n=this,o=[];t.forEach(function(t){t[0];var e=t[1];o.pushNoHas(e)}),o.forEach(function(o){for(var r=!0,i=function(e){var i=n.blockList[e][o];if(!cc.isValid(i)&&!t.find(function(t){var n=t[0],r=t[1];return n===e&&r===o}))return r=!1,"break"},a=0;a<l.MAX_X&&"break"!==i(a);++a);r&&n.changeRowSkin(o,e,r)})},e.prototype.placeShapeToBoard=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,c=this;return s(this,function(s){switch(s.label){case 0:return t=this.shapeContainer,e=t.Child("shape",m.default),n=e.getColor(),o=e.getBlocksAndXY(this.blocksNode_),r=e.node.childrenCount,i=[],a=this.node.Child("effect"),[4,ut.promiseMap(o,function(t){var e=t.block,n=t.xy;return new Promise(function(t){var o=n[0],r=n[1],s=d.gameHelper.getBoardPosBy(o,r),l=c.blocksNode_.convertToWorldSpaceAR(s),u=a.convertToNodeSpaceAR(l);i.push(u),d.gameHelper.changeParent(c.blocksNode_,e),c.blockList[o][r]=e,cc.tween(e).to(.05,{x:s.x,y:s.y,scale:1}).call(t).start()})})];case 1:return s.sent(),audioMgr.playSFX("drop_down"),this.isValid?(t.Data<3?this.shapeContainers[t.Data]=null:this.holderShapeContainer=null,this.saveBlocks(),t.removeFromParent(),t.destroy(),[2,{score:r,posList:i,color:n}]):[2,{score:r,posList:i,color:n}]}})})},e.prototype.checkCreateShapes=function(){return a(this,void 0,void 0,function(){var t,e,n=this;return s(this,function(o){switch(o.label){case 0:if(!this.shapeContainers.every(function(t){return!cc.isValid(t,!0)}))return[3,2];for(this.refreshShapeContainers(),t=[];t.every(function(t){return n.checkCoordsGray(t.coords)});)t=d.gameHelper.getColorShapes();return e=[],t.forEach(function(t,o){e.push(n.createShape(t,o))}),[4,Promise.all(e)];case 1:o.sent(),o.label=2;case 2:return this.saveShapes(),[2]}})})},e.prototype.changeColSkin=function(t,e,n){for(var o=0;o<l.MAX_Y;++o){var r=this.blockList[t][o];cc.isValid(r)&&r.Component(g.default).changeSkin(e,n)}},e.prototype.changeRowSkin=function(t,e,n){for(var o=0;o<l.MAX_X;++o){var r=this.blockList[o][t];cc.isValid(r)&&r.Component(g.default).changeSkin(e,n)}},e.prototype.checkClearBlocks=function(){for(var t=this,e=[],n=0;n<l.MAX_X;++n)this.checkClearCol(n)&&e.push(n);for(var o=[],r=0;r<l.MAX_Y;++r)this.checkClearRow(r)&&o.push(r);e.forEach(function(e){return t.clearCol(e)}),o.forEach(function(e){return t.clearRow(e)}),this.saveBlocks();for(var i=e.length+o.length,a=[],s=[],c=[],u=this.node.Child("effect"),p=0,h=e;p<h.length;p++){for(n=h[p],r=0;r<l.MAX_Y;++r){var f=d.gameHelper.getBoardPosBy(n,r);a.push(f)}var y=d.gameHelper.getBoardPosBy(n,3.5),_=this.blocksNode_.convertToWorldSpaceAR(y),g=u.convertToNodeSpaceAR(_);s.push(g)}for(var m=0,v=o;m<v.length;m++){r=v[m];var b=function(t){var e=d.gameHelper.getBoardPosBy(t,r);a.find(function(t){return t.equals(e)})||a.push(e)};for(n=0;n<l.MAX_X;++n)b(n);y=d.gameHelper.getBoardPosBy(3.5,r),_=this.blocksNode_.convertToWorldSpaceAR(y),g=u.convertToNodeSpaceAR(_),c.push(g)}return{combo:i,fallPosList:a.map(function(e){var n=t.blocksNode_.convertToWorldSpaceAR(e);return u.convertToNodeSpaceAR(n)}),rowClearList:c,colClearList:s}},e.prototype.checkClearCol=function(t){for(var e=!0,n=0;n<l.MAX_Y;++n){var o=this.blockList[t][n];if(!cc.isValid(o)){e=!1;break}}return e},e.prototype.checkClearRow=function(t){for(var e=!0,n=0;n<l.MAX_X;++n){var o=this.blockList[n][t];if(!cc.isValid(o)){e=!1;break}}return e},e.prototype.clearCol=function(t){for(var e=0;e<l.MAX_Y;++e){var n=this.blockList[t][e];cc.isValid(n)&&n.destroy(),this.blockList[t][e]=null}},e.prototype.clearRow=function(t){for(var e=0;e<l.MAX_X;++e){var n=this.blockList[e][t];cc.isValid(n)&&n.destroy(),this.blockList[e][t]=null}},e.prototype.saveBlocks=function(){for(var t=[],e=0;e<l.MAX_X;++e){for(var n=[],o=0;o<l.MAX_Y;++o){var r=this.blockList[e][o],i=0;r&&(i=r.Component(g.default).soul.color),n.push(i)}t.push(n)}this.model.setGameBlocks(t)},e.prototype.refreshShapeContainers=function(){var t=this;this.shapeContainers=[new cc.Node("shape_0"),new cc.Node("shape_1"),new cc.Node("shape_2")],this.shapeContainers.forEach(function(e,n){e.setContentSize(250),e.Data=n,e.parent=t.shapesNode_,e.setPosition(l.SHAPE_CONTAINER_POS_LIST[n])})},e.prototype.refreshHolder=function(){if(!this.holderShapeContainer){var t=new cc.Node("shape_3");t.setContentSize(250),this.shapesNode_.addChild(t),t.Data=3,t.setPosition(l.SHAPE_CONTAINER_POS_LIST[3]),this.holderShapeContainer=t}},e.prototype.initShapeContainers=function(){this.refreshShapeContainers(),this.refreshHolder()},e.prototype.checkShapeGray=function(t){var e=t.getCoords();return this.checkCoordsGray(e)},e.prototype.checkCoordsGray=function(t){for(var e=this,n=function(n){for(var r=function(r){return o.blockList[n][r]?"continue":t.every(function(t){var o=t[0],i=t[1]+n,a=r-o;return d.gameHelper.isVaildXY(i,a)&&!e.blockList[i][a]})?{value:!1}:void 0},i=0;i<l.MAX_Y;++i){var a=r(i);if("object"==typeof a)return a}},o=this,r=0;r<l.MAX_X;++r){var i=n(r);if("object"==typeof i)return i.value}return!0},e.prototype.getOnlyXYListToPlace=function(t){for(var e=this,n=t.getCoords(),o=[],r=0,i=function(t){for(var i=function(i){if(a.blockList[t][i])return"continue";if(n.every(function(n){var o=n[0],r=n[1]+t,a=i-o;return d.gameHelper.isVaildXY(r,a)&&!e.blockList[r][a]})){if(++r>1)return{value:[]};o=n.map(function(e){var n=e[0];return[e[1]+t,i-n]})}},s=0;s<l.MAX_Y;++s){var c=i(s);if("object"==typeof c)return c}},a=this,s=0;s<l.MAX_X;++s){var c=i(s);if("object"==typeof c)return c.value}return o},e.prototype.refreshComTask=function(t){return void 0===t&&(t=!0),a(this,void 0,void 0,function(){var e,n,o,r,i,a,c,u,p,f;return s(this,function(s){switch(s.label){case 0:return e=this.model.getTaskInfo(),n=assetsMgr.getJsonData("QuestConfig",e.id),o=Math.min(e.progress,e.count)+"/"+e.count,this.comTaskNode_.Child("desc",cc.LocaleLabel).setLangKey(n.desc,o),r=ut.stringToNumbers(n.reward,"="),i=r[0],a=r[1],i==l.COIN_ID?y.resHelper.loadTempIcon(this.comTaskNode_,"1001",this.tag):y.resHelper.loadTempIcon(this.comTaskNode_,""+i,this.tag),this.comTaskNode_.Child("val",cc.Label).string=""+a,c=this.comTaskNode_.Child("progress/bar",cc.Sprite),t?[4,new Promise(function(t){cc.tween(c).to(.2,{fillRange:e.progress/e.count}).call(t).start()})]:[3,2];case 1:return s.sent(),[3,3];case 2:c.fillRange=e.progress/e.count,s.label=3;case 3:return e.progress>=e.count&&e.count>0&&(u=[{id:i,count:a}],d.gameHelper.getRewards(u,!1),e.setGot(!0),p=this.comTaskNode_.Child("icon"),f=this.comTaskNode_.Child("grow"),cc.tween(f).then(cc.fadeTo(.5,100)).then(cc.fadeTo(.5,0)).start(),i==l.COIN_ID?h.animHelper.playClickFlyMoney(p,5,""+i,this.coinNode_,this.node):i==l.ROTATE_ID&&h.animHelper.playFlyRotate(p,1,""+i,this.rotateNode_,this.node),this.model.newTask(),c.fillRange=0,this.refreshComTask(!1)),[2]}})})},e.prototype.createReviveShapes=function(){return a(this,void 0,void 0,function(){var t,e,n=this;return s(this,function(o){switch(o.label){case 0:return this.shapesNode_.children.map(function(t){3!=t.Data&&t.removeFromParent(!0)}),this.shapeContainers.forEach(function(t){return null==t?void 0:t.destroy()}),this.shapeContainers=[],this.refreshShapeContainers(),t=d.gameHelper.getReviveShapes(),e=[],t.forEach(function(t,o){e.push(n.createShape(t,o))}),[4,Promise.all(e)];case 1:return o.sent(),this.saveShapes(),[2]}})})},i([ut.addLock],e.prototype,"onTouchStart",null),i([ut.addLock],e.prototype,"onTouchEnd",null),i([ut.addLock],e.prototype,"putBackShapeToContainer",null),i([ut.addLock],e.prototype,"putShapeToHolder",null),i([v],e)}(mc.BaseWindCtrl);n.default=b,cc._RF.pop()},{"../../../core/component/MultiFrame":"MultiFrame","../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/AnimHelper":"AnimHelper","../../common/helper/GameHelper":"GameHelper","../../common/helper/GotoHelper":"GotoHelper","../../common/helper/ResHelper":"ResHelper","../../common/helper/ViewHelper":"ViewHelper","../cmpt/game/BlockCmpt":"BlockCmpt","../cmpt/game/ShapeCmpt":"ShapeCmpt"}],GemShapeCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"3aab3zHOu9M17Tt2n2+FvQB","GemShapeCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../common/constant/Constant"),s=t("../../../common/constant/Enums"),c=t("../../../common/helper/GameHelper"),l=t("../../../model/common/BlockObj"),u=t("./BlockCmpt"),p=t("./ShapeCmpt"),h=cc._decorator,d=h.ccclass,f=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.soul=t;var e=this.getCoords();this.node.angle=0;var n=t.gemType,o=Math.random()>.2,r=t.add&&o,i=t.add&&!o,p=new Array(e.length).fill(t.color);r&&(p[0]=n),i&&(p[1]=s.ColorType.DreamGem),p.sort(function(){return Math.random()-.5}),this.node.Items(e,function(t,e,n){var o=e[0],r=e[1]*a.GRID_WIDTH,i=o*a.GRID_WIDTH;t.setPosition(r,i);var s=p[n],c=(new l.default).init(s,e),h=t.getComponent(u.default);h||(h=t.addComponent(u.default)),h.init(c).initView()}),c.gameHelper.resizeParentToFitChildren(this.node)},i([d],e)}(p.default));n.default=f,cc._RF.pop()},{"../../../common/constant/Constant":"Constant","../../../common/constant/Enums":"Enums","../../../common/helper/GameHelper":"GameHelper","../../../model/common/BlockObj":"BlockObj","./BlockCmpt":"BlockCmpt","./ShapeCmpt":"ShapeCmpt"}],GlobalAppPayHelper:[function(t,e,n){"use strict";cc._RF.push(e,"3bb25G4Dh9OapFz3sTS+7tI","GlobalAppPayHelper");this&&this.__awaiter,this&&this.__generator;Object.defineProperty(n,"__esModule",{value:!0});t("../event/JsbEvent");cc._RF.pop()},{"../event/JsbEvent":"JsbEvent"}],GlobalModel:[function(t,e,n){"use strict";cc._RF.push(e,"9d2ddamH8BHqIh9ESv4zJb0","GlobalModel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Enums"),l=t("../../common/event/EventType"),u=t("../../../core/utils/EncValue"),p=t("../../common/helper/DatabaseHelper"),h=t("../../common/helper/GameHelper"),d=t("../../common/constant/Constant"),f=t("../../common/apple/AppleHelper"),y=t("./ColorShapeObj"),_=t("../task/TaskConditionObj"),g=t("./BlockObj"),m=t("../../view/cmpt/game/BlockCmpt"),v=t("../../common/wx/WxHelper"),b=t("../../common/helper/ReddotHelper"),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.version="",e.coin=new u.default(0),e.rotation=new u.default(2),e.heart=new u.default(0),e.leaves=new u.default(0),e.lastRecoverHeartTime=0,e.topLayoutHeight=0,e.isHideMainUI=!1,e.isEditFurnShowGrid=!1,e.isEditFurnShowFrun=!0,e.accTotalBiscuits=new u.default(0),e.accTotalCandies=new u.default(0),e.accTotalAdCount=new u.default(0),e.accActTotalAdCount=new u.default(0),e.shareUses=[],e.checkPraiseCount=0,e.triggerPraiseCount=1,e.tempHeart=0,e.tempInviteInfos=[],e.showAdAuthTip=!1,e.HEART_REPORT_NUMS=[5,10,20,40,100,250,500,1e3,2500,5e3,1e4],e.HEART_REPORT_MAX=e.HEART_REPORT_NUMS.last(),e.lastDailyGetTime=0,e.gotDay=0,e.lastLoginTime=0,e.level=0,e.isNewUser=!0,e.task=null,e.firstEnterMain=!1,e.gameCombo=0,e.levelCombo=0,e.blockList="",e.shapeList=[],e.score=0,e.revive=0,e.bestScore=0,e.todayWatchShopAD=0,e.todaySpin=0,e}return r(e,t),e.prototype.newTask=function(){var t=assetsMgr.getJson("QuestConfig").datas.random();this.task=(new _.default).init(t.id)},e.prototype.getTaskInfo=function(){if(!this.task||this.task.got){var t=assetsMgr.getJson("QuestConfig").datas.random();this.task=(new _.default).init(t.id)}return this.task},e.prototype.checkComboTaskProgress=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=0);var n=this.task.id,o=assetsMgr.getJsonData("QuestConfig",n);1==(null==o?void 0:o.type)&&(t?this.task.progress=0:this.task.progress+=e,eventMgr.emit(l.default.UPDATE_GUIDE_TASK))},e.prototype.addTaskProgress=function(t,e){this.task&&t==this.task.type&&(this.task.progress+=e,eventMgr.emit(l.default.UPDATE_GUIDE_TASK))},e.prototype.setLastDailyGetTime=function(t){this.lastDailyGetTime=t},e.prototype.getLastDailyGetTime=function(){var t;return null!==(t=this.lastDailyGetTime)&&void 0!==t?t:0},e.prototype.setGotDay=function(t){this.gotDay=t},e.prototype.getGotDay=function(){return this.gotDay},e.prototype.getStartOfDayTimestamp=function(t){var e=new Date(t);return e.setHours(0,0,0,0),e.getTime()},e.prototype.getDailyRewardState=function(t){return t<=this.getGotDay()?c.DailyRewardState.Got:t==this.getGotDay()+1?this.getStartOfDayTimestamp(Date.now())==this.getStartOfDayTimestamp(this.getLastDailyGetTime())?c.DailyRewardState.Lock:c.DailyRewardState.canGet:c.DailyRewardState.Lock},e.prototype.getCheckRedDot=function(){var t=this;return[1,2,3,4,5,6,7].some(function(e){return t.getDailyRewardState(e)==c.DailyRewardState.canGet})},e.prototype.getSpinRedDot=function(){return this.getTodayLeftSpin()>0},e.prototype.setDaily=function(t){this.setLastDailyGetTime(Date.now()),this.setGotDay(t)},e.prototype.checkClearDailyData=function(){var t=this.getGotDay(),e=this.getStartOfDayTimestamp(Date.now()),n=this.getStartOfDayTimestamp(this.getLastDailyGetTime());7==t&&e>n&&(this.setLastDailyGetTime(0),this.setGotDay(0))},e.prototype.checkClearTodayData=function(){this.getStartOfDayTimestamp(Date.now())>this.getStartOfDayTimestamp(this.lastLoginTime)&&(this.todayWatchShopAD=0,this.todaySpin=0,this.lastLoginTime=Date.now(),b.reddotHelper.check("check"),b.reddotHelper.check("spin"),eventMgr.emit(l.default.UPDATE_DAILY_FREE))},e.prototype.onCreate=function(){},e.prototype.init=function(){var t,e,n,o,r,i,a,s,c,l,u,h,d,f,g=p.dbHelper.register("global",2,this.toDB,this,Object.keys(this.toDB()))||{};this.version=g.version||"",this.coin.value=Math.floor(g.coin||0),this.leaves.value=Math.floor(g.leaves||0),this.tempHeart=this.heart.value=Math.floor(g.heart||0),this.rotation.value=Math.floor(g.rotation||0),this.shapeList=null!==(e=null===(t=null==g?void 0:g.shapeList)||void 0===t?void 0:t.map(function(t){return t&&(new y.default).fromDB(t)}))&&void 0!==e?e:[],this.blockList=null!==(n=g.blockList)&&void 0!==n?n:"",this.score=null!==(o=g.score)&&void 0!==o?o:0,this.bestScore=null!==(r=g.bestScore)&&void 0!==r?r:0,this.todayWatchShopAD=null!==(i=g.todayWatchShopAD)&&void 0!==i?i:0,this.todaySpin=null!==(a=g.todaySpin)&&void 0!==a?a:0,this.lastDailyGetTime=null!==(s=g.lastDailyGetTime)&&void 0!==s?s:0,this.lastRecoverHeartTime=null!==(c=g.lastRecoverHeartTime)&&void 0!==c?c:Date.now(),this.lastLoginTime=null!==(l=g.lastLoginTime)&&void 0!==l?l:0,this.gotDay=null!==(u=g.gotDay)&&void 0!==u?u:0,this.level=null!==(h=g.level)&&void 0!==h?h:1,this.isNewUser=null===(d=g.isNewUser)||void 0===d||d,this.gameCombo=null!==(f=g.gameCombo)&&void 0!==f?f:0,g.task?this.task=(new _.default).fromDB(g.task):this.newTask(),this.isNewUser&&(this.tempHeart=this.heart.value=5,this.setRotate(1),this.setCoin(200),this.lastRecoverHeartTime=Date.now(),this.isNewUser=!1),this.checkClearDailyData(),this.checkClearTodayData(),b.reddotHelper.register("check",this.getCheckRedDot,this),b.reddotHelper.register("spin",this.getSpinRedDot,this)},e.prototype.toDB=function(){var t,e;return{version:this.version,coin:this.coin.value,leaves:this.leaves.value,heart:this.heart.value,rotation:this.rotation.value,shapeList:null===(t=this.shapeList)||void 0===t?void 0:t.map(function(t){return null==t?void 0:t.toDB()}),blockList:this.blockList,score:this.score,bestScore:this.bestScore,lastDailyGetTime:this.lastDailyGetTime,gotDay:this.gotDay,task:null===(e=this.task)||void 0===e?void 0:e.toDB(),todayWatchShopAD:this.todayWatchShopAD,lastLoginTime:this.lastLoginTime,level:this.level,lastRecoverHeartTime:this.lastRecoverHeartTime,isNewUser:this.isNewUser,todaySpin:this.todaySpin,gameCombo:this.gameCombo}},e.prototype.addGameCombo=function(t){return this.gameCombo=Math.min(t+this.gameCombo,10),Math.max(this.gameCombo,1)},e.prototype.addLevelCombo=function(t){return this.levelCombo=Math.min(t+this.levelCombo,10),Math.max(this.levelCombo,1)},e.prototype.clearGameCombo=function(){return this.gameCombo=0,Math.max(this.gameCombo,1)},e.prototype.clearLevelCombo=function(){return this.levelCombo=0,Math.max(this.levelCombo,1)},e.prototype.getRotation=function(){return this.rotation.value},e.prototype.setRotate=function(t,e){void 0===e&&(e=!0),isNaN(t)||void 0===t||(t=Math.floor(t),this.rotation.value=Math.max(t,0),e&&this.emit(l.default.UPDATE_ROTATE))},e.prototype.addRotate=function(t){this.setRotate(this.rotation.value+t)},e.prototype.setScore=function(t,e){if(void 0===e&&(e=!0),!isNaN(t)&&void 0!==t){var n=Math.floor(t-this.score);this.score=Math.floor(t),this.setBestScore(t,e),e&&this.emit(l.default.UPDATE_SCORE,n)}},e.prototype.setBestScore=function(t,e){if(void 0===e&&(e=!0),!isNaN(t)&&void 0!==t){var n=Math.floor(t-this.bestScore);(t=Math.floor(t))>this.bestScore&&(this.bestScore=t,ut.isWechatGame()&&v.wxHelper.uploadScoce(t),e&&this.emit(l.default.UPDATE_BEST_SCORE,n))}},e.prototype.getBestScore=function(){return this.bestScore},e.prototype.addScore=function(t,e){void 0===e&&(e=!0),this.setScore(this.score+t,e),this.addTaskProgress(c.TaskConditionType.Score,t)},e.prototype.getScore=function(){return this.score},e.prototype.setRevive=function(t,e){void 0===e&&(e=!0),isNaN(t)||void 0===t||(Math.floor(t-this.revive),t=Math.floor(t),this.revive=t)},e.prototype.addRevive=function(t){this.setRevive(this.revive+t)},e.prototype.addLevel=function(){this.level+=1},e.prototype.setLevel=function(t){this.level=t},e.prototype.getLevel=function(){return this.level},e.prototype.getRevive=function(){return this.revive},e.prototype.useRotation=function(t){var e=this.rotation.value;return e>=t&&(this.rotation.value=e-t),this.rotation.value},e.prototype.getTodayLeftAD=function(){return Math.max(10-this.todayWatchShopAD,0)},e.prototype.addTodayAD=function(t){void 0===t&&(t=!0),this.todayWatchShopAD+=1,t&&eventMgr.emit(l.default.UPDATE_DAILY_FREE)},e.prototype.getTodayLeftSpin=function(){return Math.max(6-this.todaySpin,0)},e.prototype.addSpin=function(t){void 0===t&&(t=!0),this.todaySpin+=1,b.reddotHelper.check("spin"),t&&eventMgr.emit(l.default.UPDATE_SPIN)},e.prototype.setGameBlocks=function(t){var e=t.map(function(t){return t.join(",")}).join(",");this.blockList=e},e.prototype.gameover=function(){this.newTask(),this.setShapeList([]),this.setScore(0,!1),this.setGameBlocks([]),this.gameCombo=0},e.prototype.getBlockDataList=function(){for(var t=[],e=0;e<d.MAX_X;++e){for(var n=[],o=0;o<d.MAX_Y;++o){var r=ut.xyToIndex(e,o),i=this.blockList[r],a=i?Number(i):0;n.push(a)}t.push(n)}return t},e.prototype.initBlockList=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c,l,u,p,f,y,_;return s(this,function(s){switch(s.label){case 0:return e=[],[4,assetsMgr.loadTempRes("block",cc.Prefab,"block")];case 1:for(n=s.sent(),o=this.blockList.replaceAll(",",""),r=0;r<d.MAX_X;++r){for(i=[],a=0;a<d.MAX_Y;++a)c=r*d.MAX_Y+a,l=o.charAt(c),(u=Number(l))>0?(p=cc.instantiate2(n,t),f=h.gameHelper.getBoardPosBy(r,a),p.setPosition(f),y=(new g.default).init(u,[a,r]),(_=p.getComponent(m.default))||(_=p.addComponent(m.default)),_.init(y).initView(),i.push(p)):i.push(null);e.push(i)}return[2,e]}})})},e.prototype.setShapeList=function(t){this.shapeList=t},e.prototype.getColorShapes=function(){return this.shapeList},e.prototype.getTempHeart=function(){return this.tempHeart},e.prototype.getCoin=function(){return this.coin.value},e.prototype.setCoin=function(t,e){if(void 0===e&&(e=!0),!isNaN(t)&&void 0!==t){var n=Math.floor(t-this.coin.value);this.coin.value=Math.floor(t),e&&this.emit(l.default.UPDATE_COIN,n)}},e.prototype.addCoin=function(t,e){void 0===e&&(e=!0),this.setCoin(this.coin.value+t,e)},e.prototype.getHeart=function(){return this.heart.value},e.prototype.setHeart=function(t,e){if(void 0===e&&(e=!0),!isNaN(t)&&void 0!==t){var n=Math.floor(t-this.heart.value);this.tempHeart=this.heart.value=Math.max(Math.floor(t),0),this.emit(l.default.EVENT_HEART_CHANGE,this.heart.value),e&&this.emit(l.default.UPDATE_HEART,n)}},e.prototype.getTopLayoutHeight=function(){return this.topLayoutHeight},e.prototype.addTopLayoutHeight=function(t){var e=cc.misc.clampf(this.topLayoutHeight+t,-d.MAX_LAYOUT_HEIGHT,d.MAX_LAYOUT_HEIGHT);return this.topLayoutHeight!==e&&(this.topLayoutHeight=e,this.emit(l.default.UPDATE_LAYOUT_HEIGHT,this.topLayoutHeight)),this.topLayoutHeight},e.prototype.setHideMainUI=function(t){this.isHideMainUI=t},e.prototype.getHideMainUI=function(){return this.isHideMainUI},e.prototype.getIsEditFurnShowGrid=function(){return this.isEditFurnShowGrid},e.prototype.setIsEditFurnShowGrid=function(t){this.isEditFurnShowGrid=t},e.prototype.getIsEditFurnShowFrun=function(){return this.isEditFurnShowFrun},e.prototype.setIsEditFurnShowFrun=function(t){this.isEditFurnShowFrun=t},e.prototype.changeLeaves=function(t,e){return void 0===e&&(e=!0),t<0&&this.leaves.value+t<0?-1:(this.setCoin(this.leaves.value+t,e),this.leaves)},e.prototype.addHeart=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),!n&&this.heart.value+t>5&&(t=5-this.heart.value),this.setHeart(this.heart.value+t,e)},e.prototype.addLeaves=function(t,e){void 0===e&&(e=!0),this.setCoin(this.leaves.value+t,e)},e.prototype.isCanTriggerPraise=function(){return!ut.isWechatOrQQ()&&this.checkPraiseCount<3&&this.triggerPraiseCount>0},e.prototype.setCheckPraiseCount=function(t){this.checkPraiseCount=t},e.prototype.checktriggerPraiseTaost=function(){if(!this.isCanTriggerPraise())return!1;if(ut.chance(75))return!1;if(h.gameHelper.isInland()&&h.gameHelper.appChannel==c.ChannelType.DY)return!1;if(ut.isFBInstant())return!1;var t=this.getHeart();if(this.checkPraiseCount<1&&t>=50);else if(this.checkPraiseCount<2&&t>=300);else if(!(this.checkPraiseCount<3&&t>=1e3))return!1;return this.checkPraiseCount+=1,this.triggerPraiseCount-=1,!0},e.prototype.isCanTriggerAuthTip=function(){return!(this.showAdAuthTip||!cc.sys.isNative||!ut.isIos()||this.getHeart()<=40||(2!==f.appleHelper.isAttceptAtt()||"1"!==storageMgr.getOrgItem("__@showAdAuth1"))&&(this.setShowAdAuthTip(),1))},e.prototype.setShowAdAuthTip=function(){this.showAdAuthTip=!0,storageMgr.setOrgItem("__@showAdAuth2","1")},e.prototype.initShowAdAuthTip=function(){this.showAdAuthTip="1"===storageMgr.getOrgItem("__@showAdAuth2")||"1"!==storageMgr.getOrgItem("__@showAdAuth1")},e.prototype.getShareUses=function(){return this.shareUses},e.prototype.getNextHeartTime=function(){return this.lastRecoverHeartTime+9e5},e.prototype.isFull=function(){return this.getHeart()>=5},e.prototype.costHeart=function(){return this.getHeart()>0&&(this.addHeart(-1),this.lastRecoverHeartTime=Date.now(),!0)},e.prototype.update=function(){if(!(this.getHeart()>=5)){var t=Math.max(Date.now()-this.lastRecoverHeartTime,0),e=Math.floor(t/9e5);e>0&&(this.lastRecoverHeartTime=Date.now(),this.addHeart(e,!0))}},i([mc.addmodel("global")],e)}(mc.BaseModel);n.default=w,cc._RF.pop()},{"../../../core/utils/EncValue":"EncValue","../../common/apple/AppleHelper":"AppleHelper","../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/DatabaseHelper":"DatabaseHelper","../../common/helper/GameHelper":"GameHelper","../../common/helper/ReddotHelper":"ReddotHelper","../../common/wx/WxHelper":"WxHelper","../../view/cmpt/game/BlockCmpt":"BlockCmpt","../task/TaskConditionObj":"TaskConditionObj","./BlockObj":"BlockObj","./ColorShapeObj":"ColorShapeObj"}],GoogleHelper:[function(t,e,n){"use strict";cc._RF.push(e,"0af8eC2PsRGT4rroKMQN4w8","GoogleHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.googleHelper=void 0;var i=t("../event/JsbEvent"),a=function(){function t(){}return t.prototype.login=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return[4,jsbHelper.call(i.default.GOOGLE_LOGIN)];case 1:return(t=e.sent()).error?[2,{errcode:t.code||-10086,msg:t.message}]:[2,{userId:t.userId,avatarUrl:t.photoUrl,nickName:t.nickName}]}})})},t}();n.googleHelper=new a,cc._RF.pop()},{"../event/JsbEvent":"JsbEvent"}],GotoHelper:[function(t,e,n){"use strict";cc._RF.push(e,"1f7a7y8oLBIx42f/wdgZ1dg","GotoHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.gotoHelper=void 0;var i=t("./ViewHelper"),a=function(){function t(){}return t.prototype.gotoWind=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return eventMgr.emit(mc.Event.LOAD_BEGIN_WIND),[4,i.viewHelper.preloadWind(t)];case 1:return e.sent(),eventMgr.emit(mc.Event.LOAD_END_WIND),eventMgr.emit(mc.Event.GOTO_WIND,t),[2]}})})},t}();n.gotoHelper=new a,cc.sys.isBrowser&&(window.gotoHelper=n.gotoHelper),cc._RF.pop()},{"./ViewHelper":"ViewHelper"}],GridAd:[function(t,e,n){"use strict";cc._RF.push(e,"d65d7arA1RGlp7mJF1CeFBx","GridAd"),Object.defineProperty(n,"__esModule",{value:!0}),n.WxCustomerAd=n.WxGridAd=void 0;var o,r=t("../constant/Enums"),i=t("../wx/WxHelper");(function(t){t[t.BANNER=0]="BANNER",t[t.GAME_BANNER=1]="GAME_BANNER",t[t.GRID_BANNER=2]="GRID_BANNER"})(o||(o={}));var a=function(){function t(){this.bannerAdMap={},this._adList=null}return Object.defineProperty(t.prototype,"adList",{get:function(){return this._adList||("undefined"!=typeof qq?this._adList=[]:this._adList=[{id:"adunit-b35911ad12b9a367",type:o.GRID_BANNER}]),this._adList},enumerable:!1,configurable:!0}),t.prototype.load=function(t){for(var e=0,n=this.adList;e<n.length;e++){var r=n[e],i=r.id,a=r.type;this.bannerAdMap[i]?this.updateAdInfo(i,t):a==o.BANNER?this.loadBannerAd(i):a==o.GRID_BANNER&&this.loadGridAd(i)}},t.prototype.loadBannerAd=function(t){var e=wx.createBannerAd({adUnitId:t,style:this.getStyle(),adIntervals:60}),n={type:o.BANNER,hide:!0,state:r.AdState.LOADING,showTime:0,reloadDelay:ut.random(30,60),adIns:e,lock:!1};this.bannerAdMap[t]=n,this.initListener(n,t)},t.prototype.initListener=function(t,e){var n=t.adIns;n.onError(function(n){lplog.error("loadBanner error",e,n),t.state=r.AdState.LOAD_FAIL,n&&("no Banner"==n.errMsg||0==n.errCode||1004==n.errCode?t.reloadDelay+=120:t.reloadDelay+=60)}),n.onLoad(function(){t.state=r.AdState.LOAD_SUCCESS})},t.prototype.loadGridAd=function(t){var e=wx.createCustomAd({adUnitId:t,style:this.getStyle()}),n={type:o.GRID_BANNER,hide:!0,state:r.AdState.LOADING,showTime:0,reloadDelay:ut.random(30,60),adIns:e,lock:!1};this.bannerAdMap[t]=n,this.initListener(n,t)},t.prototype.updateAdInfo=function(t,e){var n=this.bannerAdMap[t];if(n.state!=r.AdState.LOADING&&!n.lock)return n.hide?void(n.state==r.AdState.LOAD_FAIL&&(n.reloadDelay-=e,n.reloadDelay<=0&&this.destroy(t))):(n.showTime+=e,void(n.showTime>90&&this.hide(t)))},t.prototype.randomAd=function(){var t=this,e=this.adList.filter(function(e){var n=e.id,o=t.bannerAdMap[n];return o&&!o.lock&&o.state==r.AdState.LOAD_SUCCESS});if(!(e.length<=0))return e[ut.random(0,e.length-1)]},t.prototype.isShow=function(){for(var t in this.bannerAdMap)if(0==this.bannerAdMap[t].hide)return!0;return!1},t.prototype.show=function(){var t=this;if(!this.isShow()){var e=this.randomAd();if(e){var n=e.id,o=this.bannerAdMap[n];o.lock=!0,o.hide=!1,o.adIns.show().then(function(){o.lock=null,o.hide&&t.hide(n)}).catch(function(t){lplog.error("showGrid error",n,t),o.lock=null,o.hide=!0})}}},t.prototype.hide=function(t){var e=this.bannerAdMap[t];if(e&&!e.lock&&!e.hide&&e.state==r.AdState.LOAD_SUCCESS){var n=function(){e.showTime=0,e.hide=!0,e.lock=null};e.lock=!0;var o=e.adIns.hide();o?o.then(function(){n()}).catch(function(n){lplog.error("hideGrid error",t,n),e.lock=null}):n()}},t.prototype.hideAll=function(){for(var t in this.bannerAdMap)this.hide(t)},t.prototype.destroy=function(t){try{var e=this.bannerAdMap[t];e&&e.adIns&&e.adIns.destroy(),delete this.bannerAdMap[t]}catch(n){lplog.error("destoryBanner error",t,n)}},t.prototype.getResSize=function(){return cc.size(400,180)},t.prototype.getStyle=function(){var t=i.wxHelper.getSystemInfo(),e=t.screenWidth,n=t.screenHeight,o=180/Math.min(cc.winSize.width/e,cc.winSize.height/n),r=this.getResSize(),a=r.width,s=r.height,c=cc.misc.clampf(o/s*a,300,e);return{left:(e-c)/2,top:n-(o=c/a*s)-12,width:c,height:o}},t.prototype.getBoundary=function(){var t=i.wxHelper.getSystemInfo(),e=t.screenWidth,n=t.screenHeight,o=Math.min(cc.winSize.width/e,cc.winSize.height/n),r=this.getStyle();return cc.rect(r.left*o,(n-r.top-r.height)*o,r.width*o,r.height*o)},t}();n.WxGridAd=a;var s=function(){function t(){this.bannerAdMap={},this._adList=null}return Object.defineProperty(t.prototype,"adList",{get:function(){return this._adList||("undefined"!=typeof qq?this._adList=[]:this._adList=[{id:"adunit-6a5f9c3bd59c8c1d",type:o.GRID_BANNER},{id:"adunit-9af7b76a13b6574f",type:o.GRID_BANNER}]),this._adList},enumerable:!1,configurable:!0}),t.prototype.load=function(t){for(var e=0,n=this.adList;e<n.length;e++){var r=n[e],i=r.id,a=r.type;this.bannerAdMap[i]?this.updateAdInfo(i,t):a==o.BANNER?this.loadBannerAd(i):a==o.GRID_BANNER&&this.loadGridAd(i)}},t.prototype.loadBannerAd=function(t){var e=wx.createBannerAd({adUnitId:t,style:this.getStyle(),adIntervals:60}),n={type:o.BANNER,hide:!0,state:r.AdState.LOADING,showTime:0,reloadDelay:ut.random(30,60),adIns:e,lock:!1};this.bannerAdMap[t]=n,this.initListener(n,t)},t.prototype.initListener=function(t,e){var n=t.adIns;n.onError(function(n){lplog.error("loadBanner error",e,n),t.state=r.AdState.LOAD_FAIL,n&&("no Banner"==n.errMsg||0==n.errCode||1004==n.errCode?t.reloadDelay+=120:t.reloadDelay+=60)}),n.onLoad(function(){t.state=r.AdState.LOAD_SUCCESS}),n.onResize(function(t,e){console.log("customer ad width",t,e)})},t.prototype.loadGridAd=function(t){var e=wx.createCustomAd({adUnitId:t,style:this.getStyle()}),n={type:o.GRID_BANNER,hide:!0,state:r.AdState.LOADING,showTime:0,reloadDelay:ut.random(30,60),adIns:e,lock:!1};this.bannerAdMap[t]=n,this.initListener(n,t)},t.prototype.updateAdInfo=function(t,e){var n=this.bannerAdMap[t];if(n.state!=r.AdState.LOADING&&!n.lock)return n.hide?void(n.state==r.AdState.LOAD_FAIL&&(n.reloadDelay-=e,n.reloadDelay<=0&&this.destroy(t))):(n.showTime+=e,void(n.showTime>90&&this.hide(t)))},t.prototype.randomAd=function(){var t=this,e=this.adList.filter(function(e){var n=e.id,o=t.bannerAdMap[n];return o&&!o.lock&&o.state==r.AdState.LOAD_SUCCESS});if(!(e.length<=0))return e[ut.random(0,e.length-1)]},t.prototype.isShow=function(){for(var t in this.bannerAdMap)if(0==this.bannerAdMap[t].hide)return!0;return!1},t.prototype.show=function(){var t=this;if(!this.isShow()){var e=this.randomAd();if(e){var n=e.id,o=this.bannerAdMap[n];o.lock=!0,o.hide=!1,o.adIns.show().then(function(){o.lock=null,o.hide&&t.hide(n)}).catch(function(t){console.error("show custome error",n,t),o.lock=null,o.hide=!0})}}},t.prototype.hide=function(t){var e=this.bannerAdMap[t];if(e&&!e.lock&&!e.hide&&e.state==r.AdState.LOAD_SUCCESS){var n=function(){e.showTime=0,e.hide=!0,e.lock=null};e.lock=!0;var o=e.adIns.hide();o?o.then(function(){n()}).catch(function(n){console.error("hide custome ad error",t,n),e.lock=null}):n()}},t.prototype.hideAll=function(){for(var t in this.bannerAdMap)this.hide(t)},t.prototype.destroy=function(t){try{var e=this.bannerAdMap[t];e&&e.adIns&&e.adIns.destroy(),delete this.bannerAdMap[t]}catch(n){console.error("destoryBanner error",t,n)}},t.prototype.getResSize=function(){return cc.size(600,334)},t.prototype.getStyle=function(){var t=i.wxHelper.getSystemInfo(),e=t.screenWidth,n=t.screenHeight,o=400/Math.min(cc.winSize.width/e,cc.winSize.height/n),r=this.getResSize(),a=r.width,s=r.height,c=cc.misc.clampf(o/s*a,300,e);return{left:(e-c)/2,top:20,width:c,height:o=c/a*s}},t.prototype.getBoundary=function(){var t=i.wxHelper.getSystemInfo(),e=t.screenWidth,n=t.screenHeight,o=Math.min(cc.winSize.width/e,cc.winSize.height/n),r=this.getStyle();return cc.rect(r.left*o,(n-r.top-r.height)*o,r.width*o,r.height*o)},t}();n.WxCustomerAd=s,cc._RF.pop()},{"../constant/Enums":"Enums","../wx/WxHelper":"WxHelper"}],GuidePnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"c9bcfSZKIxM+4x+1Z+eYieR","GuidePnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../scene/CameraCtrl"),l=t("../../common/constant/Enums"),u=t("../../common/event/EventType"),p=t("../../common/helper/ViewHelper"),h=t("../../common/constant/Constant"),d=t("../../common/helper/GameHelper"),f=cc._decorator.ccclass,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.darkScreenNode_=null,e.skyNode_=null,e.flutterNode_=null,e.maskNode_=null,e.bgNode_=null,e.boxNode_=null,e.descNode_=null,e.descLbl_=null,e.fingerNode_=null,e.touchNode_=null,e.skipNode_=null,e.model=null,e.curNode=null,e.clickCb=null,e.canSwallow=!1,e.fingerAngle=0,e.fingerX=0,e.fingerY=0,e.showFinger=!1,e.showNodeDesc=!1,e.skipDelayTime=10,e.skipTime=0,e.isShowSkip=!1,e.pleaseMaxTime=5,e.pleaseTime=0,e.isShowPlease=!0,e.touchId=-1,e.figerBody="body",e.isMoving=!1,e.isCameraMoving=!1,e.fingerNodePlanB=null,e}return r(e,t),e.prototype.eventMaps=function(){var t,e,n,o,r,i,a,s,c,l,p,h,d,f,y,_,g,m,v;return[(t={},t[u.default.START_GUIDE]=this.onGuideStart,t),(e={},e[u.default.CHANGE_GUIDE_PROGRESS]=this.onStepChange,e),(n={},n[u.default.END_GUIDE]=this.onGuideEnd,n),(o={},o[u.default.SHOW_SKIP_GUIDE]=this.onShowSkip,o),(r={},r[u.default.DELAY_SHOW_SKIP]=this.onDelayShowSkip,r),(i={},i[u.default.ADD_CLICK_EVENT]=this.onAddClickEvent,i),(a={},a[u.default.GUIDE_DRAK_SCREEN]=this.onDarkScreen,a),(s={},s[u.default.GUIDE_SPECIAL_DRAK_SCREEN]=this.onSpecialDarkScreen,s),(c={},c[u.default.SHOW_GUIDE_NODE_DESC]=this.onShowGuideNodeDesc,c),(l={},l[u.default.GUIDE_CHANGE_FINGER]=this.onChangeFinger,l),(p={},p[u.default.GUIDE_MOVE_CAMERA]=this.onMoveCamera,p),(h={},h[u.default.GUIDE_ZOOM_CAMERA]=this.onZoomCamera,h),(d={},d[u.default.CLEAN_GUIDE]=this.onCleanGuide,d),(f={},f[u.default.HIDE_GUIDE_FINGER]=this.onHideGuideFinger,f),(y={},y[u.default.CHANGE_GUIDE_FINGER_ANI]=this.onChangeGuideFingerAni,y),(_={},_[mc.Event.PNL_ENTER]=this.onHideView,_),(g={},g[mc.Event.PNL_LEAVE]=this.onShowView,g),(m={},m[u.default.GUIDE_PLAY_MOVE_FURN_ANI]=this.onPlayCanMoveFurnAni,m.enter=!0,m),(v={},v[u.default.GUIDE_HIDE_MOVE_FURN_ANI]=this.onHideMoveFurnAni,v.enter=!0,v)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.setParam({isClean:!1,isAct:!1,isMask:!1,Index:h.PNL_ZINDEX.Guide,isHideClean:!1}),this.model=this.getModel("guide"),this.maskNode_.active=!1,this.boxNode_.active=!1,this.descNode_.active=!1,this.fingerNode_.active=!1,this.darkScreenNode_.active=!1,this.skipNode_.active=!1,this.fingerNodePlanB=cc.instantiate(this.fingerNode_),[2]})})},e.prototype.onEnter=function(){this.bgNode_.setContentSize(cc.winSize)},e.prototype.onRemove=function(){},e.prototype.onDispose=function(){this.fingerNodePlanB&&(this.fingerNodePlanB.destroy(),this.fingerNodePlanB=null)},e.prototype.onClickSkip=function(){this.model.getId()===l.GuideModType.OPENING?p.viewHelper.showPnl("main/OneNews"):this.model.getId()===l.GuideModType.ATTIC&&this.model.showHomeDirty()&&this.emit(u.default.GUIDE_PLAY_ZHUANGHUANG_ANI,!0),this.model.isCanEnterMain()||(this.emit(u.default.UPDATE_QIANTAI_STATE,!0),this.emit(u.default.UPDATE_HUAMAO_STATE,2)),this.model.skipGuide()},e.prototype.onGuideStart=function(t){this._reset(),this.registerEvent(t)},e.prototype.onGuideEnd=function(){this._reset()},e.prototype.onStepChange=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c,u,p,h,f,y,_,g,m,v,b;return s(this,function(s){switch(s.label){case 0:return this.maskNode_.active=!1,this.fingerNode_.active=!1,this.boxNode_.active=!1,this.descNode_.active=!1,this.descNode_.opacity=0,this.skipNode_.active=!1,this.curNode=null,e=t.stepInfo,n=e.nodeName,o=e.changeNode,r=e.focus,i=e.finger,a=e.fingerX,c=e.fingerY,u=e.angle,p=e.nodeDesc,h=e.showSkip,r=!1!==r,this.showNodeDesc=!!p,this.showFinger=!1!==i,this.fingerAngle=u||0,this.fingerX=a||0,this.fingerY=c||0,this.canSwallow=!this.model.isForceStep(),this.isShowSkip=h,h&&(this.skipDelayTime=!0===h?this.skipDelayTime:h,this.skipTime=this.skipDelayTime),t.type==l.GuideStepType.STORY&&(n="StoryPnl",r=!1),n||o?(f=null,y=t.stepInfo,_=y.moveCamera?y.args.moveTime:0,this.model.getIsWorkingById(l.GuideModType.BATTLE_PASS_1)&&d.gameHelper.isGLobal()&&n.includes("battle_pass_be_n")&&d.gameHelper.isOpenedPnlByKey("shop/Shop")&&(n="View/ShopPnl/content_n/0_-1/banner/view/banner_content_n/BATTLEPASS"),n?[4,this.findNode(n,_)]:[3,2]):[3,5];case 1:return f=s.sent(),[3,4];case 2:return[4,this.findChangeNode(o.parent,o.child,_)];case 3:f=s.sent(),s.label=4;case 4:f&&cc.isValid(f)&&(r?this.focusNode(f):(this.curNode=f,g=this.getTargetInfo(f),m=g.targetPos,v=g.size,b=g.scale,this.maskNode_.setPosition(m),this.maskNode_.setScale(b),this.focusDesc(m,v))),s.label=5;case 5:return[2]}})})},e.prototype.onShowSkip=function(){},e.prototype.onDelayShowSkip=function(t){this.skipTime+=t},e.prototype.onAddClickEvent=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){return t.clickCb=e})]})})},e.prototype.onDarkScreen=function(t){this.darkScreenNode_.active=!0;var e=this.darkScreenNode_.FindChild("bg");if(t){e.opacity=0;var n=1.5*Math.max(cc.winSize.width,cc.winSize.height);cc.tween(e).to(1.5,{opacity:255,width:n,height:n}).delay(1).to(1.5,{opacity:0,width:0,height:0}).call(function(){return e.active=!1}).start()}else cc.tween(e).to(.5,{opacity:0,width:0,height:0}).start()},e.prototype.onSpecialDarkScreen=function(t){var e=this;this.darkScreenNode_.active=!0;var n=this.darkScreenNode_.FindChild("bg"),o=1.5*Math.max(cc.winSize.width,cc.winSize.height),r=t.id,i=t.progress;r===l.GuideModType.NEWYEAR_2023_MAMA?6===i||12===i?(n.opacity=0,n.width=n.height=2,cc.tween(n).to(1.5,{opacity:255,width:o,height:o}).call(function(){e.model.gotoNextStep()}).start()):9!==i&&13!==i||cc.tween(n).to(1.5,{opacity:0,width:0,height:0}).call(function(){e.model.gotoNextStep()}).start():r===l.GuideModType.VALENTINE_2023_BEGIN||r===l.GuideModType.VALENTINE_2023_END?(n.opacity=0,n.width=n.height=2,cc.tween(n).to(1.5,{opacity:255,width:o,height:o}).call(function(){e.showValentineFlutterDesc(i)}).start()):r===l.GuideModType.TENANT&&(n.opacity=0,n.width=n.height=2,cc.tween(n).to(1.5,{opacity:255,width:o,height:o}).call(function(){e.showTenantFlutterDesc(r)}).start())},e.prototype.onShowGuideNodeDesc=function(t){this.descLbl_.setLocaleKey(t)},e.prototype.onShowView=function(t){if(t.key){if(!this.model)return this.node.opacity=255,void(this.canSwallow=!1);this.model.isInSolicit()&&"common/UnlockRoleTip"===t.key&&(this.node.opacity=255,this.canSwallow=!1,this.model.isSolicitFinish&&this.model.gotoNextStep()),this.model.isInClickTech()&&"dining/MiningHelper"===t.key&&(this.node.opacity=255,this.canSwallow=!1),this.model.isServiceTaskReward()&&"gali/GaLiExploreReward"===t.key&&(this.node.opacity=255,this.canSwallow=!1),this.model.isFirstUseElfEgg()&&"rank/RankFirstUseElfEgg"===t.key&&(this.node.opacity=255,this.canSwallow=!1),this.model.isStaffUnlockView()&&"staff/UnlockStaffTip"===t.key&&(this.node.opacity=255,this.canSwallow=!1),this.model.isStaffLotteryRewardView()&&"staff/StaffLotteryGetReward"===t.key&&!d.gameHelper.isOpenedPnlByKey("staff/StaffLotteryGetNewItem")&&(this.node.opacity=255,this.canSwallow=!1),this.model.isStaffTrainRewardView()&&"staff/StaffTrainReward"===t.key&&(this.node.opacity=255,this.canSwallow=!1),this.model.isGaliAuctionRewardView()&&"common/GeneralReward"===t.key&&(this.node.opacity=255,this.canSwallow=!1,this.model.gotoNextStep()),this.model.isBeautyHairRewardView()&&"beauty/GetDesignReward"===t.key&&(this.node.opacity=255,this.canSwallow=!1,this.model.gotoNextStep(),this.emit(mc.Event.HIDE_PNL,"beauty/BeautyDesign")),this.model.isGardenPlantUpView()&&"garden/PlantUpPnl"===t.key&&(this.node.opacity=255,this.canSwallow=!1,this.model.gotoNextStep()),this.model.isTenantGetFavTipView()&&"common/GetFavTip"===t.key&&(this.node.opacity=255,this.canSwallow=!1),this.model.isFoodUnlockAnimView()&&"dining/FoodUnlockAnim"===t.key&&(this.node.opacity=255,this.canSwallow=!1),!this.model.isBattlePassRewardView()||"activities/BattlePassReward"!==t.key&&"common/GeneralReward"!==t.key||(this.node.opacity=255,this.canSwallow=!1,this.model.gotoNextStep())}},e.prototype.onHideView=function(t){if(t.key){if(!this.model)return this.node.opacity=0,void(this.canSwallow=!0);this.model.isInSolicit()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isInClickTech()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isServiceTaskReward()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isFirstUseElfEgg()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isStaffUnlockView()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isStaffLotteryRewardView()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isStaffTrainRewardView()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isGaliAuctionRewardView()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isBeautyHairRewardView()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isGardenPlantUpView()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isTenantGetFavTipView()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isFoodUnlockAnimView()&&(this.node.opacity=0,this.canSwallow=!0),this.model.isBattlePassRewardView()&&(this.node.opacity=0,this.canSwallow=!0)}},e.prototype.onChangeFinger=function(t){(!t.show||t.guest.node&&t.guest.node.isValid)&&(this.fingerNode_.isValid||(this.fingerNode_=cc.instantiate(this.fingerNodePlanB)),this.fingerNode_.active=t.show,t.show?(this.fingerNode_.parent=t.guest.node,this.fingerNode_.angle=180,this.fingerNode_.setPosition(0,250),this.fingerNode_.Child(this.figerBody,sp.Skeleton).animation="dianji"):this.fingerNode_.parent=null)},e.prototype.onMoveCamera=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i;return s(this,function(a){switch(a.label){case 0:return t.target?(this.isCameraMoving=!0,e=ut.stringToNumbers(t.offsetPos,","),n=e[0],o=e[1],r=null,t.target.child?[4,this.findChangeNode(t.target.parent,t.target.child)]:[3,2]):[2];case 1:return r=a.sent(),[3,3];case 2:t.target.parent&&(r=cc.Canvas.instance.FindChild(t.target.parent)),a.label=3;case 3:return t.delay?[4,ut.wait(t.delay)]:[3,5];case 4:a.sent(),a.label=5;case 5:return i=t.moveTime||.8,[4,c.cameraCtrl.moveToByNode(i,r,cc.v2(n,o))];case 6:return a.sent(),this.isCameraMoving=!1,[2]}})})},e.prototype.onZoomCamera=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a;return s(this,function(s){switch(s.label){case 0:return t.target&&(this.isCameraMoving=!0),e=ut.stringToNumbers(t.offsetPos,","),n=e[0],o=e[1],t.delay?[4,ut.wait(t.delay)]:[3,2];case 1:s.sent(),s.label=2;case 2:return r=t.moveTime||.8,i=t.zoomRatio,(a=cc.v2(.5*cc.winSize.width,.5*cc.winSize.height)).x-=n,a.y-=o,[4,c.cameraCtrl.zoomRatioTo(r,i,a)];case 3:return s.sent(),this.isCameraMoving=!1,[2]}})})},e.prototype.onCleanGuide=function(){this.setParam({isClean:!0}),this._reset(),this.close()},e.prototype.onHideGuideFinger=function(){this.hideFinger()},e.prototype.onChangeGuideFingerAni=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a;return s(this,function(s){switch(s.label){case 0:return t.box?[4,this.findNode(t.box)]:[3,2];case 1:(n=s.sent())&&cc.isValid(n)&&(e=this.getTargetInfo(n),r=e.targetPos,i=e.size,a=e.scale,this.curNode=n,this.maskNode_.active=!0,this.maskNode_.setPosition(r),this.maskNode_.setScale(a),this.setBox(r,i)),s.label=2;case 2:return t.item?[4,this.findNode(t.item)]:[3,4];case 3:(n=s.sent())&&cc.isValid(n)&&(o=this.getTargetInfo(n),r=o.targetPos,i=o.size,a=o.scale,this.setFinger(r,i,t.ani)),s.label=4;case 4:return[2]}})})},e.prototype.onPlayCanMoveFurnAni=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return[4,assetsMgr.loadTempRes("guide/move_furn",cc.Prefab,"guide/guide")];case 1:return t=n.sent(),this.isValid?((e=cc.instantiate2(t,this.touchNode_)).width=cc.winSize.width,e.height=cc.winSize.height,[2]):[2]}})})},e.prototype.onHideMoveFurnAni=function(){var t=this.touchNode_.FindChild("move_furn");t&&t.destroy()},e.prototype._reset=function(){this.unregisterEvent(),this.curNode=null,this.hideFinger(),this.maskNode_.active=!1,this.maskNode_.setPosition(0,0),this.descNode_.opacity=0,this.descNode_.active=!1,this.darkScreenNode_.active=!1,this.skipNode_.active=!1},e.prototype.hideFinger=function(){this.fingerNode_.active=!1,this.boxNode_.active=!1},e.prototype.onTouchStart=function(t){-1===this.touchId?this.checkSection(this.curNode,t.getLocation())||this.canSwallow?this.touchId=t.getID():(!this.isMoving&&this.curNode&&this.isShowPlease&&(this.isShowPlease=!1,this.pleaseTime=this.pleaseMaxTime,p.viewHelper.showAlert("toast.guide_please",{hideMask:!0})),this.touchId=-1,this.handleInput(t)):this.handleInput(t)},e.prototype.onTouchMove=function(t){this.touchId===t.getID()&&this.model.isDragSoupStuff()||this.handleInput(t)},e.prototype.onTouchEnd=function(t){if(this.touchId===t.getID()&&(this.touchId=-1,(this.checkSection(this.curNode,t.getLocation())||this.canSwallow)&&this.clickCb)){var e=t.getLocation();c.cameraCtrl.convertWorldSub(t.getStartLocation(),e).mag()<h.CLICK_SPACE&&(this.clickCb(),this.clickCb=null)}},e.prototype.onTouchCancel=function(t){this.handleInput(t),this.touchId===t.getID()&&(this.touchId=-1)},e.prototype.register=function(){this.touchNode_.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touchNode_.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touchNode_.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touchNode_.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.touchNode_.SetSwallowTouches(!1)},e.prototype.handleInput=function(t){t.stopPropagation()},e.prototype.registerEvent=function(t){var e=this,n=t.force,o=function(t){n&&t.stopPropagation()};this.touchNode_.on(cc.Node.EventType.TOUCH_START,function(t){if(-1!==e.touchId)return o(t);e.model.isForceStep()?e.checkSection(e.curNode,t.getLocation())||e.canSwallow?e.touchId=t.getID():(!e.isMoving&&e.curNode&&e.isShowPlease&&(e.isShowPlease=!1,e.pleaseTime=e.pleaseMaxTime,p.viewHelper.showAlert("toast.guide_please",{hideMask:!0})),o(t),e.touchId=-1):e.hideFinger()},this),this.touchNode_.on(cc.Node.EventType.TOUCH_END,function(t){if(e.touchId===t.getID()&&(e.touchId=-1,(e.checkSection(e.curNode,t.getLocation())||e.canSwallow)&&e.clickCb)){var n=t.getLocation();c.cameraCtrl.convertWorldSub(t.getStartLocation(),n).mag()<h.CLICK_SPACE&&(e.clickCb(),e.clickCb=null)}},this),this.touchNode_.on(cc.Node.EventType.TOUCH_MOVE,function(t){!e.model.isDragSoupStuff()&&e.model.isForceStep()&&o(t)}),this.touchNode_.on(cc.Node.EventType.TOUCH_CANCEL,function(t){o(t),e.touchId===t.getID()&&(e.touchId=-1)}),this.touchNode_.SetSwallowTouches(!1)},e.prototype.unregisterEvent=function(){this.touchNode_.off(cc.Node.EventType.TOUCH_START),this.touchNode_.off(cc.Node.EventType.TOUCH_MOVE),this.touchNode_.off(cc.Node.EventType.TOUCH_END),this.touchNode_.off(cc.Node.EventType.TOUCH_CANCEL)},e.prototype.checkSection=function(t,e){return!!(t&&t.isValid&&t.parent&&t.parent.isValid)&&t._hitTest(e)},e.prototype.focusNode=function(t){var e=this;this.maskNode_.active=!0;var n=this.getTargetInfo(t),o=n.targetPos,r=n.scale;this.isMoving=!0,cc.tween(this.maskNode_).to(.4,{position:cc.v3(o),scaleX:r.x,scaleY:r.y}).call(function(){e.isMoving=!1;var n=e.getTargetInfo(t),o=n.size,r=n.targetPos,i=n.scale;e.maskNode_.setPosition(r),e.maskNode_.setScale(i),e.curNode=t,e.setBox(r,o),e.setFinger(r,o),e.setDesc(r,o)}).start()},e.prototype.focusDesc=function(t,e){this.setFinger(t,e),this.setDesc(t,e)},e.prototype.getTargetInfo=function(t){var e=t.getBoundingBox(),n=e.xMin,o=e.yMin,r=e.xMax,i=e.yMax,a=ut.convertToNodePosAR(t.parent,this.maskNode_.parent,cc.v2(n,o),cc.v2()),s=ut.convertToNodePosAR(t.parent,this.maskNode_.parent,cc.v2(r,i),cc.v2()),c=s.x-a.x,l=s.y-a.y;return{size:cc.size(c,l),targetPos:cc.v2(a.x+.5*c,a.y+.5*l),scale:cc.v2(c/this.maskNode_.width,l/this.maskNode_.height)}},e.prototype.confirmScale=function(t){for(var e=1,n=1;t.parent;)e*=t.parent.scaleX,n*=t.parent.scaleY,t=t.parent;return{sx:e,sy:n}},e.prototype.findNode=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a,c,l,u=this;return s(this,function(s){switch(s.label){case 0:return e?[4,ut.wait(e,this)]:[3,2];case 1:s.sent(),s.label=2;case 2:n=0,o=0,r=0,c=function(t){r++;var e=u.confirmScale(t),n=t.convertToWorldSpaceAR(cc.v2(0,0));return 1==r?(i=e,a=n,!1):o>=25||i.sx==e.sx&&i.sx==e.sx&&a.x==n.x&&a.y==n.y?o>=25||3==r:(r=0,o++,i=e,void(a=n))},s.label=3;case 3:return this.model.isSkip()?[2]:this.isCameraMoving?[4,ut.wait(.1,this)]:[3,5];case 4:return s.sent(),[3,3];case 5:return(l=cc.Canvas.instance.FindChild(t))&&l.active?c(l)?[2,l]:[3,6]:[3,9];case 6:return[4,ut.wait(.05,this)];case 7:s.sent(),s.label=8;case 8:return[3,11];case 9:return[4,ut.wait(.2,this)];case 10:s.sent(),s.label=11;case 11:return n++>30&&(p.viewHelper.showAlert("toast.net_error"),n=0),[3,3];case 12:return[2]}})})},e.prototype.findChangeNode=function(t,e,n){return a(this,void 0,void 0,function(){var o,r,i,a,c,l,u,h,d=this;return s(this,function(s){switch(s.label){case 0:return n?[4,ut.wait(n,this)]:[3,2];case 1:s.sent(),s.label=2;case 2:o=0,r=0,i=0,l=function(t){i++;var e=d.confirmScale(t),n=t.convertToWorldSpaceAR(cc.v2(0,0));return 1==i?(a=e,c=n,!1):r>=25||a.sx==e.sx&&a.sy==e.sy&&c.x==n.x&&c.y==n.y?r>=25||3==i:(i=0,r++,a=e,void(c=n))},s.label=3;case 3:return this.model.isSkip()?[2]:(u=cc.Canvas.instance.FindChild(t))&&u.active?(h=this.recursionFind(u,e))&&h.active?l(h)?[2,h]:[3,4]:[3,7]:[3,10];case 4:return[4,ut.wait(.05,this)];case 5:s.sent(),s.label=6;case 6:return[3,9];case 7:return[4,ut.wait(.2,this)];case 8:s.sent(),s.label=9;case 9:return[3,12];case 10:return[4,ut.wait(.2,this)];case 11:s.sent(),s.label=12;case 12:return o++>30&&(p.viewHelper.showAlert("toast.net_error"),o=0),[3,3];case 13:return[2]}})})},e.prototype.findNodeNoExist=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(o){switch(o.label){case 0:e=0,o.label=1;case 1:return(n=cc.Canvas.instance.FindChild(t))&&n.active?[3,2]:[2,!0];case 2:return[4,ut.wait(.2,this)];case 3:o.sent(),o.label=4;case 4:return e++>30&&(p.viewHelper.showAlert("toast.net_error"),e=0),[3,1];case 5:return[2]}})})},e.prototype.recursionFind=function(t,e){if(t.name==e)return t;for(var n=0;n<t.children.length;n++){var o=t.children[n],r=this.recursionFind(o,e);if(r)return r}},e.prototype.setFinger=function(t,e,n){if(void 0===n&&(n="dianji"),this.showFinger){var o=e.width/2,r=e.height/2,i=t.x,a=t.y;0===this.fingerAngle?a-=r/2:90===this.fingerAngle?i+=o/2:-90===this.fingerAngle?i-=o/2:-45===this.fingerAngle?(i-=o/2,a-=r/2):45===this.fingerAngle&&(i+=o/2,a-=r/2),this.fingerNode_.parent=this.node,this.fingerNode_.setPosition(i+this.fingerX,a+this.fingerY),this.fingerNode_.angle=this.fingerAngle,this.fingerNode_.Child(this.figerBody,sp.Skeleton).animation=n,this.fingerNode_.active=!0}},e.prototype.setDesc=function(t,e){if(this.showNodeDesc){var n=this.descNode_.width/2,o=this.descNode_.height/2,r=cc.winSize.width/2,i=t.x,a=t.y,s=e.height/2+o+50;r-t.x<n?i=r-n:t.x<-r+n?i=-r+n:cc.winSize.height/2-t.y<n&&(s=-s),this.descNode_.setPosition(i,a+s),this.descNode_.active=!0,this.descNode_.opacity=0,cc.tween(this.descNode_).to(.3,{opacity:255}).start()}},e.prototype.setBox=function(t,e){this.boxNode_.setPosition(t),this.boxNode_.setContentSize(e.width+16,e.height+16),this.boxNode_.active=!0},e.prototype.showSkip=function(){this.skipNode_.active=!0,this.skipNode_.opacity=0,cc.tween(this.skipNode_).to(.2,{opacity:255}).start()},e.prototype.update=function(t){this.isShowSkip&&(this.skipTime-=t,this.skipTime<=0&&(this.isShowSkip=!1,this.showSkip())),this.isShowPlease||(this.pleaseTime-=t,this.pleaseTime<=0&&(this.isShowPlease=!0))},e.prototype.showValentineFlutterDesc=function(t){var e=this,n=[140,-140,-386],o=[{progress:2,msgs:["guide.valentine_desc1","guide.valentine_desc2"]},{progress:0,msgs:["guide.valentine_desc3","guide.valentine_desc4","guide.valentine_desc5"]}].find(function(e){return e.progress===t});if(o){this.flutterNode_.Items(o.msgs,function(t,e){t.y=0,t.setLocaleKey(e)});for(var r=function(o){var r=i.flutterNode_.children[o];cc.tween(r).delay(2*o).to(2,{y:cc.winSize.height/2+100+n[o]}).delay(1*o).call(function(){if(o===e.flutterNode_.childrenCount-1)if(e.flutterNode_.children.forEach(function(t){t.Component(cc.Label).string="",t.y=0,t.active=!1}),2===t){var n=e.darkScreenNode_.FindChild("bg");cc.tween(n).to(1.5,{opacity:0,width:0,height:0}).call(function(){e.model.gotoNextStep()}).start()}else 0===t&&(e.model.isWorking()?e.model.gotoNextStep():p.viewHelper.showPnl("activities/ValentineGif").then(function(t){if(t&&t.isValid){var n=e.darkScreenNode_.FindChild("bg");cc.tween(n).to(1.5,{opacity:0,width:0,height:0}).start()}}))}).start()},i=this,a=0;a<this.flutterNode_.childrenCount;a++)r(a)}},e.prototype.showTenantFlutterDesc=function(t){var e=this,n=[-140],o={id:l.GuideModType.TENANT,msgs:["guide.tenant_desc1"]};if(o){this.flutterNode_.Items(o.msgs,function(t,e){t.y=0,t.setLocaleKey(e)});for(var r=function(o){var r=i.flutterNode_.children[o];cc.tween(r).to(2,{y:cc.winSize.height/2+100+n[o]}).delay(1).call(function(){if(o===e.flutterNode_.childrenCount-1&&(e.flutterNode_.children.forEach(function(t){t.Component(cc.Label).string="",t.y=0,t.active=!1}),t===l.GuideModType.TENANT)){var n=e.darkScreenNode_.FindChild("bg");cc.tween(n).to(1.5,{opacity:0,width:0,height:0}).call(function(){e.model.gotoNextStep()}).start()}}).start()},i=this,a=0;a<this.flutterNode_.childrenCount;a++)r(a)}},i([f],e)}(mc.BasePnlCmpt);n.default=y,cc._RF.pop()},{"../../../scene/CameraCtrl":"CameraCtrl","../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/GameHelper":"GameHelper","../../common/helper/ViewHelper":"ViewHelper"}],HeartPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"cbd668SEm5NYa5qqio2Cqat","HeartPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../core/utils/Decorator"),l=t("../../common/constant/Constant"),u=t("../../common/constant/Enums"),p=t("../../common/event/EventType"),h=t("../../common/helper/GameHelper"),d=t("../../common/helper/ViewHelper"),f=cc._decorator.ccclass,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.countLbl_=null,e.titleLbl_=null,e.itemADNode_=null,e.shareNode_=null,e.freeLbl_=null,e.itemCoinNode_=null,e.costLbl_=null,e.heartNode_=null,e.heartCountLbl_=null,e.countDownLbl_=null,e}return r(e,t),e.prototype.listenEventMaps=function(){var t;return[(t={},t[p.default.UPDATE_HEART]=this.refreshLife,t)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("HeartPnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){cc.log("HeartPnlCtrl onEnter"),this.countLbl_.string="800"},e.prototype.onRemove=function(){cc.log("HeartPnlCtrl onRemove")},e.prototype.onClean=function(){cc.log("HeartPnlCtrl onClean")},e.prototype.onClickClose1=function(t,e){cc.log("onClickClose1",e),this.close()},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close()},e.prototype.onClickGetAd=function(t,e){cc.log("onClickGetAd",e),this.clickAD()},e.prototype.onClickGetCoin=function(t,e){cc.log("onClickGetCoin",e),h.gameHelper.exchange(l.ItemType.Heart,5,800)||d.viewHelper.showPnl("common/Shop")},e.prototype.clickAD=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,h.gameHelper.ad.showAd(u.AdPropType.Heart)];case 1:return 0==t.sent().status&&h.gameHelper.getRewards([{id:l.ItemType.Heart,count:1}]),[2]}})})},e.prototype.refreshLife=function(){console.log("refreshLife");var t=h.gameHelper.global.getHeart();if(this.countLbl_.string=""+t,t<5){var e=h.gameHelper.global.getNextHeartTime(),n=Date.now();this.countDownLbl_.string=ut.millisecondFormat(e-n),this.heartCountLbl_.node.active=!1}else this.countDownLbl_.string="",this.heartCountLbl_.node.active=!0},e.prototype.update=function(){this.refreshLife()},i([ut.addLock],e.prototype,"clickAD",null),i([c.throttle(1e3)],e.prototype,"refreshLife",null),i([f],e)}(mc.BasePnlCmpt);n.default=y,cc._RF.pop()},{"../../../core/utils/Decorator":"Decorator","../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/GameHelper":"GameHelper","../../common/helper/ViewHelper":"ViewHelper"}],HotUpdateMgr:[function(t,e,n){"use strict";cc._RF.push(e,"e012cilpONGy7Hh9YDVpfHE","HotUpdateMgr");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i=t("../event/CoreEventType"),a=t("../../script/common/crypto/CryptoHelper"),s=t("../../../startScene/version"),c=t("../../script/common/net/netMgr"),l=t("../../script/common/helper/GameHelper"),u=function(){function t(){this._am=null,this._updating=!1,this._hotStorage="",this._verfiyManifest=null,this.tempCostTime=0,this.newVersion=null}return Object.defineProperty(t.prototype,"searchPaths",{get:function(){return[]},enumerable:!1,configurable:!0}),t.prototype.setSearchPaths=function(){},t.prototype.addSearchPath=function(t){this.searchPaths.indexOf(t)},t.prototype.getWritablePath=function(t){return t?"./"+t:"./"},t.prototype.isFileExist=function(){return!1},t.prototype.getStringFromFile=function(){return""},t.prototype.writeStringToFile=function(){},t.prototype.getHotStorage=function(){return this._hotStorage||(this._hotStorage=mc.GameNameSpace+"-hot-update"),this._hotStorage},t.prototype.getTempHotStorage=function(){return mc.GameNameSpace+"-hot-update_temp"},t.prototype.getOriginManifestPath=function(){return assetsMgr.transform({bundle:"manifest",path:"project"},{ext:".manifest",__isNative__:!0})},t.prototype.getCacheManifestPath=function(){return"project.manifest"},t.prototype.getTempManifestPath=function(){return this.getWritablePath(this.getTempHotStorage()+"/project.manifest.temp")},t.prototype.versionCompareHandle=function(t,e){lplog.info("JS Custom Version Compare: version A is "+t+", version B is "+e);for(var n=t.split("."),o=e.split("."),r=0;r<n.length;++r){var i=parseInt(n[r]||"0"),a=parseInt(o[r]||"0");if(i!==a)return i-a}return o.length>n.length?-1:0},t.prototype.setVerifyCallback=function(t,e){var n=e.compressed,o=e.md5,r=e.path;if(n)return!0;var i=jsb.fileUtils.getDataFromFile(t),s=a.cryptoHelper.md5(i);return o===s||(lplog.info("Verification fail : "+r+" ("+o+") ("+s+")"),!1)},t.prototype.verifyRemoteManifest=function(){return!0},t.prototype.filterManifest=function(){return{}},t.prototype.versionCompareHandle2=function(t,e){var n=t.split("."),o=e.split(".");return n.pop(),o.pop(),this.versionCompareHandle(n.join("."),o.join("."))},t.prototype.release=function(){this._am&&(this._am.setEventCallback(null),this._am=null)},t.prototype.createAssetsManager=function(t){var e=this.getOriginManifestPath(),n=this.getWritablePath(this.getHotStorage()+"/");lplog.info("hotupdate originManifest path:",e),lplog.info("hotupdate storage path:",n);var o=new jsb.AssetsManager(e,n);if(o.setVersionCompareHandle(this.versionCompareHandle.bind(this)),o.setVerifyCallback(this.setVerifyCallback.bind(this)),o.setEventCallback(this.updateCallback.bind(this)),o.getState()===jsb.AssetsManager.State.UNINITED){var r=JSON.stringify({packageUrl:t,remoteManifestUrl:t+"project.manifest",remoteVersionUrl:t+"version.manifest",version:"0.0.0",assets:{},searchPaths:[]}),i=new jsb.Manifest(r,n);o.loadLocalManifest(i,n),lplog.info("not manifest!!!")}else lplog.info("find manifest!!!");return cc.sys.os===cc.sys.OS_ANDROID&&o.setMaxConcurrentTask(2),o},t.prototype.printError=function(t){lplog.info("\u3010Update Error\u3011",t)},t.prototype.updateCallback=function(t){var e=!1,n=!1;switch(t.getEventCode()){case jsb.EventAssetsManager.ERROR_UPDATING:this.printError("Asset update error: "+t.getAssetId()+", "+t.getMessage()),e=!0;break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:this.printError(t.getMessage()),e=!0;break;case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:e=!0,this.printError("No local manifest file found, hot update skipped.");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:e=!0,this.printError("Fail to download manifest file, hot update skipped.");break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:lplog.info("New version found.");break;case jsb.EventAssetsManager.UPDATE_FAILED:e=!0;break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:lplog.info("Already up to date with the latest remote version."),this.setSearchPaths(this.searchPaths),n=!0;break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:break;case jsb.EventAssetsManager.UPDATE_FINISHED:lplog.info("Update finished. "),this.onFinish(t),n=!0}(e||n)&&(this._am&&this._am.setEventCallback(null),this._updating=!1),n&&this.setSearchPaths(this.searchPaths),eventMgr.emit(i.default.HOT_UPDATE_EVENT,t,e)},t.prototype.start=function(t,e,n){if(cc.sys.isNative){if(this._updating)return lplog.info("HotUpdateMgr is updating, did NOT valid to run....");if(this._am&&this.release(),this.onStart(n),this.updateManifestUrl(t,e),this.setSearchPaths(this.searchPaths),this._am=this.createAssetsManager(t),!this._am)return lplog.error("AssetsManager create failed!");this._am.update(),this._updating=!0}},t.prototype.abort=function(){this._updating&&(this._updating=!1,this.release(),lplog.info("\u4e2d\u6b62\u4e0b\u8f7d..."))},t.prototype.redownload=function(){this._updating=!0,this._am.setEventCallback(this.updateCallback.bind(this)),this._am.downloadFailedAssets()},t.prototype.getVersion=function(){return"0.0.0"},t.prototype.cleanCache=function(){if(!cc.sys.isNative)return lplog.error("the platform not support.");var t=this.getWritablePath(this.getHotStorage()+"/");t?jsb.fileUtils.isDirectoryExist(t)?jsb.fileUtils.removeDirectory(t):lplog.error("path:--\x3e"+t+" not exist"):lplog.error("storagePath not exist")},t.prototype.convertBytesToString=function(t){return t>=1073741824?(t/1073741824).toFixed(2)+"GB":t>=1048576?(t/1048576).toFixed(2)+"MB":t>=1024?(t/1024).toFixed(2)+"KB":t+"B"},t.prototype.updateManifestUrl=function(t,e){var n=this;if(t){var o=function(o){var r=n.getStringFromFile(o);if(r){var i=JSON.parse(r);lplog.info("updateManifest",i.remoteManifestUrl),i.remoteManifestUrl=e+"project.manifest",i.packageUrl=t;var a=n.writeStringToFile(JSON.stringify(i),o);if(!a){var s=n.getWritablePath(n.getHotStorage()+"/"),c=s+o;(a=n.writeStringToFile(JSON.stringify(i),c))&&n.addSearchPath(s)}}};o(this.getCacheManifestPath()),o(this.getOriginManifestPath())}},t.prototype.isUpdating=function(){return this._updating},t.prototype.initStoreInfo=function(t){var e=this.getStoreInfo();return e.version!=t&&(e={curVer:s.default.VERSION,version:t,time:0},this.setStoreInfo(e)),e},t.prototype.getStoreInfo=function(){var t=storageMgr.getOrgItem("__@hotUpdateInfo");return t?t=JSON.parse(t):(t={curVer:s.default.VERSION,version:"???",time:0},this.setStoreInfo(t)),t},t.prototype.setStoreInfo=function(t){storageMgr.setOrgItem("__@hotUpdateInfo",JSON.stringify(t))},t.prototype.updateCostTime=function(t){this.isUpdating()&&(this.tempCostTime+=t,this.tempCostTime>.5&&this.syncCostTime())},t.prototype.syncCostTime=function(){var t=this.getStoreInfo();t.time+=this.tempCostTime,this.setStoreInfo(t),this.tempCostTime=0},t.prototype.getCostTime=function(){return this.getStoreInfo().time},t.prototype.onStart=function(t){this.newVersion=t;var e=this.initStoreInfo(t),n=l.gameHelper.user.getTempUid();c.netMgr.post("/report/hotUpdateStart",{uid:n,curVer:e.curVer,version:e.version})},t.prototype.onFinish=function(t){this.syncCostTime();var e=this.getStoreInfo();e.finish=!0,e.size=t.getTotalBytes(),e.files=t.getTotalFiles(),this.setStoreInfo(e),this.checkReport()},t.prototype.checkReport=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(n){switch(n.label){case 0:return!(t=this.getStoreInfo()).finish||t.report?[3,2]:(e=l.gameHelper.user.getTempUid(),[4,c.netMgr.post("/report/hotUpdateEnd",{uid:e,curVer:t.curVer,version:t.version,time:t.time,size:t.size,files:t.files,platform:l.gameHelper.getPlatform()})]);case 1:n.sent()&&(t.report=!0,this.setStoreInfo(t)),n.label=2;case 2:return[2]}})})},t}();window.hotUpdateMgr=new u,cc._RF.pop()},{"../../../startScene/version":void 0,"../../script/common/crypto/CryptoHelper":"CryptoHelper","../../script/common/helper/GameHelper":"GameHelper","../../script/common/net/netMgr":"netMgr","../event/CoreEventType":"CoreEventType"}],IItemObj:[function(t,e,n){"use strict";cc._RF.push(e,"56d57FD4qdJV7TGyHFP/iNe","IItemObj"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this.id=0,this.lv=0}return Object.defineProperty(t.prototype,"attrId",{get:function(){return 1e3*this.id+this.lv},enumerable:!1,configurable:!0}),t}();n.default=o,cc._RF.pop()},{}],IgnoreAutoReleaseSpriteCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"a7dcflEKqZK85PVqEKKbOo9","IgnoreAutoReleaseSpriteCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],IgnoreFlashLightCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"38a04ScCO5PqaolnxUozbni","IgnoreFlashLightCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],InstagramHelper:[function(t,e,n){"use strict";cc._RF.push(e,"3368bGgOldKAI6MYaMZ6NeA","InstagramHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.instagramHelper=void 0;var i=t("../event/JsbEvent"),a=function(){function t(){}return t.prototype.share=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,jsbHelper.call(i.default.INS_SHARE,t)];case 1:return[2,"success"===(e.sent()||{result:"success"}).result]}})})},t}();n.instagramHelper=new a,cc._RF.pop()},{"../event/JsbEvent":"JsbEvent"}],InterstitialAd:[function(t,e,n){"use strict";cc._RF.push(e,"92153fvuNVIBbr4chwpIyx0","InterstitialAd");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.FBInstantInterstitialAd=n.NativeInterstitialAd=n.WxInterstitialAd=void 0;var s=t("../event/JsbEvent"),c=t("../wx/WxHelper"),l=t("../wx/WxPromise"),u=t("../constant/Enums"),p=t("../helper/GameHelper"),h=function(){function t(){this.watchedCount=0,this.lastWatchTime=0,this.maxWatchCount=20,this.checkUpdateTime=0}return t.prototype.initData=function(t){t=t||{},this.watchedCount=t.watchedCount||0,this.lastWatchTime=t.lastWatchTime||0,this.checkRefresh()},t.prototype.updateWatch=function(){this.watchedCount++,this.lastWatchTime=p.gameHelper.now()},t.prototype.isReady=function(){return!0},t.prototype.toDB=function(){return{watchedCount:this.watchedCount,lastWatchTime:this.lastWatchTime}},t.prototype.checkRefresh=function(){(this.lastWatchTime<=0||p.gameHelper.getToDaySurpluTime(this.lastWatchTime)<=0)&&(this.watchedCount=0)},t.prototype.load=function(t){this.checkUpdateTime+=t,this.checkUpdateTime>60&&(this.checkUpdateTime=0,this.checkRefresh())},t}(),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ads=[],e.inited=!1,e}return r(e,t),e.prototype.initAd=function(){if(wx.createInterstitialAd&&!(c.wxHelper.compareVersion("2.6.4")<0))for(var t=["adunit-a53732333f01ca7c"],e=function(e){var o=wx.createInterstitialAd({adUnitId:t[e]}),r={ad:o,timeCount:120,isShow:!1,state:u.AdState.LOADING,reloadTime:0};n.ads.push(r),o.onLoad(function(){lplog.info("@@load interstitial ad"),r.state=u.AdState.LOAD_SUCCESS,r.reloadTime=0}),o.onError(function(t){r.state=u.AdState.LOAD_FAIL,lplog.error("load InterstitialAd error",t)})},n=this,o=0;o<t.length;o++)e(o)},e.prototype.isReady=function(e){void 0===e&&(e=0);var n=this.ads[e];return!!t.prototype.isReady.call(this)&&!(!n||n.state!=u.AdState.LOAD_SUCCESS||n.timeCount<120||n.isShow)},e.prototype.load=function(e){this.inited||(this.inited=!0,this.initAd()),t.prototype.load.call(this,e);for(var n=0;n<this.ads.length;n++){var o=this.ads[n];o.state==u.AdState.LOAD_SUCCESS?o.timeCount+=e:o.state!=u.AdState.LOAD_FAIL&&o.state!=u.AdState.LOADING||(o.reloadTime+=e,o.reloadTime>5&&(o.reloadTime=0,o.ad.load().catch(function(){})))}},e.prototype.show=function(t){return void 0===t&&(t=0),i(this,void 0,Promise,function(){var e,n;return a(this,function(o){switch(o.label){case 0:e=this.ads[t],o.label=1;case 1:return o.trys.push([1,4,,5]),e.isShow=!0,[4,e.ad.show()];case 2:return o.sent(),[4,l.promisefyOnce(e.ad.onClose,e.ad.offClose)];case 3:return o.sent(),e.timeCount=0,e.isShow=!1,this.updateWatch(),[2,!0];case 4:return n=o.sent(),lplog.error("showInterstitialAd error",n),e.isShow=!1,e.timeCount=10,[2,!1];case 5:return[2]}})})},e}(h);n.WxInterstitialAd=d;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ready=!1,e.waitTime=0,e.waitCache=!0,e.loadStartTime=0,e.loadCacheStartTime=0,e.loadReqId=0,e.inited=!1,e.expireCheckTime=0,e.ecpmLevel="",e.startFlag=!1,e.noAdTime=0,e}return r(e,t),e.prototype.init=function(){var t=this;jsbHelper.on(s.default.INTERSTITIAL_AD_ON_ERROR,function(e){var n=e.status;e.errcode,t.ready=!1,t.state=u.AdState.WAIT,t.waitTime=29,lplog.error("ad error",n)})},e.prototype.isReady=function(){return!!t.prototype.isReady.call(this)&&(this.waitCache?this.ready:this.isCacheReady()&&this.ready)},e.prototype.load=function(e){var n=this;if(this.inited||(this.init(),this.inited=!0),t.prototype.load.call(this,e),this.noAdTime-=1,t.prototype.isReady.call(this)){if(this.state!==u.AdState.LOADING&&this.state!==u.AdState.LOAD_SUCCESS&&this.state!==u.AdState.WAIT){this.state=u.AdState.LOADING;var o=++this.loadReqId;jsbHelper.cast(s.default.LOAD_INTERSTITIAL_AD,function(t){if(n.loadReqId==o){var e=t.status,r=(t.errcode,t.ecpmLevel),i=e;if("0"===i){n.state=u.AdState.LOAD_SUCCESS,n.ready=!0;var a=p.gameHelper.now();n.loadCacheStartTime=a,n.ecpmLevel=r,n.noAdTime=66}else"-1"===i?n.waitTime=29:"-3"===i?n.waitTime=26:lplog.info("load ads unknow code is "+i+" "+typeof i);"0"!==i&&(n.state=u.AdState.WAIT,n.ready=!1)}})}else this.state===u.AdState.WAIT&&(this.waitTime+=e,this.waitTime>=30&&(this.waitTime=0,this.state=u.AdState.LOAD_FAIL));if(this.ready&&this.loadCacheStartTime>0&&this.isCacheReady()&&(this.state=u.AdState.LOAD_SUCCESS,this.loadCacheStartTime=-1),this.state==u.AdState.LOAD_SUCCESS){this.expireCheckTime+=e;var r=3e3;this.getEcpmLevel()>6&&(r=1200),this.expireCheckTime>r&&(this.expireCheckTime=0,this.state=u.AdState.LOAD_FAIL)}}},e.prototype.show=function(){return i(this,void 0,Promise,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return audioMgr.pauseAll(),[4,jsbHelper.call(s.default.SHOW_INTERSTITIAL_AD)];case 1:return t=n.sent(),e=t.status,audioMgr.resumeAll(),"0"===e?(this.state=u.AdState.PLAY_SUCCESS,this.ready=!1,this.waitCache=!0,this.updateWatch(),[2,!0]):"-1"===e?(this.state=u.AdState.PLAY_FAIL,this.ready=!1,[2,!1]):(lplog.info("show ads unknow code is "+e+" "+typeof e),[2,!1])}})})},e.prototype.waitCacheReady=function(){return i(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:if(!this.waitCache)return[2,!0];t=this.isCacheReady(),e=p.gameHelper.now(),n.label=1;case 1:return t?[3,3]:[4,ut.wait(.05)];case 2:return n.sent(),t=this.isCacheReady(),p.gameHelper.now()-e>=5*ut.Time.Second?[3,3]:[3,1];case 3:return 0==t&&(this.waitCache=!1,this.state=u.AdState.WAIT,this.waitTime=20),[2,t]}})})},e.prototype.isCacheReady=function(){var t=!0;return cc.sys.os==cc.sys.OS_IOS?t=jsb.reflection.callStaticMethod("jsbHelp","isInterstitialADReady"):ut.isAndroid()&&(t=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsbHelper","isInterstitialADReady","()Z")),t},e.prototype.isAdVaild=function(){var t=!0;return cc.sys.os==cc.sys.OS_IOS?t=jsb.reflection.callStaticMethod("jsbHelp","isInterstitialADVaild"):ut.isAndroid()&&(t=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsbHelper","isInterstitialADVaild","()Z")),t},e.prototype.getEcpmLevel=function(){return isNaN(Number(this.ecpmLevel.substring(5)))?100:Number(this.ecpmLevel.substring(5))},e.prototype.giveUpAd=function(){this.state=u.AdState.LOAD_FAIL,this.ready=!1},e}(h);n.NativeInterstitialAd=f;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ad=null,e.reloadTime=0,e.state=null,e.placementId="186451227433565_216344734444214",e.ready=!1,e.waitTime=0,e.inited=!1,e}return r(e,t),e.prototype.isReady=function(t){return void 0===t&&(t=!1),this.state==u.AdState.LOAD_SUCCESS},e.prototype.isCanShare=function(){return!1},e.prototype.initiativeLoad=function(){},e.prototype.destroy=function(){},e.prototype.reportShareBehavior=function(){},e.prototype.getPlanBAD=function(){},e.prototype.init=function(){this.inited=!0},e.prototype.load=function(e){var n=this;t.prototype.load.call(this,e),this.state!==u.AdState.LOADING&&this.state!==u.AdState.LOAD_SUCCESS&&this.state!==u.AdState.WAIT&&this.state!==u.AdState.PLAYING?(this.state=u.AdState.LOADING,FBInstant.getInterstitialAdAsync(this.placementId).then(function(t){return n.ad=t,n.ad.loadAsync()}).then(function(){n.state=u.AdState.LOAD_SUCCESS,n.ready=!0}).catch(function(t){n.reloadTime=20,n.state=u.AdState.WAIT,n.ready=!1,lplog.error("[load interstitialad fail]",t)})):this.state===u.AdState.WAIT&&(this.waitTime+=e,this.waitTime>=this.reloadTime&&(this.waitTime=0,this.state=null))},e.prototype.show=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),i(this,void 0,Promise,function(){var t,e;return a(this,function(n){switch(n.label){case 0:return t=this.ad,audioMgr.pauseAll(),this.state=u.AdState.PLAYING,[4,new Promise(function(e){return t.showAsync().then(function(){return e(!0)}).catch(function(){return e(!1)})})];case 1:return e=n.sent(),audioMgr.resumeAll(),this.ad=null,e?(this.state=u.AdState.PLAY_SUCCESS,this.ready=!1,this.updateWatch(),[2,!0]):(this.state=u.AdState.PLAY_FAIL,this.ready=!1,[2,!1])}})})},e}(h);n.FBInstantInterstitialAd=y,cc._RF.pop()},{"../constant/Enums":"Enums","../event/JsbEvent":"JsbEvent","../helper/GameHelper":"GameHelper","../wx/WxHelper":"WxHelper","../wx/WxPromise":"WxPromise"}],JSEncrypt:[function(t,e,n){"use strict";var o;cc._RF.push(e,"c9d9aMXpudBH4OKWET3j/d/","JSEncrypt"),Object.defineProperty(n,"__esModule",{value:!0}),o=function(t){var e="0123456789abcdefghijklmnopqrstuvwxyz";function n(t){return e.charAt(t)}function o(t,e){return t&e}function r(t,e){return t|e}function i(t,e){return t^e}function a(t,e){return t&~e}function s(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function c(t){for(var e=0;0!=t;)t&=t-1,++e;return e}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="=";function p(t){var e,n,o="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),o+=l.charAt(n>>6)+l.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),o+=l.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),o+=l.charAt(n>>2)+l.charAt((3&n)<<4));(3&o.length)>0;)o+=u;return o}function h(t){var e,o="",r=0,i=0;for(e=0;e<t.length&&t.charAt(e)!=u;++e){var a=l.indexOf(t.charAt(e));a<0||(0==r?(o+=n(a>>2),i=3&a,r=1):1==r?(o+=n(i<<2|a>>4),i=15&a,r=2):2==r?(o+=n(i),o+=n(a>>2),i=3&a,r=3):(o+=n(i<<2|a>>4),o+=n(15&a),r=0))}return 1==r&&(o+=n(i<<2)),o}var d,f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function y(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var _,g=function(t){var e;if(void 0===d){var n="0123456789ABCDEF",o=" \f\n\r\t\xa0\u2028\u2029";for(d={},e=0;e<16;++e)d[n.charAt(e)]=e;for(n=n.toLowerCase(),e=10;e<16;++e)d[n.charAt(e)]=e;for(e=0;e<o.length;++e)d[o.charAt(e)]=-1}var r=[],i=0,a=0;for(e=0;e<t.length;++e){var s=t.charAt(e);if("="==s)break;if(-1!=(s=d[s])){if(void 0===s)throw new Error("Illegal character at offset "+e);i|=s,++a>=2?(r[r.length]=i,i=0,a=0):i<<=4}}if(a)throw new Error("Hex encoding incomplete: 4 bits missing");return r},m={decode:function(t){var e;if(void 0===_){var n="= \f\n\r\t\xa0\u2028\u2029";for(_=Object.create(null),e=0;e<64;++e)_["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)]=e;for(e=0;e<n.length;++e)_[n.charAt(e)]=-1}var o=[],r=0,i=0;for(e=0;e<t.length;++e){var a=t.charAt(e);if("="==a)break;if(-1!=(a=_[a])){if(void 0===a)throw new Error("Illegal character at offset "+e);r|=a,++i>=4?(o[o.length]=r>>16,o[o.length]=r>>8&255,o[o.length]=255&r,r=0,i=0):r<<=6}}switch(i){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:o[o.length]=r>>10;break;case 3:o[o.length]=r>>16,o[o.length]=r>>8&255}return o},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(t){var e=m.re.exec(t);if(e)if(e[1])t=e[1];else{if(!e[2])throw new Error("RegExp out of sync");t=e[2]}return m.decode(t)}},v=function(){function t(t){this.buf=[+t||0]}return t.prototype.mulAdd=function(t,e){var n,o,r=this.buf,i=r.length;for(n=0;n<i;++n)(o=r[n]*t+e)<1e13?e=0:o-=1e13*(e=0|o/1e13),r[n]=o;e>0&&(r[n]=e)},t.prototype.sub=function(t){var e,n,o=this.buf,r=o.length;for(e=0;e<r;++e)(n=o[e]-t)<0?(n+=1e13,t=1):t=0,o[e]=n;for(;0===o[o.length-1];)o.pop()},t.prototype.toString=function(t){if(10!=(t||10))throw new Error("only base 10 is supported");for(var e=this.buf,n=e[e.length-1].toString(),o=e.length-2;o>=0;--o)n+=(1e13+e[o]).toString().substring(1);return n},t.prototype.valueOf=function(){for(var t=this.buf,e=0,n=t.length-1;n>=0;--n)e=1e13*e+t[n];return e},t.prototype.simplify=function(){var t=this.buf;return 1==t.length?t[0]:this},t}(),b="\u2026",w=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,S=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function C(t,e){return t.length>e&&(t=t.substring(0,e)+b),t}var T,A=function(){function t(e,n){this.hexDigits="0123456789ABCDEF",e instanceof t?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=n)}return t.prototype.get=function(t){if(void 0===t&&(t=this.pos++),t>=this.enc.length)throw new Error("Requesting byte offset "+t+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(t):this.enc[t]},t.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},t.prototype.hexDump=function(t,e,n){for(var o="",r=t;r<e;++r)if(o+=this.hexByte(this.get(r)),!0!==n)switch(15&r){case 7:o+="  ";break;case 15:o+="\n";break;default:o+=" "}return o},t.prototype.isASCII=function(t,e){for(var n=t;n<e;++n){var o=this.get(n);if(o<32||o>176)return!1}return!0},t.prototype.parseStringISO=function(t,e){for(var n="",o=t;o<e;++o)n+=String.fromCharCode(this.get(o));return n},t.prototype.parseStringUTF=function(t,e){for(var n="",o=t;o<e;){var r=this.get(o++);n+=r<128?String.fromCharCode(r):r>191&&r<224?String.fromCharCode((31&r)<<6|63&this.get(o++)):String.fromCharCode((15&r)<<12|(63&this.get(o++))<<6|63&this.get(o++))}return n},t.prototype.parseStringBMP=function(t,e){for(var n,o,r="",i=t;i<e;)n=this.get(i++),o=this.get(i++),r+=String.fromCharCode(n<<8|o);return r},t.prototype.parseTime=function(t,e,n){var o=this.parseStringISO(t,e),r=(n?w:S).exec(o);return r?(n&&(r[1]=+r[1],r[1]+=+r[1]<70?2e3:1900),o=r[1]+"-"+r[2]+"-"+r[3]+" "+r[4],r[5]&&(o+=":"+r[5],r[6]&&(o+=":"+r[6],r[7]&&(o+="."+r[7]))),r[8]&&(o+=" UTC","Z"!=r[8]&&(o+=r[8],r[9]&&(o+=":"+r[9]))),o):"Unrecognized time: "+o},t.prototype.parseInteger=function(t,e){for(var n,o=this.get(t),r=o>127,i=r?255:0,a="";o==i&&++t<e;)o=this.get(t);if(0==(n=e-t))return r?-1:0;if(n>4){for(a=o,n<<=3;0==(128&(+a^i));)a=+a<<1,--n;a="("+n+" bit)\n"}r&&(o-=256);for(var s=new v(o),c=t+1;c<e;++c)s.mulAdd(256,this.get(c));return a+s.toString()},t.prototype.parseBitString=function(t,e,n){for(var o=this.get(t),r="("+((e-t-1<<3)-o)+" bit)\n",i="",a=t+1;a<e;++a){for(var s=this.get(a),c=a==e-1?o:0,l=7;l>=c;--l)i+=s>>l&1?"1":"0";if(i.length>n)return r+C(i,n)}return r+i},t.prototype.parseOctetString=function(t,e,n){if(this.isASCII(t,e))return C(this.parseStringISO(t,e),n);var o=e-t,r="("+o+" byte)\n";o>(n/=2)&&(e=t+n);for(var i=t;i<e;++i)r+=this.hexByte(this.get(i));return o>n&&(r+=b),r},t.prototype.parseOID=function(t,e,n){for(var o="",r=new v,i=0,a=t;a<e;++a){var s=this.get(a);if(r.mulAdd(128,127&s),i+=7,!(128&s)){if(""===o)if((r=r.simplify())instanceof v)r.sub(80),o="2."+r.toString();else{var c=r<80?r<40?0:1:2;o=c+"."+(r-40*c)}else o+="."+r.toString();if(o.length>n)return C(o,n);r=new v,i=0}}return i>0&&(o+=".incomplete"),o},t}(),E=function(){function t(t,e,n,o,r){if(!(o instanceof O))throw new Error("Invalid tag value.");this.stream=t,this.header=e,this.length=n,this.tag=o,this.sub=r}return t.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},t.prototype.content=function(t){if(void 0===this.tag)return null;void 0===t&&(t=1/0);var e=this.posContent(),n=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+n,t);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(e)?"false":"true";case 2:return this.stream.parseInteger(e,e+n);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(e,e+n,t);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+n,t);case 6:return this.stream.parseOID(e,e+n,t);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return C(this.stream.parseStringUTF(e,e+n),t);case 18:case 19:case 20:case 21:case 22:case 26:return C(this.stream.parseStringISO(e,e+n),t);case 30:return C(this.stream.parseStringBMP(e,e+n),t);case 23:case 24:return this.stream.parseTime(e,e+n,23==this.tag.tagNumber)}return null},t.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},t.prototype.toPrettyString=function(t){void 0===t&&(t="");var e=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(e+="+"),e+=this.length,this.tag.tagConstructed?e+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(e+=" (encapsulates)"),e+="\n",null!==this.sub){t+="  ";for(var n=0,o=this.sub.length;n<o;++n)e+=this.sub[n].toPrettyString(t)}return e},t.prototype.posStart=function(){return this.stream.pos},t.prototype.posContent=function(){return this.stream.pos+this.header},t.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},t.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},t.decodeLength=function(t){var e=t.get(),n=127&e;if(n==e)return n;if(n>6)throw new Error("Length over 48 bits not supported at position "+(t.pos-1));if(0===n)return null;e=0;for(var o=0;o<n;++o)e=256*e+t.get();return e},t.prototype.getHexStringValue=function(){var t=this.toHexString(),e=2*this.header,n=2*this.length;return t.substr(e,n)},t.decode=function(e){var n;n=e instanceof A?e:new A(e,0);var o=new A(n),r=new O(n),i=t.decodeLength(n),a=n.pos,s=a-o.pos,c=null,l=function(){var e=[];if(null!==i){for(var o=a+i;n.pos<o;)e[e.length]=t.decode(n);if(n.pos!=o)throw new Error("Content size is not correct for container starting at offset "+a)}else try{for(;;){var r=t.decode(n);if(r.tag.isEOC())break;e[e.length]=r}i=a-n.pos}catch(s){throw new Error("Exception while decoding undefined length content: "+s)}return e};if(r.tagConstructed)c=l();else if(r.isUniversal()&&(3==r.tagNumber||4==r.tagNumber))try{if(3==r.tagNumber&&0!=n.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");c=l();for(var u=0;u<c.length;++u)if(c[u].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(p){c=null}if(null===c){if(null===i)throw new Error("We can't skip over an invalid tag with undefined length at offset "+a);n.pos=a+Math.abs(i)}return new t(o,s,i,r,c)},t}(),O=function(){function t(t){var e=t.get();if(this.tagClass=e>>6,this.tagConstructed=0!=(32&e),this.tagNumber=31&e,31==this.tagNumber){var n=new v;do{e=t.get(),n.mulAdd(128,127&e)}while(128&e);this.tagNumber=n.simplify()}}return t.prototype.isUniversal=function(){return 0===this.tagClass},t.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},t}(),P=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],R=(1<<26)/P[P.length-1],N=function(){function t(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}return t.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var o,r=(1<<e)-1,i=!1,a="",s=this.t,c=this.DB-s*this.DB%e;if(s-- >0)for(c<this.DB&&(o=this[s]>>c)>0&&(i=!0,a=n(o));s>=0;)c<e?(o=(this[s]&(1<<c)-1)<<e-c,o|=this[--s]>>(c+=this.DB-e)):(o=this[s]>>(c-=e)&r,c<=0&&(c+=this.DB,--s)),o>0&&(i=!0),i&&(a+=n(o));return i?a:"0"},t.prototype.negate=function(){var e=H();return t.ZERO.subTo(this,e),e},t.prototype.abs=function(){return this.s<0?this.negate():this},t.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},t.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+j(this[this.t-1]^this.s&this.DM)},t.prototype.mod=function(e){var n=H();return this.abs().divRemTo(e,null,n),this.s<0&&n.compareTo(t.ZERO)>0&&e.subTo(n,n),n},t.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new M(e):new L(e),this.exp(t,n)},t.prototype.clone=function(){var t=H();return this.copyTo(t),t},t.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},t.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},t.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},t.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},t.prototype.toByteArray=function(){var t=this.t,e=[];e[0]=this.s;var n,o=this.DB-t*this.DB%8,r=0;if(t-- >0)for(o<this.DB&&(n=this[t]>>o)!=(this.s&this.DM)>>o&&(e[r++]=n|this.s<<this.DB-o);t>=0;)o<8?(n=(this[t]&(1<<o)-1)<<8-o,n|=this[--t]>>(o+=this.DB-8)):(n=this[t]>>(o-=8)&255,o<=0&&(o+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e},t.prototype.equals=function(t){return 0==this.compareTo(t)},t.prototype.min=function(t){return this.compareTo(t)<0?this:t},t.prototype.max=function(t){return this.compareTo(t)>0?this:t},t.prototype.and=function(t){var e=H();return this.bitwiseTo(t,o,e),e},t.prototype.or=function(t){var e=H();return this.bitwiseTo(t,r,e),e},t.prototype.xor=function(t){var e=H();return this.bitwiseTo(t,i,e),e},t.prototype.andNot=function(t){var e=H();return this.bitwiseTo(t,a,e),e},t.prototype.not=function(){for(var t=H(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},t.prototype.shiftLeft=function(t){var e=H();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},t.prototype.shiftRight=function(t){var e=H();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},t.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+s(this[t]);return this.s<0?this.t*this.DB:-1},t.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=c(this[n]^e);return t},t.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},t.prototype.setBit=function(t){return this.changeBit(t,r)},t.prototype.clearBit=function(t){return this.changeBit(t,a)},t.prototype.flipBit=function(t){return this.changeBit(t,i)},t.prototype.add=function(t){var e=H();return this.addTo(t,e),e},t.prototype.subtract=function(t){var e=H();return this.subTo(t,e),e},t.prototype.multiply=function(t){var e=H();return this.multiplyTo(t,e),e},t.prototype.divide=function(t){var e=H();return this.divRemTo(t,e,null),e},t.prototype.remainder=function(t){var e=H();return this.divRemTo(t,null,e),e},t.prototype.divideAndRemainder=function(t){var e=H(),n=H();return this.divRemTo(t,e,n),[e,n]},t.prototype.modPow=function(t,e){var n,o,r=t.bitLength(),i=U(1);if(r<=0)return i;n=r<18?1:r<48?3:r<144?4:r<768?5:6,o=r<8?new M(e):e.isEven()?new D(e):new L(e);var a=[],s=3,c=n-1,l=(1<<n)-1;if(a[1]=o.convert(this),n>1){var u=H();for(o.sqrTo(a[1],u);s<=l;)a[s]=H(),o.mulTo(u,a[s-2],a[s]),s+=2}var p,h,d=t.t-1,f=!0,y=H();for(r=j(t[d])-1;d>=0;){for(r>=c?p=t[d]>>r-c&l:(p=(t[d]&(1<<r+1)-1)<<c-r,d>0&&(p|=t[d-1]>>this.DB+r-c)),s=n;0==(1&p);)p>>=1,--s;if((r-=s)<0&&(r+=this.DB,--d),f)a[p].copyTo(i),f=!1;else{for(;s>1;)o.sqrTo(i,y),o.sqrTo(y,i),s-=2;s>0?o.sqrTo(i,y):(h=i,i=y,y=h),o.mulTo(y,a[p],i)}for(;d>=0&&0==(t[d]&1<<r);)o.sqrTo(i,y),h=i,i=y,y=h,--r<0&&(r=this.DB-1,--d)}return o.revert(i)},t.prototype.modInverse=function(e){var n=e.isEven();if(this.isEven()&&n||0==e.signum())return t.ZERO;for(var o=e.clone(),r=this.clone(),i=U(1),a=U(0),s=U(0),c=U(1);0!=o.signum();){for(;o.isEven();)o.rShiftTo(1,o),n?(i.isEven()&&a.isEven()||(i.addTo(this,i),a.subTo(e,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;r.isEven();)r.rShiftTo(1,r),n?(s.isEven()&&c.isEven()||(s.addTo(this,s),c.subTo(e,c)),s.rShiftTo(1,s)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);o.compareTo(r)>=0?(o.subTo(r,o),n&&i.subTo(s,i),a.subTo(c,a)):(r.subTo(o,r),n&&s.subTo(i,s),c.subTo(a,c))}return 0!=r.compareTo(t.ONE)?t.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},t.prototype.pow=function(t){return this.exp(t,new I)},t.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var o=e;e=n,n=o}var r=e.getLowestSetBit(),i=n.getLowestSetBit();if(i<0)return e;for(r<i&&(i=r),i>0&&(e.rShiftTo(i,e),n.rShiftTo(i,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return i>0&&n.lShiftTo(i,n),n},t.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=P[P.length-1]){for(e=0;e<P.length;++e)if(n[0]==P[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<P.length;){for(var o=P[e],r=e+1;r<P.length&&o<R;)o*=P[r++];for(o=n.modInt(o);e<r;)if(o%P[e++]==0)return!1}return n.millerRabin(t)},t.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},t.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},t.prototype.fromString=function(e,n){var o;if(16==n)o=4;else if(8==n)o=3;else if(256==n)o=8;else if(2==n)o=1;else if(32==n)o=5;else{if(4!=n)return void this.fromRadix(e,n);o=2}this.t=0,this.s=0;for(var r=e.length,i=!1,a=0;--r>=0;){var s=8==o?255&+e[r]:B(e,r);s<0?"-"==e.charAt(r)&&(i=!0):(i=!1,0==a?this[this.t++]=s:a+o>this.DB?(this[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this[this.t++]=s>>this.DB-a):this[this.t-1]|=s<<a,(a+=o)>=this.DB&&(a-=this.DB))}8==o&&0!=(128&+e[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&t.ZERO.subTo(this,this)},t.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},t.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},t.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},t.prototype.lShiftTo=function(t,e){for(var n=t%this.DB,o=this.DB-n,r=(1<<o)-1,i=Math.floor(t/this.DB),a=this.s<<n&this.DM,s=this.t-1;s>=0;--s)e[s+i+1]=this[s]>>o|a,a=(this[s]&r)<<n;for(s=i-1;s>=0;--s)e[s]=0;e[i]=a,e.t=this.t+i+1,e.s=this.s,e.clamp()},t.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var o=t%this.DB,r=this.DB-o,i=(1<<o)-1;e[0]=this[n]>>o;for(var a=n+1;a<this.t;++a)e[a-n-1]|=(this[a]&i)<<r,e[a-n]=this[a]>>o;o>0&&(e[this.t-n-1]|=(this.s&i)<<r),e.t=this.t-n,e.clamp()}},t.prototype.subTo=function(t,e){for(var n=0,o=0,r=Math.min(t.t,this.t);n<r;)o+=this[n]-t[n],e[n++]=o&this.DM,o>>=this.DB;if(t.t<this.t){for(o-=t.s;n<this.t;)o+=this[n],e[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<t.t;)o-=t[n],e[n++]=o&this.DM,o>>=this.DB;o-=t.s}e.s=o<0?-1:0,o<-1?e[n++]=this.DV+o:o>0&&(e[n++]=o),e.t=n,e.clamp()},t.prototype.multiplyTo=function(e,n){var o=this.abs(),r=e.abs(),i=o.t;for(n.t=i+r.t;--i>=0;)n[i]=0;for(i=0;i<r.t;++i)n[i+o.t]=o.am(0,r[i],n,i,0,o.t);n.s=0,n.clamp(),this.s!=e.s&&t.ZERO.subTo(n,n)},t.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var o=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,o,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},t.prototype.divRemTo=function(e,n,o){var r=e.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)return null!=n&&n.fromInt(0),void(null!=o&&this.copyTo(o));null==o&&(o=H());var a=H(),s=this.s,c=e.s,l=this.DB-j(r[r.t-1]);l>0?(r.lShiftTo(l,a),i.lShiftTo(l,o)):(r.copyTo(a),i.copyTo(o));var u=a.t,p=a[u-1];if(0!=p){var h=p*(1<<this.F1)+(u>1?a[u-2]>>this.F2:0),d=this.FV/h,f=(1<<this.F1)/h,y=1<<this.F2,_=o.t,g=_-u,m=null==n?H():n;for(a.dlShiftTo(g,m),o.compareTo(m)>=0&&(o[o.t++]=1,o.subTo(m,o)),t.ONE.dlShiftTo(u,m),m.subTo(a,a);a.t<u;)a[a.t++]=0;for(;--g>=0;){var v=o[--_]==p?this.DM:Math.floor(o[_]*d+(o[_-1]+y)*f);if((o[_]+=a.am(0,v,o,g,0,u))<v)for(a.dlShiftTo(g,m),o.subTo(m,o);o[_]<--v;)o.subTo(m,o)}null!=n&&(o.drShiftTo(u,n),s!=c&&t.ZERO.subTo(n,n)),o.t=u,o.clamp(),l>0&&o.rShiftTo(l,o),s<0&&t.ZERO.subTo(o,o)}}},t.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},t.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},t.prototype.exp=function(e,n){if(e>4294967295||e<1)return t.ONE;var o=H(),r=H(),i=n.convert(this),a=j(e)-1;for(i.copyTo(o);--a>=0;)if(n.sqrTo(o,r),(e&1<<a)>0)n.mulTo(r,i,o);else{var s=o;o=r,r=s}return n.revert(o)},t.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},t.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),o=U(n),r=H(),i=H(),a="";for(this.divRemTo(o,r,i);r.signum()>0;)a=(n+i.intValue()).toString(t).substr(1)+a,r.divRemTo(o,r,i);return i.intValue().toString(t)+a},t.prototype.fromRadix=function(e,n){this.fromInt(0),null==n&&(n=10);for(var o=this.chunkSize(n),r=Math.pow(n,o),i=!1,a=0,s=0,c=0;c<e.length;++c){var l=B(e,c);l<0?"-"==e.charAt(c)&&0==this.signum()&&(i=!0):(s=n*s+l,++a>=o&&(this.dMultiply(r),this.dAddOffset(s,0),a=0,s=0))}a>0&&(this.dMultiply(Math.pow(n,a)),this.dAddOffset(s,0)),i&&t.ZERO.subTo(this,this)},t.prototype.fromNumber=function(e,n,o){if("number"==typeof n)if(e<2)this.fromInt(1);else for(this.fromNumber(e,o),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),r,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(n);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(t.ONE.shiftLeft(e-1),this);else{var i=[],a=7&e;i.length=1+(e>>3),n.nextBytes(i),a>0?i[0]&=(1<<a)-1:i[0]=0,this.fromString(i,256)}},t.prototype.bitwiseTo=function(t,e,n){var o,r,i=Math.min(t.t,this.t);for(o=0;o<i;++o)n[o]=e(this[o],t[o]);if(t.t<this.t){for(r=t.s&this.DM,o=i;o<this.t;++o)n[o]=e(this[o],r);n.t=this.t}else{for(r=this.s&this.DM,o=i;o<t.t;++o)n[o]=e(r,t[o]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},t.prototype.changeBit=function(e,n){var o=t.ONE.shiftLeft(e);return this.bitwiseTo(o,n,o),o},t.prototype.addTo=function(t,e){for(var n=0,o=0,r=Math.min(t.t,this.t);n<r;)o+=this[n]+t[n],e[n++]=o&this.DM,o>>=this.DB;if(t.t<this.t){for(o+=t.s;n<this.t;)o+=this[n],e[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<t.t;)o+=t[n],e[n++]=o&this.DM,o>>=this.DB;o+=t.s}e.s=o<0?-1:0,o>0?e[n++]=o:o<-1&&(e[n++]=this.DV+o),e.t=n,e.clamp()},t.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},t.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},t.prototype.multiplyLowerTo=function(t,e,n){var o=Math.min(this.t+t.t,e);for(n.s=0,n.t=o;o>0;)n[--o]=0;for(var r=n.t-this.t;o<r;++o)n[o+this.t]=this.am(0,t[o],n,o,0,this.t);for(r=Math.min(t.t,e);o<r;++o)this.am(0,t[o],n,o,0,e-o);n.clamp()},t.prototype.multiplyUpperTo=function(t,e,n){--e;var o=n.t=this.t+t.t-e;for(n.s=0;--o>=0;)n[o]=0;for(o=Math.max(e-this.t,0);o<t.t;++o)n[this.t+o-e]=this.am(e-o,t[o],n,0,0,this.t+o-e);n.clamp(),n.drShiftTo(1,n)},t.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var o=this.t-1;o>=0;--o)n=(e*n+this[o])%t;return n},t.prototype.millerRabin=function(e){var n=this.subtract(t.ONE),o=n.getLowestSetBit();if(o<=0)return!1;var r=n.shiftRight(o);(e=e+1>>1)>P.length&&(e=P.length);for(var i=H(),a=0;a<e;++a){i.fromInt(P[Math.floor(Math.random()*P.length)]);var s=i.modPow(r,this);if(0!=s.compareTo(t.ONE)&&0!=s.compareTo(n)){for(var c=1;c++<o&&0!=s.compareTo(n);)if(0==(s=s.modPowInt(2,this)).compareTo(t.ONE))return!1;if(0!=s.compareTo(n))return!1}}return!0},t.prototype.square=function(){var t=H();return this.squareTo(t),t},t.prototype.gcda=function(t,e){var n=this.s<0?this.negate():this.clone(),o=t.s<0?t.negate():t.clone();if(n.compareTo(o)<0){var r=n;n=o,o=r}var i=n.getLowestSetBit(),a=o.getLowestSetBit();if(a<0)e(n);else{i<a&&(a=i),a>0&&(n.rShiftTo(a,n),o.rShiftTo(a,o));var s=function(){(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),(i=o.getLowestSetBit())>0&&o.rShiftTo(i,o),n.compareTo(o)>=0?(n.subTo(o,n),n.rShiftTo(1,n)):(o.subTo(n,o),o.rShiftTo(1,o)),n.signum()>0?setTimeout(s,0):(a>0&&o.lShiftTo(a,o),setTimeout(function(){e(o)},0))};setTimeout(s,10)}},t.prototype.fromNumberAsync=function(e,n,o,i){if("number"==typeof n)if(e<2)this.fromInt(1);else{this.fromNumber(e,o),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),r,this),this.isEven()&&this.dAddOffset(1,0);var a=this,s=function(){a.dAddOffset(2,0),a.bitLength()>e&&a.subTo(t.ONE.shiftLeft(e-1),a),a.isProbablePrime(n)?setTimeout(function(){i()},0):setTimeout(s,0)};setTimeout(s,0)}else{var c=[],l=7&e;c.length=1+(e>>3),n.nextBytes(c),l>0?c[0]&=(1<<l)-1:c[0]=0,this.fromString(c,256)}},t}(),I=function(){function t(){}return t.prototype.convert=function(t){return t},t.prototype.revert=function(t){return t},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},t.prototype.sqrTo=function(t,e){t.squareTo(e)},t}(),M=function(){function t(t){this.m=t}return t.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},t.prototype.revert=function(t){return t},t.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}(),L=function(){function t(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}return t.prototype.convert=function(t){var e=H();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(N.ZERO)>0&&this.m.subTo(e,e),e},t.prototype.revert=function(t){var e=H();return t.copyTo(e),this.reduce(e),e},t.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],o=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,o,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}(),D=function(){function t(t){this.m=t,this.r2=H(),this.q3=H(),N.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t)}return t.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=H();return t.copyTo(e),this.reduce(e),e},t.prototype.revert=function(t){return t},t.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}();function H(){return new N(null)}function k(t,e){return new N(t,e)}"Microsoft Internet Explorer"==navigator.appName?(N.prototype.am=function(t,e,n,o,r,i){for(var a=32767&e,s=e>>15;--i>=0;){var c=32767&this[t],l=this[t++]>>15,u=s*c+l*a;r=((c=a*c+((32767&u)<<15)+n[o]+(1073741823&r))>>>30)+(u>>>15)+s*l+(r>>>30),n[o++]=1073741823&c}return r},T=30):"Netscape"!=navigator.appName?(N.prototype.am=function(t,e,n,o,r,i){for(;--i>=0;){var a=e*this[t++]+n[o]+r;r=Math.floor(a/67108864),n[o++]=67108863&a}return r},T=26):(N.prototype.am=function(t,e,n,o,r,i){for(var a=16383&e,s=e>>14;--i>=0;){var c=16383&this[t],l=this[t++]>>14,u=s*c+l*a;r=((c=a*c+((16383&u)<<14)+n[o]+r)>>28)+(u>>14)+s*l,n[o++]=268435455&c}return r},T=28),N.prototype.DB=T,N.prototype.DM=(1<<T)-1,N.prototype.DV=1<<T,N.prototype.FV=Math.pow(2,52),N.prototype.F1=52-T,N.prototype.F2=2*T-52;var x,F,G=[];for(x="0".charCodeAt(0),F=0;F<=9;++F)G[x++]=F;for(x="a".charCodeAt(0),F=10;F<36;++F)G[x++]=F;for(x="A".charCodeAt(0),F=10;F<36;++F)G[x++]=F;function B(t,e){var n=G[t.charCodeAt(e)];return null==n?-1:n}function U(t){var e=H();return e.fromInt(t),e}function j(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}N.ZERO=U(0),N.ONE=U(1);var W,V,z=function(){function t(){this.i=0,this.j=0,this.S=[]}return t.prototype.init=function(t){var e,n,o;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,o=this.S[e],this.S[e]=this.S[n],this.S[n]=o;this.i=0,this.j=0},t.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]},t}(),K=256,Y=null,J=0;if(null==Y){Y=[],V=0;var X=void 0;if(window.crypto&&window.crypto.getRandomValues){var q=new Uint32Array(256);for(window.crypto.getRandomValues(q),X=0;X<q.length;++X)Y[V++]=255&q[X]}var Q=function(t){if(J>=256||V>=K)window.removeEventListener?window.removeEventListener("mousemove",Q,!1):window.detachEvent&&window.detachEvent("onmousemove",Q);else try{var e=t.x+t.y;Y[V++]=255&e,J+=1}catch(n){}};window.addEventListener?window.addEventListener("mousemove",Q,!1):window.attachEvent&&window.attachEvent("onmousemove",Q)}function Z(){if(null==W){for(W=new z;V<K;){var t=Math.floor(65536*Math.random());Y[V++]=255&t}for(W.init(Y),V=0;V<Y.length;++V)Y[V]=0;V=0}return W.next()}var $=function(){function t(){}return t.prototype.nextBytes=function(t){for(var e=0;e<t.length;++e)t[e]=Z()},t}();function tt(t,e){if(e<t.length+22)return console.error("Message too long for RSA"),null;for(var n=e-t.length-6,o="",r=0;r<n;r+=2)o+="ff";return k("0001"+o+"00"+t,16)}function et(t,e){if(e<t.length+11)return console.error("Message too long for RSA"),null;for(var n=[],o=t.length-1;o>=0&&e>0;){var r=t.charCodeAt(o--);r<128?n[--e]=r:r>127&&r<2048?(n[--e]=63&r|128,n[--e]=r>>6|192):(n[--e]=63&r|128,n[--e]=r>>6&63|128,n[--e]=r>>12|224)}n[--e]=0;for(var i=new $,a=[];e>2;){for(a[0]=0;0==a[0];)i.nextBytes(a);n[--e]=a[0]}return n[--e]=2,n[--e]=0,new N(n)}var nt=function(){function t(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return t.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},t.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(n)<0;)e=e.add(this.p);return e.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},t.prototype.setPublic=function(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=k(t,16),this.e=parseInt(e,16)):console.error("Invalid RSA public key")},t.prototype.encrypt=function(t){var e=et(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var o=n.toString(16);return 0==(1&o.length)?o:"0"+o},t.prototype.setPrivate=function(t,e,n){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=k(t,16),this.e=parseInt(e,16),this.d=k(n,16)):console.error("Invalid RSA private key")},t.prototype.setPrivateEx=function(t,e,n,o,r,i,a,s){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=k(t,16),this.e=parseInt(e,16),this.d=k(n,16),this.p=k(o,16),this.q=k(r,16),this.dmp1=k(i,16),this.dmq1=k(a,16),this.coeff=k(s,16)):console.error("Invalid RSA private key")},t.prototype.generate=function(t,e){var n=new $,o=t>>1;this.e=parseInt(e,16);for(var r=new N(e,16);;){for(;this.p=new N(t-o,1,n),0!=this.p.subtract(N.ONE).gcd(r).compareTo(N.ONE)||!this.p.isProbablePrime(10););for(;this.q=new N(o,1,n),0!=this.q.subtract(N.ONE).gcd(r).compareTo(N.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var i=this.p;this.p=this.q,this.q=i}var a=this.p.subtract(N.ONE),s=this.q.subtract(N.ONE),c=a.multiply(s);if(0==c.gcd(r).compareTo(N.ONE)){this.n=this.p.multiply(this.q),this.d=r.modInverse(c),this.dmp1=this.d.mod(a),this.dmq1=this.d.mod(s),this.coeff=this.q.modInverse(this.p);break}}},t.prototype.decrypt=function(t){var e=k(t,16),n=this.doPrivate(e);return null==n?null:ot(n,this.n.bitLength()+7>>3)},t.prototype.generateAsync=function(t,e,n){var o=new $,r=t>>1;this.e=parseInt(e,16);var i=new N(e,16),a=this,s=function(){var e=function(){if(a.p.compareTo(a.q)<=0){var t=a.p;a.p=a.q,a.q=t}var e=a.p.subtract(N.ONE),o=a.q.subtract(N.ONE),r=e.multiply(o);0==r.gcd(i).compareTo(N.ONE)?(a.n=a.p.multiply(a.q),a.d=i.modInverse(r),a.dmp1=a.d.mod(e),a.dmq1=a.d.mod(o),a.coeff=a.q.modInverse(a.p),setTimeout(function(){n()},0)):setTimeout(s,0)},c=function(){a.q=H(),a.q.fromNumberAsync(r,1,o,function(){a.q.subtract(N.ONE).gcda(i,function(t){0==t.compareTo(N.ONE)&&a.q.isProbablePrime(10)?setTimeout(e,0):setTimeout(c,0)})})},l=function(){a.p=H(),a.p.fromNumberAsync(t-r,1,o,function(){a.p.subtract(N.ONE).gcda(i,function(t){0==t.compareTo(N.ONE)&&a.p.isProbablePrime(10)?setTimeout(c,0):setTimeout(l,0)})})};setTimeout(l,0)};setTimeout(s,0)},t.prototype.sign=function(t,e,n){var o=tt((rt[n]||"")+e(t).toString(),this.n.bitLength()/4);if(null==o)return null;var r=this.doPrivate(o);if(null==r)return null;var i=r.toString(16);return 0==(1&i.length)?i:"0"+i},t.prototype.verify=function(t,e,n){var o=k(e,16),r=this.doPublic(o);return null==r?null:it(r.toString(16).replace(/^1f+00/,""))==n(t).toString()},t}();function ot(t,e){for(var n=t.toByteArray(),o=0;o<n.length&&0==n[o];)++o;if(n.length-o!=e-1||2!=n[o])return null;for(++o;0!=n[o];)if(++o>=n.length)return null;for(var r="";++o<n.length;){var i=255&n[o];i<128?r+=String.fromCharCode(i):i>191&&i<224?(r+=String.fromCharCode((31&i)<<6|63&n[o+1]),++o):(r+=String.fromCharCode((15&i)<<12|(63&n[o+1])<<6|63&n[o+2]),o+=2)}return r}var rt={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};function it(t){for(var e in rt)if(rt.hasOwnProperty(e)){var n=rt[e],o=n.length;if(t.substr(0,o)==n)return t.substr(o)}return t}var at={};at.lang={extend:function(t,e,n){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var o=function(){};if(o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),n){var r;for(r in n)t.prototype[r]=n[r];var i=function(){},a=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(i=function(t,e){for(r=0;r<a.length;r+=1){var n=a[r],o=e[n];"function"==typeof o&&o!=Object.prototype[n]&&(t[n]=o)}})}catch(s){}i(t.prototype,n)}}};var st={};void 0!==st.asn1&&st.asn1||(st.asn1={}),st.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var o="",r=0;r<n;r++)o+="f";e=new N(o,16).xor(t).add(N.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return hextopem(t,e)},this.newObject=function(t){var e=st.asn1,n=e.DERBoolean,o=e.DERInteger,r=e.DERBitString,i=e.DEROctetString,a=e.DERNull,s=e.DERObjectIdentifier,c=e.DEREnumerated,l=e.DERUTF8String,u=e.DERNumericString,p=e.DERPrintableString,h=e.DERTeletexString,d=e.DERIA5String,f=e.DERUTCTime,y=e.DERGeneralizedTime,_=e.DERSequence,g=e.DERSet,m=e.DERTaggedObject,v=e.ASN1Util.newObject,b=Object.keys(t);if(1!=b.length)throw"key of param shall be only one.";var w=b[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+w+":"))throw"undefined key: "+w;if("bool"==w)return new n(t[w]);if("int"==w)return new o(t[w]);if("bitstr"==w)return new r(t[w]);if("octstr"==w)return new i(t[w]);if("null"==w)return new a(t[w]);if("oid"==w)return new s(t[w]);if("enum"==w)return new c(t[w]);if("utf8str"==w)return new l(t[w]);if("numstr"==w)return new u(t[w]);if("prnstr"==w)return new p(t[w]);if("telstr"==w)return new h(t[w]);if("ia5str"==w)return new d(t[w]);if("utctime"==w)return new f(t[w]);if("gentime"==w)return new y(t[w]);if("seq"==w){for(var S=t[w],C=[],T=0;T<S.length;T++){var A=v(S[T]);C.push(A)}return new _({array:C})}if("set"==w){for(S=t[w],C=[],T=0;T<S.length;T++)A=v(S[T]),C.push(A);return new g({array:C})}if("tag"==w){var E=t[w];if("[object Array]"===Object.prototype.toString.call(E)&&3==E.length){var O=v(E[2]);return new m({tag:E[0],explicit:E[1],obj:O})}var P={};if(void 0!==E.explicit&&(P.explicit=E.explicit),void 0!==E.tag&&(P.tag=E.tag),void 0===E.obj)throw"obj shall be specified for 'tag'.";return P.obj=v(E.obj),new m(P)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},st.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),o=(e=Math.floor(n/40)+"."+n%40,""),r=2;r<t.length;r+=2){var i=("00000000"+parseInt(t.substr(r,2),16).toString(2)).slice(-8);o+=i.substr(1,7),"0"==i.substr(0,1)&&(e=e+"."+new N(o,2).toString(10),o="")}return e},st.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",o=new N(t,10).toString(2),r=7-o.length%7;7==r&&(r=0);for(var i="",a=0;a<r;a++)i+="0";for(o=i+o,a=0;a<o.length-1;a+=7){var s=o.substr(a,7);a!=o.length-7&&(s="1"+s),n+=e(parseInt(s,2))}return n};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var o="",r=t.split("."),i=40*parseInt(r[0])+parseInt(r[1]);o+=e(i),r.splice(0,2);for(var a=0;a<r.length;a++)o+=n(r[a]);return o},st.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var n=e.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},st.asn1.DERAbstractString=function(t){st.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},at.lang.extend(st.asn1.DERAbstractString,st.asn1.ASN1Object),st.asn1.DERAbstractTime=function(){st.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,n){var o=this.zeroPadding,r=this.localDateToUTC(t),i=String(r.getFullYear());"utc"==e&&(i=i.substr(2,2));var a=i+o(String(r.getMonth()+1),2)+o(String(r.getDate()),2)+o(String(r.getHours()),2)+o(String(r.getMinutes()),2)+o(String(r.getSeconds()),2);if(!0===n){var s=r.getMilliseconds();if(0!=s){var c=o(String(s),3);a=a+"."+(c=c.replace(/[0]+$/,""))}}return a+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(t)},this.setByDateValue=function(t,e,n,o,r,i){var a=new Date(Date.UTC(t,e-1,n,o,r,i,0));this.setByDate(a)},this.getFreshValueHex=function(){return this.hV}},at.lang.extend(st.asn1.DERAbstractTime,st.asn1.ASN1Object),st.asn1.DERAbstractStructured=function(t){st.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},at.lang.extend(st.asn1.DERAbstractStructured,st.asn1.ASN1Object),st.asn1.DERBoolean=function(){st.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},at.lang.extend(st.asn1.DERBoolean,st.asn1.ASN1Object),st.asn1.DERInteger=function(t){st.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=st.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new N(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},at.lang.extend(st.asn1.DERInteger,st.asn1.ASN1Object),st.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=st.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}st.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var n=0;n<=e;n++)t+="0";var o="";for(n=0;n<t.length-1;n+=8){var r=t.substr(n,8),i=parseInt(r,2).toString(16);1==i.length&&(i="0"+i),o+=i}this.hTLV=null,this.isModified=!0,this.hV="0"+e+o},this.setByBooleanArray=function(t){for(var e="",n=0;n<t.length;n++)1==t[n]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},at.lang.extend(st.asn1.DERBitString,st.asn1.ASN1Object),st.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=st.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}st.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},at.lang.extend(st.asn1.DEROctetString,st.asn1.DERAbstractString),st.asn1.DERNull=function(){st.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},at.lang.extend(st.asn1.DERNull,st.asn1.ASN1Object),st.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",o=new N(t,10).toString(2),r=7-o.length%7;7==r&&(r=0);for(var i="",a=0;a<r;a++)i+="0";for(o=i+o,a=0;a<o.length-1;a+=7){var s=o.substr(a,7);a!=o.length-7&&(s="1"+s),n+=e(parseInt(s,2))}return n};st.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var o="",r=t.split("."),i=40*parseInt(r[0])+parseInt(r[1]);o+=e(i),r.splice(0,2);for(var a=0;a<r.length;a++)o+=n(r[a]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=o},this.setValueName=function(t){var e=st.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},at.lang.extend(st.asn1.DERObjectIdentifier,st.asn1.ASN1Object),st.asn1.DEREnumerated=function(t){st.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=st.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new N(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},at.lang.extend(st.asn1.DEREnumerated,st.asn1.ASN1Object),st.asn1.DERUTF8String=function(t){st.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},at.lang.extend(st.asn1.DERUTF8String,st.asn1.DERAbstractString),st.asn1.DERNumericString=function(t){st.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},at.lang.extend(st.asn1.DERNumericString,st.asn1.DERAbstractString),st.asn1.DERPrintableString=function(t){st.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},at.lang.extend(st.asn1.DERPrintableString,st.asn1.DERAbstractString),st.asn1.DERTeletexString=function(t){st.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},at.lang.extend(st.asn1.DERTeletexString,st.asn1.DERAbstractString),st.asn1.DERIA5String=function(t){st.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},at.lang.extend(st.asn1.DERIA5String,st.asn1.DERAbstractString),st.asn1.DERUTCTime=function(t){st.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},at.lang.extend(st.asn1.DERUTCTime,st.asn1.DERAbstractTime),st.asn1.DERGeneralizedTime=function(t){st.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},at.lang.extend(st.asn1.DERGeneralizedTime,st.asn1.DERAbstractTime),st.asn1.DERSequence=function(t){st.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++)t+=this.asn1Array[e].getEncodedHex();return this.hV=t,this.hV}},at.lang.extend(st.asn1.DERSequence,st.asn1.DERAbstractStructured),st.asn1.DERSet=function(t){st.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var n=this.asn1Array[e];t.push(n.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},at.lang.extend(st.asn1.DERSet,st.asn1.DERAbstractStructured),st.asn1.DERTaggedObject=function(t){st.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,n){this.hT=e,this.isExplicit=t,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},at.lang.extend(st.asn1.DERTaggedObject,st.asn1.ASN1Object);var ct=function(t){function e(n){var o=t.call(this)||this;return n&&("string"==typeof n?o.parseKey(n):(e.hasPrivateKeyProperty(n)||e.hasPublicKeyProperty(n))&&o.parsePropertiesFrom(n)),o}return y(e,t),e.prototype.parseKey=function(t){try{var e=0,n=0,o=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(t)?g(t):m.unarmor(t),r=E.decode(o);if(3===r.sub.length&&(r=r.sub[2].sub[0]),9===r.sub.length){e=r.sub[1].getHexStringValue(),this.n=k(e,16),n=r.sub[2].getHexStringValue(),this.e=parseInt(n,16);var i=r.sub[3].getHexStringValue();this.d=k(i,16);var a=r.sub[4].getHexStringValue();this.p=k(a,16);var s=r.sub[5].getHexStringValue();this.q=k(s,16);var c=r.sub[6].getHexStringValue();this.dmp1=k(c,16);var l=r.sub[7].getHexStringValue();this.dmq1=k(l,16);var u=r.sub[8].getHexStringValue();this.coeff=k(u,16)}else{if(2!==r.sub.length)return!1;var p=r.sub[1].sub[0];e=p.sub[0].getHexStringValue(),this.n=k(e,16),n=p.sub[1].getHexStringValue(),this.e=parseInt(n,16)}return!0}catch(h){return!1}},e.prototype.getPrivateBaseKey=function(){var t={array:[new st.asn1.DERInteger({int:0}),new st.asn1.DERInteger({bigint:this.n}),new st.asn1.DERInteger({int:this.e}),new st.asn1.DERInteger({bigint:this.d}),new st.asn1.DERInteger({bigint:this.p}),new st.asn1.DERInteger({bigint:this.q}),new st.asn1.DERInteger({bigint:this.dmp1}),new st.asn1.DERInteger({bigint:this.dmq1}),new st.asn1.DERInteger({bigint:this.coeff})]};return new st.asn1.DERSequence(t).getEncodedHex()},e.prototype.getPrivateBaseKeyB64=function(){return p(this.getPrivateBaseKey())},e.prototype.getPublicBaseKey=function(){var t=new st.asn1.DERSequence({array:[new st.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new st.asn1.DERNull]}),e=new st.asn1.DERSequence({array:[new st.asn1.DERInteger({bigint:this.n}),new st.asn1.DERInteger({int:this.e})]}),n=new st.asn1.DERBitString({hex:"00"+e.getEncodedHex()});return new st.asn1.DERSequence({array:[t,n]}).getEncodedHex()},e.prototype.getPublicBaseKeyB64=function(){return p(this.getPublicBaseKey())},e.wordwrap=function(t,e){if(!t)return t;var n="(.{1,"+(e=e||64)+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(n,"g")).join("\n")},e.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";return(t+=e.wordwrap(this.getPrivateBaseKeyB64())+"\n")+"-----END RSA PRIVATE KEY-----"},e.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";return(t+=e.wordwrap(this.getPublicBaseKeyB64())+"\n")+"-----END PUBLIC KEY-----"},e.hasPublicKeyProperty=function(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")},e.hasPrivateKeyProperty=function(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")},e.prototype.parsePropertiesFrom=function(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)},e}(nt),lt=function(){function t(t){t=t||{},this.default_key_size=parseInt(t.default_key_size,10)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null}return t.prototype.setKey=function(t){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new ct(t)},t.prototype.setPrivateKey=function(t){this.setKey(t)},t.prototype.setPublicKey=function(t){this.setKey(t)},t.prototype.decrypt=function(t){try{return this.getKey().decrypt(h(t))}catch(e){return!1}},t.prototype.encrypt=function(t){try{return p(this.getKey().encrypt(t))}catch(e){return!1}},t.prototype.sign=function(t,e,n){try{return p(this.getKey().sign(t,e,n))}catch(o){return!1}},t.prototype.verify=function(t,e,n){try{return this.getKey().verify(t,h(e),n)}catch(o){return!1}},t.prototype.getKey=function(t){if(!this.key){if(this.key=new ct,t&&"[object Function]"==={}.toString.call(t))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,t);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},t.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},t.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},t.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},t.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},t.version="3.0.0-rc.1",t}();window.JSEncrypt=lt,t.JSEncrypt=lt,t.default=lt,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?o(n):"function"==typeof define&&define.amd?define(["exports"],o):o(this.JSEncrypt={}),n.default=e.exports.JSEncrypt,cc._RF.pop()},{}],JsbEvent:[function(t,e,n){"use strict";cc._RF.push(e,"74d62gSR31ApovYIf8k0KPg","JsbEvent"),Object.defineProperty(n,"__esModule",{value:!0}),n.default={INIT_AD:"INIT_AD",LOAD_REWARD_VIDEO_AD:"LOAD_REWARD_VIDEO_AD",SHOW_REWARD_VIDEO_AD:"SHOW_REWARD_VIDEO_AD",REWARD_AD_ON_ERROR:"REWARD_AD_ON_ERROR",LOAD_INTERSTITIAL_AD:"LOAD_INTERSTITIAL_AD",SHOW_INTERSTITIAL_AD:"SHOW_INTERSTITIAL_AD",INTERSTITIAL_AD_ON_ERROR:"INTERSTITIAL_AD_ON_ERROR",LOAD_BANNER_AD:"LOAD_BANNER_AD",SHOW_BANNER_AD:"SHOW_BANNER_AD",HIDE_BANNER_AD:"HIDE_BANNER_AD",COPY_TO_CLIPBOARD:"COPY_TO_CLIPBOARD",OPEN_TAP_TAP_TALK:"OPEN_TAP_TAP_TALK",APPLE_LOGIN:"APPLE_LOGIN",WX_APP_LOGIN:"WX_APP_LOGIN",WX_SHARE_LINK:"WX_SHARE_LINK",UMENG_ENENT:"UMENG_ENENT",REQUEST_PERMISSION:"REQUEST_PERMISSION",GET_PACKAGE_SIGN:"GET_PACKAGE_SIGN",WX_SHARE_MINIGAME:"WX_SHARE_MINIGAME",WX_SHARE_IMAGE:"WX_SHARE_IMAGE",SAVE_PHOTO:"SAVE_PHOTO",SAVE_PHOTO_PERMIT:"SAVE_PHOTO_PERMIT",PHOTO_PERMIT:"PHOTO_PERMIT",GDTACTION_EVENT:"GDTACTION_EVENT",FACEBOOK_LOGIN:"FACEBOOK_LOGIN",TWITTER_LOGIN:"TWITTER_LOGIN",TWITTER_SHARE:"TWITTER_SHARE",FACEBOOK_SHARE_LINK:"FACEBOOK_SHARE_LINK",FACEBOOK_SHARE_PHOTO:"FACEBOOK_SHARE_PHOTO",GDTACTION_EVENT_JSON:{reward_ad_load_time:"gt_ad_request"},OPEN_WEIBO:"OPEN_WEIBO",INIT_PAY:"INIT_PAY",GDTACTION_START:"GDTACTION_START",IAP_INIT:"IAP_INIT",GOOLE_PAY:"GOOLE_PAY",APPLE_PAY:"APPLE_PAY",GET_LOST_ORDER_LIST:"GET_LOST_ORDER_LIST",CONSUME_ORDER:"CONSUME_ORDER",GET_DEVICE_TOKEN:"GET_DEVICE_TOKEN",GET_DEVICE_INFO:"GET_DEVICE_INFO",REPORT_REGISTER:"REPORT_REGISTER",GET_INSTALL_PARAMS:"GET_INSTALL_PARAMS",GOOGLE_LOGIN:"GOOGLE_LOGIN",AF_EVENT:"AF_EVENT",FIREBASE_EVENT:"FIREBASE_EVENT",OPEN_APP_SETTING:"OPEN_APP_SETTING",GET_HOST_ADDRESS:"GET_HOST_ADDRESS",GET_AD_INFO:"GET_AD_INFO",WEIBO_SHARE:"WEIBO_SHARE",SEND_GDT_OPENID:"SEND_GDT_OPENID",LOAD_NATIVE_AD:"LOAD_NATIVE_AD",SHOW_NATIVE_AD:"SHOW_NATIVE_AD",CLOSE_NATIVE_AD:"CLOSE_NATIVE_AD",CHECK_NOTICE_ENABLED:"CHECK_NOTICE_ENABLED",GO_TO_SETTING:"GO_TO_SETTING",INS_SHARE:"INS_SHARE",OPEN_KEFU:"OPEN_KEFU",INIT_SDK:"INIT_SDK",MEMORY_WARNING:"MEMORY_WARNING",MEMORY_WARNING_INIT:"MEMORY_WARNING_INIT",GDTACTION_EVENT_EXPOSE_AD:"GDTACTION_EVENT_EXPOSE_AD",CHECK_PERMISSION:"CHECK_PERMISSION",TRACKING_EVENT:"TRACKING_EVENT",PANGLE_EVENT:"PANGLE_EVENT"},cc._RF.pop()},{}],JsbHelper:[function(t,e,n){"use strict";cc._RF.push(e,"f0959nt7kZD4ouaBQwexIDW","JsbHelper");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../core/utils/Utils"),s=t("../event/JsbEvent"),c=t("./GameHelper"),l=function(){function t(){this.iapCfg={}}return t.prototype.cast=function(t,e,n,o){this.send(t,JSON.stringify(n)),e&&eventMgr.once(t,e,o)},t.prototype.call=function(t,e){return r(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return this.send(t,JSON.stringify(e)),[4,eventMgr.wait(t)];case 1:return[2,n.sent()]}})})},t.prototype.send=function(t,e){e&&""!=e||(e="{}"),ut.isMobile()?setTimeout(function(){ut.isAndroid()?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsbHelper","request","(Ljava/lang/String;Ljava/lang/String;)V",t,e):ut.isIos()&&jsb.reflection.callStaticMethod("jsbHelp","request:JsonStr:",t,e)}):lplog.info("jsbHelper jsb not found",t)},t.prototype.on=function(t,e,n){eventMgr.on(t,e,n)},t.prototype.off=function(t,e,n){eventMgr.off(t,e,n)},t.prototype.emit=function(t,e){if(lplog.info("jsbEmit",t,JSON.stringify(e)),e)for(var n in e)"true"==e[n]?e[n]=!0:"false"==e[n]&&(e[n]=!1);eventMgr.emit(t,e)},t.prototype.getPackageSign=function(){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return ut.isAndroid()&&c.gameHelper.isInland()?[4,jsbHelper.call(s.default.GET_PACKAGE_SIGN)]:[3,2];case 1:return[2,t.sent().sign];case 2:return[2]}})})},t.prototype.getDeviceType=function(){return ut.isAndroid()?"":jsb.reflection.callStaticMethod("jsbHelp","getDeviceName")},t.prototype.initIAP=function(t){return void 0===t&&(t=60),r(this,void 0,void 0,function(){var e,n,o;return i(this,function(r){switch(r.label){case 0:if(c.gameHelper.isInland())return[2];e=function(){var e,o,r,a,l,u,p,h,d,f,y,_,g,m,v,b,w,S,C;return i(this,function(i){switch(i.label){case 0:return t--,e=c.gameHelper.isInland()?"in_purchase":"purchase",o=c.gameHelper.getPurchaseDatas().map(function(t){return t[e]}),r=Date.now(),void 0,a=ut.isAndroid()?{key:o}:{key:o.join(",")},[4,n.call(s.default.IAP_INIT,a)];case 1:if(l=i.sent(),u=l.error,p=l.result,lplog.info("initIAP cost",Date.now()-r),u)return[3,2];if(h=[],ut.isIos())for(d=p.split("|"),f=0;f<d.length;++f)y=d[f],_=y.split(","),g=_[0],m=_[1],v=_[2],b=_[3],h.push({productId:g,price:m,currency_pay:v,currency_price:b});else h=p;for(w=0,S=h;w<S.length;w++)C=S[w],n.iapCfg[C.productId]=C;return[2,{value:{result:p}}];case 2:return console.error("initIAP err",u),[4,ut.wait(3)];case 3:i.sent(),i.label=4;case 4:return[2]}})},n=this,r.label=1;case 1:return t>0?[5,e()]:[3,3];case 2:return"object"==typeof(o=r.sent())?[2,o.value]:[3,1];case 3:return[2]}})})},t.prototype.getIAPCfg=function(){return this.iapCfg},o([a.util.callOnce],t.prototype,"initIAP",null),t}();n.default=l,window.jsbHelper=new l,cc._RF.pop()},{"../../../core/utils/Utils":"Utils","../event/JsbEvent":"JsbEvent","./GameHelper":"GameHelper"}],LabelAutoAdaptSize:[function(t,e,n){"use strict";cc._RF.push(e,"b267f35Q+dJv4m8OiluFkr8","LabelAutoAdaptSize");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.requireComponent,u=a.menu,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=cc.v2(),e.minScaleWidth=.8,e.checkStringChange=!0,e.initScale=1,e.label=null,e.initFontSize=20,e.initLineHeight=20,e.initOverflow=cc.Label.Overflow.NONE,e.fontSizeRatio=1,e.preSize=cc.v2(),e.preString=null,e.preFontSize=20,e.lineCount=1,e.isEnable=!1,e.orgY=0,e}return r(e,t),e.prototype.onLoad=function(){this.label=this.getComponent(cc.Label),this.init()},e.prototype.reset=function(){this.label&&(this.autoFixSize(),this.preString="",this.update(0))},e.prototype.init=function(){this.initScale=this.node.scale,this.preFontSize=this.initFontSize=this.label.fontSize,this.initLineHeight=this.label.lineHeight,this.initOverflow=this.label.overflow,this.fontSizeRatio=this.initFontSize/this.label.lineHeight,this.size.y<this.initLineHeight&&(this.size.y=this.initLineHeight),this.lineCount=1,this.orgY=this.size.y,this.autoFixSize()},e.prototype.autoFixSize=function(){this.label.font?this.size.y=this.orgY:this.getComponent(cc.LabelOutline)?this.size.y=1.2*this.orgY:this.size.y=1.1*this.orgY},e.prototype.onEnable=function(){this.isEnable||(this.isEnable=!0,this.label.overflow===cc.Label.Overflow.RESIZE_HEIGHT&&(0===this.size.x?this.size.x=this.node.width:this.node.width=this.size.x),this.label._forceUpdateRenderData())},e.prototype.update=function(){var t=this.node.width,e=this.node.height;if(null===this.preString||this.checkStringChange&&this.preString!==this.label.string)this.preString=this.label.string,this.label._forceUpdateRenderData(),t=this.node.width,e=this.node.height;else if(this.preFontSize!==this.label.fontSize);else if(0===t||this.preSize.equals2(t,e))return;if(this.preSize.set2(t,e),this.label.overflow===cc.Label.Overflow.NONE){if(this.preFontSize!==this.label.fontSize)return this.label.lineHeight=this.initLineHeight,this.setFontSize(this.initFontSize),this.preSize.set2(-1,-1);if(t<=this.size.x&&e<=this.size.y)return void(this.node.scale=this.initScale);var n=e>this.size.y?this.size.y/e:this.size.x/t;if(n>=this.minScaleWidth||this.size.y<=this.label.lineHeight)return void(this.node.scale=n*this.initScale);this.label.overflow=cc.Label.Overflow.RESIZE_HEIGHT,this.node.width=this.size.x,this.node.scale=this.initScale,this.updateLineHeight(2,1)}else if(this.label.overflow===cc.Label.Overflow.RESIZE_HEIGHT){var o=e>this.size.y?1:-1;this.updateLineHeight(this.lineCount+o,o)}},e.prototype.updateLineHeight=function(t,e){if(this.lineCount=t,this.lineCount<=1)this.lineCount=1,this.label.lineHeight=this.initLineHeight,this.setFontSize(this.initFontSize),this.initOverflow===cc.Label.Overflow.NONE?this.label.overflow=cc.Label.Overflow.NONE:(this.label._forceUpdateRenderData(),this.node.height>this.size.y?this.updateLineHeight(2,1):(this.preSize.set2(this.node.width,this.node.height),this.adaptSpineSize(this.preSize)));else{var n=this.label.lineHeight=Math.min(this.initLineHeight,Math.floor(this.size.y/t));this.setFontSize(Math.floor(n*this.fontSizeRatio)),this.label._forceUpdateRenderData();var o=this.node.height;e>0&&o>this.size.y||e<0&&o<this.size.y?this.updateLineHeight(t+e,e):e<0&&o>this.size.y?this.updateLineHeight(t+1,1):(this.preSize.set2(this.node.width,o),this.adaptSpineSize(this.preSize))}},e.prototype.adaptSpineSize=function(){},e.prototype.setFontSize=function(t){this.preFontSize=this.label.fontSize=t},e.prototype.setSize=function(t){this.size.equals(t)||(this.size.set(t),this.preSize.set2(0,0),this.label&&this.init(),this.isEnable&&(this.isEnable=!1,this.onEnable()))},e.prototype.setMinScaleWidth=function(t){this.minScaleWidth=t},i([c(cc.Vec2)],e.prototype,"size",void 0),i([c],e.prototype,"minScaleWidth",void 0),i([c],e.prototype,"checkStringChange",void 0),i([s,u("\u591a\u8bed\u8a00\u7ec4\u4ef6/LabelAutoAdaptSize"),l(cc.Label)],e)}(cc.Component);n.default=p,cc.LabelAutoAdaptSize=p,cc._RF.pop()},{}],LabelMaskCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"2435aUyRSdCIJ2iFGuKziYA","LabelMaskCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.range=cc.size(0,0),e.labelNode=null,e.checkTime=1,e.lastSize=cc.size(0,0),e}return r(e,t),e.prototype.update=function(t){this.checkTime-=t,this.checkTime<=0&&(this.checkTime=1,this.checkRange())},e.prototype.checkRange=function(){var t=this.labelNode.getContentSize();this.lastSize.equals(t)||(this.lastSize.width=t.width,this.lastSize.height=t.height,this.lastSize.height>this.range.height?this.rollHeight():(this.labelNode.stopAllActions(),this.labelNode.y=0))},e.prototype.check=function(){this.labelNode.Component(cc.Label)._forceUpdateRenderData(),this.checkRange()},e.prototype.rollHeight=function(){this.labelNode.stopAllActions();var t=.5*(this.node.height-this.labelNode.height),e=-t;this.labelNode.y=t;var n=.05*Math.abs(t);cc.tween(this.labelNode).sequence(cc.delayTime(2),cc.moveTo(n,0,e),cc.delayTime(2),cc.moveTo(n,0,t)).repeatForever().start()},i([c()],e.prototype,"range",void 0),i([c(cc.Node)],e.prototype,"labelNode",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],LabelRollNumber:[function(t,e,n){"use strict";cc._RF.push(e,"a99e6I+L/JOWINCotk265XT","LabelRollNumber");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a,s=cc._decorator,c=s.ccclass,l=s.property,u=s.requireComponent,p=s.menu;(function(t){t[t.NONE=0]="NONE",t[t.COMMA=1]="COMMA"})(a||(a={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=.5,e.type=a.NONE,e.prefix="",e._label=null,e._start=0,e._end=0,e.elapsed=0,e.time=0,e}return r(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label||(this._label=this.getComponent(cc.Label)),this._label},enumerable:!1,configurable:!0}),e.prototype.getCurrNumber=function(){var t=this.label.string;return this.type===a.COMMA&&(t=t.replace(/,/g,"")),this.prefix&&(t=t.replace(this.prefix,"")),Number(t)},e.prototype.format=function(t){var e=t+"";return this.type===a.COMMA&&(e=ut.formatNumberByComma(t)),this.prefix+e},e.prototype.update=function(t){if(0!==this.time)if(this.elapsed+=t,this.elapsed>=this.time)this.time=0,this.label.string=this.format(this._end);else{var e=Math.floor(this._start+(this._end-this._start)*this.sineOut());this.label.string=this.format(e)}},e.prototype.sineOut=function(){return Math.sin(this.elapsed/this.time*Math.PI*.5)},e.prototype.setPrefix=function(t){return this.prefix=t,this},e.prototype.set=function(t){return this.time=0,this.label.string=this.format(t),this},e.prototype.to=function(t,e){this._start=this.getCurrNumber(),this._start!==t&&(this._end=t,this.elapsed=0,this.time=e||this.duration)},e.prototype.by=function(t,e){t&&(this._start=this.getCurrNumber(),this._end=Math.max(this._start+t,0),this.elapsed=0,this.time=e||this.duration)},e.prototype.run=function(t,e,n){this.set(t),this.to(e,n)},i([l()],e.prototype,"duration",void 0),i([l({type:cc.Enum(a)})],e.prototype,"type",void 0),i([l()],e.prototype,"prefix",void 0),i([c,p("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/LabelRollNumber"),u(cc.Label)],e)}(cc.Component);n.default=h,cc.LabelRollNumber=h,cc._RF.pop()},{}],LabelTimer:[function(t,e,n){"use strict";cc._RF.push(e,"37b09imgMpEbpFEmXhZUc6V","LabelTimer");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../script/common/helper/GameHelper"),s=cc._decorator,c=s.ccclass,l=s.property,u=s.menu,p=s.requireComponent,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.format="hh:mm:ss",e.endTime=0,e.prefix="",e._label=null,e.pause=!1,e.formatFunc=null,e.time=0,e.tempTime=0,e.callback=null,e.startTime=0,e.speed=1,e}return r(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label||(this._label=this.getComponent(cc.Label)),this._label},enumerable:!1,configurable:!0}),e.prototype.setPause=function(t){this.pause=t},e.prototype.setPrefix=function(t){return this.prefix=t,this},e.prototype.setFormat=function(t){return"string"==typeof t?(this.format=t,this.formatFunc=null):"function"==typeof t&&(this.format="",this.formatFunc=t),this},e.prototype.setEndTime=function(t){return this.endTime=t,this},e.prototype.run=function(t,e){this.time=t,this.speed=ut.normalizeNumber(this.endTime-t),this.callback=e,this.tempTime=Math.floor(this.time),this.startTime=a.gameHelper.now(),this.updateLabelString()},e.prototype.setTime=function(t){this.time=t,this.speed=ut.normalizeNumber(this.endTime-t),this.tempTime=Math.floor(this.time),this.startTime=a.gameHelper.now()},Object.defineProperty(e.prototype,"string",{get:function(){return this.label.string},set:function(t){this.time=-1,this.tempTime=-1,this.startTime=0,this.callback=null,this.label.string=t},enumerable:!1,configurable:!0}),e.prototype.getTime=function(){return this.time},e.prototype.update=function(){if(0!==this.startTime&&!this.pause){var t=a.gameHelper.now(),e=.001*(t-this.startTime);this.startTime=t,this.time+=e*this.speed;var n=Math.floor(this.time);this.tempTime!==n&&(this.tempTime=n,this.speed<0&&this.tempTime<=this.endTime||this.speed>0&&this.tempTime>=this.endTime?(this.startTime=0,this.tempTime=this.endTime,this.updateLabelString(),this.callback&&this.callback(),this.callback=null):this.updateLabelString())}},e.prototype.updateLabelString=function(){var t;this.format?this.label.string=this.prefix+ut.millisecondFormat(1e3*this.tempTime,this.format):this.formatFunc?this.label.string=this.prefix+(null!==(t=this.formatFunc(this.tempTime))&&void 0!==t?t:this.tempTime):this.label.string=this.prefix+this.tempTime},i([l()],e.prototype,"format",void 0),i([l()],e.prototype,"endTime",void 0),i([l()],e.prototype,"prefix",void 0),i([c,u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/LabelTimer"),p(cc.Label)],e)}(cc.Component);n.default=h,cc.LabelTimer=h,cc._RF.pop()},{"../../script/common/helper/GameHelper":"GameHelper"}],LabelWaitDot:[function(t,e,n){"use strict";cc._RF.push(e,"36939br9zhHZ4F0UWXjtbg9","LabelWaitDot");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.requireComponent,u=a.menu,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.interval=.5,e.label=null,e.originalString="",e.dot="",e.elapsed=0,e.running=!1,e.pause=!1,e}return r(e,t),e.prototype.onLoad=function(){this.label=this.getComponent(cc.Label)},e.prototype.onEnable=function(){this.pause=!1},e.prototype.onDisable=function(){this.pause=!0},e.prototype.play=function(t){this.originalString=this.label.string=void 0!==t?t:this.label.string,this.dot="",this.elapsed=0,this.running=!0},e.prototype.stop=function(t){this.running=!1,this.label.string=void 0!==t?t:void 0===this.originalString?this.label.string:this.originalString,this.originalString="",this.dot=""},e.prototype.tick=function(){this.dot.length<3?this.dot+=".":this.dot="",this.label.string=this.originalString+this.dot},e.prototype.update=function(t){this.running&&!this.pause&&(this.elapsed+=t,this.elapsed>=this.interval&&(this.elapsed-=this.interval,this.tick()))},i([c()],e.prototype,"interval",void 0),i([s,u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/LabelWaitDot"),l(cc.Label)],e)}(cc.Component);n.default=p,cc.LabelWaitDot=p,cc._RF.pop()},{}],LanguageMgr:[function(t,e,n){"use strict";cc._RF.push(e,"76675uqFEtHnZ3jtRPUtdPZ","LanguageMgr"),Object.defineProperty(n,"__esModule",{value:!0}),n.languageMgr=void 0;var o=function(){function t(){this._change=!1,this._lang=""}return t.prototype.init=function(t,e){this._lang=t,this._change=!!e},Object.defineProperty(t.prototype,"change",{get:function(){return this._change},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lang",{get:function(){return this._lang},set:function(t){this._lang=t,localStorage.setItem("__@lang__",t),assetsMgr.changeLangJson(t)},enumerable:!1,configurable:!0}),t}();n.languageMgr=new o,cc._RF.pop()},{}],LevelBootPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"7ccd2FbsmFFw5eLl7Kltd+n","LevelBootPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/GameHelper"),l=t("../../common/helper/ResHelper"),u=t("../../common/helper/ViewHelper"),p=cc._decorator.ccclass,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameNode_=null,e.flagLeftNode_=null,e.flagRightNode_=null,e.rewardLbl_=null,e.targetLbl_=null,e.titleLbl_=null,e.targetLayoutNode_=null,e.rewardLayoutNode_=null,e.animNode_=null,e.hardNode_=null,e.levelJson=null,e.level=1,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("LevelBootPnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){cc.log("LevelBootPnlCtrl onEnter");var e=t.data,n=c.gameHelper.global.level;this.levelJson=e,this.level=n,this.titleLbl_.setLocaleKey("level_title",n);var o=this.levelJson.questList,r=o.some(function(t){return 0==t.type});this.animNode_.active=r,this.targetLayoutNode_.active=!r,r?this.animNode_.Child("content/text",cc.Label).string=""+o[0].count:this.targetLayoutNode_.Items(e.questList,function(t,e){l.resHelper.loadTargetIcon(t,"level_item_gem_"+e.type,"level"),t.Child("text",cc.Label).string=""+e.count});var i=c.gameHelper.getLevelRewardBy(n);this.rewardLayoutNode_.Items(i,function(t,e){l.resHelper.loadTempIcon(t,""+e.id,"level"),t.Child("text",cc.Label).string=""+e.count});var a=n%5==0;this.flagLeftNode_.Component(cc.MultiFrame).setFrame(a?1:0),this.flagRightNode_.Component(cc.MultiFrame).setFrame(a?1:0),this.hardNode_.active=a},e.prototype.onRemove=function(){cc.log("LevelBootPnlCtrl onRemove")},e.prototype.onClean=function(){cc.log("LevelBootPnlCtrl onClean")},e.prototype.onClickClose1=function(t,e){cc.log("onClickClose1",e),this.close()},e.prototype.onClickGame=function(t,e){cc.log("onClickGame",e),this.play()},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close()},e.prototype.play=function(){return a(this,void 0,void 0,function(){return s(this,function(){return c.gameHelper.global.getHeart()<=0?(u.viewHelper.showPnl("common/Heart"),this.close(),[2]):(u.viewHelper.gotoWind("level",{data:this.levelJson,level:this.level}),this.isValid&&this.close(),[2])})})},i([p],e)}(mc.BasePnlCmpt);n.default=h,cc._RF.pop()},{"../../common/helper/GameHelper":"GameHelper","../../common/helper/ResHelper":"ResHelper","../../common/helper/ViewHelper":"ViewHelper"}],LevelRevivePnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"aa359sM9LtH/bU7fZC+zexu","LevelRevivePnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Enums"),l=t("../../common/helper/GameHelper"),u=t("../../common/helper/ViewHelper"),p=cc._decorator.ccclass,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coinSpr_=null,e.costLbl_=null,e.adStatusNode_=null,e.freeLbl_=null,e.descLbl_=null,e.titleLbl_=null,e.cb=null,e.cost=200,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("LevelRevivePnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){cc.log("LevelRevivePnlCtrl onEnter"),this.setParam({adIndex:1}),this.cb=null==t?void 0:t.cb,cc.log("RevivePnlCtrl onEnter"),this.costLbl_.string=""+this.cost,l.gameHelper.ad.initCurrentAd(c.AdType.REWARD);var e=l.gameHelper.ad.isAdReady();this.adStatusNode_.Component(cc.MultiFrame).setFrame(e?0:1)},e.prototype.onRemove=function(){cc.log("LevelRevivePnlCtrl onRemove")},e.prototype.onClean=function(){cc.log("LevelRevivePnlCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.cb&&this.cb(!1),l.gameHelper.global.addHeart(-1),this.close()},e.prototype.onClickRevive=function(t,e){cc.log("onClickRevive",e),cc.log("onClickRevive",e);var n=l.gameHelper.global.getCoin();n<this.cost?u.viewHelper.showAlert("coin_not_enough"):(l.gameHelper.global.setCoin(n-this.cost),this.cb&&this.cb(!0),this.close())},e.prototype.onClickReviveAd=function(t,e){cc.log("onClickReviveAd",e),this.btnADHandler()},e.prototype.btnADHandler=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,l.gameHelper.ad.showAd(c.AdPropType.Revive)];case 1:return(t=e.sent())&&t.status==c.RewardAdStatus.SUCCESS&&(this.cb&&this.cb(!0),this.isValid&&this.close()),[2]}})})},i([p],e)}(mc.BasePnlCmpt);n.default=h,cc._RF.pop()},{"../../common/constant/Enums":"Enums","../../common/helper/GameHelper":"GameHelper","../../common/helper/ViewHelper":"ViewHelper"}],LevelSettingPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"31d9aKntaJJsIAQnalfs2vV","LevelSettingPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/ShareHelper"),l=t("../../common/helper/ViewHelper"),u=cc._decorator.ccclass,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.soundNode_=null,e.titleLbl_=null,e.exitNode_=null,e.retryNode_=null,e.gameNode_=null,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("LevelSettingPnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){cc.log("LevelSettingPnlCtrl onEnter")},e.prototype.onRemove=function(){cc.log("LevelSettingPnlCtrl onRemove")},e.prototype.onClean=function(){cc.log("LevelSettingPnlCtrl onClean")},e.prototype.onClickClose1=function(t,e){cc.log("onClickClose1",e),this.close()},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close()},e.prototype.onClickSound=function(t,e){cc.log("onClickSound",e);var n=audioMgr.sfxVolume;audioMgr.sfxVolume=1==n?0:1,this.refreshSound()},e.prototype.onClickShare=function(t,e){cc.log("onClickShare",e),c.shareHelper.share("")},e.prototype.onClickExit=function(t,e){cc.log("onClickExit",e),this.confirmExit()},e.prototype.onClickGame=function(t,e){cc.log("onClickGame",e),this.close()},e.prototype.confirmExit=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){l.viewHelper.showPnl("level/LostLife",{callback:function(e){t(e)}})})];case 1:return t.sent()&&(this.isValid&&this.close(),l.viewHelper.gotoWind("main")),[2]}})})},e.prototype.refreshSound=function(){this.soundNode_.Child("on").active=audioMgr.sfxVolume>0,this.soundNode_.Child("off").active=audioMgr.sfxVolume<=0},i([u],e)}(mc.BasePnlCmpt);n.default=p,cc._RF.pop()},{"../../common/helper/ShareHelper":"ShareHelper","../../common/helper/ViewHelper":"ViewHelper"}],LevelWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"144deSdW49MJKzx/wz1U7gl","LevelWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../core/component/LabelRollNumber"),l=t("../../../core/component/MultiFrame"),u=t("../../common/constant/Constant"),p=t("../../common/constant/Enums"),h=t("../../common/event/EventType"),d=t("../../common/helper/AnimHelper"),f=t("../../common/helper/GameHelper"),y=t("../../common/helper/ResHelper"),_=t("../../common/helper/ViewHelper"),g=t("../../model/common/BlockObj"),m=t("../../model/common/ColorGemShapeObj"),v=t("../cmpt/game/BlockCmpt"),b=t("../cmpt/game/GemShapeCmpt"),w=cc._decorator.ccclass,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelLbl_=null,e.comCoinNode_=null,e.countLbl_=null,e.coinNode_=null,e.targetLayoutNode_=null,e.targetScoreNode_=null,e.scoreBarSpr_=null,e.atNode_=null,e.moveNode_=null,e.rotateNode_=null,e.rotationSp_=null,e.rotationLbl_=null,e.costNode_=null,e.costLbl_=null,e.gridsNode_=null,e.shadowsNode_=null,e.hintsNode_=null,e.blocksNode_=null,e.shapesNode_=null,e.rotatesNode_=null,e.topShapesNode_=null,e.levelJson=null,e.level=1,e.targetMap=new Map,e.realTargetMap=new Map,e.score=0,e.blockList=[],e.shapeList=[],e.shapeContainers=[],e.shadowList=[],e.hintsList=[],e.rotateHints_=[],e.moved=!1,e.up=!1,e.presetShapes=[],e.reviveTime=0,e}return r(e,t),e.prototype.eventMaps=function(){var t,e;return[(t={},t[h.default.UPDATE_COIN]=this.onUpdateCoin,t),(e={},e[h.default.UPDATE_ROTATE]=this.onUpdateRotate,e)]},e.prototype.onUpdateRotate=function(){this.model.getRotation()>0?(this.costNode_.active=!1,this.rotationLbl_.string=""+this.model.getRotation()):(this.costNode_.active=!0,this.rotationLbl_.string=""),this.rotationSp_.play("idle")},Object.defineProperty(e.prototype,"model",{get:function(){return f.gameHelper.global},enumerable:!1,configurable:!0}),e.prototype.onUpdateCoin=function(){this.countLbl_.string=this.model.getCoin()},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("LevelWindCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){var e=this;cc.log("LevelWindCtrl onEnter");var n=t.data,o=f.gameHelper.global.level;this.levelJson=n,this.level=o,this.levelJson.questList.map(function(t){e.targetMap.set(t.type,t.count),e.realTargetMap.set(t.type,t.count)}),this.levelLbl_.setLocaleKey("level",o);var r=this.levelJson.presetShapes;this.presetShapes=r.split(","),this.onUpdateCoin(),this.initGridAndShadow(),this.initRotate(),this.initRotateAnim(),this.updateTarget(),this.costLbl_.string=""+u.ROTATE_COST,this.startGame(n,o)},e.prototype.onClean=function(){cc.log("LevelWindCtrl onClean")},e.prototype.onClickBack=function(t,e){cc.log("onClickBack",e),_.viewHelper.showPnl("level/LevelSetting")},e.prototype.onClickCoin=function(t,e){cc.log("onClickCoin",e),_.viewHelper.showPnl("common/Shop")},e.prototype.onClickRotate=function(t,e){cc.log("onClickRotate",e),0==this.model.getRotation()&&this.model.getCoin()<u.ROTATE_COST?(this.rotationSp_.play("idle"),this.model.getCoin()<u.ROTATE_COST&&_.viewHelper.showPnl("common/Shop")):(this.switchRotate(),audioMgr.playSFX("audio_start_rotate"))},e.prototype.switchRotate=function(){var t=this;"ues"!=this.rotationSp_.animation?(this.rotationSp_.play("ues"),this.shapeContainers.forEach(function(e,n){if(cc.isValid(e)){var o=t.rotateHints_[n];o&&t.setRotateHintActive(o)}})):this.closeRotate()},e.prototype.initGridAndShadow=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(){return t=[],this.gridsNode_.children.map(function(e){t.push(e.getPosition())}),this.shadowsNode_.Items(u.MAX_X*u.MAX_Y,function(n,o,r){n.setPosition(t[r]),n.setActive(!1),e.shadowList[r]=n}),this.hintsNode_.Items(u.MAX_X*u.MAX_Y,function(n,o,r){n.setPosition(t[r]),n.setActive(!1),e.hintsList[r]=n}),[2]})})},e.prototype.initRotate=function(){this.model.getRotation()>0?(this.costNode_.active=!1,this.rotationLbl_.string=""+this.model.getRotation()):(this.costNode_.active=!0,this.rotationLbl_.string=""),this.rotationSp_.play("idle"),this.rotationSp_.loop=!0},e.prototype.initRotateAnim=function(){var t=this;this.rotatesNode_.children[0]&&(this.rotateHints_.forEach(function(t){return null==t?void 0:t.destroy()}),this.rotateHints_=[],this.rotatesNode_.Items(3,function(e,n,o){var r=e;r.active=!1;var i=u.CONTAINER_POS_LIST[o];r.setPosition(i.x,i.y),r.Child("icon"),t.rotateHints_[o]=r}))},e.prototype.addEvents=function(){var t=this.shapesNode_;t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.startGame=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(n){switch(n.label){case 0:return mc.lockTouch(!0),this.model.setRevive(0),this.shapesNode_.destroyAllChildren(),this.blocksNode_.cleanAllChildren(),this.refreshShapeContainers(),this.shapeList.length=0,[4,Promise.all([this.playTargetAnim(),this.initBlockList(this.blocksNode_,t).then(function(){e.initShapes()})])];case 1:return n.sent(),this.addEvents(),mc.lockTouch(!1),[2]}})})},e.prototype.updateTarget=function(t){var e=this;void 0===t&&(t=!1);var n=this.levelJson.questList,o=n.some(function(t){return 0==t.type});this.targetScoreNode_.active=o,this.targetLayoutNode_.active=!o,o?(this.scoreBarSpr_.fillRange=0,this.moveNode_.Child("text",cc.Label).string=""+this.score,this.moveNode_.x=370*this.score/this.getMaxScore()-185,this.atNode_.Child("text",cc.Label).string=""+this.getMaxScore()):this.targetLayoutNode_.Items(n,function(t,n){var o=t.Child("content");y.resHelper.loadTargetIcon(o,"level_item_gem_"+n.type,"level");var r=e.targetMap.get(n.type);o.Child("text",cc.Label).string=r>0?""+r:"",o.Child("complete").setActive(r<=0),t.Data=n.type})},e.prototype.getMaxScore=function(){var t=this.levelJson.questList;return Math.max.apply(Math,t.map(function(t){return t.count}))},e.prototype.playTargetAnim=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r=this;return s(this,function(){return t=this.levelJson.questList,e=t.some(function(t){return 0==t.type}),this.targetLayoutNode_.active=!1,this.atNode_.active=!1,n=e?this.atNode_.convertToWorldSpaceAR(cc.Vec2.ZERO):this.targetLayoutNode_.convertToWorldSpaceAR(cc.Vec2.ZERO),o=function(){r.isValid&&(r.atNode_.active=e,r.targetLayoutNode_.active=!e,e?!r.atNode_.Child("TARGET_REACHED")&&d.animHelper.playTargetReached(r.atNode_,cc.Vec2.ZERO,"level"):r.targetLayoutNode_.children.forEach(function(t){t.active=!0,t.Child("content").scale=.8,d.animHelper.playTargetReached(t,cc.Vec2.ZERO,"level"),cc.tween(t.Child("content")).to(.2,{scale:1},{easing:cc.easing.backOut}).start()}))},_.viewHelper.showPnl("level/TargetShow",{data:this.levelJson,level:this.level,targetPos:n,callback:o}),[2]})})},e.prototype.initBlockList=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a,c,l,p,h,d,y,_,m;return s(this,function(s){switch(s.label){case 0:return n=[],[4,assetsMgr.loadTempRes("block",cc.Prefab,"block")];case 1:for(o=s.sent(),r=ut.stringToNumbers(e.placeList,","),i=0;i<u.MAX_X;++i){for(a=[],c=0;c<u.MAX_Y;++c)l=c*u.MAX_Y+i,p=r[l],(h=Number(p))>0?(d=cc.instantiate2(o,t),y=f.gameHelper.getBoardPosBy(i,c),d.setPosition(y),_=(new g.default).init(h,[c,i]),(m=d.getComponent(v.default))||(m=d.addComponent(v.default)),m.init(_).initView(),a.push(d)):a.push(null);n.push(a)}return this.blockList=n,[2]}})})},e.prototype.initShapes=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(n){switch(n.label){case 0:return t=[],this.getColorShapes().map(function(n,o){n.add=!1,t.push(e.createShape(n,o))}),[4,Promise.all(t)];case 1:return n.sent(),[2]}})})},e.prototype.refreshShapeContainers=function(){var t=this;this.shapeContainers=[new cc.Node("shape_0"),new cc.Node("shape_1"),new cc.Node("shape_2")],this.shapeContainers.forEach(function(e,n){e.setContentSize(250),e.Data=n,e.parent=t.shapesNode_,e.setPosition(u.CONTAINER_POS_LIST[n])})},e.prototype.onTouchStart=function(t){return a(this,void 0,void 0,function(){var e,n,o=this;return s(this,function(r){switch(r.label){case 0:return this.isTargetFinish()?[2]:(e=t.getLocation(),f.gameHelper.lastTopTouchTime=f.gameHelper.now(),this.shapeContainer?[2]:(this.shapeContainer=this.findTouchedShapeContainer(e),this.shapeContainer?(this.moved=!1,this.up=!1,(n=this.shapeContainer.Child("shape",b.default))?this.isRotateUsing()?(this.scheduleOnce(function(){return o.goUp(e,n)},.18),[3,3]):[3,1]:(this.shapeContainer=null,[2])):[2]));case 1:return[4,this.goUp(e,n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.goUp=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a,c,l=this;return s(this,function(s){switch(s.label){case 0:return!this.shapeContainer||this.moved||this.up?[2]:(this.unscheduleAllCallbacks(),this.up=!0,n=this.shapeContainer.Data,(o=this.rotateHints_[n])&&(o.active=!1),f.gameHelper.changeParent(this.topShapesNode_,this.shapeContainer),r=t.add(cc.v2(0,u.TOUCH_OFFSET_Y)),i=this.topShapesNode_.convertToNodeSpaceAR(r),a=i.x,c=i.y,this.showOnlyPlaceHint(e),audioMgr.playSFX("common/go_up"),[4,new Promise(function(t){var e=l.shapeContainer.Child("shape");e.children.forEach(function(t){cc.tween(t).to(.02,{scale:.8}).start()}),cc.tween(e).to(.02,{scale:1}).call(t).start(),cc.tween(l.shapeContainer).to(.02,{x:a,y:c}).start()})]);case 1:return s.sent(),[2]}})})},e.prototype.getOnlyXYListToPlace=function(t){for(var e=this,n=t.getCoords(),o=[],r=0,i=function(t){for(var i=function(i){if(a.blockList[t][i])return"continue";if(n.every(function(n){var o=n[0],r=n[1]+t,a=i-o;return f.gameHelper.isVaildXY(r,a)&&!e.blockList[r][a]})){if(++r>1)return{value:[]};o=n.map(function(e){var n=e[0];return[e[1]+t,i-n]})}},s=0;s<u.MAX_Y;++s){var c=i(s);if("object"==typeof c)return c}},a=this,s=0;s<u.MAX_X;++s){var c=i(s);if("object"==typeof c)return c.value}return o},e.prototype.showOnlyPlaceHint=function(t){var e=this,n=this.getOnlyXYListToPlace(t);this.hideAllHint(),n.length>0&&n.map(function(t){var e=t[0];return t[1]*u.MAX_X+e}).forEach(function(t){var n=e.hintsList[t];n.setActive(!0),n.opacity=255,cc.Tween.stopAllByTarget(n),cc.tween(n).sequence(cc.fadeOut(.5),cc.fadeIn(.5)).repeatForever().start()})},e.prototype.isRotateUsing=function(){return"ues"==this.rotationSp_.animation},e.prototype.findTouchedShapeContainer=function(t){return this.shapeContainers.find(function(e){if(e&&e.isValid)return e.convertToWorldSpaceAR(cc.Vec2.ZERO).sub(t).mag()<84})},e.prototype.hideAllShadow=function(){this.shadowList.forEach(function(t){return t.setActive(!1)})},e.prototype.hideAllHint=function(){this.hintsList.forEach(function(t){return t.setActive(!1)})},e.prototype.hideAllSkin=function(){this.blockList.forEach(function(t){return t.forEach(function(t){return t&&t.Component(v.default).changeSkin(null,!1)})})},e.prototype.onTouchMove=function(t){if(this.shapeContainer&&!this.isTargetFinish()){var e=t.getLocation(),n=e.add(cc.v2(0,u.TOUCH_OFFSET_Y));if(!this.up){var o=this.shapeContainer.Child("shape",b.default);if(!o)return;this.goUp(e,o)}this.moved=!0;var r=this.topShapesNode_.convertToNodeSpaceAR(n);this.shapeContainer.setPosition(r),this.hideAllShadow();var i=this.getShapeToBoardXYList(),a=i.xyList,s=i.color,c=i.colors,l=this.placeShapeShadow(a,c);this.hideAllSkin(),l&&(this.checkColSkin(a,s),this.checkRowSkin(a,s))}},e.prototype.checkColSkin=function(t,e){var n=this,o=[];t.forEach(function(t){var e=t[0];t[1],o.pushNoHas(e)}),o.forEach(function(o){for(var r=!0,i=function(e){var i=n.blockList[o][e];if(!cc.isValid(i)&&!t.find(function(t){var n=t[0],r=t[1];return n===o&&r===e}))return r=!1,"break"},a=0;a<u.MAX_Y&&"break"!==i(a);++a);r&&n.changeColSkin(o,e,r)})},e.prototype.checkRowSkin=function(t,e){var n=this,o=[];t.forEach(function(t){t[0];var e=t[1];o.pushNoHas(e)}),o.forEach(function(o){for(var r=!0,i=function(e){var i=n.blockList[e][o];if(!cc.isValid(i)&&!t.find(function(t){var n=t[0],r=t[1];return n===e&&r===o}))return r=!1,"break"},a=0;a<u.MAX_X&&"break"!==i(a);++a);r&&n.changeRowSkin(o,e,r)})},e.prototype.changeRowSkin=function(t,e,n){for(var o=0;o<u.MAX_X;++o){var r=this.blockList[o][t];cc.isValid(r)&&r.Component(v.default).changeSkin(e,n)}},e.prototype.changeColSkin=function(t,e,n){for(var o=0;o<u.MAX_Y;++o){var r=this.blockList[t][o];cc.isValid(r)&&r.Component(v.default).changeSkin(e,n)}},e.prototype.getShapeToBoardXYList=function(){var t=this.shapeContainer.Child("shape",b.default),e=t.soul.color;return{xyList:t.getBlocksXY(this.blocksNode_),colors:t.getColors(),color:e}},e.prototype.placeShapeShadow=function(t,e){var n=this;return!!t.every(function(t){var e=t[0],o=t[1];return f.gameHelper.isVaildXY(e,o)&&!n.blockList[e][o]})&&(t.map(function(t){var e=t[0];return t[1]*u.MAX_X+e}).forEach(function(t,o){var r=n.shadowList[t];if(r.setActive(!0),e[o]==p.ColorType.DreamGem){var i=16;r.Component(l.default).setFrame(i)}else i=e[o]-1,r.Component(l.default).setFrame(i)}),!0)},e.prototype.onTouchEnd=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,c,l;return s(this,function(s){switch(s.label){case 0:return this.shapeContainer?this.isTargetFinish()?[2]:(this.unscheduleAllCallbacks(),mc.lockTouch(!0),t=this.shapeContainer,(e=t.Child("shape",b.default))?!this.isRotateUsing()||this.up||this.moved?[3,2]:(this.shapeContainer=null,[4,e.rotate()]):(mc.lockTouch(!1),[2])):[2];case 1:return s.sent(),n=this.checkShapeGray(e),e.setGray(n),n||d.animHelper.hideWeakGuideFinger(!0),[3,10];case 2:return o=this.checkCanPlaceShapeToBoard()&&this.moved,this.hideAllShadow(),this.hideAllHint(),r=e.isRotated(),!o&&this.hideAllSkin(),o?(this.checkConductRotate(r),[4,this.placeShapeToBoard()]):[3,5];case 3:return i=s.sent(),this.closeRotate(),a=this.checkClearBlocks(),this.addScore(i,a),this.checkCollect(a.collectList),this.checkPlayClearAnim(i,a),[4,this.checkCreateShapes()];case 4:return s.sent(),[3,7];case 5:return[4,this.putBackShapeToContainer(this.shapeContainer)];case 6:s.sent(),s.label=7;case 7:return this.refreshShapes(),this.shapeContainer=null,c=this.checkOverOrTip(),l=c.over,c.tipHolder,l?[4,this.gameOver()]:[3,9];case 8:s.sent(),s.label=9;case 9:s.label=10;case 10:return mc.lockTouch(!1),[2]}})})},e.prototype.placeShapeToBoard=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,c=this;return s(this,function(s){switch(s.label){case 0:return t=this.shapeContainer,e=t.Child("shape",b.default),n=e.getColor(),o=e.getBlocksAndXY(this.blocksNode_),r=e.node.childrenCount,i=[],a=this.node.Child("effect"),[4,ut.promiseMap(o,function(t){var e=t.block,n=t.xy;return new Promise(function(t){var o=n[0],r=n[1],s=f.gameHelper.getBoardPosBy(o,r),l=c.blocksNode_.convertToWorldSpaceAR(s),u=a.convertToNodeSpaceAR(l);i.push(u),f.gameHelper.changeParent(c.blocksNode_,e),c.blockList[o][r]=e,cc.tween(e).to(.05,{x:s.x,y:s.y,scale:1}).call(t).start()})})];case 1:return s.sent(),audioMgr.playSFX("drop_down"),this.isValid?(this.shapeContainers[t.Data]=null,t.removeFromParent(),t.destroy(),[2,{score:r,posList:i,color:n}]):[2,{score:r,posList:i,color:n}]}})})},e.prototype.createShape=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a;return s(this,function(s){switch(s.label){case 0:return[4,assetsMgr.loadTempRes("shape",cc.Prefab,"block")];case 1:return n=s.sent(),o=this.shapeContainers[e],(r=cc.instantiate2(n,o)).addComponent(b.default).init(t),r.setScale(0),r.Data=e,r.name="shape",i=r.Component(b.default),a=this.checkShapeGray(i),i.setGray(a),[4,new Promise(function(t){cc.tween(r).to(.2,{scale:u.SHAPE_SCALE}).call(t).start()})];case 2:return s.sent(),[2]}})})},e.prototype.getColorShapes=function(){var t,e,n,o=this,r=[],i=ut.stringToNumbers(this.levelJson.placeList,","),a=this.levelJson.questList.filter(function(t){return u.GEM_LIST.has(t.type)}),s=i.filter(function(t){return u.COLOR_LIST.has(t)}),c={},l={},p=[];a.map(function(t){c[t.type]=0,l[t.type]=t.count,o.targetMap.get(t.type)>0&&p.push(t.type)});var h=0,d=!1,f=function(t){var e=i.filter(function(e){return e==Number(t)});if(c[t]=e.length,e.length<l[t])return d=!0,"break"};for(var y in c)if("break"===f(y))break;for(var _=u.GAME_SHAPE_LIST.filter(function(t){var e=assetsMgr.getJsonData("ShapeConfig",t.id);return!o.checkCoordsGray(e.coords)}),g=0;g<3;++g){var v,b=this.presetShapes.shift();if(!b){var w=_[ut.randomIndexByWeight(_,"weight")],S=null!==(e=null!==(t=this.levelJson.color)&&void 0!==t?t:s.random())&&void 0!==e?e:u.COLOR_LIST.random();b=w.id+":"+S}var C=ut.stringToNumbers(b,":"),T=C[0];v=C[1];var A=assetsMgr.getJsonData("ShapeConfig",T);h=null!==(n=p.random())&&void 0!==n?n:0;var E=(new m.default).init(T,A.coords,A.headPos).initGemType(h,d);E.initColor(v),E.initDegree(0),r.push(E)}return r},e.prototype.checkCreateShapes=function(){return a(this,void 0,void 0,function(){var t,e,n=this;return s(this,function(o){switch(o.label){case 0:return this.shapeContainers.every(function(t){return!cc.isValid(t,!0)})?(this.refreshShapeContainers(),t=[],t=this.getColorShapes(),e=[],t.forEach(function(t,o){e.push(n.createShape(t,o))}),[4,Promise.all(e)]):[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},e.prototype.checkClearBlocks=function(){for(var t=this,e=[],n=0;n<u.MAX_X;++n)this.checkClearCol(n)&&e.push(n);for(var o=[],r=0;r<u.MAX_Y;++r)this.checkClearRow(r)&&o.push(r);var i=[];e.map(function(e){t.clearCol(e).map(function(t){i.pushNoHas(t,"id")})}),o.map(function(e){t.clearRow(e).map(function(t){i.pushNoHas(t,"id")})});for(var a=e.length+o.length,s=[],c=[],l=[],p=this.node.Child("effect"),h=0,d=e;h<d.length;h++){for(n=d[h],r=0;r<u.MAX_Y;++r){var y=f.gameHelper.getBoardPosBy(n,r);s.push(y)}var _=f.gameHelper.getBoardPosBy(n,3.5),g=this.blocksNode_.convertToWorldSpaceAR(_),m=p.convertToNodeSpaceAR(g);c.push(m)}for(var v=0,b=o;v<b.length;v++){r=b[v];var w=function(t){var e=f.gameHelper.getBoardPosBy(t,r);s.find(function(t){return t.equals(e)})||s.push(e)};for(n=0;n<u.MAX_X;++n)w(n);_=f.gameHelper.getBoardPosBy(3.5,r),g=this.blocksNode_.convertToWorldSpaceAR(_),m=p.convertToNodeSpaceAR(g),l.push(m)}return{combo:a,fallPosList:s.map(function(e){var n=t.blocksNode_.convertToWorldSpaceAR(e);return p.convertToNodeSpaceAR(n)}),rowClearList:l,colClearList:c,collectList:i}},e.prototype.checkCollect=function(t){return a(this,void 0,void 0,function(){var e,n,o,r=this;return s(this,function(i){switch(i.label){case 0:return e=this.node.Child("effect"),n="_level_wind_",[4,ut.promiseMap(t,function(t){var o=t.colorType,i=e.convertToNodeSpaceAR(t.start);if(o==p.ColorType.DreamGem){var a=Array.from(r.targetMap.keys());a.forEach(function(t){return[r.realTargetMap.set(t,Math.max(r.realTargetMap.get(t)-1,0))]});var s=r.targetLayoutNode_.children.map(function(t){var n=t.Child("content/icon").convertToWorldSpaceAR(cc.Vec2.ZERO);return e.convertToNodeSpaceAR(n)});return d.animHelper.playDreamGemAnim(e,n,s,a,i).then(function(){r.isValid&&(a.forEach(function(t){return[r.targetMap.set(t,Math.max(r.targetMap.get(t)-1,0))]}),r.updateTarget(!0),audioMgr.playSFX("common/target_fly"))})}r.realTargetMap.set(o,Math.max(r.realTargetMap.get(o)-1,0));var c=e.convertToNodeSpaceAR(t.end);return d.animHelper.playCollectGemAnim(e,n,c,t.colorType,i).then(function(){r.isValid&&(r.targetMap.set(o,Math.max(r.targetMap.get(o)-1,0)),r.updateTarget(!0),audioMgr.playSFX("common/target_fly"))})})];case 1:return i.sent(),o=[],t.map(function(t){var e=t.colorType;e==p.ColorType.DreamGem?Array.from(r.targetMap.keys()).map(function(e){if(!o.has("colorType",e)){var n=t.start,i=r.targetLayoutNode_.children.find(function(t){return t.Data==e}).Child("content/icon").convertToWorldSpaceAR(cc.Vec2.ZERO),a=t.id,s=e;o.push({start:n,end:i,id:a,colorType:s})}}):o.has("colorType",e)||o.push(t)}),o.map(function(t){var o=t.colorType,i=e.convertToNodeSpaceAR(t.end),a=r.targetLayoutNode_.children.find(function(t){return t.Data==o});cc.tween(a).to(.1,{scale:1.2}).to(.1,{scale:1}).start(),d.animHelper.playTargetReached(e,i,n)}),this.isTargetFinish()?(mc.lockTouch(!0),[4,ut.wait(.8)]):[3,4];case 2:return i.sent(),[4,_.viewHelper.showPnl("level/TargetDone",{data:this.levelJson,level:this.level})];case 3:i.sent(),mc.lockTouch(!1),i.label=4;case 4:return[2]}})})},e.prototype.checkClearCol=function(t){for(var e=!0,n=0;n<u.MAX_Y;++n){var o=this.blockList[t][n];if(!cc.isValid(o)){e=!1;break}}return e},e.prototype.checkClearRow=function(t){for(var e=!0,n=0;n<u.MAX_X;++n){var o=this.blockList[n][t];if(!cc.isValid(o)){e=!1;break}}return e},e.prototype.clearCol=function(t){for(var e=[],n=function(n){var r=o.blockList[t][n];if(cc.isValid(r)){var i=r.Component(v.default).getColor();if(i==p.ColorType.DreamGem){var a=t+"_"+n,s=r.convertToWorldSpaceAR(cc.Vec2.ZERO);e.push({colorType:i,start:s,id:a})}else{var c=o.targetLayoutNode_.children.find(function(t){return t.Data==i});if(c){s=r.convertToWorldSpaceAR(cc.Vec2.ZERO);var l=c.Child("content/icon").convertToWorldSpaceAR(cc.Vec2.ZERO);a=t+"_"+n,e.push({colorType:i,start:s,end:l,id:a})}}r.destroy()}o.blockList[t][n]=null},o=this,r=0;r<u.MAX_Y;++r)n(r);return e},e.prototype.clearRow=function(t){for(var e=[],n=function(n){var r=o.blockList[n][t];if(cc.isValid(r)){var i=r.Component(v.default).getColor();if(i==p.ColorType.DreamGem){var a=n+"_"+t,s=r.convertToWorldSpaceAR(cc.Vec2.ZERO);e.push({colorType:i,start:s,id:a})}else{var c=o.targetLayoutNode_.children.find(function(t){return t.Data==i});if(c){s=r.convertToWorldSpaceAR(cc.Vec2.ZERO);var l=c.Child("content/icon").convertToWorldSpaceAR(cc.Vec2.ZERO);a=n+"_"+t,e.push({colorType:i,start:s,end:l,id:a})}}r.destroy()}o.blockList[n][t]=null},o=this,r=0;r<u.MAX_X;++r)n(r);return e},e.prototype.closeRotate=function(){this.rotationSp_.play("idle"),this.hideAllRotateHints(),this.shapesRotateToZero()},e.prototype.hideAllRotateHints=function(){this.rotateHints_.forEach(function(t){t&&cc.isValid(t)&&(t.active=!1)})},e.prototype.shapesRotateToZero=function(){this.shapesNode_.children.forEach(function(t){var e=null==t?void 0:t.Child("shape",b.default);e&&e.isRotated()&&e.rotateToZero()})},e.prototype.checkCanPlaceShapeToBoard=function(){var t=this;return this.shapeContainer.Child("shape",b.default).getBlocksXY(this.blocksNode_).every(function(e){var n=e[0],o=e[1];return f.gameHelper.isVaildXY(n,o)&&!t.blockList[n][o]})},e.prototype.checkConductRotate=function(t){if(t)if(this.model.getRotation()>0)this.model.addRotate(-1);else{var e=u.ROTATE_COST,n=this.model.getCoin();n>=e&&this.model.setCoin(Math.max(n-e,0))}},e.prototype.gameOver=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r=this;return s(this,function(i){switch(i.label){case 0:return audioMgr.playSFX("game_over"),[4,this.playBoardBlocksGrayAnim()];case 1:return i.sent(),t=this.levelJson.questList,e=t.some(function(t){return 0==t.type}),n=[],e?n.push({type:0,count:this.getMaxScore()-this.score}):t.map(function(t){var e=t.type,o=r.targetMap.get(e);n.push({type:e,count:o})}),this.reviveTime>=2?(_.viewHelper.gotoWind("fail",{data:n,level:this.level}),[3,4]):[3,2];case 2:return this.reviveTime++,o={cb:function(t){return a(r,void 0,void 0,function(){var e;return s(this,function(o){switch(o.label){case 0:return e="level/LevelRevive",eventMgr.emit(mc.Event.CLOSE_PNL,e),_.viewHelper.readyShowPnls.remove(e),t?(mc.lockTouch(!0),audioMgr.playSFX("game_revive"),[4,Promise.all([this.playBoardBlocksColorAnim(),this.createReviveShapes()])]):[3,2];case 1:return o.sent(),mc.lockTouch(!1),[3,3];case 2:_.viewHelper.gotoWind("fail",{data:n,level:this.level}),o.label=3;case 3:return[2]}})})}},[4,_.viewHelper.showPnl("level/LevelRevive",o)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},e.prototype.createReviveShapes=function(){return a(this,void 0,void 0,function(){var t,e,n=this;return s(this,function(o){switch(o.label){case 0:return this.shapesNode_.children.map(function(t){t.removeFromParent(!0)}),this.shapeContainers.forEach(function(t){return null==t?void 0:t.destroy()}),this.shapeContainers=[],this.refreshShapeContainers(),t=f.gameHelper.getReviveShapes(),e=[],t.forEach(function(t,o){e.push(n.createShape(t,o))}),[4,Promise.all(e)];case 1:return o.sent(),[2]}})})},e.prototype.playBoardBlocksGrayAnim=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r;return s(this,function(i){switch(i.label){case 0:for(t=[],e=0;e<u.MAX_X;++e)for(n=0;n<u.MAX_Y;++n)(o=this.blockList[e][n])&&t.push(o);return r=t.map(function(t){return new Promise(function(e){var n=t.Child("gray");n.active=!0,n.opacity=0;var o=.1*ut.random(4,12);cc.tween(n).delay(o).to(.8,{opacity:255}).call(e).start()})}),[4,Promise.all(r)];case 1:return i.sent(),[2]}})})},e.prototype.playBoardBlocksColorAnim=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r;return s(this,function(i){switch(i.label){case 0:for(t=[],e=0;e<u.MAX_X;++e)for(n=0;n<u.MAX_Y;++n)(o=this.blockList[e][n])&&t.push(o);return r=t.map(function(t){return new Promise(function(e){var n=t.Child("gray");n.active=!0,n.opacity=255,cc.tween(n).delay(.1*ut.random(1,5)).to(.4,{opacity:0}).call(function(){n.active=!1,e(null)}).start()})}),[4,Promise.all(r)];case 1:return i.sent(),[2]}})})},e.prototype.addScore=function(t,e,n){var o,r;void 0===n&&(n=!0);var i=null!==(o=null==e?void 0:e.combo)&&void 0!==o?o:0,a=null!==(r=u.COMBO_SCORE[i])&&void 0!==r?r:u.COMBO_SCORE.last(),s=t.score+a,l=this.levelJson.questList[0].count;this.score+=s,this.score=Math.min(this.score,l);var p=370*this.score/this.getMaxScore()-185;n?(cc.Tween.stopAllByTarget(this.scoreBarSpr_),cc.tween(this.scoreBarSpr_).to(.5,{fillRange:this.score/l},{easing:cc.easing.sineInOut}).start(),this.moveNode_.Child("text",c.default).to(this.score,.5),cc.Tween.stopAllByTarget(this.moveNode_),cc.tween(this.moveNode_).to(.5,{x:p},{easing:cc.easing.sineInOut}).start()):(this.moveNode_.Child("text",c.default).set(this.score),this.scoreBarSpr_.fillRange=this.score/l,this.moveNode_.x=p)},e.prototype.checkOverOrTip=function(){var t=this,e=!1;return this.isTargetFinish()?{over:e,tipHolder:!1}:{over:e=this.shapeContainers.filter(function(t){return cc.isValid(t)}).every(function(e){var n=e.Child("shape",b.default);return t.checkShapeGray(n)}),tipHolder:!1}},e.prototype.refreshShapes=function(){var t=this;this.shapesNode_.children.forEach(function(e){var n=null==e?void 0:e.Child("shape",b.default);if(n){var o=t.checkShapeGray(n);n.setGray(o)}})},e.prototype.collectTargets=function(){},e.prototype.checkPlayClearAnim=function(t,e){var n,o=e.colClearList,r=e.rowClearList,i=e.fallPosList,a=e.combo,s=t.posList,c=t.color,l=this.node.Child("topEffect"),p="_level_wind_";o.length>0&&d.animHelper.playLineAnim(o,l,p,c,90),r.length>0&&d.animHelper.playLineAnim(r,l,p,c,0),i.length>0&&d.animHelper.playFallingParticle(i,l,c,p);var h=this.levelJson.questList.some(function(t){return 0==t.type}),y=null!=a?a:0,_=null!==(n=u.COMBO_SCORE[y])&&void 0!==n?n:u.COMBO_SCORE.last(),g=f.gameHelper.getCenterBy(s);if(d.animHelper.playFlutterText([_],l,g,p,h),2==y?audioMgr.playSFX("good"):3==y?audioMgr.playSFX("great"):y>3&&audioMgr.playSFX("amazing"),y>=1){var m=this.model.addLevelCombo(y);audioMgr.playSFX("clear_"+m)}else this.model.clearLevelCombo()},e.prototype.putBackShapeToContainer=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c=this;return s(this,function(s){switch(s.label){case 0:return e=u.CONTAINER_POS_LIST[t.Data],n=e.x,o=e.y,r=this.shapeContainer.Child("shape"),[4,new Promise(function(e){cc.tween(c.shapeContainer).to(.032,{x:n},{easing:cc.easing.sineOut}).start(),cc.tween(c.shapeContainer).to(.04,{y:o},{easing:cc.easing.sineInOut}).call(function(){t.setParent(c.shapesNode_),t.setPosition(n,o),e(null)}).start(),cc.tween(r).to(.04,{scale:u.SHAPE_SCALE}).start(),r.children.forEach(function(t){cc.tween(t).to(.04,{scale:1}).start()})})];case 1:return s.sent(),audioMgr.playSFX("drop_back"),i=t.Data,(a=this.rotateHints_[i])&&this.setRotateHintActive(a,this.isRotateUsing()),[2]}})})},e.prototype.setRotateHintActive=function(t,e){void 0===e&&(e=!0),t.active=e;var n=t.Child("icon");n&&e&&(cc.Tween.stopAllByTarget(n),n.angle=0,cc.tween(n).by(2,{angle:-180}).repeatForever().start())},e.prototype.checkShapeGray=function(t){var e=t.getCoords();return this.checkCoordsGray(e)},e.prototype.checkCoordsGray=function(t){for(var e=this,n=function(n){for(var r=function(r){return o.blockList[n][r]?"continue":t.every(function(t){var o=t[0],i=t[1]+n,a=r-o;return f.gameHelper.isVaildXY(i,a)&&!e.blockList[i][a]})?{value:!1}:void 0},i=0;i<u.MAX_Y;++i){var a=r(i);if("object"==typeof a)return a}},o=this,r=0;r<u.MAX_X;++r){var i=n(r);if("object"==typeof i)return i.value}return!0},e.prototype.isTargetFinish=function(){if(this.levelJson.questList.some(function(t){return 0==t.type}))return this.score>=this.getMaxScore();var t=0;return this.realTargetMap.forEach(function(e){t+=e}),t<=0},e.prototype.update=function(){this.node.Child("effect").children.map(function(t){t.z=cc.winSize.height-t.y})},i([ut.addLock],e.prototype,"onTouchStart",null),i([ut.addLock],e.prototype,"onTouchEnd",null),i([ut.addLock],e.prototype,"putBackShapeToContainer",null),i([w],e)}(mc.BaseWindCtrl);n.default=S,cc._RF.pop()},{"../../../core/component/LabelRollNumber":"LabelRollNumber","../../../core/component/MultiFrame":"MultiFrame","../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/AnimHelper":"AnimHelper","../../common/helper/GameHelper":"GameHelper","../../common/helper/ResHelper":"ResHelper","../../common/helper/ViewHelper":"ViewHelper","../../model/common/BlockObj":"BlockObj","../../model/common/ColorGemShapeObj":"ColorGemShapeObj","../cmpt/game/BlockCmpt":"BlockCmpt","../cmpt/game/GemShapeCmpt":"GemShapeCmpt"}],ListItem:[function(t,e,n){"use strict";cc._RF.push(e,"62015tOt5xAubN2qlDm8yzD","ListItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a,s=cc._decorator,c=s.ccclass,l=s.property,u=s.disallowMultiple,p=(s.menu,s.executionOrder);(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(a||(a={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.title=null,e.selectedMode=a.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e.adaptiveSize=!1,e._selected=!1,e._eventReg=!1,e}return r(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case a.TOGGLE:this.selectedFlag.active=t;break;case a.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(this.selectedMode==a.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this)},e.prototype._registerEvent=function(){this._eventReg||(this.btnCom&&this.list.selectedMode>0&&this.btnCom.clickEvents.unshift(this.createEvt(this,"onClickThis")),this.adaptiveSize&&this.node.on(cc.Node.EventType.SIZE_CHANGED,this._onSizeChange,this),this._eventReg=!0)},e.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},e.prototype.createEvt=function(t,e,n){if(void 0===n&&(n=null),t.isValid){t.comName=t.comName||t.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var o=new cc.Component.EventHandler;return o.target=n||t.node,o.component=t.comName,o.handler=e,o}},e.prototype.showAni=function(t,e,n){var o,r=this;switch(t){case 0:o=cc.tween(r.node).to(.2,{scale:.7}).by(.3,{y:2*r.node.height});break;case 1:o=cc.tween(r.node).to(.2,{scale:.7}).by(.3,{x:2*r.node.width});break;case 2:o=cc.tween(r.node).to(.2,{scale:.7}).by(.3,{y:-2*r.node.height});break;case 3:o=cc.tween(r.node).to(.2,{scale:.7}).by(.3,{x:-2*r.node.width});break;default:o=cc.tween(r.node).to(.3,{scale:.1})}(e||n)&&o.call(function(){if(n){r.list._delSingleItem(r.node);for(var t=r.list.displayData.length-1;t>=0;t--)if(r.list.displayData[t].id==r.listId){r.list.displayData.splice(t,1);break}}e()}),o.start()},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},i([l({type:cc.Sprite,tooltip:!1})],e.prototype,"icon",void 0),i([l({type:cc.Node,tooltip:!1})],e.prototype,"title",void 0),i([l({type:cc.Enum(a),tooltip:!1})],e.prototype,"selectedMode",void 0),i([l({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>a.NONE}})],e.prototype,"selectedFlag",void 0),i([l({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==a.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),i([l({tooltip:!1})],e.prototype,"adaptiveSize",void 0),i([c,u(),p(-5001)],e)}(cc.Component);n.default=h,cc._RF.pop()},{}],List:[function(t,e,n){"use strict";cc._RF.push(e,"eed7an3PvtPtb0Csc/S5ImR","List");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a,s,c,l=cc._decorator,u=l.ccclass,p=l.property,h=l.disallowMultiple,d=(l.menu,l.executionOrder),f=l.requireComponent,y=t("./ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(a||(a={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(s||(s={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(c||(c={}));var _=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=a.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=s.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.cyclic=!1,e.lackCenter=!1,e.lackSlide=!1,e._updateRate=0,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=c.NONE,e.repeatEventSingle=!1,e.selectedEvent=new cc.Component.EventHandler,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._needUpdateWidget=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return r(e,t),Object.defineProperty(e.prototype,"slideMode",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,n=this;switch(n.selectedMode){case c.SINGLE:if(!n.repeatEventSingle&&t==n._selectedId)return;e=n.getItemByListId(t);var o=void 0;if(n._selectedId>=0?n._lastSelectedId=n._selectedId:n._lastSelectedId=null,n._selectedId=t,e&&((o=e.getComponent(y.default)).selected=!0),n._lastSelectedId>=0&&n._lastSelectedId!=n._selectedId){var r=n.getItemByListId(n._lastSelectedId);r&&(r.getComponent(y.default).selected=!1)}n.selectedEvent&&cc.Component.EventHandler.emitEvents([n.selectedEvent],e,t%this._actualNumItems,null==n._lastSelectedId?null:n._lastSelectedId%this._actualNumItems);break;case c.MULT:if(!(e=n.getItemByListId(t)))return;o=e.getComponent(y.default),n._selectedId>=0&&(n._lastSelectedId=n._selectedId),n._selectedId=t;var i=!o.selected;o.selected=i;var a=n.multSelected.indexOf(t);i&&a<0?n.multSelected.push(t):!i&&a>=0&&n.multSelected.splice(a,1),n.selectedEvent&&cc.Component.EventHandler.emitEvents([n.selectedEvent],e,t%this._actualNumItems,null==n._lastSelectedId?null:n._lastSelectedId%this._actualNumItems,i)}},enumerable:!1,configurable:!0}),e.prototype.setRenderFunc=function(t,e){this.renderEvent.target=t,this.renderEvent.handler=e},Object.defineProperty(e.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=s.PAGE||(e.curPageNum=e.nearestListId);else{e.cyclic&&(e._resizeContent(),e._numItems=e._cyclicNum*e._numItems);var n=e.content.getComponent(cc.Layout);if(n&&(n.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var o=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,r=0;r<o;r++)e._createOrUpdateItem2(r);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(r=0;r<e._numItems;r++)e._createOrUpdateItem2(r);e.displayItemNum=e._numItems}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.onDestroy=function(){var t=this;cc.isValid(t._itemTmp)&&t._itemTmp.destroy(),cc.isValid(t.tmpNode)&&t.tmpNode.destroy(),t._pool&&t._pool.clear()},e.prototype.onEnable=function(){this._registerEvent(),this._init(),this._aniDelRuning&&(this._aniDelRuning=!1,this._aniDelItem&&(this._aniDelBeforePos&&(this._aniDelItem.position=this._aniDelBeforePos,delete this._aniDelBeforePos),this._aniDelBeforeScale&&(this._aniDelItem.scale=this._aniDelBeforeScale,delete this._aniDelBeforeScale),delete this._aniDelItem),this._aniDelCB&&(this._aniDelCB(),delete this._aniDelCB))},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.on("touch-up",t._onTouchUp,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0),t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._unregisterEvent=function(){var t=this;t.node.off(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.off("touch-up",t._onTouchUp,t),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0),t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(cc.instantiate(t.templateType==a.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=s.ADHERING&&t._slideMode!=s.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.removeAllChildren(),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!")},e.prototype._processAutoScrolling=function(t){this._scrollView._autoScrollAccumulatedTime+=1*t;var e=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var n=e-1;e=n*n*n*n*n+1}var o=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(e)),r=this._scrollView.getScrollEndedEventTiming(),i=Math.abs(e-1)<=r;Math.abs(e-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),i&&(this._scrollView._autoScrolling=!1);var a=o.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(a),i),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},e.prototype.setTemplateItem=function(t){if(t){var e=this;e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(t.width,t.height);var n=t.getComponent(y.default),o=!1;switch(n||(o=!0),o&&(e.selectedMode=c.NONE),(n=t.getComponent(cc.Widget))&&n.enabled&&(e._needUpdateWidget=!0),e.selectedMode==c.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var r=e.content.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((r+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var i=e.content.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((i+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},e.prototype.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e._customSize){var n=e._getFixedSize(null);t=e._leftGap+n.val+e._itemSize.width*(e._numItems-n.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:e._customSize?(n=e._getFixedSize(null),t=e._topGap+n.val+e._itemSize.height*(e._numItems-n.count)+e._lineGap*(e._numItems-1)+e._bottomGap):t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var o=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*o+e._lineGap*(o-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var r=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*r+e._columnGap*(r-1)+e._rightGap}}var i=e.content.getComponent(cc.Layout);if(i&&(i.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var a=e._sizeType?e.node.height:e.node.width;e._cyclicPos1=0,a-=e._cyclicPos1,e._cyclicNum=Math.ceil(a/e._allItemSizeNoEdge)+1;var s=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+s,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+s*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=s*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e.node.height:e.node.width);var c=e._lack&&e.lackCenter||!e.lackSlide?.1:0,l=e._lack?(e._sizeType?e.node.height:e.node.width)-c:e.cyclic?e._cyclicAllItemSize:e._allItemSize;l<0&&(l=0),e._sizeType?e.content.height=l:e.content.width=l},e.prototype._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var n=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),o=this._sizeType?cc.v2(0,n):cc.v2(n,0);switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o))):e<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o)));break;case 2:e<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o))):e>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o)));break;case 3:e<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o))):e>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o)));break;case 4:e>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(o))):e<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(o)))}}var r,i,a,s;if(this._calcViewPos(),this._sizeType?(r=this.viewTop,a=this.viewBottom):(i=this.viewRight,s=this.viewLeft),this._virtual){this.displayData=[];var c=void 0,l=0,u=this._numItems-1;if(this._customSize)for(var p=!1;l<=u&&!p;l++)switch(c=this._calcItemPos(l),this._align){case cc.Layout.Type.HORIZONTAL:c.right>=s&&c.left<=i?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.Type.VERTICAL:c.bottom<=r&&c.top>=a?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:c.bottom<=r&&c.top>=a?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0);break;case cc.Layout.AxisDirection.VERTICAL:c.right>=s&&c.left<=i?this.displayData.push(c):0!=l&&this.displayData.length>0&&(p=!0)}}else{var h=this._itemSize.width+this._columnGap,d=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:l=(s-this._leftGap)/h,u=(i-this._leftGap)/h;break;case 2:l=(-i-this._rightGap)/h,u=(-s-this._rightGap)/h;break;case 3:l=(-r-this._topGap)/d,u=(-a-this._topGap)/d;break;case 4:l=(a-this._bottomGap)/d,u=(r-this._bottomGap)/d}for(l=Math.floor(l)*this._colLineNum,u=Math.ceil(u)*this._colLineNum,l<0&&(l=0),--u>=this._numItems&&(u=this._numItems-1);l<=u;l++)this.displayData.push(this._calcItemPos(l))}if(this._delRedundantItem(),this.displayData.length<=0||!this._numItems)return void(this._lastDisplayData=[]);this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var f=this._lastDisplayData.length,y=this.displayItemNum!=f;if(y&&(this.frameByFrameRenderNum>0&&this._lastDisplayData.sort(function(t,e){return t-e}),y=this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[f-1]),this._forceUpdate||y)if(this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1,this.update()):(this._updateCounter=0,this._updateDone=!0);else{this._lastDisplayData=[];for(var _=0;_<this.displayItemNum;_++)this._createOrUpdateItem(this.displayData[_]);this._forceUpdate=!1}this._calcNearestItem()}}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,n,o,r,i,a,s,c;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var l=this._getFixedSize(t);i=this._leftGap+(this._itemSize.width+this._columnGap)*(t-l.count)+(l.val+this._columnGap*l.count),e=(u=this._customSize[t])>0?u:this._itemSize.width}else i=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;return this.lackCenter&&(i-=this._leftGap,i+=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,left:i,right:a=i+e,x:i+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this._customSize?(l=this._getFixedSize(t),a=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-l.count)-(l.val+this._columnGap*l.count),e=(u=this._customSize[t])>0?u:this._itemSize.width):(a=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width),this.lackCenter&&(a+=this._rightGap,a-=this.content.width/2-this._allItemSizeNoEdge/2),{id:t,right:a,left:i=a-e,x:i+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this._customSize?(l=this._getFixedSize(t),o=-this._topGap-(this._itemSize.height+this._lineGap)*(t-l.count)-(l.val+this._lineGap*l.count),n=(u=this._customSize[t])>0?u:this._itemSize.height):(o=-this._topGap-(this._itemSize.height+this._lineGap)*t,n=this._itemSize.height),this.lackCenter&&(o+=this._topGap,o-=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:o,bottom:r=o-n,x:this._itemTmp.x,y:r+this._itemTmp.anchorY*n};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var u;if(this._customSize)l=this._getFixedSize(t),r=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-l.count)+(l.val+this._lineGap*l.count),n=(u=this._customSize[t])>0?u:this._itemSize.height;else r=this._bottomGap+(this._itemSize.height+this._lineGap)*t,n=this._itemSize.height;return this.lackCenter&&(r-=this._bottomGap,r+=this.content.height/2-this._allItemSizeNoEdge/2),{id:t,top:o=r+n,bottom:r,x:this._itemTmp.x,y:r+this._itemTmp.anchorY*n}}case cc.Layout.Type.GRID:var p=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c=(r=(o=-this._topGap-(this._itemSize.height+this._lineGap)*p)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:o=(r=this._bottomGap+(this._itemSize.height+this._lineGap)*p)+this._itemSize.height,c=r+this._itemTmp.anchorY*this._itemSize.height}switch(s=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:s+=this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s+=(1-this._itemTmp.anchorX)*this._itemSize.width,s-=(1-this.content.anchorX)*this.content.width,s*=-1}return{id:t,top:o,bottom:r,x:s,y:c};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:a=(i=this._leftGap+(this._itemSize.width+this._columnGap)*p)+this._itemSize.width,s=i+this._itemTmp.anchorX*this._itemSize.width,s-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:s=(i=(a=-this._rightGap-(this._itemSize.width+this._columnGap)*p)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,s+=(1-this.content.anchorX)*this.content.width}switch(c=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:c-=(1-this._itemTmp.anchorY)*this._itemSize.height,c+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:c-=this._itemTmp.anchorY*this._itemSize.height,c+=this.content.anchorY*this.content.height,c*=-1}return{id:t,left:i,right:a,x:s,y:c}}}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var n={id:t,x:e.x,y:e.y};return this._sizeType?(n.top=e.y+e.height*(1-e.anchorY),n.bottom=e.y-e.height*e.anchorY):(n.left=e.x-e.width*e.anchorX,n.right=e.x+e.width*(1-e.anchorX)),n},e.prototype.getItemPos=function(t){return this._virtual?this._calcItemPos(t):this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},e.prototype._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,n=0;for(var o in this._customSize)parseInt(o)<t&&(e+=this._customSize[o],n++);return{val:e,count:n}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(t.curScrollIsTouch=!1,null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&cc.tween(e).to(.1,{scale:1.06}).to(.1,{scale:1}).start()}t._onScrolling(),t._slideMode!=s.ADHERING||t.adhering?t._slideMode==s.PAGE&&(null!=t._beganPos&&t.curScrollIsTouch?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onTouchStart=function(t,e){if(!this._scrollView.hasNestedViewGroup(t,e)&&(this.curScrollIsTouch=!0,t.eventPhase!==cc.Event.AT_TARGET||t.target!==this.node)){for(var n=t.target;null==n._listId&&n.parent;)n=n.parent;this._scrollItem=null!=n._listId?n:t.target}},e.prototype._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==s.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==s.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},e.prototype._onTouchCancelled=function(t,e){var n=this;n._scrollView.hasNestedViewGroup(t,e)||t.simulate||(n._scrollPos=null,n._slideMode==s.ADHERING?(n.adhering&&(n._adheringBarrier=!0),n.adhere()):n._slideMode==s.PAGE&&(null!=n._beganPos?n._pageAdhere():n.adhere()),this._scrollItem=null)},e.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},e.prototype._onItemAdaptive=function(t){if(!this._sizeType&&t.width!=this._itemSize.width||this._sizeType&&t.height!=this._itemSize.height){this._customSize||(this._customSize={});var e=this._sizeType?t.height:t.width;this._customSize[t._listId]!=e&&(this._customSize[t._listId]=e,this._resizeContent(),this.updateAll(),null!=this._scrollToListId&&(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},e.prototype._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,n=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>n)switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this.frameByFrameRenderNum,e=this._updateCounter;t>0&&e<this.displayData.length;e++){var n=this.displayData[e];n&&this._createOrUpdateItem(n)&&t--}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._doneAfterUpdate=!1):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==s.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){var o=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum;for(e=this._updateCounter;e<o;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==s.PAGE&&(this.curPageNum=this.nearestListId)},e.prototype._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(!e){var n=this._pool.size()>0;if(e=n?this._pool.get():cc.instantiate(this._itemTmp),n&&cc.isValid(e)||(e=cc.instantiate(this._itemTmp),n=!1),e._listId!=t.id&&(e._listId=t.id,e.setContentSize(this._itemSize)),e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.content.addChild(e),n&&this._needUpdateWidget){var o=e.getComponent(cc.Widget);o&&o.updateAlignment()}e.setSiblingIndex(this.content.childrenCount-1);var r=e.getComponent(y.default);return e.listItem=r,r&&(r.listId=t.id,r.list=this,r._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems),this.node.emit("listRender",e,t.id%this._actualNumItems),!0}return this._forceUpdate?(e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems),this.node.emit("listRender",e,t.id%this._actualNumItems),!0):(this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id),!1)},e.prototype._createOrUpdateItem2=function(t){var e,n=this.content.children[t];n?this._forceUpdate&&this.renderEvent&&(n._listId=t,e&&(e.listId=t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],n,t%this._actualNumItems),this.node.emit("listRender",n,t%this._actualNumItems)):((n=cc.instantiate(this._itemTmp))._listId=t,this.content.addChild(n),e=n.getComponent(y.default),n.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],n,t%this._actualNumItems),this.node.emit("listRender",n,t%this._actualNumItems)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>c.NONE){var e=t.node;switch(this.selectedMode){case c.SINGLE:t.selected=this.selectedId==e._listId;break;case c.MULT:t.selected=this.multSelected.indexOf(e._listId)>=0}}},e.prototype._resetItemSize=function(){},e.prototype._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),n=this.getItemPos(e._listId);e.setPosition(n.x,n.y)},e.prototype.setMultSelected=function(t,e){var n=this;if(n.checkInited()){if(Array.isArray(t)||(t=[t]),null==e)n.multSelected=t;else{var o=void 0,r=void 0;if(e)for(var i=t.length-1;i>=0;i--)o=t[i],(r=n.multSelected.indexOf(o))<0&&n.multSelected.push(o);else for(i=t.length-1;i>=0;i--)o=t[i],(r=n.multSelected.indexOf(o))>=0&&n.multSelected.splice(r,1)}n._forceUpdate=!0,n._onScrolling()}},e.prototype.getMultSelected=function(){return this.multSelected},e.prototype.hasMultSelected=function(t){return this.multSelected&&this.multSelected.indexOf(t)>=0},e.prototype.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,n=t.length;e<n;e++){var o=t[e],r=this.getItemByListId(o);r&&(cc.Component.EventHandler.emitEvents([this.renderEvent],r,o%this._actualNumItems),this.node.emit("listRender",r,o%this._actualNumItems))}}},e.prototype.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},e.prototype.getItemByListId=function(t){if(this.content)for(var e=this.content.childrenCount-1;e>=0;e--){var n=this.content.children[e];if(n._listId==t)return n}},e.prototype._getOutsideItem=function(){for(var t,e=[],n=this.content.childrenCount-1;n>=0;n--)t=this.content.children[n],this.displayData.find(function(e){return e.id==t._listId})||e.push(t);return e},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var n=t[e];if(!this._scrollItem||n._listId!=this._scrollItem._listId){n.isCached=!0,this._pool.put(n);for(var o=this._lastDisplayData.length-1;o>=0;o--)if(this._lastDisplayData[o]==n._listId){this._lastDisplayData.splice(o,1);break}}}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,n){var o=this;if(!o.checkInited()||o.cyclic||!o._virtual)return cc.error("This function is not allowed to be called!");if(!e)return cc.error("CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!");if(o._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var r,i=o.getItemByListId(t);if(i){r=i.getComponent(y.default),o._aniDelRuning=!0,o._aniDelCB=e,o._aniDelItem=i,o._aniDelBeforePos=i.position,o._aniDelBeforeScale=i.scale;var a=o.displayData[o.displayData.length-1].id,s=r.selected;r.showAni(n,function(){var n,r,l;if(a<o._numItems-2&&(n=a+1),null!=n){var u=o._calcItemPos(n);o.displayData.push(u),o._virtual?o._createOrUpdateItem(u):o._createOrUpdateItem2(n)}else o._numItems--;if(o.selectedMode==c.SINGLE)s?o._selectedId=-1:o._selectedId-1>=0&&o._selectedId--;else if(o.selectedMode==c.MULT&&o.multSelected.length){var p=o.multSelected.indexOf(t);p>=0&&o.multSelected.splice(p,1);for(var h=o.multSelected.length-1;h>=0;h--)(y=o.multSelected[h])>=t&&o.multSelected[h]--}if(o._customSize){o._customSize[t]&&delete o._customSize[t];var d={},f=void 0;for(var y in o._customSize){f=o._customSize[y];var _=parseInt(y);d[_-(_>=t?1:0)]=f}o._customSize=d}for(h=null!=n?n:a;h>=t+1;h--)if(i=o.getItemByListId(h)){var g=o._calcItemPos(h-1);r=cc.tween(i).to(.2333,{position:cc.v2(g.x,g.y)}),h<=t+1&&(l=!0,r.call(function(){o._aniDelRuning=!1,e(t),delete o._aniDelCB})),r.start()}l||(o._aniDelRuning=!1,e(t),o._aniDelCB=null)},!0)}else e(t)},e.prototype.scrollTo=function(t,e,n,o){void 0===e&&(e=.5),void 0===n&&(n=null),void 0===o&&(o=!1);var r=this;if(r.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=r._numItems&&(t=r._numItems-1),!r._virtual&&r._layout&&r._layout.enabled&&r._layout.updateLayout();var i,a,s=r.getItemPos(t);if(!s)return!1;switch(r._alignCalcType){case 1:i=s.left,i-=null!=n?r.node.width*n:r._leftGap,s=cc.v2(i,0);break;case 2:i=s.right-r.node.width,i+=null!=n?r.node.width*n:r._rightGap,s=cc.v2(i+r.content.width,0);break;case 3:a=s.top,a+=null!=n?r.node.height*n:r._topGap,s=cc.v2(0,-a);break;case 4:a=s.bottom+r.node.height,a-=null!=n?r.node.height*n:r._bottomGap,s=cc.v2(0,-a+r.content.height)}var c=r.content.getPosition();c=Math.abs(r._sizeType?c.y:c.x);var l=r._sizeType?s.y:s.x;Math.abs((null!=r._scrollPos?r._scrollPos:c)-l)>.5&&(r._scrollView.scrollToOffset(s,e),r._scrollToListId=t,r._scrollToEndTime=(new Date).getTime()/1e3+e,r._scrollToSo=r.scheduleOnce(function(){if(r._adheringBarrier||(r.adhering=r._adheringBarrier=!1),r._scrollPos=r._scrollToListId=r._scrollToEndTime=r._scrollToSo=null,o){var e=r.getItemByListId(t);e&&cc.tween(e).to(.1,{scale:1.05}).to(.1,{scale:1}).start()}},e+.1),e<=0&&r._onScrolling())}},e.prototype._calcNearestItem=function(){var t,e,n,o,r,i,a=this;a.nearestListId=null,a._virtual&&a._calcViewPos(),n=a.viewTop,o=a.viewRight,r=a.viewBottom,i=a.viewLeft;for(var s=!1,c=0;c<a.content.childrenCount&&!s;c+=a._colLineNum)if(t=a._virtual?a.displayData[c]:a._calcExistItemPos(c))switch(e=a._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,a._alignCalcType){case 1:t.right>=i&&(a.nearestListId=t.id,i>e&&(a.nearestListId+=a._colLineNum),s=!0);break;case 2:t.left<=o&&(a.nearestListId=t.id,o<e&&(a.nearestListId+=a._colLineNum),s=!0);break;case 3:t.bottom<=n&&(a.nearestListId=t.id,n<e&&(a.nearestListId+=a._colLineNum),s=!0);break;case 4:t.top>=r&&(a.nearestListId=t.id,r>e&&(a.nearestListId+=a._colLineNum),s=!0)}if((t=a._virtual?a.displayData[a.displayItemNum-1]:a._calcExistItemPos(a._numItems-1))&&t.id==a._numItems-1)switch(e=a._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,a._alignCalcType){case 1:o>e&&(a.nearestListId=t.id);break;case 2:i<e&&(a.nearestListId=t.id);break;case 3:r<e&&(a.nearestListId=t.id);break;case 4:n>e&&(a.nearestListId=t.id)}},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var n=this;if(n.checkInited())return n._slideMode!=s.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t>=n._numItems||n.curPageNum!=t&&(n.curPageNum=t,n.pageChangeEvent&&cc.Component.EventHandler.emitEvents([n.pageChangeEvent],t),n.scrollTo(t,e)))},e.prototype.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e._customSize={};var n=cc.instantiate(e._itemTmp);e.content.addChild(n);for(var o=0;o<t;o++)cc.Component.EventHandler.emitEvents([e.renderEvent],n,o),this.node.emit("listRender",n,o),n.height==e._itemSize.height&&n.width==e._itemSize.width||(e._customSize[o]=e._sizeType?n.height:n.width);return Object.keys(e._customSize).length||(e._customSize=null),n.removeFromParent(),n.destroy&&n.destroy(),e._customSize}},i([p({type:cc.Enum(a),tooltip:!1})],e.prototype,"templateType",void 0),i([p({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==a.NODE}})],e.prototype,"tmpNode",void 0),i([p({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==a.PREFAB}})],e.prototype,"tmpPrefab",void 0),i([p()],e.prototype,"_slideMode",void 0),i([p({type:cc.Enum(s),tooltip:!1})],e.prototype,"slideMode",null),i([p({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==s.PAGE}})],e.prototype,"pageDistance",void 0),i([p({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==s.PAGE}})],e.prototype,"pageChangeEvent",void 0),i([p()],e.prototype,"_virtual",void 0),i([p({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),i([p({tooltip:!1,visible:function(){var t=this.slideMode==s.NORMAL;return t||(this.cyclic=!1),t}})],e.prototype,"cyclic",void 0),i([p({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),i([p({tooltip:!1,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}})],e.prototype,"lackSlide",void 0),i([p({type:cc.Integer})],e.prototype,"_updateRate",void 0),i([p({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),i([p({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),i([p({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),i([p({type:cc.Enum(c),tooltip:!1})],e.prototype,"selectedMode",void 0),i([p({tooltip:!1,visible:function(){return this.selectedMode==c.SINGLE}})],e.prototype,"repeatEventSingle",void 0),i([p({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>c.NONE}})],e.prototype,"selectedEvent",void 0),i([p({serializable:!1})],e.prototype,"_numItems",void 0),i([u,h(),f(cc.ScrollView),d(-5e3)],e)}(cc.Component);n.default=_,cc._RF.pop()},{"./ListItem":"ListItem"}],LoadSpriteWaitNotCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"ecc4f4D38pNx4r4gsvA5Dx8","LoadSpriteWaitNotCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator.ccclass,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maskNode_=null,e.rootNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){var t,e,n,o,r,i;return[(t={},t[mc.Event.LOAD_BEGIN_WIND]=this.showLoading,t),(e={},e[mc.Event.LOAD_END_WIND]=this.hide,e),(n={},n[mc.Event.LOAD_BEGIN_PNL]=this.showLoading,n),(o={},o[mc.Event.LOAD_END_PNL]=this.hide,o),(r={},r[mc.Event.LOAD_BEGIN_SPRITE]=this.showLoading,r),(i={},i[mc.Event.LOAD_END_SPRITE]=this.hide,i)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("LoadSpriteWaitNotCtrl onCreate"),[2]})})},e.prototype.showLoading=function(){this.open(),cc.tween(this.maskNode_).to(.2,{opacity:120}).start()},i([c],e)}(mc.BaseNoticeCtrl);n.default=l,cc._RF.pop()},{}],LoadingNotCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"a2a72LWGU9DrLM1DvDxuPDY","LoadingNotCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator.ccclass,l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("LoadingNotCtrl onCreate"),[2]})})},i([c],e)}(mc.BaseNoticeCtrl);n.default=l,cc._RF.pop()},{}],LocalConfig:[function(t,e,n){"use strict";cc._RF.push(e,"94874H5mSRIhJttyOKSlwCf","LocalConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.localConfig=void 0;n.localConfig=new function(){this.release=!0,this.openGuide=!0,this.serverList=null,this.isTestServer=!1,this.openLog=!0,this.isGm=!0,this.showFps=!0,this.debugStorage=!1,this.debugDBHelper=!1,this.copyTestModel=!1,this.isNetLog=!0,this.openGuide=!!this.release||this.openGuide,this.serverList=this.release?null:this.serverList,this.isTestServer=!this.release&&this.isTestServer,this.openLog=!this.release&&this.openLog,this.isGm=!this.release&&this.isGm,this.showFps=!this.release&&this.showFps,this.debugStorage=!this.release&&this.debugStorage,this.debugDBHelper=!this.release&&this.debugDBHelper,this.copyTestModel=!this.release&&this.copyTestModel},cc._RF.pop()},{}],LocalLang:[function(t,e,n){"use strict";cc._RF.push(e,"7abeeWvpgBK4ZpTIwqLedby","LocalLang"),Object.defineProperty(n,"__esModule",{value:!0}),n.default={readying:"app.readying",loading_0:"app.loading_0",loading_1:"app.loading_1",loading_2:"app.loading_2",loading_3:"app.loading_3",loading_4:"app.loading_4",loading_5:"app.loading_5",guide:"app.guide",guide_goon:"app.guide_goon",guide_skip:"app.guide_skip",update_0:"app.update_0",update_1:"app.update_1",update_2:"app.update_2",play_time_1:"app.play_time_1",play_time_2:"app.play_time_2",login_expire:"app.login_expire",login:"app.login",wetchat_text:"app.wetchat_text",agreement_text1:"app.agreement_text1",agreement_text2:"app.agreement_text2",agreement_text3:"app.agreement_text3",agreement_text4:"app.agreement_text4",agreement_toast:"app.agreement_toast",android_app:"app.android_app",ios_app:"app.ios_app",wx:"app.wx",device_diff:"app.device_diff",device_app_diff:"app.device_app_diff",device_diff_confirm:"app.device_diff_confirm",version_diff:"app.version_diff",version_diff_samePlat:"app.version_diff_samePlat",version_diff_confirm:"app.version_diff_confirm",feedback:"app.feedback",send:"app.send",feedback_send_success:"app.feedback_send_success",send_failed:"app.send_failed",wx_version_update_title:"app.wx_version_update_title",wx_version_update_content:"app.wx_version_update_content",apple_text:"app.apple_text",visitor_text:"app.visitor_text",twitter_text:"app.twitter_text",facebook_text:"app.facebook_text",google_text:"app.google_text",login_fail:"app.login_fail",visitor_login_alert:"app.visitor_login_alert",confirm:"app.confirm",cancel:"app.cancel",tips:"app.tips",go:"app.go",retry:"app.retry",goon:"app.goon",soft_tips:"app.soft_tips",goback:"app.goback",update_need_appstore:"app.update_need_appstore",update_must_appstore:"app.update_must_appstore",exit_game_tips:"app.exit_game_tips",net_fail:"app.net_fail",client_sign_error:"app.client_sign_error",login_block:"app.login_block",cheat_feedback_ok:"app.cheat_feedback_ok",deblock_punishment:"app.deblock_punishment",deblock_comfirm:"app.deblock_comfirm",copy_uid_complete:"app.copy_uid_complete"},cc._RF.pop()},{}],LocaleLabel:[function(t,e,n){"use strict";cc._RF.push(e,"9705eZTZHVNNalGAojhJWC6","LocaleLabel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../script/common/constant/Constant"),l=t("../base/BaseLanguage"),u=t("../event/CoreEventType"),p=t("../manage/LanguageMgr"),h=t("./LabelAutoAdaptSize"),d=cc._decorator,f=d.ccclass,y=d.property,_=d.menu,g=d.requireComponent,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e.fontName="",e.params=[],e._label=null,e._string="",e._lang="",e._font="",e._json=null,e._loadFont="",e._params=[],e._temp_params=[],e._change=!1,e._is_empty_string=!1,e}return r(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label||(this._label=this.getComponent(cc.Label)),this._label},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._params=this.params,eventMgr.on(u.default.LANGUAGE_CLEAN,this.onLanguageReset,this)},e.prototype.onEnable=function(){p.languageMgr.lang&&(this._lang!==p.languageMgr.lang&&(this.releaseFont(),this._lang=p.languageMgr.lang,this._json=null,this.updateTempParams()),this._json||this.updateJson(),this.updateString(),this._change=p.languageMgr.change,this._change&&eventMgr.on(u.default.SWITCH_LANGUAGE,this.onLanguageChanged,this))},e.prototype.onDisable=function(){this._change&&(this._change=!1,eventMgr.off(u.default.SWITCH_LANGUAGE,this.onLanguageChanged,this))},e.prototype.onDestroy=function(){this.releaseFont(),eventMgr.off(u.default.LANGUAGE_CLEAN,this.onLanguageChanged,this)},e.prototype.onLanguageReset=function(){""!==this._font&&(this.releaseFont(),this.updateTempParams(),this.updateJson(),this.updateString())},e.prototype.onLanguageChanged=function(t){this.releaseFont(),this._lang=t,this.updateTempParams(),this.updateJson(),this.updateString()},Object.defineProperty(e.prototype,"string",{get:function(){return this.label.string},set:function(t){this.label.string=t,this._is_empty_string=""===t},enumerable:!1,configurable:!0}),e.prototype.updateLang=function(){this._lang=p.languageMgr.lang},e.prototype.updateString=function(){var t=this._json?this._json[this._lang]:void 0;void 0!==t?this._string=ut.stringFormat(t,this._temp_params):this.key?this._string=ut.stringFormat(this.key,this._temp_params):this._is_empty_string?this._string="":this._string="404",this._string!==this.label.string&&(this.label.string=this._string)},e.prototype.setParams=function(t){var e=this;this._params.length=0,t.forEach(function(t){return Array.isArray(t)?e._params.pushArr(t):e._params.push(t)}),this.updateTempParams()},e.prototype.updateTempParams=function(){var t=this;this._temp_params=this._params.map(function(e){if("string"==typeof e&&-1!==e.indexOf(".")){var n=(assetsMgr.getJsonData("Language",t.key)||{})[t._lang];return void 0!==n?n:e}return e})},e.prototype.updateJson=function(){this.key?(this._json=assetsMgr.getJsonData("Language",this.key),this.updateFont()):this._json=null},e.prototype.updateFont=function(){""!==this.fontName?this.fontName!==this._font&&this.setFont(this.fontName):this.setFont(c.DEFAULT_FONT)},e.prototype.releaseFont=function(){""!==this._font&&(assetsMgr.releaseFont(this._font,this._lang),this._font="")},e.prototype.setFont=function(t){return a(this,void 0,void 0,function(){var e,n,o;return s(this,function(r){switch(r.label){case 0:return this.releaseFont(),this._loadFont=t,e=this._lang,this.label.font=null,[4,assetsMgr.getFontDynamic(t)];case 1:return(n=r.sent())?this._loadFont===t&&e===this._lang&&this.isValid?(this._font=t,this.label.font=n,(o=this.node.getComponent(h.default))?o.reset():this.label._forceUpdateRenderData()):assetsMgr.releaseFont(t,e):this.isValid&&(this.label.font=null,this._font=""),[2]}})})},e.prototype.setLangKey=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._lang||(this._lang=p.languageMgr.lang),this.key===t&&this._json||(this.key=t,this.string="",this.updateJson()),this._is_empty_string=""===t,this.setParams(e),this.updateString()},i([y()],e.prototype,"key",void 0),i([y()],e.prototype,"fontName",void 0),i([y([cc.String])],e.prototype,"params",void 0),i([f,_("\u591a\u8bed\u8a00\u7ec4\u4ef6/LocaleLabel"),g(cc.Label)],e)}(l.default);n.default=m,cc.LocaleLabel=m,cc._RF.pop()},{"../../script/common/constant/Constant":"Constant","../base/BaseLanguage":"BaseLanguage","../event/CoreEventType":"CoreEventType","../manage/LanguageMgr":"LanguageMgr","./LabelAutoAdaptSize":"LabelAutoAdaptSize"}],LocaleRichText:[function(t,e,n){"use strict";cc._RF.push(e,"e769d+YgOxJk7O+jV4RDTuh","LocaleRichText");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../script/common/constant/Constant"),l=t("../base/BaseLanguage"),u=t("../event/CoreEventType"),p=t("../manage/LanguageMgr"),h=cc._decorator,d=h.ccclass,f=h.property,y=h.menu,_=h.requireComponent,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e.fontName="",e.params=[],e._label=null,e._string="",e._lang="",e._font="",e._json=null,e._params=[],e._temp_params=[],e._change=!1,e._is_empty_string=!1,e}return r(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label||(this._label=this.getComponent(cc.RichText)),this._label},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._params=this.params,eventMgr.on(u.default.LANGUAGE_CLEAN,this.onLanguageReset,this)},e.prototype.onEnable=function(){p.languageMgr.lang&&(this._lang!==p.languageMgr.lang&&(this.releaseFont(),this._lang=p.languageMgr.lang,this._json=null,this.updateTempParams()),this._json||this.updateJson(),this.updateString(),this._change=p.languageMgr.change,this._change&&eventMgr.on(u.default.SWITCH_LANGUAGE,this.onLanguageChanged,this))},e.prototype.onDisable=function(){this._change&&(this._change=!1,eventMgr.off(u.default.SWITCH_LANGUAGE,this.onLanguageChanged,this))},e.prototype.onDestroy=function(){this.releaseFont(),eventMgr.off(u.default.LANGUAGE_CLEAN,this.onLanguageChanged,this)},e.prototype.onLanguageReset=function(){""!==this._font&&(this.releaseFont(),this.updateTempParams(),this.updateJson(),this.updateString())},e.prototype.onLanguageChanged=function(t){this.releaseFont(),this._lang=t,this.updateTempParams(),this.updateJson(),this.updateString()},Object.defineProperty(e.prototype,"string",{get:function(){return this.label.string},set:function(t){this.label.string=t,this._is_empty_string=""===t},enumerable:!1,configurable:!0}),e.prototype.updateLang=function(){this._lang=p.languageMgr.lang},e.prototype.updateString=function(){var t=this._json?this._json[this._lang]:void 0;void 0!==t?this._string=ut.stringFormat(t,this._temp_params):this.key?this._string=ut.stringFormat(this.key,this._temp_params):this._is_empty_string?this._string="":this._string="404",this._string!==this.label.string&&(this.label.string=this._string)},e.prototype.setParams=function(t){var e=this;this._params.length=0,t.forEach(function(t){return Array.isArray(t)?e._params.pushArr(t):e._params.push(t)}),this.updateTempParams()},e.prototype.updateTempParams=function(){var t=this;this._temp_params=this._params.map(function(e){if("string"==typeof e&&-1!==e.indexOf(".")){var n=e.split("."),o=n[0],r=n[1],i=(assetsMgr.getJsonData(o,r)||{})[t._lang];return void 0!==i?i:e}return e})},e.prototype.updateJson=function(){this.key?(this._json=assetsMgr.getJsonData("Language",this.key),this.updateFont()):this._json=null},e.prototype.updateFont=function(){""!==this.fontName?this.fontName!==this._font&&this.setFont(this.fontName):this.setFont(c.DEFAULT_FONT)},e.prototype.releaseFont=function(){""!==this._font&&(assetsMgr.releaseFont(this._font,this._lang),this._font="")},e.prototype.setFont=function(t){return a(this,void 0,void 0,function(){var e,n;return s(this,function(o){switch(o.label){case 0:return this.releaseFont(),assetsMgr.enabledBMFont()?(this._font=t,e=this._lang,this.label.font=null,[4,assetsMgr.getFontDynamic(t)]):[3,2];case 1:return(n=o.sent())?this._font===t&&e===this._lang&&this.isValid?(this._font=t,this.label.font=n,this.label._updateRichText()):assetsMgr.releaseFont(t,e):this.isValid&&(this.label.font=null,this._font=""),[3,3];case 2:this.label.font=null,this._font="",o.label=3;case 3:return[2]}})})},e.prototype.setLangKey=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._lang||(this._lang=p.languageMgr.lang),this.key===t&&this._json||(this.key=t,this.string="",this.updateJson()),this._is_empty_string=""===t,this.setParams(e),this.updateString()},i([f()],e.prototype,"key",void 0),i([f()],e.prototype,"fontName",void 0),i([f([cc.String])],e.prototype,"params",void 0),i([d,y("\u591a\u8bed\u8a00\u7ec4\u4ef6/LocaleRichText"),_(cc.RichText)],e)}(l.default);n.default=g,cc.LocaleRichText=g,cc._RF.pop()},{"../../script/common/constant/Constant":"Constant","../base/BaseLanguage":"BaseLanguage","../event/CoreEventType":"CoreEventType","../manage/LanguageMgr":"LanguageMgr"}],LocaleSprite:[function(t,e,n){"use strict";cc._RF.push(e,"120c1Cc8FVER42epaZtmWqS","LocaleSprite");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../base/BaseLanguage"),l=t("../event/CoreEventType"),u=t("../manage/LanguageMgr"),p=cc._decorator,h=p.ccclass,d=p.property,f=p.menu,y=p.requireComponent,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e.frames=[],e._sprite=null,e._json=null,e._lang="",e._change=!1,e}return r(e,t),Object.defineProperty(e.prototype,"sprite",{get:function(){return this._sprite||(this._sprite=this.getComponent(cc.Sprite)),this._sprite},enumerable:!1,configurable:!0}),e.prototype.onEnable=function(){u.languageMgr.lang&&(this._lang!==u.languageMgr.lang&&(this._lang=u.languageMgr.lang,this._json=null),this._json||this.updateJson(),this.updateSprite(),this._change=u.languageMgr.change,this._change&&eventMgr.on(l.default.SWITCH_LANGUAGE,this.onLanguageChanged,this))},e.prototype.onDisable=function(){this._change&&(this._change=!1,eventMgr.off(l.default.SWITCH_LANGUAGE,this.onLanguageChanged,this))},e.prototype.onLanguageChanged=function(t){this._lang=t,this.updateSprite()},e.prototype.updateSprite=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return this._json?void 0===(t=this._json[this._lang])?(this.sprite.spriteFrame=null,[2]):(e=this.frames.find(function(e){return e.name===t}))?[3,2]:[4,assetsMgr.loadTempRes(t,cc.SpriteFrame,"__lang_sprite")]:(this.sprite.spriteFrame=null,[2]);case 1:e=n.sent(),n.label=2;case 2:return e?(this.isValid&&(this.sprite.spriteFrame=e),[2]):[2,lplog.info("\u6ca1\u6709\u627e\u5230\u591a\u8bed\u8a00\u56fe\u7247, key="+this.key+", url="+t)]}})})},e.prototype.updateJson=function(){if(this.key){var t=this.key.split("."),e=t[0],n=t[1];this._json=assetsMgr.getJsonData(e,n),this._json||(this._json={},lplog.info("\u6ca1\u6709\u627e\u5230\u591a\u8bed\u8a00\u56fe\u7247json\u4fe1\u606f, key="+this.key))}else this._json={}},e.prototype.setLangKey=function(t){this.key===t&&this._json||(this.key=t,this.updateJson()),this.updateSprite()},e.prototype.addSpriteFrame=function(t){this.frames.push(t)},i([d()],e.prototype,"key",void 0),i([d([cc.SpriteFrame])],e.prototype,"frames",void 0),i([h,f("\u591a\u8bed\u8a00\u7ec4\u4ef6/LocaleSprite"),y(cc.Sprite)],e)}(c.default);n.default=_,cc.LocaleSprite=_,cc._RF.pop()},{"../base/BaseLanguage":"BaseLanguage","../event/CoreEventType":"CoreEventType","../manage/LanguageMgr":"LanguageMgr"}],LockTouchCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"dcc4bFlzDpMEa4gPfg5AEdh","LockTouchCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../common/helper/GameHelper"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),this.node.SetSwallowTouches(!1)},e.prototype.onTouchStart=function(t){-1===a.gameHelper.clickTouchId&&(a.gameHelper.clickTouchId=t.getID())},e.prototype.onTouchEnd=function(t){a.gameHelper.clickTouchId===t.getID()&&(a.gameHelper.clickTouchId=-1)},i([c],e)}(cc.Component));n.default=l,cc._RF.pop()},{"../../../common/helper/GameHelper":"GameHelper"}],Logger:[function(t,e,n){"use strict";cc._RF.push(e,"6baadjM1IhKz4X2x37dFl1D","Logger");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../event/CoreEventType"),i=null,a={},s=function(){function t(){}return t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i&&(i.info.apply(i,o([i],t)),lplog.info.apply(lplog,o([i],t)))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i&&(i.warn.apply(i,o([i],t)),lplog.info.apply(lplog,o([i],t)))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];i&&(i.error.apply(i,o([i],t)),lplog.error.apply(lplog,o([i],t)))},t.prototype.setFilterMsg=function(t){i&&i.setFilterMsg&&"string"==typeof t&&i.setFilterMsg(t)},t.prototype.addFilterMsg=function(t){i&&i.addFilterMsg&&"string"==typeof t&&(a[t]||(a[t]=!0,i.addFilterMsg(t)))},t}(),c=function(){function t(){this._open=!1,this._upLog=null}return Object.defineProperty(t.prototype,"upLog",{get:function(){return this._upLog||("undefined"!=typeof wx&&(i=wx.getRealtimeLogManager?wx.getRealtimeLogManager():null),this._upLog=new s),this._upLog},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},set:function(t){this._open=t},enumerable:!1,configurable:!0}),t.prototype.info=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(this._open){var o=this.wrapLogger(t,e);if(cc.sys.isMobile)console.log(o);else{var i=console.log||cc.log;i.call(this,o)}eventMgr.emit(r.default.MVC_LOGGER_PRINT,"info",o)}},t.prototype.error=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(this._open){var o=this.wrapLogger(t,e);if(cc.sys.isMobile)console.error(o);else{var i=console.error||cc.error;i.call(this,o)}eventMgr.emit(r.default.MVC_LOGGER_PRINT,"error",o)}},t.prototype.wrapLogger=function(t,e){var n=this;return"["+ut.dateFormat("h:mm:ss")+"] "+this.formatter(t)+" "+e.join2(function(t){return n.formatter(t)}," ")},t.prototype.formatter=function(t){var e=this;return null===t?"null":void 0===t?"undefined":Array.isArray(t)?"["+t.join2(function(t){return e.formatter(t)},",")+"]":"object"==typeof t?this.warpObject(t):String(t)},t.prototype.warpObject=function(t){try{return t.__classname__?t.__classname__+" { name: "+t.name+" }":JSON.stringify(t)}catch(e){return"\u65e0\u6cd5\u89e3\u6790"}},t}();window.lplog=new c,cc._RF.pop()},{"../event/CoreEventType":"CoreEventType"}],LoginCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"4fcd4jUHilIhqE105A6OWhh","LoginCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../script/common/helper/GameHelper"),u=t("../script/common/helper/ViewHelper"),p=t("../script/common/apple/AppleHelper"),h=t("../script/common/event/NotEvent"),d=t("../script/common/constant/Enums"),f=t("../../startScene/LangLabel"),y=cc._decorator,_=y.ccclass,g=y.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wechatText=null,e.appleText=null,e.visitorText=null,e.twitterText=null,e.facebookText=null,e.googleText=null,e.agreementTg=null,e.agreementLbl1=null,e.agreementLbl2=null,e.agreementLbl3=null,e.agreementLbl4=null,e.buttonsNode=null,e.wechatBtnNode=null,e.appleBtnNode=null,e.twitterBtnNode=null,e.facebookBtnNode=null,e.googleBtnNode=null,e.alertNode=null,e.loadingNode=null,e.app=null,e.localLang=null,e.isAgree=!1,e.isHasAgree=!1,e.isHasShowAgreePnl=!1,e}return r(e,t),e.prototype.onLoad=function(){this.alertNode.parent=this.node.parent,this.loadingNode.parent=this.node.parent,this.alertNode.zIndex=2e3,this.loadingNode.zIndex=2001,this.alertNode.active=!1,this.loadingNode.active=!1,this.isHasShowAgreePnl=!1,this.updateBtns(),eventMgr.on(h.default.OPEN_ALERT,this.showAlert,this)},e.prototype.clean=function(){eventMgr.off(h.default.OPEN_ALERT,this.showAlert,this),this.closePnl("common/Agreement"),this.closePnl("login/AdAuth"),this.closePnl("login/AuthTip"),this.closePnl("login/DeviceTip"),this.alertNode.destroy(),this.loadingNode.destroy(),this.node.destroy()},e.prototype.closePnl=function(t){eventMgr.emit(mc.Event.CLOSE_PNL,t),u.viewHelper.readyShowPnls.remove(t)},e.prototype.init=function(t,e){this.app=t,this.localLang=e,this.wechatText.setLangKey(e.wetchat_text),this.appleText.setLangKey(e.apple_text),this.visitorText.setLangKey(e.visitor_text),this.twitterText.setLangKey(e.twitter_text),this.facebookText.setLangKey(e.facebook_text),this.googleText.setLangKey(e.google_text),this.agreementLbl1.setLangKey(e.agreement_text1),this.agreementLbl2.setLangKey(e.agreement_text2),this.agreementLbl3.setLangKey(e.agreement_text3),this.agreementLbl4.setLangKey(e.agreement_text4),this.check(),this.agreementTg.node.parent.active=l.gameHelper.isInland()},e.prototype.updateBtns=function(){var t=l.gameHelper.isInland(),e=l.gameHelper.isGLobal();this.wechatBtnNode.active=t&&(!ut.isIos()||!!jsb.reflection.callStaticMethod("WXApiManager","isWeChatHas")),this.appleBtnNode.active=ut.isIos()&&p.appleHelper.isShowAppleButton(),this.twitterBtnNode.active=e,this.facebookBtnNode.active=e,this.googleBtnNode.active=e&&ut.isAndroid()},e.prototype.onClickAppleLogin=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onClickTwitterLogin=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onClickFacebookLogin=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.onClickGoogleLogin=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.showAlert=function(t){for(var e,n=this,o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];this.alertNode.active=!0;var i=this.alertNode.Child("root"),a=this.alertNode.Child("close"),s=i.Child("alertText",cc.Label);(e=s.Component(f.default)).setLangKey.apply(e,c([t],o)),s._forceUpdateRenderData(),i.width=Math.max(600,s.node.width+200),i.stopAllActions(),i.opacity=255,i.scale=.2,cc.tween(i).to(.2,{scale:1},{easing:cc.easing.backOut}).delay(1).to(.18,{opacity:0}).call(function(){var t;(null===(t=n.alertNode)||void 0===t?void 0:t.isValid)&&(n.alertNode.active=!1)}).start(),a.stopAllActions(),a.opacity=0,cc.tween(a).to(.2,{opacity:120}).delay(1).to(.18,{opacity:0}).start()},e.prototype.onCloseAlert=function(){var t,e=this;if((null===(t=this.alertNode)||void 0===t?void 0:t.isValid)&&this.alertNode.active){var n=this.alertNode.Child("root"),o=this.alertNode.Child("close");n.stopAllActions(),cc.tween(n).to(.18,{opacity:0}).call(function(){var t;(null===(t=e.alertNode)||void 0===t?void 0:t.isValid)&&(e.alertNode.active=!1)}).start(),o.stopAllActions(),cc.tween(o).to(.18,{opacity:0}).start()}},e.prototype.showLoading=function(t){var e;(null===(e=this.loadingNode)||void 0===e?void 0:e.isValid)&&(this.loadingNode.active=t)},e.prototype.showSyncInfo=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return[2,this.app.showSyncInfo(t)]})})},e.prototype.check=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(){return t=l.gameHelper.isInland(),l.gameHelper.isGLobal(),this.isHasAgree=this.agreementTg.node.parent.active=t&&cc.sys.isNative,this.isHasAgree?this.isAgree=this.agreementTg.isChecked=!1:this.isAgree=!0,this.buttonsNode.active=!0,this.isAgree||this.showAgreement(),[2]})})},e.prototype.showAgreement=function(t){var e=this;this.isHasAgree&&(this.isHasShowAgreePnl&&l.gameHelper.isInland()&&l.gameHelper.appChannel==d.ChannelType.JL?this.showAlert("app.toogle_tip"):u.viewHelper.showPnl("common/Agreement",this.node.parent,function(n){e.isValid&&(e.agreementTg.isChecked=e.isAgree="ok_b"===n,l.gameHelper.appChannel==d.ChannelType.DY&&(e.agreementTg.isChecked=e.isAgree=!1),l.gameHelper.appChannel==d.ChannelType.JL&&(e.isHasShowAgreePnl=!0,e.agreementTg.isChecked=e.isAgree=!1),e.isAgree&&t&&t())}))},i([g(f.default)],e.prototype,"wechatText",void 0),i([g(f.default)],e.prototype,"appleText",void 0),i([g(f.default)],e.prototype,"visitorText",void 0),i([g(f.default)],e.prototype,"twitterText",void 0),i([g(f.default)],e.prototype,"facebookText",void 0),i([g(f.default)],e.prototype,"googleText",void 0),i([g(cc.Toggle)],e.prototype,"agreementTg",void 0),i([g(f.default)],e.prototype,"agreementLbl1",void 0),i([g(f.default)],e.prototype,"agreementLbl2",void 0),i([g(f.default)],e.prototype,"agreementLbl3",void 0),i([g(f.default)],e.prototype,"agreementLbl4",void 0),i([g(cc.Node)],e.prototype,"buttonsNode",void 0),i([g(cc.Node)],e.prototype,"wechatBtnNode",void 0),i([g(cc.Node)],e.prototype,"appleBtnNode",void 0),i([g(cc.Node)],e.prototype,"twitterBtnNode",void 0),i([g(cc.Node)],e.prototype,"facebookBtnNode",void 0),i([g(cc.Node)],e.prototype,"googleBtnNode",void 0),i([g(cc.Node)],e.prototype,"alertNode",void 0),i([g(cc.Node)],e.prototype,"loadingNode",void 0),i([_],e)}(cc.Component);n.default=m,cc._RF.pop()},{"../../startScene/LangLabel":void 0,"../script/common/apple/AppleHelper":"AppleHelper","../script/common/constant/Enums":"Enums","../script/common/event/NotEvent":"NotEvent","../script/common/helper/GameHelper":"GameHelper","../script/common/helper/ViewHelper":"ViewHelper"}],LostLifePnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"560f5Og3whI4Kl+f3bnRngg","LostLifePnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/GameHelper"),l=cc._decorator.ccclass,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleLbl_=null,e.exitNode_=null,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("LostLifePnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){this.callback=t.callback,cc.log("LostLifePnlCtrl onEnter")},e.prototype.onRemove=function(){cc.log("LostLifePnlCtrl onRemove")},e.prototype.onClean=function(){cc.log("LostLifePnlCtrl onClean")},e.prototype.onClickClose1=function(t,e){cc.log("onClickClose1",e),this.close(),this.callback&&this.callback(!1)},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close(),this.callback&&this.callback(!1)},e.prototype.onClickExit=function(t,e){cc.log("onClickExit",e),this.close(),c.gameHelper.global.costHeart(),this.callback&&this.callback(!0)},i([l],e)}(mc.BasePnlCmpt);n.default=u,cc._RF.pop()},{"../../common/helper/GameHelper":"GameHelper"}],MainSkinHelper:[function(t,e,n){"use strict";cc._RF.push(e,"845d7mQKqdNRIHKvMGL1PrX","MainSkinHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.mainSkinHelper=void 0;var o=t("../constant/Constant"),r=function(){function t(){}return t.prototype.addExtraNode=function(t,e,n,r,i,a,s){n&&t&&e.forEach(function(e){(t[e.name]||[]).forEach(function(t){var c,l,u=t.isInContent?null==n?void 0:n.FindChild(t.parent):t.parent.includes("di")?a.FindChild(t.parent):r.FindChild(t.parent);if(u){var p=cc.instantiate2(e,u);if(t.position&&p.setPosition(t.position),(11===s||13===s)&&(e.name.includes("sd_dalou_zhuangshi")||e.name.includes("shengdan_3"))){var h=t["offset_"+s];h&&(p.x+=h.x,p.y+=h.y)}if(i.push(p),"role_n"===u.name?p.zIndex=Math.floor(o.MAX_ZINDEX-t.position.y):p.zIndex=null!==(c=t.zIndex)&&void 0!==c?c:0,t.scale&&p.setScale(t.scale),t.cmpt){var d=t.cmpt.split("."),f=d[0],y=d[1],_=f?p.getComponent(f)||p.addComponent(f):null;_&&y&&t.params&&(null===(l=_[y])||void 0===l||l.call(_,t.params))}t.isInContent&&(p.parent=n.FindChild(t.parent))}})})},t.prototype.setOtherImg=function(t,e,n,o){if(n&&t){var r=[];e.forEach(function(e){var n=t[e.name];Array.isArray(n)?n.forEach(function(t){return"parachut"===t&&r.push(e)}):"parachut"===n&&r.push(e)}),o&&(o.Child("di/val",cc.Sprite).spriteFrame=e.find(function(e){return"dimian"===t[e.name]})||null);var i=e.find(function(e){return"shuye"===t[e.name]});i&&(n.FindChild("x/top",cc.Sprite).spriteFrame=i)}},t.prototype.addExtraImg=function(t,e,n,o){var r=this;if(n&&t){var i={},a=n,s=function(n){var s=e.find(function(t){return t.name===n});t[n].forEach(function(t){if(t.hide&&t.hide.forEach(function(t){var e;return null===(e=t.isInContent?a.FindChild(t.parent):o.FindChild(t.parent))||void 0===e?void 0:e.setActive(!1)}),s)if(t.replace)r.setNodeInfo(a.Child(t.parent),s,t);else{var e={sf:s,conf:t},n=i[t.parent];n?n.push(e):i[t.parent]=[e]}})};for(var c in t)s(c);var l=function(t){for(var e=a.Child(t),n=i[t],o=e.children.map(function(t){return t}),r=0,s=o.length,c=function(t){var i,a=n.find(function(e){return void 0===e.conf.index&&t>=s&&!e.init||e.conf.index===t});a?(a.init=!0,(i=new cc.Node(a.sf.name)).parent=e,u.setNodeInfo(i,a.sf,a.conf),i.zIndex=t):(i=o[r++])&&(i.zIndex=t)},l=0,p=s+n.length;l<p;l++)c(l)},u=this;for(var p in i)l(p)}},t.prototype.setNodeInfo=function(t,e,n){t&&((t.getComponent(cc.Sprite)||t.addComponent(cc.Sprite)).spriteFrame=e,n.position&&t.setPosition(n.position),n.scale&&t.setScale(n.scale))},t}();n.mainSkinHelper=new r,cc._RF.pop()},{"../constant/Constant":"Constant"}],MainWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"0aac6MMVPFFFK46CO5RTw+A","MainWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../core/utils/Decorator"),l=t("../../common/event/EventType"),u=t("../../common/helper/AnimHelper"),p=t("../../common/helper/GameHelper"),h=t("../../common/helper/GotoHelper"),d=t("../../common/helper/ViewHelper"),f=t("../../common/LocalConfig"),y=t("../../common/wx/WxHelper"),_=cc._decorator.ccclass,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapNode_=null,e.settingNode_=null,e.countLbl_=null,e.logoEnglishNode_=null,e.logoNode_=null,e.heartNode_=null,e.heartCountLbl_=null,e.countDownLbl_=null,e.playNode_=null,e.levelNode_=null,e.checkNode_=null,e.luckNode_=null,e.moreGameNode_=null,e.shareNode_=null,e.rankNode_=null,e.drillNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){var t,e;return[(t={},t[l.default.UPDATE_COIN]=this.refreshView,t),(e={},e[l.default.UPDATE_HEART]=this.refreshLife,e)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("........MainWindCtrl onCreate..........."),[2]})})},e.prototype.onEnter=function(){cc.log("MainWindCtrl onEnter"),this.refreshView(),this.refreshLife(),f.localConfig.isGm&&cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.shareNode_.active=this.rankNode_.active=!0,this.settingNode_.active=this.logoEnglishNode_.active=p.gameHelper.isInland(),this.logoNode_.active=!0,u.animHelper.playFrameLight(this.logoNode_),p.gameHelper.global.getCheckRedDot()&&this.scheduleOnce(function(){d.viewHelper.showPnl("main/Check")},1)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.a:d.viewHelper.gotoWind("debug")}},e.prototype.onClean=function(){cc.log("MainWindCtrl onClean")},e.prototype.onClickPlay=function(t,e){cc.log("onClickPlay",e),h.gotoHelper.gotoWind("game")},e.prototype.onClickSetting=function(t,e){cc.log("onClickSetting",e),d.viewHelper.showPnl("common/Setting")},e.prototype.onClickCoin=function(t,e){cc.log("onClickCoin",e),d.viewHelper.showPnl("common/Shop")},e.prototype.onClickLuck=function(t,e){cc.log("onClickLuck",e),h.gotoHelper.gotoWind("spin")},e.prototype.onClickCheck=function(t,e){cc.log("onClickCheck",e),d.viewHelper.showPnl("main/Check")},e.prototype.onClickMoreGame=function(t,e){cc.log("onClickMoreGame",e),window.Telegram&&window.Telegram.WebApp.openTelegramLink("https://t.me/bestpuzzlegame")},e.prototype.onClickShare=function(t,e){cc.log("onClickShare",e)},e.prototype.onClickRank=function(){this.gotoRank()},e.prototype.onClickDrill=function(t,e){cc.log("onClickDrill",e),h.gotoHelper.gotoWind("dig")},e.prototype.onClickLevel=function(t,e){cc.log("onClickLevel",e),this.levelHandler()},e.prototype.onClickLife=function(t,e){cc.log("onClickLife",e),p.gameHelper.global.isFull()?d.viewHelper.showAlert("life_full_tip"):d.viewHelper.showPnl("common/Heart")},e.prototype.refreshView=function(){this.countLbl_.string=p.gameHelper.global.getCoin();var t=p.gameHelper.global.level;this.levelNode_.Child("text",cc.LocaleLabel).setLangKey("level_title",t);var e=t%5==0;this.levelNode_.Component(cc.MultiFrame).setFrame(e?1:0)},e.prototype.gotoRank=function(){return a(this,void 0,void 0,function(){return s(this,function(){return h.gotoHelper.gotoWind("rank"),[2]})})},e.prototype.refreshLife=function(){var t=p.gameHelper.global.getHeart();if(this.heartNode_.Child("life_be/text",cc.Label).string=""+t,this.heartNode_.Child("life_be/add").active=t<5,t<5){var e=p.gameHelper.global.getNextHeartTime(),n=Date.now();this.heartCountLbl_.string=ut.millisecondFormat(e-n),this.countDownLbl_.node.active=!1}else this.heartCountLbl_.string="",this.countDownLbl_.node.active=!0},e.prototype.update=function(){this.refreshLife()},e.prototype.checkInfoButton=function(){ut.isWechatGame()&&(y.wxHelper.getUserInfo()?y.wxHelper.destroyButton(this.rankNode_.uuid):y.wxHelper.createUserInfoButton(this.rankNode_))},e.prototype.levelHandler=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t=p.gameHelper.global.level,[4,assetsMgr.loadJsonByName(""+t)];case 1:return(e=n.sent())?d.viewHelper.showPnl("level/LevelBoot",{data:e.datas}):d.viewHelper.showAlert("no_more_level"),[2]}})})},i([ut.addLock],e.prototype,"gotoRank",null),i([c.throttle(1e3)],e.prototype,"update",null),i([ut.addLock],e.prototype,"levelHandler",null),i([_],e)}(mc.BaseWindCtrl);n.default=g,cc._RF.pop()},{"../../../core/utils/Decorator":"Decorator","../../common/LocalConfig":"LocalConfig","../../common/event/EventType":"EventType","../../common/helper/AnimHelper":"AnimHelper","../../common/helper/GameHelper":"GameHelper","../../common/helper/GotoHelper":"GotoHelper","../../common/helper/ViewHelper":"ViewHelper","../../common/wx/WxHelper":"WxHelper"}],MapTouchCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"74f5fHWI7ZNvZenyILNiRvP","MapTouchCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../common/event/EventType"),s=t("../../../../scene/CameraCtrl"),c=t("../../../common/constant/Constant"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tempVec=cc.v2(),e.touchs=[],e.touchCount=2,e.startZoomRatio=0,e.startTouchDis=0,e.startWorldPoint=cc.v2(),e.startPoint=cc.v2(),e.temp_vec2_2=cc.v2(),e}return r(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onDestroy=function(){this.unregister()},e.prototype.init=function(){eventMgr.on(a.default.CHANGE_MAP_TOUCH,this.onChangeMapTouch,this),eventMgr.on(a.default.END_GUIDE,this.onEndGuide,this),this.reset()},e.prototype.unregister=function(){eventMgr.off(a.default.CHANGE_MAP_TOUCH,this.onChangeMapTouch,this),eventMgr.off(a.default.END_GUIDE,this.onEndGuide,this)},e.prototype.reset=function(){this.touchs.length=0,this.touchCount=2,this.startZoomRatio=0,this.startTouchDis=0,this.startWorldPoint.set2(0,0),this.startPoint.set2(0,0)},e.prototype.onTouchStart=function(t){var e=t.getID();if(!(this.touchs.some(function(t){return t.id===e})||this.touchs.length>=this.touchCount)){var n=t.getLocation();if(this.touchs.push({id:e,startLocation:t.getStartLocation(),location:n}),2===this.touchs.length){this.startZoomRatio=s.cameraCtrl.zoomRatio;var o=this.touchs,r=o[0],i=o[1],a=r.location.sub(i.location,this.tempVec);this.startTouchDis=a.mag(),this.startPoint.set(a.divSelf(2).addSelf(i.location)),this.startWorldPoint.set(s.cameraCtrl.getScreenToWorldPoint(this.startPoint))}else s.cameraCtrl.dragStart(),this.startTouchDis=-1}},e.prototype.onTouchMove=function(t){var e=t.getID(),n=this.touchs.find(function(t){return t.id===e});if(n)if(n.location.set(t.getLocation()),2===this.touchs.length){var o=this.touchs,r=o[0],i=o[1],a=.5*(r.location.sub(i.location,this.tempVec).mag()/this.startTouchDis-1);if(s.cameraCtrl.zoomRatio=this.startZoomRatio+a,!s.cameraCtrl.scaleIsMinOrMax()){var c=s.cameraCtrl.getScreenToWorldPoint(this.startPoint).subSelf(this.startWorldPoint);s.cameraCtrl.setPosition(s.cameraCtrl.getPosition().subSelf(c))}}else s.cameraCtrl.dragByTouch(n.startLocation,n.location,t.touch)},e.prototype.onTouchEnd=function(t){var e=t.getID(),n=this.touchs.findIndex(function(t){return t.id===e});if(-1!==n){var o=this.touchs.splice(n,1)[0];o.location.set(t.getLocation()),1===this.touchs.length?((o=this.touchs[0]).startLocation.set(o.location),s.cameraCtrl.recordPosition()):-1===this.startTouchDis?(s.cameraCtrl.convertWorldSub(t.getStartLocation(),t.getLocation()).mag()<=c.CLICK_SPACE&&eventMgr.emit(a.default.MAP_TOUCH_END,s.cameraCtrl.getScreenToWorldPoint(o.location,this.temp_vec2_2),o.location),s.cameraCtrl.dragEnd(t.touch)):s.cameraCtrl.zoomRatioRestore()}},e.prototype.onChangeMapTouch=function(t){this.touchs.length=0,this.touchCount=t?2:0},e.prototype.onEndGuide=function(){this.reset()},i([u],e)}(cc.Component));n.default=p,cc._RF.pop()},{"../../../../scene/CameraCtrl":"CameraCtrl","../../../common/constant/Constant":"Constant","../../../common/event/EventType":"EventType"}],MessageBoxCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"18857+OxTVPk4xR4kxmFpT+","MessageBoxCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../../../startScene/LangLabel"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentLbl_=null,e.buttonsNode_=null,e.titleLb=null,e.decsNode_=null,e.clickToClose=!1,e.lang=null,e.autoClose=!0,e.lockLb=null,e}return r(e,t),e.prototype.init=function(t){var e=t.lang,n=t.msg,o=t.ok,r=t.cancel,i=t.buttons,a=t.clickToClose,s=t.descCB,l=t.autoClose,u=void 0===l||l;this.contentLbl_.setLangKey(n),this.lang=e,this.okCb=o,this.cancelCb=r,this.buttonsNode_.Child("cancel").active=!!r;var p=e.confirm,h=e.cancel;if(i){var d=i[0],f=i[1];this.buttonsNode_.Child("ok/val",c.default).setLangKey(d||p),this.buttonsNode_.Child("cancel/val",c.default).setLangKey(f||h)}else this.buttonsNode_.Child("ok/val",c.default).setLangKey(p),this.buttonsNode_.Child("cancel/val",c.default).setLangKey(h);this.clickToClose=!!a,this.autoClose=!!u,s&&(this.decsNode_.active=!0,this.decsNode_.on("click",s,this)),this.titleLb.setLangKey(this.lang.tips)},e.prototype.setTitleText=function(t){this.titleLb.setLangKey(t)},e.prototype.setTimeLock=function(t,e){return void 0===e&&(e=5),a(this,void 0,void 0,function(){var n,o,r;return s(this,function(i){switch(i.label){case 0:if(!(n="ok"==t?this.buttonsNode_.Child("ok"):this.buttonsNode_.Child("cancel")))return[2];n.getComponent(cc.Button).interactable=!1,n.opacity=140,o=n.Child("val",cc.Label),r=o.string,i.label=1;case 1:return e>0?(o.string=r+" ("+e+")",[4,ut.wait(1)]):[3,3];case 2:return i.sent(),e--,[3,1];case 3:return o.string=r,n.opacity=255,n.getComponent(cc.Button).interactable=!0,[2]}})})},e.prototype.onClickOk=function(){this.autoClose&&this.onClose(),this.okCb&&this.okCb()},e.prototype.onClickCancel=function(){this.autoClose&&this.onClose(),this.cancelCb&&this.cancelCb()},e.prototype.onClickClose=function(){this.clickToClose&&this.onClose()},e.prototype.onClose=function(){this.node.destroy()},i([p(c.default)],e.prototype,"contentLbl_",void 0),i([p(cc.Node)],e.prototype,"buttonsNode_",void 0),i([p(c.default)],e.prototype,"titleLb",void 0),i([p(cc.Node)],e.prototype,"decsNode_",void 0),i([u],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../../../../../startScene/LangLabel":void 0}],MessageHelper:[function(t,e,n){"use strict";cc._RF.push(e,"feff96kK8FCDrbJmW4dSAfe","MessageHelper");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.messageHelper=void 0;var a=t("../../../core/utils/Utils"),s=(t("../event/JsbEvent"),function(){function t(){this.deviceToken=null}return t.prototype.getDeviceToken=function(){return r(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return[3,3];case 1:t=e.sent().token,this.deviceToken=t,e.label=2;case 2:return[2,this.deviceToken];case 3:return[2]}})})},o([a.util.queueLast],t.prototype,"getDeviceToken",null),t}());n.messageHelper=new s,cc._RF.pop()},{"../../../core/utils/Utils":"Utils","../event/JsbEvent":"JsbEvent"}],ModelMgr:[function(t,e,n){"use strict";cc._RF.push(e,"cffddbrkdpD1pjEQfDC+Irq","ModelMgr"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this.models=new Map}return t.prototype.init=function(t){for(var e in t)this.__add(new t[e](e))},t.prototype.create=function(){this.models.forEach(function(t){return t.__create()})},t.prototype.__add=function(t){return t.type?this.models.has(t.type)?lplog.error("\u51fa\u73b0\u76f8\u540c\u7684model type="+t.type):void this.models.set(t.type,t):lplog.error("model type=null!")},t.prototype.add=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach(function(e){return t.__add(e)}),e.forEach(function(t){return t.__create()})},t.prototype.get=function(t){var e=this.models.get(t);return e||lplog.error("get model error! not found "+t),e},t.prototype.reset=function(t){if(!t.type)return lplog.error("model type=null!");var e=this.models.get(t.type);e&&e.__clean(),this.models.set(t.type,t)},t}();n.default=o,cc._RF.pop()},{}],MultiColor:[function(t,e,n){"use strict";cc._RF.push(e,"496b2t/7mxJwZrIreYXXHls","MultiColor");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colors=[],e}return r(e,t),e.prototype.setColor=function(t){var e="number"==typeof t?t:t?1:0;e>=this.colors.length||(this.node.color=this.colors[e])},i([c([cc.Color])],e.prototype,"colors",void 0),i([s,l("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/MultiColor")],e)}(cc.Component);n.default=u,cc.MultiColor=u,cc._RF.pop()},{}],MultiFrameParticle:[function(t,e,n){"use strict";cc._RF.push(e,"b145darW3hCUoVBNmpka6s2","MultiFrameParticle");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.menu,u=a.requireComponent,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frames=[],e}return r(e,t),e.prototype.addFrame=function(t){this.frames.push(t)},e.prototype.setFrame=function(t){if("string"!=typeof t){var e="number"==typeof t?t:t?1:0;e<this.frames.length&&e>=0&&(this.node.Component(cc.ParticleSystem).spriteFrame=this.frames[e])}else this.node.Component(cc.ParticleSystem).spriteFrame=this.frames.find(function(e){return e.name===t})||null},e.prototype.getFrame=function(t){if("string"==typeof t)return this.frames.find(function(e){return e.name===t});var e="number"==typeof t?t:t?1:0;return this.frames[e]},e.prototype.getIndex=function(){var t=this.node.Component(cc.ParticleSystem).spriteFrame;return this.frames.findIndex(function(e){return t===e})},e.prototype.frameCount=function(){return this.frames.length},e.prototype.getSpriteFrame=function(){return this.node.Component(cc.ParticleSystem).spriteFrame},e.prototype.random=function(){var t=this.frames.length;if(0===t)return-1;var e=ut.random(0,t-1);return this.node.Component(cc.ParticleSystem).spriteFrame=this.frames[e],e},e.prototype.clean=function(){this.frames.length=0},i([c([cc.SpriteFrame])],e.prototype,"frames",void 0),i([s,l("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/MultiFrameParticle"),u(cc.ParticleSystem)],e)}(cc.Component);n.default=p,cc.MultiFrameParticle=p,cc._RF.pop()},{}],MultiFrame:[function(t,e,n){"use strict";cc._RF.push(e,"9e586XjwJVGDZg1ihDgEKcb","MultiFrame");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.menu,u=a.requireComponent,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frames=[],e}return r(e,t),e.prototype.addFrame=function(t){this.frames.push(t)},e.prototype.setFrame=function(t){if("string"!=typeof t){var e="number"==typeof t?t:t?1:0;e<this.frames.length&&e>=0&&(this.node.Component(cc.Sprite).spriteFrame=this.frames[e])}else this.node.Component(cc.Sprite).spriteFrame=this.frames.find(function(e){return e.name===t})||null},e.prototype.getFrame=function(t){if("string"==typeof t)return this.frames.find(function(e){return e.name===t});var e="number"==typeof t?t:t?1:0;return this.frames[e]},e.prototype.getIndex=function(){var t=this.node.Component(cc.Sprite).spriteFrame;return this.frames.findIndex(function(e){return t===e})},e.prototype.frameCount=function(){return this.frames.length},e.prototype.getSpriteFrame=function(){return this.node.Component(cc.Sprite).spriteFrame},e.prototype.random=function(){var t=this.frames.length;if(0===t)return-1;var e=ut.random(0,t-1);return this.node.Component(cc.Sprite).spriteFrame=this.frames[e],e},e.prototype.clean=function(){this.frames.length=0},i([c([cc.SpriteFrame])],e.prototype,"frames",void 0),i([s,l("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/MultiFrame"),u(cc.Sprite)],e)}(cc.Component);n.default=p,cc.MultiFrame=p,cc._RF.pop()},{}],NativeAd:[function(t,e,n){"use strict";cc._RF.push(e,"4731ejKcABJcallxwqYVQUQ","NativeAd");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.AppNaitveAd=void 0;var s=t("../constant/Enums"),c=t("../event/JsbEvent"),l=t("../helper/GameHelper"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.waitTime=0,e.reloadTime=0,e.ready=!1,e.isFirst=!0,e}return r(e,t),e.prototype.load=function(t){var e=this;this.state!==s.AdState.LOADING&&this.state!==s.AdState.LOAD_SUCCESS&&this.state!==s.AdState.WAIT?(this.state=s.AdState.LOADING,jsbHelper.cast(c.default.LOAD_NATIVE_AD,function(t){var n=t.status;"0"===n?(e.state=s.AdState.LOAD_SUCCESS,e.isFirst=!1):"-1"===n?e.state=s.AdState.LOAD_FAIL:"-3"===n?(e.reloadTime=10,e.state=s.AdState.WAIT):"-5"===n?(e.reloadTime=120,e.state=s.AdState.WAIT):"-6"===n?(e.state=s.AdState.WAIT,e.reloadTime=6e3):"-7"===n?(e.state=s.AdState.WAIT,e.reloadTime=120+l.gameHelper.getFixTimeSurplyTime((new Date).getTime(),-8)):(lplog.info("load nativeAd unknow code is "+n+" "+typeof n),e.state=s.AdState.WAIT)},this.isFirst?this.getWandH():void 0)):this.state===s.AdState.WAIT&&(this.waitTime+=t,this.waitTime>=this.reloadTime&&(this.waitTime=0,this.state=s.AdState.LOAD_FAIL))},e.prototype.show=function(t){return i(this,void 0,Promise,function(){var e,n,o;return a(this,function(r){switch(r.label){case 0:if(!this.isReady())return[2,!1];e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,jsbHelper.call(c.default.SHOW_NATIVE_AD,t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),e={},lplog.error(n),[3,4];case 4:return"0"===(o=e.status)?[2,!0]:"-1"===o||"-101"===o?(this.state=s.AdState.PLAY_FAIL,this.ready=!1,[2,!1]):(this.state=s.AdState.PLAY_FAIL,this.ready=!1,lplog.info("show native unknow code is "+o+" "+typeof o),[2,!1])}})})},e.prototype.closeAd=function(){return i(this,void 0,Promise,function(){var t,e;return a(this,function(n){switch(n.label){case 0:t=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,jsbHelper.call(c.default.CLOSE_NATIVE_AD)];case 2:return t=n.sent(),[3,4];case 3:return e=n.sent(),t={},lplog.error(e),t={},[3,4];case 4:return"0"===t.status?(this.state=s.AdState.PLAY_FAIL,this.ready=!1,[2,!0]):[2,!1]}})})},e.prototype.isReady=function(){return this.state==s.AdState.LOAD_SUCCESS},e.prototype.getWandH=function(){var t=cc.view.getFrameSize().width/cc.winSize.width,e=cc.view.getFrameSize().height/cc.winSize.height;return{width:Math.floor(901*t),height:Math.floor(506*e)}},e}(function(){function t(){this.noSuitAdCount=0}return t.prototype.getFailTime=function(){return 10*this.noSuitAdCount*ut.Time.Second},t.prototype.toDB=function(){return{noSuitAdCount:this.noSuitAdCount}},t}());n.AppNaitveAd=u,cc._RF.pop()},{"../constant/Enums":"Enums","../event/JsbEvent":"JsbEvent","../helper/GameHelper":"GameHelper"}],NetConfig:[function(t,e,n){"use strict";cc._RF.push(e,"90c5bC1LShM94PAndbPvupF","NetConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.fastReqConfig=n.timeoutConfig=n.crpytoConifg=void 0,n.crpytoConifg={"/getNowTime":!1,"/ping":!1,"/version/check":!1,"/share/getStatus":!1,"/share/send":{res:!1},"/errorReport":!1,"/feedback/getMsgList":{res:!1},"/feedback/sendMsg":{res:!1},"/feedback/delMsgList":{res:!1},"/decryptWxData":!1,"/report/umeng":!1},n.timeoutConfig={"/record/upload":2e4,"/record/download":2e4,"/record/downloadByUid":2e4},n.fastReqConfig={"/login/web":!0,"/login/wx":!0,"/login/qq":!0,"/login/guest":!0,"/login/wxAppLogin":!0,"/login/applogin":!0,"/login/appleLogin":!0,"/login/facebookLogin":!0,"/login/twitterLogin":!0,"/login/googleLogin":!0},cc._RF.pop()},{}],NetEvent:[function(t,e,n){"use strict";cc._RF.push(e,"d95a30h+3FBnrv8G8rWkebx","NetEvent"),Object.defineProperty(n,"__esModule",{value:!0}),n.default={NET_DISCONNECT:"NET_DISCONNECT",NET_CONNECT_FAILED:"NET_CONNECT_FAILED",NET_REQ_BEGIN:"NET_REQ_BEGIN",NET_REQ_END:"NET_REQ_END"},cc._RF.pop()},{}],NetWaitNotCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"4642c1LIxRH25uITuOKBQa/","NetWaitNotCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator.ccclass,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maskNode_=null,e.rootNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("NetWaitNotCtrl onCreate"),[2]})})},i([c],e)}(mc.BaseNoticeCtrl);n.default=l,cc._RF.pop()},{}],NotEvent:[function(t,e,n){"use strict";cc._RF.push(e,"54616GPIEJITLdbMzANjO71","NotEvent"),Object.defineProperty(n,"__esModule",{value:!0}),n.default={OPEN_ALERT:"OPEN_ALERT",ALERT_HIDE:"ALERT_HIDE",OPEN_MESSAGE_BOX:"OPEN_MESSAGE_BOX",HIDE_MESSAGE_BOX:"HIDE_MESSAGE_BOX",STORAGE_SAVE_FAIL:"STORAGE_SAVE_FAIL",SHOW_LOADING:"SHOW_LOADING",HIDE_LOADING:"HIDE_LOADING",SHOW_ADD:"SHOW_ADD",HIDE_ADD:"HIDE_ADD"},cc._RF.pop()},{}],NoticeCtrlMgr:[function(t,e,n){"use strict";cc._RF.push(e,"14e5aJLEFFMyZGKk+zJGoFD","NoticeCtrlMgr");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../base/BaseNoticeCmpt"),s=t("../component/LocaleLabel"),c=t("../utils/ResLoader"),l=function(){function t(){this.node=null}return t.prototype.loadAll=function(t,e,n,i){return o(this,void 0,void 0,function(){var o,s=this;return r(this,function(r){switch(r.label){case 0:return c.loader.debug=!1,[4,c.loader.loadResDir(t,cc.Prefab,n,i)];case 1:return o=r.sent(),[4,Promise.all(o.map(function(t){var e=cc.instantiate2(t,s.node),n=e.name+"Ctrl";if(!cc.js.getClassByName(n))return lplog.error("loadNotice error! not found class "+n);var o=e.getComponent(n);return o||(o=e.addComponent(n)),o&&o instanceof a.default?(o.hide(),o.__create()):lplog.error("loadNotice error! not found class "+n)}))];case 2:return r.sent(),e&&e(),[2]}})})},t.prototype.showLoading=function(t){var e=this.node.Child("LoadingNot"),n=e.Child("root"),o=e.Child("mask");return t?(e.active=!0,n.stopAllActions(),new Promise(function(t){n.opacity=0,n.scale=.2,cc.tween(n).to(.2,{scale:1},{easing:cc.easing.backOut}).start(),o.stopAllActions(),o.opacity=0,cc.tween(o).to(.2,{opacity:255}).call(t).start()})):(o.stopAllActions(),o.opacity=255,new Promise(function(t){cc.tween(o).to(.2,{opacity:0}).call(function(){t(null),e.active=!1}).start()}))},t.prototype.hideLoading=function(){},t.prototype.showAlert=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r=this.node.Child("AlertNot");r.active=!0;var a=r.Child("root"),c=r.Child("close"),l=a.Child("alertText",cc.Label),u=null!==(e=l.Component(s.default))&&void 0!==e?e:l.addComponent(s.default);u.setLangKey.apply(u,i([t],n)),l._forceUpdateRenderData(),a.width=Math.max(600,l.node.width+200),a.stopAllActions(),a.opacity=255,a.scale=.2,cc.tween(a).to(.2,{scale:1},{easing:cc.easing.backOut}).delay(1).to(.18,{opacity:0}).call(function(){(null==r?void 0:r.isValid)&&(r.active=!1)}).start(),c.stopAllActions(),c.opacity=0},t.prototype.showAdd=function(){var t=this.node.Child("TopNot");t.active=!0,t.Component("TopNotCtrl").show()},t.prototype.hideAdd=function(){this.node.Child("TopNot").active=!1},t}();n.default=l,cc._RF.pop()},{"../base/BaseNoticeCmpt":"BaseNoticeCmpt","../component/LocaleLabel":"LocaleLabel","../utils/ResLoader":"ResLoader"}],Observer:[function(t,e,n){"use strict";cc._RF.push(e,"19d57fS9BNBKL9Wd9G219Sy","Observer"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../../script/common/LocalConfig"),r=["push","pop","shift","unshift","sort","reverse","splice"],i=function(){function t(t){this.debug=!1,this._callback=t}return t.prototype.observe=function(t,e){var n=this.debug&&[t.__proto__.constructor.name];e?this.observeByKeys(t,e,n):this.observeObj(t,n)},t.getObKeysByDB=function(t,e){if(!e)return Object.keys(t);var n={};for(var o in t||(t=e),t){var r=e[o];if(void 0!==r){if(null!==r)if("string"==typeof r)n[r]=!0;else if(Array.isArray(r))for(var i=0,a=r;i<a.length;i++)n[a[i]]=!0;else lplog.error("obMap value must be string or array",r)}else n[o]=!0}return Object.keys(n)},t.addKey=function(t,e,n){t[e]=n,t.__ob__&&(t.__ob__.observe(t,[e]),t.__ob__._callback())},t.delKeys=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var o=0,r=e;o<r.length;o++){var i=r[o];delete t[i]}t.__ob__&&t.__ob__._callback()},t.prototype.check=function(t,e,n){o.localConfig.release||t.hasOwnProperty(e)||console.error("ob undefined key!!!!",n,e)},t.prototype.observeByKeys=function(t,e,n){var o=this;Object.defineProperty(t,"__ob__",{value:this,enumerable:!1,writable:!0,configurable:!0});for(var r=function(e){var r=n&&n.concat([e]),a=t[e];i.check(t,e,n),Object.defineProperty(t,e,{get:function(){return a},set:function(t){if(t!==a){var e=a;a=t,o._callback&&o._callback(r,t,e),o.observeObj(a,r)}},enumerable:!0,configurable:!0}),i.observeObj(a,r)},i=this,a=0,s=e;a<s.length;a++)r(s[a])},t.prototype.isObj=function(t){return"object"==typeof t&&null!=t},t.prototype.observeObj=function(e,n){if(this.isObj(e)&&e.__ob__!==this){Array.isArray(e)&&this.overrideArrayProto(e,n);var o=[];if("function"==typeof e.toDB)o="function"==typeof e.getObMap?t.getObKeysByDB(e.toDB(!0),e.getObMap()):t.getObKeysByDB(e.toDB(!0));else for(var r in e)"function"!=typeof e[r]&&o.push(r);this.observeByKeys(e,o,n)}},t.prototype.overrideArrayProto=function(t,e){var n=Array.prototype,o=Object.create(n),i=this;r.forEach(function(t){var r=n[t];Object.defineProperty(o,t,{value:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a,s=i.debug&&this.slice(),c=r.apply(this,n);switch(t){case"push":case"unshift":a=n;break;case"splice":a=n.slice(2)}return a&&("push"==t||"unshift"==t?i.observeByKeys(this,[String(this.length-1)],e):"splice"==t&&i.observeByKeys(this,a.map(function(t,e){return String(e+n[0])}),e)),i._callback&&i._callback(e&&e.concat([t]),this,s),c},enumerable:!0,configurable:!0})}),t.__proto__=o},t}();n.default=i,cc._RF.pop()},{"../../script/common/LocalConfig":"LocalConfig"}],OpenInstallHelper:[function(t,e,n){"use strict";cc._RF.push(e,"fe65bLlNDlM1oHDd/edLUQl","OpenInstallHelper");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.openInstallHelper=void 0;var a=t("../../../core/utils/Utils"),s=t("../event/JsbEvent"),c=t("../helper/GameHelper"),l=function(){function t(){}return t.prototype.getAwakeParams=function(){if(!cc.sys.isNative||c.gameHelper.isGLobal())return null;if(ut.isAndroid()){var t=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/OpenInstallHelper","getAwakeParams","()Ljava/lang/String;"),e=JSON.parse(t);return e.error?null:e}if(ut.isIos()){if("error"==(t=jsb.reflection.callStaticMethod("OpenInstallHelper","getAwakeParams")))return null;try{return JSON.parse(t)}catch(n){}return null}return null},t.prototype.getInstallParams=function(){return r(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return cc.sys.isNative?[4,jsbHelper.call(s.default.GET_INSTALL_PARAMS)]:[2,null];case 1:return(t=e.sent()).error?[2,null]:[2,t]}})})},o([a.util.queueLast],t.prototype,"getInstallParams",null),t}();n.openInstallHelper=new l,cc._RF.pop()},{"../../../core/utils/Utils":"Utils","../event/JsbEvent":"JsbEvent","../helper/GameHelper":"GameHelper"}],PerformanceHelper:[function(t,e,n){"use strict";cc._RF.push(e,"77313g+XwdNZZ5xqsC/duas","PerformanceHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.performanceHelper=void 0;var o=function(){function t(){this.open=!1,this.profileMap={},this.lastTimeReportMap={}}return t.prototype.begin=function(t){if(this.open){this.profileMap[t]&&lplog.error("Performance repeat set key="+t);var e=Date.now();this.lastTimeReportMap[t]&&this.lastTimeReportMap[t]-e<5e3||(this.profileMap[t]=e)}},t.prototype.end=function(t,e){if(void 0===e&&(e=300),this.open){var n=this.profileMap[t];if(n){this.profileMap[t]=0;var o=Date.now(),r=o-n;r>=e&&(lplog.upLog.addFilterMsg("Performance"),lplog.upLog.warn("Performance",t,r,n),this.lastTimeReportMap[t]=o,r>=3*e&&(lplog.error("Performance ["+t+"] "+r+"ms"),lplog.upLog.addFilterMsg("Performance_big"),lplog.upLog.warn("Performance_big",t,r,n)))}}},t.prototype.checkDt=function(t){t>10&&(lplog.upLog.addFilterMsg("Performance_dt"),lplog.upLog.warn("Performance_dt",t))},t.prototype.clean=function(){this.profileMap.clear()},t}();n.performanceHelper=new o,cc._RF.pop()},{}],PnlBgCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"c17aa54gFtCgJIVqDvE0N+j","PnlBgCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./SceneMapBgCmpt"),s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tag="PnlBgCmpt",e}return r(e,t),i([c],e)}(a.default));n.default=l,cc._RF.pop()},{"./SceneMapBgCmpt":"SceneMapBgCmpt"}],PnlWaitNotCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"1db75Gi5YVH4aQGb3Mv24vU","PnlWaitNotCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator.ccclass,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maskNode_=null,e.rootNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("PnlWaitNotCtrl onCreate"),[2]})})},i([c],e)}(mc.BaseNoticeCtrl);n.default=l,cc._RF.pop()},{}],PropObj:[function(t,e,n){"use strict";cc._RF.push(e,"10611kymhlITZ8T95jaVA/6","PropObj"),Object.defineProperty(n,"__esModule",{value:!0});n.default=function(){},cc._RF.pop()},{}],RKNoticeRootCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"9cf59U3OrRMp7f5V19VEcUO","RKNoticeRootCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../script/common/constant/Enums"),l=t("../../script/common/event/NotEvent"),u=t("../base/BaseLayerCmpt"),p=t("../event/CoreEventType"),h=t("../utils/ResLoader"),d=cc._decorator,f=d.ccclass,y=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctrlMgr=null,e}return r(e,t),e.prototype.listenEventMaps=function(){var t,e,n,o,r,i;return[(t={},t[p.default.LOAD_ALL_NOTICE]=this.onLoadAllNotice,t),(e={},e[l.default.OPEN_ALERT]=this.showAlert,e),(n={},n[l.default.SHOW_LOADING]=this.showLoading,n),(o={},o[l.default.HIDE_LOADING]=this.hideLoading,o),(r={},r[l.default.SHOW_ADD]=this.showAdd,r),(i={},i[l.default.HIDE_ADD]=this.hideAdd,i)]},e.prototype.onCreate=function(){this.node.group="ui"},e.prototype.onClean=function(){},e.prototype.setControllers=function(t){this.ctrlMgr=t,this.ctrlMgr.node=this.node},e.prototype.onLoadAllNotice=function(t,e){this.ctrlMgr.loadAll("view/notice",t,e,h.loader.getBundle(c.Bundle.START))},e.prototype.showAlert=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.ctrlMgr.showAlert(t,e)},e.prototype.showLoading=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.ctrlMgr.showLoading(!0)];case 1:return t.sent(),[2]}})})},e.prototype.hideLoading=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.ctrlMgr.showLoading(!1)];case 1:return t.sent(),[2]}})})},e.prototype.showAdd=function(){this.ctrlMgr.showAdd()},e.prototype.hideAdd=function(){this.ctrlMgr.hideAdd()},i([f],e)}(u.default));n.default=y,cc._RF.pop()},{"../../script/common/constant/Enums":"Enums","../../script/common/event/NotEvent":"NotEvent","../base/BaseLayerCmpt":"BaseLayerCmpt","../event/CoreEventType":"CoreEventType","../utils/ResLoader":"ResLoader"}],RKViewRootCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"567b7K6qrJDhI44u1ZPp+G0","RKViewRootCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../base/BaseLayerCmpt"),c=t("../event/CoreEventType"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctrlMgr=null,e}return r(e,t),e.prototype.listenEventMaps=function(){var t,e,n,o,r,i,a,s,l,u;return[(t={},t[c.default.OPEN_PNL]=this.onOpenPnl,t),(e={},e[c.default.HIDE_PNL]=this.onHidePnl,e),(n={},n[c.default.HIDE_ALL_PNL]=this.onHideAllPnl,n),(o={},o[c.default.CLOSE_PNL]=this.onClosePnl,o),(r={},r[c.default.CLOSE_ALL_PNL]=this.onCloseAllPnl,r),(i={},i[c.default.CLOSE_MOD_PNL]=this.onCloseModPnl,i),(a={},a[c.default.PRELOAD_PNL]=this.onPreloadPnl,a),(s={},s[c.default.CLEAN_ALL_UNUSED]=this.onCleanAllUnused,s),(l={},l[c.default.GIVEUP_LOAD_PNL]=this.onGiveupLoadPnl,l),(u={},u[c.default.SET_PNL_OPTS]=this.onSetPnlOpts,u)]},e.prototype.onCreate=function(){this.node.group="ui"},e.prototype.onClean=function(){},e.prototype.setControllers=function(t){this.ctrlMgr=t,this.ctrlMgr.node=this.node},e.prototype.getOpenPnls=function(){return this.ctrlMgr.getOpened()},e.prototype.onOpenPnl=function(t,e){for(var n,o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];(n=this.ctrlMgr).show.apply(n,a([t],o)).then(function(t){return e&&e(t)})},e.prototype.onHidePnl=function(t){this.ctrlMgr.hide(t)},e.prototype.onHideAllPnl=function(t,e){this.ctrlMgr.hideAll(t,e)},e.prototype.onClosePnl=function(t){this.ctrlMgr.clean(t)},e.prototype.onCloseAllPnl=function(t){this.ctrlMgr.cleanAll(t)},e.prototype.onCloseModPnl=function(t){this.ctrlMgr.cleanByMod(t)},e.prototype.onPreloadPnl=function(t,e,n){this.ctrlMgr.preloadPnl(t).then(function(t){e&&e(t),n&&n(1,1)})},e.prototype.onCleanAllUnused=function(t){this.ctrlMgr.cleanAllUnused(t)},e.prototype.onGiveupLoadPnl=function(t){this.ctrlMgr.giveupLoadById(t)},e.prototype.onSetPnlOpts=function(t,e){this.ctrlMgr.setPnlOpts(t,e)},i([u],e)}(s.default));n.default=p,cc._RF.pop()},{"../base/BaseLayerCmpt":"BaseLayerCmpt","../event/CoreEventType":"CoreEventType"}],RKWindRootCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"1765bUAcqdA1aeHxkMMW+Yq","RKWindRootCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../base/BaseLayerCmpt"),c=t("../event/CoreEventType"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctrlMgr=null,e}return r(e,t),e.prototype.listenEventMaps=function(){var t,e,n;return[(t={},t[c.default.GOTO_WIND]=this.onGotoWind,t),(e={},e[c.default.PRELOAD_WIND]=this.onPreloadWind,e),(n={},n[c.default.CLEAN_CACHE_WIND]=this.onCleanCacheWind,n)]},e.prototype.onCreate=function(){},e.prototype.onClean=function(){},e.prototype.setControllers=function(t){this.ctrlMgr=t,this.ctrlMgr.node=this.node},e.prototype.getCurrWind=function(){return this.ctrlMgr.currWind},e.prototype.onGotoWind=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(e=this.ctrlMgr).goto.apply(e,a([t],n))},e.prototype.onPreloadWind=function(t,e,n){this.ctrlMgr.preLoad(t,n,e)},e.prototype.onCleanCacheWind=function(){this.ctrlMgr.cleanCacheWind()},i([u],e)}(s.default));n.default=p,cc._RF.pop()},{"../base/BaseLayerCmpt":"BaseLayerCmpt","../event/CoreEventType":"CoreEventType"}],RankWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"849fdZ8W8tLwZrk9CsBr35N","RankWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/GotoHelper"),l=t("../../common/wx/WxOpenData"),u=cc._decorator.ccclass,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleLbl_=null,e.subViewNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("RankWindCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return cc.log("RankWindCtrl onEnter"),ut.isWechatGame()?[4,l.wxOpenData.updateViewPort(this.subViewNode_)]:[3,2];case 1:t.sent(),l.wxOpenData.post("showFriendRank"),t.label=2;case 2:return[2]}})})},e.prototype.onClean=function(){cc.log("RankWindCtrl onClean"),ut.isWechatGame()&&l.wxOpenData.post("close")},e.prototype.onClickClose=function(){c.gotoHelper.gotoWind("main")},i([u],e)}(mc.BaseWindCtrl);n.default=p,cc._RF.pop()},{"../../common/helper/GotoHelper":"GotoHelper","../../common/wx/WxOpenData":"WxOpenData"}],ReddotCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"41adc1akAJPd6EHPeu8wQFb","ReddotCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../common/helper/ReddotHelper"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e.dot=null,e.data=null,e.interval=0,e.preVal=!1,e}return r(e,t),e.prototype.onLoad=function(){this.dot=this.FindChild("val"),this.setKey(this.key)},e.prototype.update=function(t){this.dot&&this.data&&this.key&&(this.interval-=t,this.interval>0||(this.interval=.2,this.preVal!==this.data.val&&(this.dot.active=this.preVal=this.data.val)))},e.prototype.setKey=function(t){this.key=t,this.data=t?a.reddotHelper.get(t):null,this.dot&&(this.dot.active=this.preVal=!1)},i([l()],e.prototype,"key",void 0),i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../common/helper/ReddotHelper":"ReddotHelper"}],ReddotHelper:[function(t,e,n){"use strict";cc._RF.push(e,"2e322fBHbFLhYqophPAV6iE","ReddotHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.reddotHelper=void 0;var o=t("../LocalConfig"),r=function(){function t(){this.dataMap={},this.checkDataMap=new Map}return t.prototype.register=function(t,e,n,o,r){var i={cb:e,target:n,interval:o=o||30,elapsed:r=void 0===r?o:r,pause:!1},a=this.checkDataMap.get(t);a?a.push(i):this.checkDataMap.set(t,[i])},t.prototype.unregister=function(t){this.checkDataMap.delete(t);var e=this.dataMap[t];e&&(e.val=!1,delete this.dataMap[t])},t.prototype.set=function(t,e,n){this.get(t).val=e,this.resetElapsedTime(t,n)},t.prototype.check=function(t){var e,n=this.get(t);n&&(null===(e=this.checkDataMap.get(t))||void 0===e||e.forEach(function(e){e.elapsed=0,n.val=!!e.cb.call(e.target,n.val,t)}))},t.prototype.resetElapsedTime=function(t,e){var n;null===(n=this.checkDataMap.get(t))||void 0===n||n.forEach(function(t){t.elapsed=0,t.pause=!!e})},t.prototype.get=function(t){var e=this.dataMap[t];return e||(e=this.dataMap[t]={key:t,val:!1}),e},t.prototype.pause=function(t,e){var n;null===(n=this.checkDataMap.get(t))||void 0===n||n.forEach(function(t){t.pause=e})},t.prototype.update=function(t){var e=this;this.checkDataMap.forEach(function(n,o){var r=e.get(o);n.forEach(function(e){e.pause||(e.elapsed+=t,e.elapsed>=e.interval&&(e.elapsed=0,r.val=!!e.cb.call(e.target,r.val,o)))})})},t}();n.reddotHelper=new r,(o.localConfig.isTestServer||o.localConfig.isGm)&&(window.reddotHelper=n.reddotHelper),cc._RF.pop()},{"../LocalConfig":"LocalConfig"}],ReddotMultiCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"411d1w9pzpM4aHLnxDkB7gy","ReddotMultiCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../common/helper/ReddotHelper"),s=cc._decorator,c=s.ccclass,l=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.keys=[],e.dot=null,e.datas=null,e.len=0,e.preVal=!1,e}return r(e,t),e.prototype.onLoad=function(){this.dot=this.FindChild("val"),this.init()},e.prototype.update=function(){if(this.dot&&0!==this.len&&this.datas){var t=this.datas.some(function(t){return t.val});this.preVal!==t&&(this.dot.active=this.preVal=t)}},e.prototype.init=function(){this.dot&&(this.dot.active=this.preVal=!1),this.datas=this.keys.map(function(t){return a.reddotHelper.get(t)}),this.len=this.datas.length},e.prototype.addKey=function(t){this.keys.has(t)||(this.keys.push(t),this.init())},e.prototype.removeKey=function(t){this.keys.remove(t)&&this.init()},e.prototype.setKeys=function(t){this.keys=t,this.init()},i([l([cc.String])],e.prototype,"keys",void 0),i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{"../../../common/helper/ReddotHelper":"ReddotHelper"}],RelevancyNodeCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"0f33adH3KhHtYsBKyEfZ4LA","RelevancyNodeCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.relevancyNode=null,e}return r(e,t),i([c(cc.Node)],e.prototype,"relevancyNode",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],ResConfig:[function(t,e,n){"use strict";cc._RF.push(e,"f1d5fzHrpNPwqzibh0mU9FV","ResConfig"),Object.defineProperty(n,"__esModule",{value:!0}),n.resConfig=void 0,n.resConfig={bootPack:["common/font/cn/f_600w_guide","common/font/en/f_600w_guide","common/font/jp/f_600w_guide","common/font/kr/f_600w_guide","common/font/tc/f_600w_guide","common/image/500w_ui_num","common/image/600w_ui_num","common/image/700w_out_ui_num","common/image/UI_ggtc_loading","common/image/common_loading_circle","common/image/common_tip_bg","common/image/f_number120","common/json/cnJson/toast","common/json/internalJson/Easter","common/json/internalJson/EndlessTreasure","common/json/internalJson/GuideConfig","common/json/internalJson/Language","common/json/internalJson/QuestConfig","common/json/internalJson/ShapeConfig","common/material/FlashLight","common/material/FrameLight","common/material/spineGray","common/material/spriteGray","common/prefab/CLICK_ANIM","common/prefab/PNL_MASK","common/sound/click","common/spine/ClickEffect/Click","common/spine/tangyuan/tangyuan","view/cmpt/AlertCmpt","view/cmpt/LoadingCmpt","view/cmpt/MessageBoxCmpt","view/guide/GuidePnl","view/guide/StoryPnl","view/notice/AlertNot","view/notice/EventNot","view/notice/LoadSpriteWaitNot","view/notice/LoadingNot","view/notice/NetWaitNot","view/notice/PnlWaitNot","view/notice/TopNot"]},cc._RF.pop()},{}],ResHelper:[function(t,e,n){"use strict";cc._RF.push(e,"a19724Y6I5IRa5AlxX2Mhvc","ResHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.resHelper=void 0;var i=t("../../view/cmpt/component/SceneMapBgCmpt"),a=t("./ViewHelper"),s=function(){function t(){this.rolePoolMap=new Map,this.prefabPoolMap=new Map,this.prefabUrlMap={},this.spineDefaultMaterial=null,this.spineGrayMaterial=null,this.spineNpcMaterial=null,this.spineWhiteMaterial=null,this.spineBlackMaterial=null,this.spineStaffMaterial=null,this.spineCoffeeMaterial=null,this.spriteDefaultMaterial=null,this.sprite2dGrayMaterial=null,this.spriteGrayMaterial=null,this.spriteWhiteMaterial=null,this.spriteWdSkinMaterial=null,this.spriteWdSkinMaterial2=null,this.spriteNpcMaterial=null,this.spriteBMMaterial=null,this.mapBgNode=null,this.firstGuest="BODY_2",this.RES_CACHE_LIST={}}return t.prototype.init=function(){this.rolePoolMap.clear(),this.prefabPoolMap.clear(),this.spineDefaultMaterial=cc.Material.getBuiltinMaterial("2d-spine"),this.spineGrayMaterial=assetsMgr.getMaterial("spineGray"),this.spineNpcMaterial=assetsMgr.getMaterial("spineNpc"),this.spineWhiteMaterial=assetsMgr.getMaterial("spineWhite"),this.spineBlackMaterial=assetsMgr.getMaterial("spineBlack"),this.spineStaffMaterial=assetsMgr.getMaterial("spineStaff"),this.spineCoffeeMaterial=assetsMgr.getMaterial("spineCoffee"),this.spriteDefaultMaterial=cc.Material.getBuiltinMaterial("2d-sprite"),this.sprite2dGrayMaterial=cc.Material.getBuiltinMaterial("2d-gray-sprite"),this.spriteGrayMaterial=assetsMgr.getMaterial("spriteGray"),this.spriteWhiteMaterial=assetsMgr.getMaterial("spriteWhite"),this.spriteWdSkinMaterial=assetsMgr.getMaterial("spriteWdSkin"),this.spriteWdSkinMaterial2=assetsMgr.getMaterial("spriteWdSkin2"),this.spriteNpcMaterial=assetsMgr.getMaterial("spriteNpc"),this.spriteBMMaterial=assetsMgr.getMaterial("spriteBM")},t.prototype.getNode=function(t,e){return o(this,void 0,void 0,function(){var n,o,i,a,s;return r(this,function(r){switch(r.label){case 0:return e=e||"",n=t,(o=this.prefabPoolMap.get(n))&&o.prefab&&o.prefab.isValid?[3,9]:[4,assetsMgr.loadTempRes(t,cc.Prefab,e)];case 1:return i=r.sent(),a=this.prefabPoolMap.get(n),o={prefab:i,items:[],itemUuidMap:{},key:e,refCount:0},a?[3,2]:(o.refCount++,this.prefabPoolMap.set(n,o),[3,8]);case 2:return a.prefab&&a.prefab.isValid?[3,7]:(a.items.forEach(function(t){t.destroy()}),a.items.length=0,i.isValid&&i.refCount>0?(o.refCount=1,this.prefabPoolMap.set(n,o),[3,6]):[3,3]);case 3:return this.prefabPoolMap.delete(n),[4,ut.waitNextFrame()];case 4:return r.sent(),[4,this.getNode(t,e)];case 5:return[2,r.sent()];case 6:return[3,8];case 7:(o=a).refCount++,o.refCount>1&&assetsMgr.releaseTempRes(t,e),r.label=8;case 8:return[3,10];case 9:o.refCount++,r.label=10;case 10:return s=o.items.pop(),delete o.itemUuidMap[null==s?void 0:s.uuid],s&&s.isValid||(s=cc.instantiate(o.prefab)),s&&(s.__node_pool_url=n,this.prefabUrlMap[s.uuid]=n),[2,s]}})})},t.prototype.putNode=function(t){if(t&&t.isValid){t.parent=null;var e=this.prefabUrlMap[t.uuid]||t.__node_pool_url;if(!e)return t.destroy(),lplog.error("putNode error url == null, node="+t.name);if(!this.RES_CACHE_LIST[e])return this.destoryNode(t);delete this.prefabUrlMap[t.uuid];var n=this.prefabPoolMap.get(e);n?n.itemUuidMap[t.uuid]?(t.destroy(),lplog.info("putNode, repeat push item! name="+t.name)):(t.stopAllActions(),t.Data=null,n.itemUuidMap[t.uuid]=!0,n.items.push(t),n.refCount--):t.destroy()}},t.prototype.destoryNode=function(t){if(t&&t.isValid){var e=this.prefabUrlMap[t.uuid]||t.__node_pool_url;if(!e)return t.destroy(),lplog.error("putNode error url == null, node="+t.name);delete this.prefabUrlMap[t.uuid];var n=this.prefabPoolMap.get(e);n?(t.destroy(),n.refCount--,n.refCount<=0&&(assetsMgr.releaseTempRes(e,n.key),this.prefabPoolMap.delete(e))):t.destroy()}},t.prototype.releasePrefabCache=function(t,e){e=e||"";var n=this.prefabPoolMap.get(t);n&&(n.items.forEach(function(t){t.destroy()}),assetsMgr.releaseTempRes(t,e),this.prefabPoolMap.delete(t))},t.prototype.cleanNodeByMod=function(t){var e=this,n=[];this.prefabPoolMap.forEach(function(e,o){e.key===t&&n.push(o)}),n.forEach(function(t){var n=e.prefabPoolMap.get(t);n.items.forEach(function(t){t.destroy()}),n.items.length=0,e.prefabPoolMap.delete(t),assetsMgr.releaseTempRes(t,n.key)})},t.prototype.getSpineMaterial=function(t){return t?this.spineDefaultMaterial:this.spineGrayMaterial},t.prototype.getSpineBlackMaterial=function(t){return t?this.spineDefaultMaterial:this.spineBlackMaterial},t.prototype.getSpineCoffeeMaterial=function(t){return t?this.spineDefaultMaterial:this.spineCoffeeMaterial},t.prototype.getSpriteMaterial=function(t){return t?this.spriteDefaultMaterial:this.spriteGrayMaterial},t.prototype.get2dSpriteMaterial=function(t){return t?this.spriteDefaultMaterial:this.sprite2dGrayMaterial},t.prototype.loadIcon=function(t,e,n,i,s,c){return void 0===c&&(c=1.3),o(this,void 0,void 0,function(){var o,l,u,p,h,d,f;return r(this,function(r){switch(r.label){case 0:return t&&e?(o=t.Child("val",cc.Sprite),l=t.Child("lock",cc.Sprite),u=e+"/"+n,o&&(h=o.__icon_url)===u&&o.spriteFrame?[2]:o?(n&&!s||(p=o.spriteFrame,o.spriteFrame=null,l&&(l.spriteFrame=null),p&&(h=o.__icon_url)&&h!==u&&(d=o.__icon_tag,assetsMgr.releaseTempRes(h,d),o.__icon_url=null,o.__icon_tag=null)),n?(o.spriteFrame&&(o.spriteFrame=null,l&&(l.spriteFrame=null),(h=o.__icon_url)&&h!==u&&(d=o.__icon_tag,assetsMgr.releaseTempRes(h,d),o.__icon_url=null,o.__icon_tag=null)),o.__icon_url=u,o.__icon_tag=i,[4,assetsMgr.loadTempRes(u,cc.SpriteFrame,i)]):[2]):[2]):[2];case 1:return(f=r.sent())&&o.isValid&&t.isValid&&o.__icon_url===u?(o.spriteFrame=f,c>=0&&a.viewHelper.adaptNodeSize(o.node,f.getRect(),t.getContentSize(),c),l&&l.isValid&&(l.spriteFrame=f,l.node.setContentSize(o.node.getContentSize())),[2,o]):f?(assetsMgr.releaseTempRes(u,i),[2]):[2]}})})},t.prototype.loadTempIcon=function(t,e,n,i){return o(this,void 0,void 0,function(){var o,a;return r(this,function(r){switch(r.label){case 0:return(o=t.Child("icon",cc.Sprite))&&e?(i&&(o.spriteFrame=null),[4,assetsMgr.loadTempRes("icon/"+e,cc.SpriteFrame,n)]):[2];case 1:return(a=r.sent())&&o.isValid&&(o.spriteFrame=a),[2]}})})},t.prototype.loadOrgIcon=function(t,e,n,i,a,s){return void 0===s&&(s=1),o(this,void 0,void 0,function(){var o,c,l,u,p;return r(this,function(r){switch(r.label){case 0:return t&&e&&n?(o=t.Child("val",cc.Sprite),c=t.Child("lock",cc.Sprite),o?(n&&!a||(o.spriteFrame=null,c&&(c.spriteFrame=null)),n?(l=e+"/"+n,o.__icon_url=l,[4,assetsMgr.loadTempRes(l,cc.SpriteFrame,i)]):[2]):[2]):[2];case 1:return(u=r.sent())&&o.isValid&&t.isValid&&o.__icon_url===l&&(o.spriteFrame=u,o.node.scale=s,c&&c.isValid&&(c.spriteFrame=u,p=o.node.getContentSize(),c.node.setContentSize(p.width*s,p.height*s))),[2]}})})},t.prototype.getSceneMapBg=function(t,e,n,a){var s;return o(this,void 0,Promise,function(){var o,c,l;return r(this,function(r){switch(r.label){case 0:return o=null,c=null,this.mapBgNode&&this.mapBgNode.isValid?(o=this.mapBgNode,(null===(s=o.parent)||void 0===s?void 0:s.uuid)!==t.uuid&&(o.parent=t),c=o.Component(i.default),[3,3]):[3,1];case 1:return[4,assetsMgr.loadTempRes("map/SceneMapBg",cc.Prefab,"__SceneMapBg__")];case 2:if(l=r.sent(),!t.isValid)return[2,null];o=this.mapBgNode=cc.instantiate2(l,t),(c=o.Component(i.default)).init(),r.label=3;case 3:return e&&o.SetColor(e),c.setItemOpacity(null!=n?n:255,null!=a?a:cc.Color.WHITE),o.zIndex=-1,[2,c]}})})},t.prototype.putSceneMapBg=function(){this.mapBgNode&&this.mapBgNode.isValid&&(this.mapBgNode.parent=null)},t.prototype.onMemoryWarning=function(){this.mapBgNode&&this.mapBgNode.isValid&&!this.mapBgNode.parent&&(this.mapBgNode.destroy(),this.mapBgNode=null,assetsMgr.releaseTempResByTag("__SceneMapBg__")),this.rolePoolMap.forEach(function(t){t.forEach(function(t){t.destroy()}),t.length=0}),this.rolePoolMap.clear(),this.prefabPoolMap.forEach(function(t,e){t.items.forEach(function(t){t.destroy()}),t.items.length=0,t.refCount<=0&&assetsMgr.releaseTempRes(e,t.key)}),this.prefabPoolMap.clear()},t.prototype.loadTaskIcon=function(t,e,n){return o(this,void 0,void 0,function(){var o,i;return r(this,function(r){switch(r.label){case 0:return(o=t.Child("val",cc.Sprite))?(o.spriteFrame=null,[4,assetsMgr.loadTempRes(e,cc.SpriteFrame,n)]):[2];case 1:return(i=r.sent())&&o.isValid&&(o.spriteFrame=i,a.viewHelper.adaptNodeSize13(o.node,i.getRect(),t.getContentSize())),[2]}})})},t.prototype.loadTargetIcon=function(t,e,n,i){return o(this,void 0,void 0,function(){var o,a;return r(this,function(r){switch(r.label){case 0:return(o=t.Child("icon",cc.Sprite))&&e?(i&&(o.spriteFrame=null),[4,assetsMgr.loadTempRes("target/"+e,cc.SpriteFrame,n)]):[2];case 1:return(a=r.sent())&&o.isValid&&(o.spriteFrame=a),[2]}})})},t}();n.resHelper=new s,cc.sys.isBrowser&&(window.resHelper=n.resHelper),cc._RF.pop()},{"../../view/cmpt/component/SceneMapBgCmpt":"SceneMapBgCmpt","./ViewHelper":"ViewHelper"}],ResLoader:[function(t,e,n){"use strict";cc._RF.push(e,"392e68aQY5AqK2/K8Ie7TET","ResLoader");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.loader=void 0;var a=t("../../script/common/constant/Enums"),s=t("../../script/common/helper/GameHelper"),c=t("../../script/common/LocalConfig"),l=t("../../script/common/ResConfig"),u=c.localConfig.openLog,p=function(){function e(){this._debug=0,this._error=0,this.remoteAssetMap=new Map,this.loadTimeMap=new Map,this.__load_id=0,this.__load_urls={},this.__temp_doesn_res={},this.waitTextureCallbackMap={},this.loadTextureMap={},this.spriteFrameRefMap={},this.textureUrlMap={},this.spriteInfoMap={},this.partSysInfoMap={},this.textureSpriteFrameMap={},this.markReloadSpriteFrameMap={},this.waitLoadSpriteFrameMap={},this.textrueMap={},this.ignoreSpriteFrameMap={},this.urlBundleMap=new Map,this.bundleMap={},this._isLoadResBundle=!1,this._bdLoadMap=new Map}return Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug>0},set:function(t){u&&(t?this._debug++:this._debug--)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error>0},set:function(t){u&&(t?this._error++:this._error--)},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this;for(var e in[].forEach(function(e){return t.ignoreSpriteFrameMap[e]=!0}),l.resConfig)for(var n=0,o=l.resConfig[e];n<o.length;n++){var r=o[n];this.urlBundleMap.set(r,e)}},e.prototype.clean=function(){this._debug=0,this._error=0,this.remoteAssetMap.clear(),this.loadTimeMap.clear(),this.__load_id=0,this.__load_urls={},this.__temp_doesn_res={},this.waitTextureCallbackMap={},this.loadTextureMap={},this.spriteFrameRefMap={},this.textureUrlMap={},this.spriteInfoMap={},this.partSysInfoMap={},this.textureSpriteFrameMap={},this.markReloadSpriteFrameMap={},this.waitLoadSpriteFrameMap={},this.textrueMap={},this.ignoreSpriteFrameMap={},this.init()},e.prototype.getLoadId=function(){return++this.__load_id},e.prototype.printError=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];u&&this.debug&&this.error&&lplog.error.apply(lplog,i([t],e))},e.prototype.printInfo=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];u&&this.debug&&lplog.info.apply(lplog,i([t],e))},e.prototype.makeLoadResArgs=function(t){var e=t.length;if(e<1||"string"!=typeof t[0])return this.printError("makeLoadResArgs error",t),{url:""};for(var n={url:t[0]},o=1;o<e;o++){var r=t[o];1===o&&cc.js.isChildClassOf(r,cc.Asset)?n.type=r:"function"==typeof r?n.onProgess=r:r instanceof cc.AssetManager.Bundle&&(n.bundle=r)}return n},e.prototype.loadRes=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,Promise,function(){var e,n;return r(this,function(o){switch(o.label){case 0:return e=this.getLoadId(),u&&this.debug&&this.loadTimeMap.set(e,Date.now()),[4,this.load.apply(this,t)];case 1:return n=o.sent(),[4,this.loadResComplete(e,t[0],n)];case 2:return[2,o.sent()]}})})},e.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,void 0,function(){var e,n,o,i,a=this;return r(this,function(){return e=this.makeLoadResArgs(t),n=e.url,o=e.type,i=e.onProgess,[2,new Promise(function(t){var e=a.getBundleByUrl(n),r=null;if(e&&(r=e.get(n,o))&&r.refCount>0)return t(r);r&&r.refCount<=0?s.gameHelper.setTimeout(function(){a.__load(n,o,i,t)},0):a.__load(n,o,i,t)})]})})},e.prototype.__load=function(t,e,n,o){var r=this;if(this.__temp_doesn_res[t])return o(null);var i=this.getBundleByUrl(t);if(!i)return this.startLoadBundle(this.getBundleNameByUrl(t),!1),void s.gameHelper.setTimeout(function(){r.__load(t,e,n,o)},200);this.__load_urls[t]?this.__load_urls[t]++:this.__load_urls[t]=1,i.load(t,e,n,function(i,a){i?i.message.includes("doesn't contain")?(r.printError("loadRes error -> "+t,i.message),r.__load_urls[t]--,r.__temp_doesn_res[t]=!0,o(null)):r.__load_urls[t]>0?(r.printInfo("loadRes error! try reload. "+t,i.message),s.gameHelper.setTimeout(function(){r.__load_urls[t]>0?r.__load(t,e,n,o):o(null)},100)):o(null):(r.__load_urls[t]--,o(a))})},e.prototype.giveupLoad=function(t){this.__load_urls[t]=0},e.prototype.loadResDir=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,Promise,function(){var e,n,o=this;return r(this,function(r){switch(r.label){case 0:return e=this.getLoadId(),this.debug&&this.loadTimeMap.set(e,Date.now()),[4,this.loadDir.apply(this,t)];case 1:return n=r.sent(),[4,Promise.all(n.map(function(n){return o.loadResComplete(e,t[0]+"/"+n.name,n)}))];case 2:return[2,r.sent()]}})})},e.prototype.loadDir=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=this.makeLoadResArgs(e),r=o.url,i=o.type,a=o.onProgess,s=o.bundle;return new Promise(function(e){return t.__loadDir(r,i,a,e,s)})},e.prototype.__loadDir=function(t,e,n,o,r){var i=this;if(void 0===r&&(r=null),r||(r=cc.resources),!r||!r.loadDir)return o([]);r.loadDir(t,e,n,function(r,a){r?r.message.includes("doesn't contain")?(i.printError("loadRes error -> "+t,r.message),o([])):(i.printInfo("loadRes error! try reload. "+t,r.message),s.gameHelper.setTimeout(function(){i.__loadDir(t,e,n,o)},100)):o(a)})},e.prototype.loadRemote=function(t,e){return o(this,void 0,void 0,function(){var n=this;return r(this,function(){return[2,new Promise(function(o){var r=n.remoteAssetMap.get(t);if(r)return o(r);n.__loadRemote(t,e,o)})]})})},e.prototype.__loadRemote=function(t,e,n){var o=this;cc.assetManager.loadRemote(t,{ext:e},function(r,i){r?r.message.includes("download failed")?(o.printInfo("loadRes error! try reload. "+t,r.message),s.gameHelper.setTimeout(function(){o.__loadRemote(t,e,n)},100)):(o.printError("loadRes error -> "+t,r.message),n(null)):(o.remoteAssetMap.set(t,i),n(i))})},e.prototype.__get_sprites=function(t){if(t){var e=t.getComponent(cc.Sprite);if(e&&(r=e.spriteFrame)){var n=r._uuid;if(i=this.textureUrlMap[n]){var o=e.uuid;this.spriteInfoMap[n]||(this.spriteInfoMap[n]={}),this.spriteInfoMap[n][o]=e,this.textureSpriteFrameMap[i]||(this.textureSpriteFrameMap[i]={}),this.textureSpriteFrameMap[i][n]=r}}var r,i,a=t.getComponent(cc.ParticleSystem);if(a&&(r=a.spriteFrame))n=r._uuid,(i=this.textureUrlMap[n])&&(o=a.uuid,this.partSysInfoMap[n]||(this.partSysInfoMap[n]={}),this.partSysInfoMap[n][o]=a,this.textureSpriteFrameMap[i]||(this.textureSpriteFrameMap[i]={}),this.textureSpriteFrameMap[i][n]=r),this.ignoreSpriteFrameMap[n]=!0;for(var s=t.children,c=0,l=s.length;c<l;c++)this.__get_sprites(s[c])}},e.prototype._addSpriteFrameRefDep=function(t,e,n){return o(this,void 0,void 0,function(){var o,i,a,c,l,u,p,h=this;return r(this,function(r){switch(r.label){case 0:return n[t]=!0,(o=cc.assetManager.assets.get(t))instanceof cc.SpriteFrame?this.spriteFrameRefMap[t]?(this.spriteFrameRefMap[t]++,[3,3]):[3,1]:[3,4];case 1:return this.spriteFrameRefMap[t]=1,i=this.textureUrlMap[t],a=o,c=!1,i||(u=a.getTexture())&&u.isValid&&(i=this.textureUrlMap[t]=u.nativeUrl),l=function(e){if(e.addRef(),a.setTexture(e,a.getRect(),a.isRotated(),a.getOffset(),a.getOriginalSize()),h.spriteInfoMap[t])for(var n in h.spriteInfoMap[t]){var o=h.spriteInfoMap[t][n];o.spriteFrame=null,o.spriteFrame=a}if(h.partSysInfoMap[t])for(var n in h.partSysInfoMap[t]){var r=h.partSysInfoMap[t][n];r.spriteFrame=null,r.spriteFrame=a}},this.textrueMap[i]?(u=a.getTexture())&&u.isValid||(this.textrueMap[i].isValid?(this.markReloadSpriteFrameMap[t]=!0,l(this.textrueMap[i])):c=!0):(u=a.getTexture())&&u.isValid&&(this.textrueMap[i]=u),!c||this.waitLoadSpriteFrameMap[t]?[3,3]:(this.markReloadSpriteFrameMap[t]=!0,this.waitLoadSpriteFrameMap[t]=!0,[4,new Promise(function(e){var n=function(){h.loadTexture2D(i,function(o){o?(h.textrueMap[i]=o,delete h.waitLoadSpriteFrameMap[t],l(o),e()):s.gameHelper.setTimeout(function(){n()},100)})};n()})]);case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:o instanceof cc.Prefab&&e.push(o),r.label=5;case 5:return p=cc.assetManager.dependUtil.getDeps(t),[4,Promise.all(p.map(function(t){if(!n[t])return h._addSpriteFrameRefDep(t,e,n)}))];case 6:return r.sent(),[2]}})})},e.prototype.addSpriteFrameRefDep=function(t){return o(this,void 0,void 0,function(){var e,n,o=this;return r(this,function(r){switch(r.label){case 0:return e=t._uuid,n=[],[4,this._addSpriteFrameRefDep(e,n,{})];case 1:return r.sent(),n.forEach(function(t){o.__get_sprites(t.data)}),n=null,[2]}})})},e.prototype.__del_sprites=function(t){var e=t.getComponent(cc.Sprite);if(e&&(r=e.spriteFrame)){var n=r._uuid;if(this.textureUrlMap[n]){var o=e.uuid;this.spriteInfoMap[n]?delete this.spriteInfoMap[n][o]:(lplog.upLog.setFilterMsg("resLoader"),lplog.error("missing uid",n,o))}}var r,i=t.getComponent(cc.ParticleSystem);i&&(r=i.spriteFrame)&&(n=r._uuid,this.textureUrlMap[n]&&(o=i.uuid,this.partSysInfoMap[n]?delete this.partSysInfoMap[n][o]:(lplog.upLog.setFilterMsg("resLoader"),lplog.error("missing uid",n,o))));for(var a=t.children,s=0,c=a.length;s<c;s++)this.__del_sprites(a[s])},e.prototype._decSpriteFrameRefDep=function(t,e,n){var o=this;n[t]=!0;var r=cc.assetManager.assets.get(t);if(r instanceof cc.SpriteFrame){if(!this.ignoreSpriteFrameMap[t])if(this.spriteFrameRefMap[t]>0){if(this.spriteFrameRefMap[t]--,0==this.spriteFrameRefMap[t])if(this.markReloadSpriteFrameMap[t])this.spriteFrameRefMap[t]++,this.onReleaseCacheSpriteFrame(t);else{var i=this.textureUrlMap[t];this.textureSpriteFrameMap[i]&&delete this.textureSpriteFrameMap[i][t]}}else console.error("ref error",t,r)}else r instanceof cc.Prefab&&e.push(r);cc.assetManager.dependUtil.getDeps(t).forEach(function(t){n[t]||o._decSpriteFrameRefDep(t,e,n)})},e.prototype.decSpriteFrameRefDep=function(t){var e=this,n=t._uuid,o=[];this._decSpriteFrameRefDep(n,o,{}),o.forEach(function(t){e.__del_sprites(t.data)}),o=null},e.prototype.loadResComplete=function(t,e,n){return o(this,void 0,void 0,function(){var o,i;return r(this,function(r){switch(r.label){case 0:return n?(n.addRef(),[4,this.addSpriteFrameRefDep(n)]):[3,2];case 1:r.sent(),u&&this.debug&&t&&(o=Date.now(),i=o-(this.loadTimeMap.get(t)||o),this.loadTimeMap.delete(t),this.printInfo("loadRes -> "+e+" ["+n.refCount+"] "+i+"ms")),r.label=2;case 2:return[2,n]}})})},e.prototype.decRefAsset=function(t){t.decRef(!1),t.refCount<=0&&cc.assetManager.releaseAsset(t)},e.prototype.releaseRes=function(t,e){var n=this.getBundleByUrl(t).get(t,e),o=!1;if(n||(n=this.remoteAssetMap.get(t),o=!0),!n)return this.printError("releaseRes asset is null "+t),0;this.decSpriteFrameRefDep(n),n.decRef();var r=n.refCount;return o&&r<=0&&this.remoteAssetMap.delete(t),r},e.prototype.releaseAsset=function(t,e){var n=this.getBundleByUrl(t).get(t,e),o=!1;n||(n=this.remoteAssetMap.get(t),o=!0),n?(cc.assetManager.releaseAsset(n),o&&this.remoteAssetMap.delete(t)):this.printError("releaseAsset asset is null "+t)},e.prototype.preload=function(t,e,n){return void 0===n&&(n=null),o(this,void 0,void 0,function(){var o,i=this;return r(this,function(){return o=function(r){i.getBundleByUrl(t).preload(t,e,function(t,e){n&&n(t,e)},function(e){e?(lplog.error(t,e),s.gameHelper.setTimeout(function(){o(r)},100)):r()})},[2,new Promise(function(t){o(t)})]})})},e.prototype.preloadDir=function(t,e){return void 0===e&&(e=null),o(this,void 0,void 0,function(){var n;return r(this,function(){return e||(e=cc.resources),n=function(o){e.preloadDir(t,function(t){t?(lplog.error(t),s.gameHelper.setTimeout(function(){n(o)},100)):o()})},[2,new Promise(function(t){n(t)})]})})},e.prototype.loadBundle=function(t){return o(this,void 0,Promise,function(){var e;return r(this,function(){return e=function(n){cc.assetManager.loadBundle(t,function(t,o){t?(lplog.error(t),s.gameHelper.setTimeout(function(){e(n)},100)):n(o)})},[2,new Promise(function(t){e(t)})]})})},e.prototype.__loadTexture2D=function(t){var e=this;cc.assetManager.loadRemote(t,{type:cc.Texture2D},function(n,o){var r;n?n.message.includes("doesn't contain")?e.printError("loadRes error -> "+t,n.message):(e.printInfo("loadRes error! try reload. "+t,n.message),s.gameHelper.setTimeout(function(){return e.__loadTexture2D(t)},100)):e.loadTextureMap[t]=o,null===(r=e.waitTextureCallbackMap[t])||void 0===r||r.forEach(function(t){return t(o)}),delete e.waitTextureCallbackMap[t]})},e.prototype.loadTexture2D=function(t,e){return this.loadTextureMap[t]?e(this.loadTextureMap[t]):this.waitTextureCallbackMap[t]?this.waitTextureCallbackMap[t].push(e):(this.waitTextureCallbackMap[t]=[e],void this.__loadTexture2D(t))},e.prototype.onReleaseCacheSpriteFrame=function(t){var e=cc.assetManager.assets.get(t);if(e instanceof cc.SpriteFrame&&!this.ignoreSpriteFrameMap[t])if(this.spriteFrameRefMap[t]>0){if(this.spriteFrameRefMap[t]--,0==this.spriteFrameRefMap[t]){var n=e.getTexture();if(n&&n.isValid){var o=n.nativeUrl;if(delete this.markReloadSpriteFrameMap[t],this.decRefAsset(n),n.refCount<=0&&(this.loadTextureMap[o]&&delete this.loadTextureMap[o],this.textureSpriteFrameMap[o]))for(var r in this.textureSpriteFrameMap[o]){var i=this.textureSpriteFrameMap[o][r];i.setTexture(null,i.getRect(),i.isRotated(),i.getOffset(),i.getOriginalSize())}}}}else console.error("ref error",t,e)},e.prototype._releaseCacheSpriteFrame=function(t,e){var n=this;e[t]=!0,this.onReleaseCacheSpriteFrame(t),cc.assetManager.dependUtil.getDeps(t).forEach(function(t){e[t]||n._releaseCacheSpriteFrame(t,e)})},e.prototype.releaseCacheSpriteFrame=function(t){if(t.isValid){var e=t._uuid;this._releaseCacheSpriteFrame(e,{})}},e.prototype.retainSpriteFrame=function(t){return o(this,void 0,void 0,function(){var e;return r(this,function(n){switch(n.label){case 0:return t.isValid?(e=t._uuid,[4,this._addSpriteFrameRefDep(e,[],{})]):[2];case 1:return n.sent(),[2]}})})},e.prototype._resotreSpriteFrame=function(t,e){var n=this;e[t]=!0;var o=cc.assetManager.assets.get(t);if(o instanceof cc.SpriteFrame)if(this.spriteFrameRefMap[t])this.spriteFrameRefMap[t]++;else if(this.spriteFrameRefMap[t]=1,this.textureUrlMap[t]){var r=o.getTexture();r&&r.isValid&&r.addRef()}cc.assetManager.dependUtil.getDeps(t).forEach(function(t){if(!e[t])return n._resotreSpriteFrame(t,e)})},e.prototype.resotreSpriteFrame=function(t){if(t.isValid){var e=t._uuid;this._resotreSpriteFrame(e,{})}},e.prototype.loadBundleByName=function(t){return o(this,void 0,Promise,function(){var e;return r(this,function(n){switch(n.label){case 0:return[4,new Promise(function(e){cc.assetManager.loadBundle(t,function(n,o){n?(console.error("loadBundleError: ",t,n),e(null)):e(o)})})];case 1:return(e=n.sent())?[2,e]:[4,new Promise(function(t){return setTimeout(t,100)})];case 2:return n.sent(),[3,0];case 3:return[2]}})})},e.prototype.loadSubpackage=function(e){return o(this,void 0,void 0,function(){var n,o;return r(this,function(){return ut.isWechatOrQQ()?wx.loadSubpackage?(n=this,o=function(t){wx.loadSubpackage({name:e,success:function(){t()},fail:function(){s.gameHelper.setTimeout(function(){o(t)},200)}}).onProgressUpdate(function(t){var o=n._bdLoadMap[e],r=Math.min(t.totalBytesWritten/t.totalBytesExpectedToWrite,.99);r>o&&(n._bdLoadMap[e]=r)})},[2,new Promise(function(t){o(t)})]):(t(e+"/game.js"),[2]):[2]})})},e.prototype.getBundleProgress=function(t){return this._bdLoadMap[t]||0},e.prototype.startLoadBundle=function(t,e){return void 0===e&&(e=!0),o(this,void 0,void 0,function(){var o;return r(this,function(r){switch(r.label){case 0:if(!this._bdLoadMap[t])return[3,4];if(!e)return[2];r.label=1;case 1:return this._bdLoadMap[t]<1?[4,ut.waitTimeout(200)]:[3,3];case 2:return r.sent(),[3,1];case 3:return[2];case 4:return this._bdLoadMap[t]=.01,t!==a.Bundle.RES?[3,6]:[4,this.startLoadResBundle()];case 5:return r.sent(),[3,9];case 6:return[4,this.loadSubpackage(t)];case 7:return r.sent(),[4,n.loader.loadBundleByName(t)];case 8:o=r.sent(),n.loader.addBundle(t,o),r.label=9;case 9:return this._bdLoadMap[t]=1,[2]}})})},e.prototype.isLoadResBundle=function(){return this._isLoadResBundle},e.prototype.startLoadResBundle=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:this._bdLoadMap[a.Bundle.START]||this.startLoadBundle(a.Bundle.START),t.label=1;case 1:return this._bdLoadMap[a.Bundle.START]<1?[4,ut.waitTimeout(200)]:[3,3];case 2:return t.sent(),[3,1];case 3:return[4,n.loader.loadBundleByName(cc.AssetManager.BuiltinBundleName.RESOURCES)];case 4:return t.sent(),this._isLoadResBundle=!0,[2]}})})},e.prototype.addBundle=function(t,e){this.bundleMap[t]=e},e.prototype.getBundle=function(t){return this.bundleMap[t]},e.prototype.getBundleByUrl=function(t){var e=this.urlBundleMap.get(t);return e?this.getBundle(e):cc.resources},e.prototype.getBundleNameByUrl=function(t){return this.urlBundleMap.get(t)||a.Bundle.RES},e.prototype.releaseBundle=function(t){var e=this.getBundle(t);e&&(e.releaseAll(),delete this.bundleMap[t])},e}();n.loader=new p,n.loader.init(),cc._RF.pop()},{"../../script/common/LocalConfig":"LocalConfig","../../script/common/ResConfig":"ResConfig","../../script/common/constant/Enums":"Enums","../../script/common/helper/GameHelper":"GameHelper"}],ResultWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"9cd927UG6pNxLa/JnCMrMbc","ResultWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../core/component/LabelRollNumber"),l=t("../../common/event/EventType"),u=t("../../common/event/NotEvent"),p=t("../../common/helper/GameHelper"),h=t("../../common/helper/GotoHelper"),d=t("../../common/helper/ViewHelper"),f=cc._decorator.ccclass,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.countLbl_=null,e.scoreValLbl_=null,e.bestValLbl_=null,e.drillNode_=null,e.animNode_=null,e.addLbl_=null,e}return r(e,t),e.prototype.eventMaps=function(){var t;return[(t={},t[l.default.UPDATE_COIN]=this.onUpdateCoin,t)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("ResultWindCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){cc.log("ResultWindCtrl onEnter"),this.initView(),p.gameHelper.ad.showInterstitialAd(),eventMgr.emit(u.default.SHOW_ADD)},e.prototype.onClean=function(){cc.log("ResultWindCtrl onClean"),eventMgr.emit(u.default.HIDE_ADD)},e.prototype.onClickBack=function(){h.gotoHelper.gotoWind("main")},e.prototype.onClickCoin=function(t,e){cc.log("onClickCoin",e),d.viewHelper.showPnl("common/Shop")},e.prototype.onClickPlay=function(){h.gotoHelper.gotoWind("game")},e.prototype.onClickDrill=function(){h.gotoHelper.gotoWind("dig")},e.prototype.initView=function(){var t=p.gameHelper.global.getScore(),e=p.gameHelper.global.getBestScore();this.scoreValLbl_.string="0",this.scoreValLbl_.addComponent(c.default).to(t,1),audioMgr.playSFX("increase_score"),this.bestValLbl_.string=""+e,this.onUpdateCoin(),this.playAnim()},e.prototype.onUpdateCoin=function(){this.countLbl_.string=p.gameHelper.global.getCoin()},e.prototype.playAnim=function(){p.gameHelper.dig.getMiles();var t=p.gameHelper.global.getScore();t<=0||(p.gameHelper.dig.addFlash(t),this.animNode_.active=!0,this.animNode_.setPosition(150,120),this.animNode_.opacity=255,this.addLbl_.string="+"+t,cc.tween(this.animNode_).bezierTo(1,cc.v2(150,140),cc.v2(130,150),cc.v2(-10,0)).call(function(){audioMgr.playSFX("common/collect_gem")}).delay(.5).to(.3,{opacity:0}).start())},i([f],e)}(mc.BaseWindCtrl);n.default=y,cc._RF.pop()},{"../../../core/component/LabelRollNumber":"LabelRollNumber","../../common/event/EventType":"EventType","../../common/event/NotEvent":"NotEvent","../../common/helper/GameHelper":"GameHelper","../../common/helper/GotoHelper":"GotoHelper","../../common/helper/ViewHelper":"ViewHelper"}],RevivePnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"b795fTBt3dM4bZwJ1+3fgTs","RevivePnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Enums"),l=t("../../common/helper/GameHelper"),u=t("../../common/helper/ViewHelper"),p=cc._decorator.ccclass,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coinSpr_=null,e.costLbl_=null,e.adStatusNode_=null,e.freeLbl_=null,e.descLbl_=null,e.titleLbl_=null,e.cost=200,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("RevivePnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){this.setParam({adIndex:1}),this.cb=null==t?void 0:t.cb,cc.log("RevivePnlCtrl onEnter"),this.costLbl_.string=""+this.cost,l.gameHelper.ad.initCurrentAd(c.AdType.REWARD);var e=l.gameHelper.ad.isAdReady();this.adStatusNode_.Component(cc.MultiFrame).setFrame(e?0:1)},e.prototype.onRemove=function(){cc.log("RevivePnlCtrl onRemove")},e.prototype.onDispose=function(){cc.log("RevivePnlCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.cb&&this.cb(!1),this.close()},e.prototype.onClickRevive=function(t,e){cc.log("onClickRevive",e);var n=l.gameHelper.global.getCoin();n<this.cost?u.viewHelper.showAlert("coin_not_enough"):(l.gameHelper.global.setCoin(n-this.cost),this.cb&&this.cb(!0),this.close())},e.prototype.onClickReviveAd=function(t,e){cc.log("onClickReviveAd",e),this.btnADHandler()},e.prototype.btnADHandler=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,l.gameHelper.ad.showAd(c.AdPropType.Revive)];case 1:return(t=e.sent())&&t.status==c.RewardAdStatus.SUCCESS&&(this.cb&&this.cb(!0),this.isValid&&this.close()),[2]}})})},i([p],e)}(mc.BasePnlCmpt);n.default=h,cc._RF.pop()},{"../../common/constant/Enums":"Enums","../../common/helper/GameHelper":"GameHelper","../../common/helper/ViewHelper":"ViewHelper"}],RewardAd:[function(t,e,n){"use strict";cc._RF.push(e,"0e5e4G4ms5AFbfK9nl3/ikA","RewardAd");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.TTRewardAd=n.GameRewardAd=n.FBInstantRewardAd=n.NativeRewardAd=n.WxRewardAd=void 0;var s=t("../constant/Enums"),c=t("../event/JsbEvent"),l=t("../helper/GameHelper"),u=function(){function t(t){this.noSuitAdCount=0,t=t||{},this.noSuitAdCount=t.noSuitAdCount||0}return t.prototype.getFailTime=function(){return 10*this.noSuitAdCount*ut.Time.Second},t.prototype.toDB=function(){return{noSuitAdCount:this.noSuitAdCount}},t.prototype.destroy=function(){},t.prototype.initiativeLoad=function(){},t.prototype.isCanShare=function(){return!1},t}(),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ad=null,e.inited=!1,e.cacheStartTime=0,e.adPlanB=null,e}return r(e,t),e.prototype.init=function(){this.ad=this.initAd("adunit-4e8562528dfb0d11")},e.prototype.destroy=function(){this.adPlanB&&(this.adPlanB.videoAd.destroy(),this.adPlanB=this.initAd("adunit-4e8562528dfb0d11",!0))},e.prototype.initAd=function(t,e){var n=this;void 0===e&&(e=!1);var o={adUnitId:t,state:s.AdState.LOADING,reloadTime:0,adOutOfUseTimeOut:0,videoAd:null,multiton:e,adClose:null,strategy:0,shareValue:0,rewardValue:0},r=wx.createRewardedVideoAd({adUnitId:t,multiton:e});console.log("@@video createRewardedVideoAd");var i=l.gameHelper.now();return e||(this.cacheStartTime=i),r.onLoad(function(t){console.log("@@video onLoad",t),n.cacheStartTime>0&&(l.gameHelper.now(),n.cacheStartTime,n.cacheStartTime=-1),o.state=s.AdState.LOAD_SUCCESS,o.adOutOfUseTimeOut=0,e||(n.noSuitAdCount=0)}),r.onError(function(t){lplog.error("@@loadError",t),o.state=s.AdState.WAIT,t&&("no advertisement"==t.errMsg||0==t.errCode||1004==t.errCode?(o.reloadTime-=10,e||(n.noSuitAdCount+=1)):(o.reloadTime-=20,e||(n.noSuitAdCount+=2)),t.errCode)}),r.onClose(function(t){o.adClose&&o.adClose(t)}),o.videoAd=r,o},e.prototype.isReady=function(t){return void 0===t&&(t=!1),t&&this.adPlanB?this.adPlanB.state==s.AdState.LOAD_SUCCESS:!!this.ad&&this.ad.state==s.AdState.LOAD_SUCCESS},e.prototype.initiativeLoad=function(){var t,e;console.log("@@video initiativeLoad"),null===(e=null===(t=this.adPlanB)||void 0===t?void 0:t.videoAd)||void 0===e||e.load()},e.prototype.isCanShare=function(){var t;return!!(null===(t=this.adPlanB)||void 0===t?void 0:t.shareValue)},e.prototype.reportShareBehavior=function(t,e){var n,o;void 0===e&&(e=!0);var r=null===(o=null===(n=this.adPlanB)||void 0===n?void 0:n.videoAd)||void 0===o?void 0:o.reportShareBehavior;if(r){e&&(this.adPlanB.shareValue||this.adPlanB.rewardValue?t.strategy=1:t.strategy=0),t.adunit=this.adPlanB.adUnitId||"adunit-4d1072f3f76d7da4";var i=r(t);(null==i?void 0:i.success)||console.error((null==i?void 0:i.message)||"reportShareBehavior error")}},e.prototype.getPlanBAD=function(){if(this.adPlanB)return{strategy:this.adPlanB.strategy,adunit:this.adPlanB.adUnitId,shareValue:this.adPlanB.shareValue,rewardValue:this.adPlanB.rewardValue}},e.prototype.load=function(t){var e;this.inited||(this.inited=!0,this.init()),(e=this.ad)&&(e.state==s.AdState.WAIT?(e.reloadTime+=t,e.reloadTime>=15&&(e.reloadTime=-2,e.state=s.AdState.LOADING,e.videoAd.load().catch(function(t){console.log("loadError",t)}))):e.state==s.AdState.LOADING&&(e.adOutOfUseTimeOut+=t,e.adOutOfUseTimeOut>=40&&(e.state=s.AdState.WAIT,e.adOutOfUseTimeOut=0,lplog.info("retry load22"),e.videoAd.load().catch(function(t){console.log("loadError",t)}))))},e.prototype.show=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),i(this,void 0,Promise,function(){function n(){i&&(i=null,cc.game.resume())}var o,r,i,c,u,p;return a(this,function(a){switch(a.label){case 0:o=this.ad,e&&this.adPlanB&&(o=this.adPlanB),r=o.videoAd,i=null,c=new Promise(function(t){o.adClose=t}),a.label=1;case 1:return a.trys.push([1,8,,9]),o.state=s.AdState.PLAYING,[4,r.load()];case 2:return a.sent(),i||(i=!0,cc.game.pause()),t?[4,r.show({branchId:t,branchDim:"branchDim"})]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,r.show()];case 5:a.sent(),a.label=6;case 6:return[4,c];case 7:return u=a.sent(),this.cacheStartTime=l.gameHelper.now(),o.adClose=null,o.state==s.AdState.PLAYING&&(o.state=s.AdState.WAIT,o.reloadTime=0),n(),u&&u.isEnded||void 0===u?[2,!0]:[2,!1];case 8:return p=a.sent(),o.state=s.AdState.WAIT,o.reloadTime=14,o.adClose=null,lplog.error(p),n(),[2,!1];case 9:return[2]}})})},e}(u);n.WxRewardAd=p;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ready=!1,e.waitTime=0,e.reloadTime=0,e.waitCache=!0,e.loadStartTime=0,e.loadCacheStartTime=0,e.loadReqId=0,e.inited=!1,e.expireCheckTime=0,e.ecpmLevel="",e.isEcpmHigh=!0,e.ecpmCount=0,e}return r(e,t),e.prototype.init=function(){var t=this;jsbHelper.on(c.default.REWARD_AD_ON_ERROR,function(e){var n=e.status;e.errcode,t.ready=!1,t.state=s.AdState.WAIT,t.reloadTime=1,t.noSuitAdCount+=.1,lplog.error("ad error",n)})},e.prototype.isReady=function(){return this.waitCache?this.ready:this.isCacheReady()&&this.ready},e.prototype.isCanShare=function(){return!1},e.prototype.initiativeLoad=function(){},e.prototype.destroy=function(){},e.prototype.reportShareBehavior=function(){},e.prototype.getPlanBAD=function(){},e.prototype.load=function(t){var e=this;if(this.inited||(this.init(),this.inited=!0),this.state!==s.AdState.LOADING&&this.state!==s.AdState.LOAD_SUCCESS&&this.state!==s.AdState.WAIT&&this.state!==s.AdState.PLAYING){this.state=s.AdState.LOADING,this.loadStartTime=l.gameHelper.now();var n=++this.loadReqId;jsbHelper.cast(c.default.LOAD_REWARD_VIDEO_AD,function(t){if(e.loadReqId==n){var o=t.status;if("0"===o){e.state=s.AdState.LOAD_SUCCESS,e.ready=!0,e.noSuitAdCount=0;var r=l.gameHelper.now();e.loadCacheStartTime=r;var i=t.ecpmLevel;e.ecpmLevel=i,e.getEcpmLevel()>6?e.isEcpmHigh=!1:e.isEcpmHigh=!0,e.ecpmCount=0}else"-1"===o?(e.reloadTime=1,e.noSuitAdCount+=.1):"-3"===o?e.reloadTime=4:"-4"===o?(e.reloadTime=20,e.noSuitAdCount+=2):"-5"===o?(e.reloadTime=120,"5005"==t.errcode?e.noSuitAdCount+=1200:e.noSuitAdCount+=12):"-6"===o?(e.reloadTime=6e3,e.noSuitAdCount+=60):"-7"===o?e.reloadTime=120+l.gameHelper.getFixTimeSurplyTime((new Date).getTime(),-8):(lplog.info("load ads unknow code is "+o+" "+typeof o),e.noSuitAdCount+=1,e.reloadTime=10);"0"!==o&&(e.state=s.AdState.WAIT,e.ready=!1)}})}else this.state===s.AdState.WAIT&&(this.waitTime+=t,this.waitTime>=this.reloadTime&&(this.waitTime=0,this.state=s.AdState.LOAD_FAIL));this.ready&&this.loadCacheStartTime>0&&this.isCacheReady()&&(this.state=s.AdState.LOAD_SUCCESS,this.loadCacheStartTime=-1),this.state==s.AdState.LOAD_SUCCESS&&(this.expireCheckTime+=t,this.expireCheckTime>10&&(this.expireCheckTime=0,this.isAdVaild()||(this.state=s.AdState.LOAD_FAIL)))},e.prototype.show=function(){return i(this,void 0,Promise,function(){var t,e,n,o,r;return a(this,function(i){switch(i.label){case 0:(t=null)||(t=!0,cc.game.pause()),e=l.gameHelper.now(),n=null,i.label=1;case 1:return i.trys.push([1,3,,4]),this.state=s.AdState.PLAYING,[4,jsbHelper.call(c.default.SHOW_REWARD_VIDEO_AD)];case 2:return n=i.sent(),[3,4];case 3:return o=i.sent(),lplog.error(o),[3,4];case 4:return t&&(t=null,cc.game.resume()),"0"===(r=n.status)?(n.duration&&"string"==typeof n.duration&&(n.duration=parseInt(n.duration)),n.duration&&!isNaN(n.duration)&&(n.duration=Math.min(n.duration,20),l.gameHelper.now()-e<.7*n.duration*ut.Time.Second)?(this.state=s.AdState.PLAY_FAIL,this.ready=!1,[2,!1]):(this.state=s.AdState.PLAY_SUCCESS,this.ready=!1,this.waitCache=!0,[2,!0])):"-1"===r||"-101"===r?(this.state=s.AdState.PLAY_FAIL,this.ready=!1,[2,!1]):(this.state=s.AdState.PLAY_FAIL,this.ready=!1,lplog.info("show rewardAD unknow code is "+r+" "+typeof r),[2,!1])}})})},e.prototype.waitCacheReady=function(){return i(this,void 0,void 0,function(){var t,e;return a(this,function(n){switch(n.label){case 0:if(!this.waitCache)return[2,!0];t=this.isCacheReady(),e=l.gameHelper.now(),n.label=1;case 1:return t?[3,3]:[4,ut.wait(.05)];case 2:return n.sent(),t=this.isCacheReady(),l.gameHelper.now()-e>=5*ut.Time.Second?[3,3]:[3,1];case 3:return 0==t&&(this.waitCache=!1,this.state=s.AdState.WAIT,this.reloadTime=30),[2,t]}})})},e.prototype.isCacheReady=function(){var t=!0;return cc.sys.os==cc.sys.OS_IOS?t=jsb.reflection.callStaticMethod("jsbHelp","isRewardVideoADReady"):ut.isAndroid()&&(t=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsbHelper","isRewardVideoADReady","()Z")),t},e.prototype.isAdVaild=function(){var t=!0;return cc.sys.os==cc.sys.OS_IOS?t=jsb.reflection.callStaticMethod("jsbHelp","isRewardVideoADVaild"):ut.isAndroid()&&(t=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsbHelper","isRewardVideoADVaild","()Z")),t},e.prototype.getEcpmLevel=function(){if(!this.ecpmLevel)return 100;var t=Number(this.ecpmLevel.substring(5));return isNaN(t)?100:t},e.prototype.reLoad=function(){this.state=s.AdState.WAIT,this.ready=!1,this.reloadTime=5,this.noSuitAdCount+=.5},e}(u);n.NativeRewardAd=h;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ad=null,e.inited=!1,e.reloadTime=0,e.state=null,e.placementId="186451227433565_216344434444244",e.ready=!1,e.waitTime=0,e}return r(e,t),e.prototype.init=function(){this.inited=!0},e.prototype.isReady=function(t){return void 0===t&&(t=!1),this.state==s.AdState.LOAD_SUCCESS},e.prototype.isCanShare=function(){return!1},e.prototype.initiativeLoad=function(){},e.prototype.destroy=function(){},e.prototype.reportShareBehavior=function(){},e.prototype.getPlanBAD=function(){},e.prototype.load=function(t){var e=this;this.state!==s.AdState.LOADING&&this.state!==s.AdState.LOAD_SUCCESS&&this.state!==s.AdState.WAIT&&this.state!==s.AdState.PLAYING?(this.state=s.AdState.LOADING,FBInstant.getRewardedVideoAsync(this.placementId).then(function(t){return e.ad=t,e.ad.loadAsync()}).then(function(){e.state=s.AdState.LOAD_SUCCESS,e.ready=!0,e.noSuitAdCount=0}).catch(function(t){e.reloadTime=20,e.noSuitAdCount+=2,e.state=s.AdState.WAIT,lplog.error("[load reward error:]",t)})):this.state===s.AdState.WAIT&&(this.waitTime+=t,this.waitTime>=this.reloadTime&&(this.waitTime=0,this.state=null))},e.prototype.show=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),i(this,void 0,Promise,function(){function t(){n&&(n=null,cc.game.resume())}var e,n,o,r;return a(this,function(i){switch(i.label){case 0:e=this.ad,n=null,i.label=1;case 1:return i.trys.push([1,3,,4]),this.state=s.AdState.PLAYING,n||(n=!0,cc.game.pause()),[4,new Promise(function(t){return e.showAsync().then(function(){return t(!0)}).catch(function(){return t(!1)})})];case 2:return o=i.sent(),this.state==s.AdState.PLAYING&&(this.state=s.AdState.WAIT,this.reloadTime=0),t(),this.ad=null,o?[2,!0]:[2,!1];case 3:return r=i.sent(),this.state=s.AdState.WAIT,this.reloadTime=14,lplog.error(r),t(),[2,!1];case 4:return[2]}})})},e}(u);n.FBInstantRewardAd=d;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ad=null,e.inited=!1,e.reloadTime=0,e.state=null,e}return r(e,t),e.prototype.init=function(){this.inited=!0},e.prototype.isReady=function(t){return void 0===t&&(t=!1),sdk&&sdk.showBanner},e.prototype.isCanShare=function(){return!1},e.prototype.initiativeLoad=function(){},e.prototype.destroy=function(){},e.prototype.reportShareBehavior=function(){},e.prototype.getPlanBAD=function(){},e.prototype.load=function(){},e.prototype.show=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),i(this,void 0,Promise,function(){var t;return a(this,function(e){switch(e.label){case 0:this.ad,e.label=1;case 1:return e.trys.push([1,3,,4]),this.state=s.AdState.PLAYING,sdk.showBanner(),[4,ut.wait(10)];case 2:return e.sent(),this.ad=null,[2,!0];case 3:return t=e.sent(),console.error("error",t),this.state=s.AdState.WAIT,this.reloadTime=14,lplog.error(t),[2,!1];case 4:return[2]}})})},e}(u);n.GameRewardAd=f;var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ad=null,e.inited=!1,e.cacheStartTime=0,e.adPlanB=null,e}return r(e,t),e.prototype.init=function(){this.ad=this.initAd("adunit-215c66b6811a46f7")},e.prototype.destroy=function(){this.adPlanB&&(this.adPlanB.videoAd.destroy(),this.adPlanB=this.initAd("adunit-4d1072f3f76d7da4",!0))},e.prototype.initAd=function(t,e){var n=this;void 0===e&&(e=!1);var o={adUnitId:t,state:s.AdState.LOADING,reloadTime:0,adOutOfUseTimeOut:0,videoAd:null,multiton:e,adClose:null,strategy:0,shareValue:0,rewardValue:0},r=tt.createRewardedVideoAd({adUnitId:t,multiton:e});console.log("@@video createRewardedVideoAd");var i=l.gameHelper.now();return e||(this.cacheStartTime=i),r.onLoad(function(t){console.log("@@video onLoad",t),n.cacheStartTime>0&&(l.gameHelper.now(),n.cacheStartTime,n.cacheStartTime=-1),o.state=s.AdState.LOAD_SUCCESS,o.adOutOfUseTimeOut=0,e||(n.noSuitAdCount=0)}),r.onError(function(t){lplog.error("@@loadError",t),o.state=s.AdState.WAIT,t&&("no advertisement"==t.errMsg||0==t.errCode||1004==t.errCode?(o.reloadTime-=10,e||(n.noSuitAdCount+=1)):(o.reloadTime-=20,e||(n.noSuitAdCount+=2)),t.errCode)}),r.onClose(function(t){o.adClose&&o.adClose(t)}),o.videoAd=r,o},e.prototype.isReady=function(t){return void 0===t&&(t=!1),t&&this.adPlanB?this.adPlanB.state==s.AdState.LOAD_SUCCESS:!!this.ad&&this.ad.state==s.AdState.LOAD_SUCCESS},e.prototype.initiativeLoad=function(){var t,e;console.log("@@video initiativeLoad"),null===(e=null===(t=this.adPlanB)||void 0===t?void 0:t.videoAd)||void 0===e||e.load()},e.prototype.isCanShare=function(){var t;return!!(null===(t=this.adPlanB)||void 0===t?void 0:t.shareValue)},e.prototype.reportShareBehavior=function(t,e){var n,o;void 0===e&&(e=!0);var r=null===(o=null===(n=this.adPlanB)||void 0===n?void 0:n.videoAd)||void 0===o?void 0:o.reportShareBehavior;if(r){e&&(this.adPlanB.shareValue||this.adPlanB.rewardValue?t.strategy=1:t.strategy=0),t.adunit=this.adPlanB.adUnitId||"adunit-4d1072f3f76d7da4";var i=r(t);(null==i?void 0:i.success)||console.error((null==i?void 0:i.message)||"reportShareBehavior error")}},e.prototype.getPlanBAD=function(){if(this.adPlanB)return{strategy:this.adPlanB.strategy,adunit:this.adPlanB.adUnitId,shareValue:this.adPlanB.shareValue,rewardValue:this.adPlanB.rewardValue}},e.prototype.load=function(t){var e;this.inited||(this.inited=!0,this.init()),(e=this.ad)&&(e.state==s.AdState.WAIT?(e.reloadTime+=t,e.reloadTime>=15&&(e.reloadTime=-2,e.state=s.AdState.LOADING,e.videoAd.load().catch(function(t){console.log("loadError",t)}))):e.state==s.AdState.LOADING&&(e.adOutOfUseTimeOut+=t,e.adOutOfUseTimeOut>=40&&(e.state=s.AdState.WAIT,e.adOutOfUseTimeOut=0,lplog.info("retry load22"),e.videoAd.load().catch(function(t){console.log("loadError",t)}))))},e.prototype.show=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),i(this,void 0,Promise,function(){function t(){r&&(r=null,cc.game.resume())}var n,o,r,i,c,u;return a(this,function(a){switch(a.label){case 0:n=this.ad,e&&this.adPlanB&&(n=this.adPlanB),o=n.videoAd,r=null,i=new Promise(function(t){n.adClose=t}),a.label=1;case 1:return a.trys.push([1,5,,6]),n.state=s.AdState.PLAYING,[4,o.load()];case 2:return a.sent(),r||(r=!0,cc.game.pause()),[4,o.show()];case 3:return a.sent(),[4,i];case 4:return c=a.sent(),this.cacheStartTime=l.gameHelper.now(),n.adClose=null,n.state==s.AdState.PLAYING&&(n.state=s.AdState.WAIT,n.reloadTime=0),t(),c&&c.isEnded||void 0===c?[2,!0]:[2,!1];case 5:return u=a.sent(),n.state=s.AdState.WAIT,n.reloadTime=14,n.adClose=null,lplog.error(u),t(),[2,!1];case 6:return[2]}})})},e}(u);n.TTRewardAd=y,cc._RF.pop()},{"../constant/Enums":"Enums","../event/JsbEvent":"JsbEvent","../helper/GameHelper":"GameHelper"}],RewardPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"6432fUKuLNJbpvSUoKdEdHD","RewardPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/ResHelper"),l=cc._decorator.ccclass,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tag="RewardPnlCtrl",e.rewardsNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("RewardPnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){var e=this;cc.log("RewardPnlCtrl onEnter"),audioMgr.playSFX("common/get_reward"),this.rewardsNode_.Items(t.rewards,function(t,n){return a(e,void 0,void 0,function(){return s(this,function(){return c.resHelper.loadTempIcon(t,""+n.id,this.tag),t.Child("val",cc.Label).string="x"+n.count,[2]})})}),this.scheduleOnce(function(){e.isValid&&e.close()},2)},e.prototype.onRemove=function(){cc.log("RewardPnlCtrl onRemove")},e.prototype.onDispose=function(){assetsMgr.releaseTempResByTag(this.tag),cc.log("RewardPnlCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close()},i([l],e)}(mc.BasePnlCmpt);n.default=u,cc._RF.pop()},{"../../common/helper/ResHelper":"ResHelper"}],RoleTouchCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"80ab6LUpbVAQLmKdwVeXpH2","RoleTouchCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../../scene/CameraCtrl"),s=t("../../../common/constant/Constant"),c=t("../../../common/helper/GameHelper"),l=t("../../../common/helper/TouchHelper"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isDown=!1,e._interactable=!0,e.clickCallback=null,e.clickTarget=null,e}return r(e,t),e.prototype.onDestroy=function(){this.clean()},e.prototype.on=function(t,e){return this.off(),this.clickCallback=t,this.clickTarget=e,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.node.SetSwallowTouches(!1),this},e.prototype.off=function(){this.clean(),this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.clean=function(){l.touchHelper.removeClickInfo(this.node),this.clickCallback=null,this.clickTarget=null,this.isDown&&(this.isDown=!1,c.gameHelper.roleTouchId=-1)},Object.defineProperty(e.prototype,"interactable",{get:function(){return this._interactable},set:function(t){this._interactable=t},enumerable:!1,configurable:!0}),e.prototype.onTouchStart=function(t){this.interactable&&-1===c.gameHelper.roleTouchId&&(c.gameHelper.roleTouchId=t.getID(),this.down())},e.prototype.onTouchMove=function(t){this.interactable&&c.gameHelper.roleTouchId===t.getID()&&(this.node._hitTest(t.getLocation())?this.isDown||this.down():this.isDown&&this.restore())},e.prototype.onTouchEnd=function(t){if(c.gameHelper.roleTouchId===t.getID()&&(c.gameHelper.roleTouchId=-1,this.restore(),this.interactable)){var e=t.getLocation();a.cameraCtrl.convertWorldSub(t.getStartLocation(),e).mag()<=s.CLICK_SPACE&&this.clickCallback.call(this.clickTarget,e)}},e.prototype.onTouchCancel=function(t){c.gameHelper.roleTouchId===t.getID()&&(c.gameHelper.roleTouchId=-1,this.restore())},e.prototype.down=function(){this.isDown=!0},e.prototype.restore=function(){this.isDown=!1},i([p],e)}(cc.Component));n.default=h,cc._RF.pop()},{"../../../../scene/CameraCtrl":"CameraCtrl","../../../common/constant/Constant":"Constant","../../../common/helper/GameHelper":"GameHelper","../../../common/helper/TouchHelper":"TouchHelper"}],ScalingAnimCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"9aa0caIQ2xDhayo+cUEpCEI","ScalingAnimCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.requireComponent,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delay=3,e.anim=null,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.anim=this.getComponent(cc.Animation),this.anim.playOnLoad=!1,this.delay>0?(this.anim.stop(),ut.wait(this.delay,this).then(function(){return t.isValid&&t.anim.play()})):this.anim.play()},i([c()],e.prototype,"delay",void 0),i([s,l(cc.Animation)],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],SceneMapBgCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"64a6akiztdEOoIZeDqtIJs+","SceneMapBgCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../common/helper/GameHelper"),l=cc._decorator,u=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSize=300,e.velocity=20,e.speed=cc.v2(),e.items=[],e.bgicons=[],e.bgiconsIndex=0,e.isInit=!1,e.isActive=!1,e.tag="SceneMapBgCmpt",e}return r(e,t),e.prototype.onLoad=function(){var t=this;if(!this.isInit){this.isInit=!0;var e=cc.winSize.width,n=cc.winSize.height,o=Math.ceil(e/this.iconSize)+1,r=Math.ceil(n/this.iconSize)+1,i=ut.getAngle(cc.v2(0,0),cc.v2(e,n))-90;this.node.Items(4,null,function(e){e.width=o*t.iconSize,e.height=r*t.iconSize;var n=e.children[0];n.width=t.iconSize,n.height=t.iconSize;var a=n.FindChild("val");a.scale=.5*t.iconSize/a.width*2.5,a.angle=i,e.Items(o*r),t.items.push(e)})}},e.prototype.onDestroy=function(){this.clean(),this.isInit=!1},e.prototype.setItemOpacity=function(t,e){this.items.forEach(function(n){return n.children.forEach(function(n){n.opacity=t,n.Child("val").SetColor(e)})})},e.prototype.init=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,c,l,u,p,h,d,f=this;return s(this,function(s){switch(s.label){case 0:return this.isInit||this.onLoad(),this.isActive=!0,t=cc.winSize.width,e=cc.winSize.height,n=this.items,o=n[0],r=n[1],i=n[2],a=n[3],o.x=0,o.y=0,r.x=o.width,r.y=0,i.x=0,i.y=i.height,a.x=a.width,a.y=a.height,this.speed.x=t/this.velocity,this.speed.y=e/this.velocity,assetsMgr.debug=!1,c=this.tag,l=null,assetsMgr.isLowMemory()?[4,assetsMgr.loadTempRseDir("bgLow",cc.SpriteFrame,c)]:[3,2];case 1:return l=s.sent(),[3,4];case 2:return[4,assetsMgr.loadTempRseDir("bg",cc.SpriteFrame,c)];case 3:l=s.sent(),s.label=4;case 4:if(assetsMgr.debug=!0,this.isValid&&this.isActive)this.bgicons=l,this.bgicons.sort(function(){return ut.chance(50)?-1:1}),this.bgiconsIndex=0,this.items.forEach(function(t){return t.children.forEach(function(t){return f.loadRandomIcon(t.Child("val",cc.Sprite))})});else if(!this.isValid)for(u=0,p=l.length;u<p;u++)h=l[u],d="bg/"+h.name,assetsMgr.releaseTempRes(d,c);return[2]}})})},e.prototype.clean=function(){this.isActive&&(this.isActive=!1,this.bgicons.length=0),assetsMgr.debug=!1,assetsMgr.releaseTempResByTag(this.tag),assetsMgr.debug=!0},e.prototype.loadRandomIcon=function(t){t.spriteFrame=this.bgicons[this.bgiconsIndex],this.bgiconsIndex=ut.loopValue(this.bgiconsIndex+1,this.bgicons.length)},e.prototype.startPartyBg=function(t){this.node.getComponent(cc.Animation).play("partyBg"+t)},e.prototype.endPartyBg=function(){this.node.getComponent(cc.Animation).stop(),this.node.SetColor(c.gameHelper.getSceneBgColor())},e.prototype.startGardenPartyBg=function(){this.node.getComponent(cc.Animation).play()},e.prototype.update=function(t){var e=t*this.speed.x,n=t*this.speed.y;this.items.forEach(function(t){t.x-=e,t.y-=n});var o=this.items,r=o[0],i=o[1],a=o[2],s=o[3];r.x<=-r.width?(r.x=i.x+i.width,a.x=i.x+i.width):i.x<=-i.width&&(i.x=r.x+r.width,s.x=r.x+r.width),r.y<=-r.height?(r.y=a.y+a.height,i.y=a.y+a.height):a.y<=-a.height&&(a.y=r.y+r.height,s.y=r.y+r.height)},i([u],e)}(cc.Component));n.default=p,cc._RF.pop()},{"../../../common/helper/GameHelper":"GameHelper"}],ScreenAdapterCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"c3406F3kBFNUIk0vl9lrD7k","ScreenAdapterCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a,s=cc._decorator,c=s.ccclass,l=s.property;s.menu,function(t){t[t.fullScreen=0]="fullScreen",t[t.minScale=1]="minScale",t[t.maxScale=2]="maxScale",t[t.fullScreenAndMinScale=3]="fullScreenAndMinScale"}(a||(a={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.adapterType=a.fullScreen,e.actionFlag=!1,e}return r(e,t),e.prototype.onEnable=function(){switch(this.adapterType){case a.fullScreen:this.fullScreen();break;case a.minScale:this.fixSize(!1),this.actionFlag&&this.playAction();break;case a.maxScale:this.fixSize(!0);break;case a.fullScreenAndMinScale:this.fixSize(!1),this.fullScreen()}},e.prototype.fixSize=function(t){var e=cc.view.getDesignResolutionSize(),n=e.width,o=e.height,r=cc.winSize.width/n,i=cc.winSize.height/o;this.node.scale=t?Math.max(r,i):Math.min(r,i)},e.prototype.fullScreen=function(){this.node.width=cc.winSize.width/this.node.scale,this.node.height=cc.winSize.height/this.node.scale},e.prototype.playAction=function(){var t=this.node.scale;this.node.scale=.2*t,cc.tween(this.node).to(.2,{scale:1.05*t}).delay(.05).to(.1,{scale:t}).start()},i([l({type:cc.Enum(a)})],e.prototype,"adapterType",void 0),i([l({visible:function(){return this.adapterType==a.minScale}})],e.prototype,"actionFlag",void 0),i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],ScrollViewEx:[function(t,e,n){"use strict";cc._RF.push(e,"0ccbdIWP69L7KfMFkdHwLyV","ScrollViewEx");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=a.menu,u=a.requireComponent,p=a.disallowMultiple,h=a.executionOrder,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.virtual=!0,e.childScrollViewName="",e.updateRate=1,e.updateRenderCount=1,e.scrollView=null,e.viewSize=null,e.content=null,e.layout=null,e.scrollType=0,e.rowCount=1,e.preContentPosition=cc.v2(),e.tempContentPosition=cc.v2(),e.frameCount=0,e.renderStartIndex=0,e.needRenderCount=0,e.currRenderCount=0,e.item=null,e.itemName="",e.itemSize=null,e.itemAnchor=null,e.childContentDefaultPosition=cc.v2(),e.itemDefaultPosition=cc.v2(),e.pool=[],e.datas=[],e.dataCount=0,e.setItemCallback=null,e.callbackTarget=null,e.tempVec=cc.v2(),e}return r(e,t),e.prototype.onLoad=function(){this.init()},e.prototype.init=function(){if(!this.scrollView){if(this.scrollView=this.getComponent(cc.ScrollView),this.content=this.scrollView.content,this.viewSize=this.content.parent.getContentSize(),this.layout=this.content.getComponent(cc.Layout),!this.layout)return lplog.error("\u9700\u8981Layout\u7ec4\u4ef6");if(this.layout.enabled=!1,this.item=this.content.children[0],!this.item)return lplog.error("\u5fc5\u987b\u6ee1\u8db3content\u4e2d\u6709\u4e00\u4e2a\u53ef\u62f7\u8d1d\u7684\u8282\u70b9");if(this.childScrollViewName){var t=this.item.Child(this.childScrollViewName,cc.ScrollView);t&&t.content.getPosition(this.childContentDefaultPosition)}this.item.getPosition(this.itemDefaultPosition),this.itemName=this.item.name,this.itemSize=this.item.getContentSize(),this.itemAnchor=cc.v2(this.item.anchorX,this.item.anchorY),this.item.name=this.itemName+"_clone",this.item.active=!1}},e.prototype.reset=function(){this.scrollView||this.init();var t=this.dataCount,e=this.layout,n=cc.Layout.Type,o=null,r=this.content.width,i=this.content.height;if(e.type===n.VERTICAL)i=t*this.itemSize.height+(t-1)*e.spacingY+e.paddingTop+e.paddingBottom,o=this.setItemPosByVertical,this.scrollType=0,this.rowCount=1;else if(e.type===n.HORIZONTAL)r=t*this.itemSize.width+(t-1)*e.spacingX+e.paddingLeft+e.paddingRight,o=this.setItemPosByHorizontal,this.scrollType=1,this.rowCount=1;else if(e.type===n.GRID)if(e.startAxis===cc.Layout.AxisDirection.HORIZONTAL){var a=r-e.paddingLeft-e.paddingRight+e.spacingX,s=this.rowCount=Math.floor(a/(this.itemSize.width+e.spacingX));i=(c=Math.ceil(t/s))*this.itemSize.height+(c-1)*e.spacingY+e.paddingTop+e.paddingBottom,o=this.setItemPosByGridHorizontal,this.scrollType=0}else{var c,l=i-e.paddingTop-e.paddingBottom+e.spacingY;s=this.rowCount=Math.floor(l/(this.itemSize.height+e.spacingY)),r=(c=Math.ceil(t/s))*this.itemSize.width+(c-1)*e.spacingX+e.paddingLeft+e.paddingRight,o=this.setItemPosByGridVertical,this.scrollType=1}this.preContentPosition.set(this.content.getPosition(this.tempContentPosition)),this.updateNeedRenderCount(),this.pool.length=0;for(var u=this.content.childrenCount-1;u>=0;u--){var p=this.content.children[u];p!==this.item&&(this.pool.length<this.needRenderCount&&cc.isValid(p)?this.putItem(p):p.destroy())}for(this.content.setContentSize(r,i),this.scrollView.horizontalScrollBar&&this.scrollView.horizontalScrollBar._onScroll(cc.Vec2.ZERO),this.scrollView.verticalScrollBar&&this.scrollView.verticalScrollBar._onScroll(cc.Vec2.ZERO),this.datas.length=0,u=0;u<t;u++)this.datas.push(o.call(this,u,{index:u,x:0,y:0}))},e.prototype.updateNeedRenderCount=function(){var t=this.dataCount,e=this.layout;if(this.virtual){if(0===this.scrollType){var n=this.viewSize.height-e.paddingTop-e.paddingBottom+e.spacingY;this.needRenderCount=(Math.ceil(n/(this.itemSize.height+e.spacingY))+1)*this.rowCount;var o=Math.abs(this.preContentPosition.y-e.paddingTop+e.spacingY);this.renderStartIndex=cc.misc.clampf(Math.floor(o/(this.itemSize.height+e.spacingY))*this.rowCount,0,this.dataCount-1)}else if(1===this.scrollType){var r=this.viewSize.width-e.paddingLeft-e.paddingRight+e.spacingX;this.needRenderCount=(Math.ceil(r/(this.itemSize.width+e.spacingX))+1)*this.rowCount;var i=Math.abs(this.preContentPosition.x+e.paddingLeft-e.spacingX);this.renderStartIndex=cc.misc.clampf(Math.floor(i/(this.itemSize.width+e.spacingX))*this.rowCount,0,this.dataCount-1)}}else this.renderStartIndex=0,this.needRenderCount=t},e.prototype.setItemPosByVertical=function(t,e){var n=this.layout;e.x=this.itemDefaultPosition.x;var o=1===this.content.anchorY?n.paddingTop:n.paddingBottom;return e.y=o+this.itemSize.height*(1-this.itemAnchor.y)+t*this.itemSize.height+t*n.spacingY,1===this.content.anchorY&&(e.y=-e.y),e},e.prototype.setItemPosByHorizontal=function(t,e){var n=this.layout,o=1===this.content.anchorX?n.paddingRight:n.paddingLeft;return e.x=o+this.itemSize.width*this.itemAnchor.x+t*this.itemSize.width+t*n.spacingX,1===this.content.anchorX&&(e.x=-e.x),e.y=this.itemDefaultPosition.y,e},e.prototype.setItemPosByGridHorizontal=function(t,e){var n=this.layout,o=-this.content.anchorX*this.content.width+n.paddingLeft,r=t%this.rowCount;e.x=o+this.itemSize.width*this.itemAnchor.x+r*this.itemSize.width+r*n.spacingX;var i=1===this.content.anchorY?n.paddingTop:n.paddingBottom;return r=Math.floor(t/this.rowCount),e.y=i+this.itemSize.height*this.itemAnchor.y+r*this.itemSize.height+r*n.spacingY,1===this.content.anchorY&&(e.y=-e.y),e},e.prototype.setItemPosByGridVertical=function(t,e){var n=this.layout,o=-this.content.anchorY*this.content.height+n.paddingBottom,r=t%this.rowCount;e.y=o+this.itemSize.height*this.itemAnchor.y+r*this.itemSize.height+r*n.spacingY;var i=1===this.content.anchorX?n.paddingRight:n.paddingLeft;return r=Math.floor(t/this.rowCount),e.x=i+this.itemSize.width*this.itemAnchor.x+r*this.itemSize.width+r*n.spacingX,1===this.content.anchorX&&(e.x=-e.x),e},e.prototype.getItem=function(){var t=this.pool.pop();return t||((t=cc.instantiate2(this.item,this.content)).name=this.itemName),t.active=!0,t},e.prototype.putItem=function(t){t.active=!1,t.Data=null,this.pool.has("uuid",t.uuid)?lplog.error("ScrollViewEx.putItem has uuid?"):this.pool.push(t)},e.prototype.delItems=function(t,e){e=t+e;for(var n=t;n<e&&n<this.dataCount;n++)this.delItem(this.datas[n])},e.prototype.delItem=function(t){if(t.node){if(this.childScrollViewName){var e=t.node.Child(this.childScrollViewName,cc.ScrollView);e&&(t.childContentPosition?t.childContentPosition.set(e.content.getPosition(this.tempVec)):t.childContentPosition=e.content.getPosition())}this.putItem(t.node),t.node=null}},e.prototype.updateItems=function(){var t=this.updateRenderCount>0?this.updateRenderCount:this.needRenderCount,e=0;this.currRenderCount+t>this.needRenderCount&&(t=this.needRenderCount-this.currRenderCount);for(var n=this.renderStartIndex,o=Math.min(this.renderStartIndex+this.needRenderCount,this.dataCount);n<o&&e<t;){var r=this.datas[n++];if(!r.node){var i=r.node=this.getItem();if(i.setPosition(r.x,r.y),this.childScrollViewName){var a=r.node.Child(this.childScrollViewName,cc.ScrollView);a&&(r.childContentPosition?a.content.setPosition(r.childContentPosition):a.content.setPosition(this.childContentDefaultPosition))}this.setItemCallback&&(this.callbackTarget?this.setItemCallback.call(this.callbackTarget,i,r.index):this.setItemCallback(i,r.index)),e+=1}}this.currRenderCount+=t},e.prototype.checkScroll=function(){if(0!==this.datas.length){var t=this.datas[this.renderStartIndex];if(t.node){var e=this.renderStartIndex,n=0;if(0===this.scrollType){var o=this.preContentPosition.y+(t.y-t.node.height*t.node.anchorY);o>0?n=1:o<-(t.node.height+this.layout.spacingY)&&(n=-1)}else if(1===this.scrollType){var r=this.preContentPosition.x+(t.x+t.node.width*t.node.anchorX);r<0?n=1:r>t.node.width+this.layout.spacingX&&(n=-1)}if(0!==n){if(1===n)this.delItems(e,this.rowCount),e=Math.min(e+this.rowCount,this.dataCount-1);else if(-1===n){var i=Math.max(e-this.rowCount,0);e!==i&&(this.delItems(e+this.needRenderCount-this.rowCount,this.rowCount),e=i)}this.renderStartIndex!==e&&(this.renderStartIndex=e,this.currRenderCount=0)}}else this.currRenderCount=0}},e.prototype.update=function(){var t=this.content.parent.getContentSize();t.equals(this.viewSize)||(this.viewSize=t,this.updateNeedRenderCount()),this.virtual&&!this.preContentPosition.equals(this.content.getPosition(this.tempContentPosition))&&(this.preContentPosition.set(this.tempContentPosition),this.checkScroll()),this.currRenderCount<this.needRenderCount&&(this.frameCount+=1,this.frameCount>=this.updateRate&&(this.frameCount=0,this.updateItems()))},e.prototype.list=function(t,e,n){this.dataCount=t,this.setItemCallback=e,this.callbackTarget=n,this.reset(),this.currRenderCount=0},e.prototype.redraw=function(){this.reset(),this.currRenderCount=0},e.prototype.addByList=function(){},e.prototype.getItemNode=function(){return this.item},i([c()],e.prototype,"virtual",void 0),i([c({tooltip:!1})],e.prototype,"childScrollViewName",void 0),i([c({type:cc.Integer,range:[1,10,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",void 0),i([c({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"updateRenderCount",void 0),i([s,p(),u(cc.ScrollView),l("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/ScrollViewEx"),h(-100)],e)}(cc.Component);n.default=d,cc.ScrollViewEx=d,cc._RF.pop()},{}],ScrollViewInnerCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"d844dfOgHZFYrCbwo6qm9+i","ScrollViewInnerCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../common/constant/Constant"),s=t("./ScrollViewOuterCmpt"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.outer=null,e.tempVec=cc.v2(),e}return r(e,t),e.prototype._onTouchMoved=function(t,e){if(this.enabledInHierarchy&&!this.hasNestedViewGroup(t,e)&&(this.content&&!this.outer.isDifferentBetweenSettingAndPlan(this)&&this._handleMoveLogic(t.touch),this.cancelInnerEvents)){if(t.getLocation().sub(t.getStartLocation(),this.tempVec).mag()>a.CLICK_SPACE&&!this._touchMoved&&t.target!==this.node){var n=new cc.Event.EventTouch(t.getTouches(),t.bubbles);n.type=cc.Node.EventType.TOUCH_CANCEL,n.touch=t.touch,n.simulate=!0,t.target.dispatchEvent(n),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(t)}},i([u(s.default)],e.prototype,"outer",void 0),i([l],e)}(cc.ScrollView);n.default=p,cc._RF.pop()},{"../../../common/constant/Constant":"Constant","./ScrollViewOuterCmpt":"ScrollViewOuterCmpt"}],ScrollViewOuterCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"4818faHMYtGWI3wrrSvaXY8","ScrollViewOuterCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../common/constant/Constant"),s=t("./ScrollViewInnerCmpt"),c=cc._decorator,l=c.ccclass,u=c.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.innerPath="list",e.planDir=-2,e.scrollingInnerSv=null,e.tempVec=cc.v2(),e}return r(e,t),e.prototype._isHisChild=function(t,e){return t===e||!!t.parent&&this._isHisChild(t.parent,e)},e.prototype._findScrollingInnerSv=function(t){var e=this,n=this.Find(function(n){return e._isHisChild(t,n.Child(e.innerPath))});return n&&n.Child(this.innerPath,s.default)},e.prototype.isDifferentBetweenSettingAndPlan=function(t){return!(0===this.planDir||1===this.planDir&&t.horizontal||-1===this.planDir&&t.vertical)},e.prototype.hasNestedViewGroup=function(t){return t.eventPhase,cc.Event.CAPTURING_PHASE,!1},e.prototype._onTouchBegan=function(t,e){this.enabledInHierarchy&&!this.hasNestedViewGroup(t,e)&&(this.planDir=-2,this.scrollingInnerSv=null,this.content&&this._handlePressLogic(t.touch),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(t))},e.prototype._onTouchMoved=function(t,e){if(this.enabledInHierarchy&&!this.hasNestedViewGroup(t,e)){var n=t.getLocation().sub(t.getStartLocation(),this.tempVec);if(-2===this.planDir&&n.mag()>a.CLICK_SPACE)if(this.scrollingInnerSv=this._findScrollingInnerSv(t.target),this.scrollingInnerSv){var o=this.scrollingInnerSv.content.getContentSize(),r=this.scrollingInnerSv.node.getContentSize();this.scrollingInnerSv.vertical&&o.height>r.height||this.scrollingInnerSv.horizontal&&o.width>r.width?this.planDir=Math.abs(n.x)>Math.abs(n.y)?1:-1:this.planDir=0}else this.planDir=0;if(this.content&&!this.isDifferentBetweenSettingAndPlan(this)&&this._handleMoveLogic(t.touch),this.cancelInnerEvents&&!this.scrollingInnerSv){if(n.mag()>a.CLICK_SPACE&&!this._touchMoved&&t.target!==this.node){var i=new cc.Event.EventTouch(t.getTouches(),t.bubbles);i.type=cc.Node.EventType.TOUCH_CANCEL,i.touch=t.touch,i.simulate=!0,t.target.dispatchEvent(i),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(t)}}},i([u],e.prototype,"innerPath",void 0),i([l],e)}(cc.ScrollView);n.default=p,cc._RF.pop()},{"../../../common/constant/Constant":"Constant","./ScrollViewInnerCmpt":"ScrollViewInnerCmpt"}],SettingPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"ed2193s15lCuJ9HytvD3I2B","SettingPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../../startScene/version"),l=t("../../common/helper/ShareHelper"),u=t("../../common/wx/WxHelper"),p=cc._decorator.ccclass,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleLbl_=null,e.soundNode_=null,e.feedbackNode_=null,e.gameNode_=null,e.versionLbl_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("SettingPnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(){cc.log("SettingPnlCtrl onEnter"),this.setParam({isAct:!1}),this.refreshSound(),this.versionLbl_.string="v"+c.default.VERSION,this.feedbackNode_.active=this.gameNode_.active=ut.isWechatGame(),ut.isWechatGame()&&(u.wxHelper.createFeedbackButton(this.feedbackNode_),u.wxHelper.createGameClubButton(this.gameNode_))},e.prototype.onRemove=function(){cc.log("SettingPnlCtrl onRemove"),ut.isWechatGame()&&(u.wxHelper.destroyButton(this.feedbackNode_.uuid),u.wxHelper.destroyButton(this.gameNode_.uuid))},e.prototype.onDispose=function(){cc.log("SettingPnlCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close()},e.prototype.onClickSound=function(t,e){cc.log("onClickSound",e);var n=audioMgr.sfxVolume;audioMgr.sfxVolume=1==n?0:1,this.refreshSound()},e.prototype.onClickShare=function(t,e){cc.log("onClickShare",e),l.shareHelper.share()},e.prototype.onClickFeedback=function(t,e){cc.log("onClickFeedback",e)},e.prototype.onClickGame=function(t,e){cc.log("onClickGame",e)},e.prototype.onClickClose1=function(t,e){cc.log("onClickClose1",e),this.close()},e.prototype.refreshSound=function(){this.soundNode_.Child("on").active=audioMgr.sfxVolume>0,this.soundNode_.Child("off").active=audioMgr.sfxVolume<=0},i([p],e)}(mc.BasePnlCmpt);n.default=h,cc._RF.pop()},{"../../../../startScene/version":void 0,"../../common/helper/ShareHelper":"ShareHelper","../../common/wx/WxHelper":"WxHelper"}],ShapeCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"28716cIIbxEy7IXsXRQar/r","ShapeCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../common/constant/Constant"),l=t("../../../common/helper/GameHelper"),u=t("../../../model/common/BlockObj"),p=t("./BlockCmpt"),h=cc._decorator,d=h.ccclass,f=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.soul=t;var e=this.getCoords();this.node.angle=0,this.node.Items(e,function(e,n){var o=n[0],r=n[1]*c.GRID_WIDTH,i=o*c.GRID_WIDTH;e.setPosition(r,i);var a=(new u.default).init(t.color,n),s=e.getComponent(p.default);s||(s=e.addComponent(p.default)),s.init(a).initView()}),l.gameHelper.resizeParentToFitChildren(this.node)},e.prototype.rotate90=function(){var t=(this.soul.degree+=90)%360;this.soul.degree=t},e.prototype.isRotated=function(){var t=this.getCoords(),e=this.soul.coords;return JSON.stringify(t)!=JSON.stringify(e)},e.prototype.rotateToZero=function(){this.node.angle=0,this.soul.degree=0;var t=this.getCoords();this.node.Items(t,function(t,e){var n=e[0],o=e[1]*c.GRID_WIDTH,r=n*c.GRID_WIDTH;t.setPosition(o,r)}),l.gameHelper.resizeParentToFitChildren(this.node)},e.prototype.rotate=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t){cc.tween(e.node).by(.2,{angle:-90}).call(t).start()})];case 1:return n.sent(),this.rotate90(),this.node.angle=0,t=this.getCoords(),this.node.Items(t,function(t,e){var n=e[0],o=e[1]*c.GRID_WIDTH,r=n*c.GRID_WIDTH;t.setPosition(o,r)}),l.gameHelper.resizeParentToFitChildren(this.node),[2]}})})},e.prototype.getCoords=function(){var t=this.soul.degree;return this.soul.degreeCoordsMap.get(t)},e.prototype.setGray=function(t){this.node.children.forEach(function(e){e.Component(p.default).setGray(t)})},e.prototype.getBlocksXY=function(t){return this.node.children.map(function(e){var n=e.convertToWorldSpaceAR(cc.Vec2.ZERO),o=t.convertToNodeSpaceAR(n);return l.gameHelper.getBoardXYBy(o)})},e.prototype.getColors=function(){return this.node.children.map(function(t){return t.getComponent(p.default).getColor()})},e.prototype.getBlocksAndXY=function(t){return this.node.children.map(function(e){var n=e.convertToWorldSpaceAR(cc.Vec2.ZERO),o=t.convertToNodeSpaceAR(n);return{block:e,xy:l.gameHelper.getBoardXYBy(o)}})},e.prototype.getColor=function(){return this.soul.color},i([d],e)}(cc.Component));n.default=f,cc._RF.pop()},{"../../../common/constant/Constant":"Constant","../../../common/helper/GameHelper":"GameHelper","../../../model/common/BlockObj":"BlockObj","./BlockCmpt":"BlockCmpt"}],ShapeObj:[function(t,e,n){"use strict";cc._RF.push(e,"a60d7hrqGdI+J+GAVofOO5m","ShapeObj"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this.degreeCoordsMap=new Map}return t.prototype.init=function(t,e,n){this.id=t,this.coords=ut.deepClone(e),this.headPos=ut.deepClone(n);for(var o=0,r=0;r<4;++r)this.degreeCoordsMap.set(o,this.getRotateCoords(o)),o=(o+90)%360;return this},t.prototype.getRotateCoords=function(t){return this.coords.map(function(e){var n=e[0],o=e[1];switch(t){case 90:return[-o,n];case 180:return[-n,-o];case 270:return[o,-n];case 0:return[n,o]}})},t.prototype.initJson=function(){assetsMgr.getJsonData("ShapeConfig",this.id)},t.prototype.toDB=function(){return{id:this.id}},t}();n.default=o,cc._RF.pop()},{}],ShareAd:[function(t,e,n){"use strict";cc._RF.push(e,"03d73uqrzVLh4gMWchetkjx","ShareAd");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ShareAd=void 0;var i=t("../constant/Enums"),a=t("../helper/GameHelper"),s=t("../helper/ShareHelper"),c=function(){function t(){this.lastShareTime=0,this.sharedCount=0,this._config=null,this.adModel=null}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config?this._config:(ut.isWechatOrQQ()?this._config={cds:[.2,.5,.8,1.4,1.8,2.4,3,4]}:this._config={cds:[.3,.5,1,1.5,2,3,4,5]},this._config)},enumerable:!1,configurable:!0}),t.prototype.init=function(t,e){this.adModel=e,t=t||{},this.lastShareTime=t.lastShareTime||0,this.sharedCount=t.sharedCount||0,this.checkRefresh()},t.prototype.show=function(t){return o(this,void 0,void 0,function(){var e;return r(this,function(n){switch(n.label){case 0:return[4,s.shareHelper.shareJump(i.ShareType.AD,{index:t})];case 1:return(e=n.sent())&&(this.sharedCount++,this.lastShareTime=a.gameHelper.now()),[2,e]}})})},t.prototype.toDB=function(){return{sharedCount:this.sharedCount,lastShareTime:this.lastShareTime}},t.prototype.isReady=function(){return!(!this.config||!this.config.cds||this.sharedCount>=this.config.cds.length||this.adModel.rewardAd&&!this.adModel.isType(i.AdType.SHARE)&&!(this.adModel.rewardAd.getFailTime()>=this.config.cds[this.sharedCount]*ut.Time.Minute))},t.prototype.checkRefresh=function(){var t=this.lastShareTime;(t<=0||a.gameHelper.getToDaySurpluTime(t)<=0)&&(this.sharedCount=0)},t.prototype.load=function(){this.checkRefresh()},t}();n.ShareAd=c,cc._RF.pop()},{"../constant/Enums":"Enums","../helper/GameHelper":"GameHelper","../helper/ShareHelper":"ShareHelper"}],ShareHelper:[function(t,e,n){"use strict";cc._RF.push(e,"0d73d5Y1FtNzpA55hLi5nC0","ShareHelper");var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.shareHelper=void 0;var s=t("../LocalConfig"),c=t("../wx/WxHelper"),l=t("./GameHelper"),u=t("./ViewHelper"),p=t("../wx_app/WxAppHelper"),h=t("../constant/Enums"),d=t("../net/netMgr"),f=t("../../../scene/CameraCtrl"),y=function(){function t(){this.shareFailCount=0,this.defaultShareList=[{title:"\u4e00\u8d77\u73a9\u800d\u5427\uff5e",key:"share.play_together",url:"share1.png"},{title:"\u7237\u8bf7\u56de\uff01",key:"share.open_hotel_with_me",url:"share2.png"},{title:"\u7ecf\u5178\u91cd\u71c3\uff0c\u65b9\u5757\u6d88\u4e0d\u505c",key:"share.start_hotel",url:"share3.png"},{title:"\u5fc3\u8df3\u6311\u6218\uff0c\u7b2c\u4e8c\u5173\u592a\u96be\u4e86\uff01",key:"share.start_hotel",url:"share2.png"},{title:"\u6839\u672c\u505c\u4e0d\u4e0b\u6765\uff01",key:"share.start_hotel",url:"share3.png"}]}return t.prototype.IMAGE_URL=function(t){return t},Object.defineProperty(t.prototype,"shareFailCheckTimes",{get:function(){return ut.isWechatOrQQ()?[2.5,2,1.5,1]:[2,3,2.5,2]},enumerable:!1,configurable:!0}),t.prototype.init=function(){var t=this;ut.isWechatOrQQ()&&(wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),(wx.uma||wx).onShareAppMessage(function(){var e=t.getRandomShareInfo(),n={uid:l.gameHelper.user.getUid(),type:h.ShareType.ON_SHARE_APP_MESSAGE,imageName:t.getImageNameByUrl(e.url)};return{title:e.title,imageUrl:e.url,query:d.netMgr.encodeURIObj(n)}}),wx.onShareTimeline&&wx.onShareTimeline(function(){var e=t.getRandomShareInfo(),n={uid:l.gameHelper.user.getUid(),type:h.ShareType.ON_SHARE_TIMELINE,imageName:t.getImageNameByUrl(e.url)};return{title:e.title,imageUrl:e.url,query:d.netMgr.encodeURIObj(n)}}))},t.prototype.shareShootCamera=function(t,e,n){return i(this,void 0,void 0,function(){var o;return a(this,function(r){switch(r.label){case 0:return o=e>0?assetsMgr.lang("share.shoot_share_count",e):assetsMgr.lang("share.shoot_share"),[4,this.share(o,n,{type:h.ShareType.ROOM_SHOOT,roomid:t},!0)];case 1:return[2,r.sent()]}})})},t.prototype.shareRankInfo=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(){return t=assetsMgr.lang("share.rankInfo"),[2,this.share(t,null,{type:h.ShareType.RANK},!0)]})})},t.prototype.isWorking=function(){return this.__lock_share},t.prototype.shareJump=function(t,e,n){return i(this,void 0,void 0,function(){var r,i,s,c,u,p,d,f,y,_;return a(this,function(a){switch(a.label){case 0:return r=null,t===h.ShareType.ROOM_SHOOT?(i=e.roomlike>0?assetsMgr.lang("share.shoot_share_count",e.roomlike):assetsMgr.lang("share.shoot_share"),r={title:i,imgUrl:e.img,queryInfo:{type:t,roomid:e.roomid},loose:!0}):t===h.ShareType.INVITE?r={title:null,imgUrl:null,queryInfo:{type:t},loose:!0}:t===h.ShareType.AD&&(s={type:t},1!==(c=null==e?void 0:e.index)&&2!==c||(u=l.gameHelper.ad.getPlanBAD())&&(s=o({type:t,inviteUser:l.gameHelper.user.getOpenId()},u)),r={title:null,imgUrl:null,queryInfo:s,loose:!1}),r?[4,this.showShareChoice(t)]:[2,!1];case 1:return"NONE"==(p=a.sent())?[2,!1]:(d=r.title,f=r.imgUrl,y=r.queryInfo,_=r.loose,[2,this.share(d,f,y,_,"",p,n,null==e?void 0:e.index)])}})})},t.prototype.showShareChoice=function(t){return i(this,void 0,void 0,function(){return a(this,function(){return ut.isMobile()?[2,new Promise(function(e){var n=[];l.gameHelper.isGLobal()?(n.pushArr([h.GlobalSharePlatform.FB,h.GlobalSharePlatform.TWITTER]),t!=h.ShareType.SHOOT_IMAGE&&t!=h.ShareType.ROOM_SHOOT||n.push(h.GlobalSharePlatform.INS)):n.pushArr([h.InlandSharePlatform.APP_WX,h.InlandSharePlatform.WEIBO,h.InlandSharePlatform.WX_PYQ]),u.viewHelper.showPnl("common/ShareChoice",n,e)})]:[2]})})},t.prototype.share=function(t,e,n,o,r){return void 0===o&&(o=!0),i(this,void 0,void 0,function(){var i,s,u,p;return a(this,function(a){switch(a.label){case 0:return t&&e||(i=this.getRandomShareInfo(),t=t||i.title,e=this.IMAGE_URL(i.url)),s=l.gameHelper.user.getUid(),(n=n||{}).uid=s,void 0===n.type&&(n.type=h.ShareType.UNKNOWN),e&&(console.log("imgUrl",e),n.imageName=this.getImageNameByUrl(e)),u=!0,p=l.gameHelper.now(),ut.isWechatOrQQ()?[4,c.wxHelper.share(t,e,n,o)]:[3,2];case 1:return u=a.sent(),[3,3];case 2:ut.isMobile()||ut.isFBInstant()||(o=!0,u=!0),a.label=3;case 3:return u?(this.shareFailCount=0,storageMgr.saveNumber("last_share_time",p)):(this.shareFailCount++,o||this.showFailToast(r)),[2,u]}})})},t.prototype.shoot=function(t,e,n,o,r,i){ut.isWechatOrQQ()?this.saveImageToTempFilePath(t,e,n,o,500,400,null,i):this.saveImageToTempFilePath(t,e,n,o,n,o,r,i)},t.prototype.screenshoot=function(t){var e=new cc.RenderTexture,n=cc.game._renderContext;e.initWithSize(Math.floor(cc.winSize.width),Math.floor(cc.winSize.height),n.STENCIL_INDEX8);var o=new cc.Node("Shoot");o.parent=cc.Canvas.instance.node;var r=o.addComponent(cc.Camera);return r.clearFlags=cc.Camera.ClearFlags.COLOR|cc.Camera.ClearFlags.DEPTH|cc.Camera.ClearFlags.STENCIL,t&&(r.backgroundColor=ut.colorFromHEX(t)),r.cullingMask=f.cameraCtrl.getCamera().cullingMask,r.zoomRatio=f.cameraCtrl.getCamera().zoomRatio,r.node.setPosition(f.cameraCtrl.getCamera().node.getPosition()),r.targetTexture=e,r.render(),o.destroy(),e},t.prototype.writePhotosAlbum=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return ut.isWechatOrQQ()?(wx.getSetting({success:function(e){e.authSetting["scope.writePhotosAlbum"]?t(!0):wx.authorize({scope:"scope.writePhotosAlbum",success:function(){t(!0)},fail:function(){t(!1)}})},fail:function(){t(!1)}}),[3,4]):[3,1];case 1:return ut.isIos()||ut.isAndroid()?[4,p.wxAppHelper.photoPermitStatus()]:[3,3];case 2:return e=n.sent(),t(e.result),[3,4];case 3:t(!1),n.label=4;case 4:return[2]}})})},t.prototype.saveImageToTempFilePath=function(t,e,n,o,r,i,a,s){if(ut.isWechatOrQQ()){var c=cc.game.canvas.height/cc.winSize.height;t*=c,e=(cc.winSize.height-e-o)*c,n*=c,o*=c,cc.game.canvas.toTempFilePath({x:t,y:e,width:n,height:o,destWidth:r,destHeight:i,fileType:"png",success:function(t){s(t.tempFilePath)},fail:function(){s()}})}else{for(var l=this.screenshoot(a).readPixels(null,t,e,n,o),u=new Uint8Array(n*o*4),p=4*n,h=0;h<o;h++)for(var d=(o-1-h)*n*4,f=h*n*4,y=0;y<p;y++)u[f+y]=l[d+y];var _="";try{_=jsb.fileUtils.getWritablePath()+Date.parse((new Date).toString())/1e3+".png",jsb.saveImageData(u,n,o,_)}catch(g){}s(_)}},t.prototype.saveImageToPhotosAlbum=function(t,e,n,o,r,i){var a=this;ut.isWechatOrQQ()?this.saveImageToTempFilePath(t,e,n,o,n,o,null,function(t){t?wx.saveImageToPhotosAlbum({filePath:t,success:function(){i(!0)},fail:function(){i(!1)}}):i(!1)}):this.saveImageToTempFilePath(t,e,n,o,n,o,r,function(t){t?a.saveImageToAPPPhotosAlbum(t,i):i(!1)})},t.prototype.saveImageToAPPPhotosAlbum=function(t,e){return i(this,void 0,void 0,function(){var n;return a(this,function(o){switch(o.label){case 0:return[4,p.wxAppHelper.savePhoto(t)];case 1:return n=o.sent(),e(n.result),[2]}})})},t.prototype.getRandomShareInfo=function(){var t=this.defaultShareList.random(),e=t.title;return assetsMgr.getJson("share")&&(e=assetsMgr.lang(t.key)),{title:e,url:this.IMAGE_URL+t.url}},t.prototype.shareGame=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(){return s.localConfig.isGm?[2,!0]:(e={type:h.ShareType.DAILY_TASK},t&&(e.wxgamebranchid=t,e.wxgamebranchdim="wxgamebranchdim"),[2,this.share(null,null,e,!1)])})})},t.prototype.shareInvite=function(){return i(this,void 0,void 0,function(){return a(this,function(){return[2,this.share(null,null,{type:h.ShareType.INVITE},!0)]})})},t.prototype.shareFriend=function(t){return i(this,void 0,void 0,function(){return a(this,function(){return[2,this.share(assetsMgr.lang("share.friend_share"),this.IMAGE_URL+"fx_ty_tjhy.png",{type:h.ShareType.FRIEND,date:l.gameHelper.now()},!0,"",t)]})})},t.prototype.showFailToast=function(t){if(""!==t){if(!t){var e=void 0;t=l.gameHelper.isGLobal()?"toast.toast_shareRecord_failed":(e=["toast.share_fail_1","toast.share_fail_2"])[ut.randomIndex(e.length)]}u.viewHelper.showAlert(t)}},t.prototype.getImageNameByUrl=function(){return""},r([ut.addLock],t.prototype,"share",null),t}();n.shareHelper=new y,cc._RF.pop()},{"../../../scene/CameraCtrl":"CameraCtrl","../LocalConfig":"LocalConfig","../constant/Enums":"Enums","../net/netMgr":"netMgr","../wx/WxHelper":"WxHelper","../wx_app/WxAppHelper":"WxAppHelper","./GameHelper":"GameHelper","./ViewHelper":"ViewHelper"}],ShareParamsHelper:[function(t,e,n){"use strict";cc._RF.push(e,"8cd11oVHeFLtKMe9/r2NR1k","ShareParamsHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.shareParamsHelper=void 0;var i=t("../appsFlyer/AppsFlyerHelper"),a=t("../helper/GameHelper"),s=t("../openInstall/OpenInstallHelper"),c=function(){function t(){}return t.prototype.getInstallParams=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return cc.sys.isNative?(t=null,a.gameHelper.isGLobal()?(t=i.appsFlyerHelper.getDeepLinkParams(),[3,3]):[3,1]):[2,null];case 1:return[4,s.openInstallHelper.getInstallParams()];case 2:t=e.sent(),e.label=3;case 3:return[2,t]}})})},t.prototype.getAwakeParams=function(){return cc.sys.isNative?a.gameHelper.isGLobal()?i.appsFlyerHelper.getDeepLinkParams():s.openInstallHelper.getAwakeParams():null},t}();n.shareParamsHelper=new c,cc._RF.pop()},{"../appsFlyer/AppsFlyerHelper":"AppsFlyerHelper","../helper/GameHelper":"GameHelper","../openInstall/OpenInstallHelper":"OpenInstallHelper"}],ShootHelper:[function(t,e,n){"use strict";cc._RF.push(e,"782399bMORGa6s+/GP5egCa","ShootHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.shootHelper=void 0;var i=t("../../../scene/CameraCtrl"),a=t("../wx_app/WxAppHelper"),s=function(){function t(){}return t.prototype.shoot=function(t,e,n,o,r,i,a){ut.isFBInstant()?this.shootOnFbInstant(t,e,n,o,r,i,a):ut.isWechatOrQQ()?this.saveImageToTempFilePath(t,e,n,o,500,400,null,i,a):this.saveImageToTempFilePath(t,e,n,o,n,o,r,i,a)},t.prototype.screenshoot=function(t,e){var n=new cc.RenderTexture,o=cc.game._renderContext;n.initWithSize(Math.floor(cc.winSize.width),Math.floor(cc.winSize.height),o.STENCIL_INDEX8);var r=new cc.Node("Shoot");r.parent=cc.Canvas.instance.node;var a=r.addComponent(cc.Camera);return a.clearFlags=cc.Camera.ClearFlags.COLOR|cc.Camera.ClearFlags.DEPTH|cc.Camera.ClearFlags.STENCIL,e?a.backgroundColor=ut.colorFromHEX("#FFFFFF"):t&&(a.backgroundColor=ut.colorFromHEX(t)),a.cullingMask=e?-8:i.cameraCtrl.getCamera().cullingMask,a.zoomRatio=e?1:i.cameraCtrl.getCamera().zoomRatio,a.node.setPosition(e?cc.v2():i.cameraCtrl.getCamera().node.getPosition()),a.targetTexture=n,a.render(),r.destroy(),n},t.prototype.writePhotosAlbum=function(t){return o(this,void 0,void 0,function(){var e;return r(this,function(n){switch(n.label){case 0:return ut.isWechatOrQQ()?(wx.getSetting({success:function(e){e.authSetting["scope.writePhotosAlbum"]?t(!0):wx.authorize({scope:"scope.writePhotosAlbum",success:function(){t(!0)},fail:function(){t(!1)}})},fail:function(){t(!1)}}),[3,4]):[3,1];case 1:return ut.isIos()||ut.isAndroid()?[4,a.wxAppHelper.photoPermitStatus()]:[3,3];case 2:return e=n.sent()||{},t(e.result),[3,4];case 3:t(!1),n.label=4;case 4:return[2]}})})},t.prototype.saveImageToTempFilePath=function(t,e,n,o,r,i,a,s,c){if(ut.isWechatOrQQ()){var l=cc.game.canvas.height/cc.winSize.height;t*=l,e=(cc.winSize.height-e-o)*l,n*=l,o*=l,cc.game.canvas.toTempFilePath({x:t,y:e,width:n,height:o,destWidth:r,destHeight:i,fileType:"png",success:function(t){s(t.tempFilePath)},fail:function(){s()}})}else{for(var u=this.screenshoot(a,c).readPixels(null,t,e,n,o),p=new Uint8Array(n*o*4),h=4*n,d=0;d<o;d++)for(var f=(o-1-d)*n*4,y=d*n*4,_=0;_<h;_++)p[y+_]=u[f+_];var g="";try{g=jsb.fileUtils.getWritablePath()+Date.parse((new Date).toString())/1e3+".png",jsb.saveImageData(p,n,o,g)}catch(m){}s(g)}},t.prototype.saveImageToPhotosAlbum=function(t,e,n,o,r,i,a){var s=this;ut.isWechatOrQQ()?this.saveImageToTempFilePath(t,e,n,o,n,o,null,function(t){t?wx.saveImageToPhotosAlbum({filePath:t,success:function(){i(!0)},fail:function(){i(!1)}}):i(!1)},a):this.saveImageToTempFilePath(t,e,n,o,n,o,r,function(t){t?s.saveImageToAPPPhotosAlbum(t,i):i(!1)},a)},t.prototype.saveImageToAPPPhotosAlbum=function(t,e){return o(this,void 0,void 0,function(){var n;return r(this,function(o){switch(o.label){case 0:return[4,a.wxAppHelper.savePhoto(t)];case 1:return n=o.sent()||{},e(n.result),[2]}})})},t.prototype.shootOnFbInstant=function(t,e,n,o,r,i,a){var s=this.screenshoot(r,a).readPixels(null,t,e,n,o),c=document.createElement("canvas"),l=c.getContext("2d");c.width=n,c.height=o;for(var u=4*n,p=0;p<o;p++){for(var h=(o-1-p)*n*4,d=l.createImageData(n,1),f=0;f<u;f++)d.data[f]=s[h+f];l.putImageData(d,0,p)}var y=c.toDataURL("image/jpeg",.8);c.remove(),i(y)},t}();n.shootHelper=new s,cc.sys.isBrowser&&(window.shootHelper=n.shootHelper),cc._RF.pop()},{"../../../scene/CameraCtrl":"CameraCtrl","../wx_app/WxAppHelper":"WxAppHelper"}],ShopPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"814b4PC9N1IPImuCVNPSKKC","ShopPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Constant"),l=t("../../common/constant/Enums"),u=t("../../common/event/EventType"),p=t("../../common/helper/GameHelper"),h=cc._decorator.ccclass,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleLbl_=null,e.comCoinNode_=null,e.countLbl_=null,e.coinNode_=null,e.listSv_=null,e.adStatusNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){var t,e;return[(t={},t[u.default.UPDATE_DAILY_FREE]=this.refreshList,t),(e={},e[u.default.UPDATE_COIN]=this.onUpdateCoin,e)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.setParam({isAct:!1}),cc.log("ShopPnlCtrl onCreate"),p.gameHelper.ad.initCurrentAd(l.AdType.REWARD),[2]})})},e.prototype.onEnter=function(){var t=this;cc.log("ShopPnlCtrl onEnter"),this.onUpdateCoin(),this.listSv_.Items(1,function(e){var n=e.Child("content");n.x=720,n.y=0,cc.tween(n).to(.3,{x:0,opacity:255},{easing:cc.easing.sineOut}).start();var o=p.gameHelper.global.getTodayLeftAD();e.Child("content/count",cc.Label).string=""+o,e.Child("content/btnBuy",cc.Button).interactable=o>0;var r=e.Child("content/btnBuy");r.off("click"),r.on("click",t.watchReward,t);var i=p.gameHelper.ad.isAdReady();t.adStatusNode_.Component(cc.MultiFrame).setFrame(i?0:1)})},e.prototype.watchReward=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,p.gameHelper.ad.showAd(l.AdPropType.Shop)];case 1:return t.sent().status==l.RewardAdStatus.SUCCESS&&(p.gameHelper.global.addTodayAD(),p.gameHelper.getRewards([{id:c.COIN_ID,count:50}])),[2]}})})},e.prototype.onRemove=function(){cc.log("ShopPnlCtrl onRemove")},e.prototype.onDispose=function(){cc.log("ShopPnlCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.close()},e.prototype.onClickBuy=function(t,e){cc.log("onClickBuy",e)},e.prototype.onClickCoin=function(t,e){cc.log("onClickCoin",e)},e.prototype.refreshList=function(){var t=this;this.listSv_.List(1,function(e){var n=p.gameHelper.global.getTodayLeftAD();e.Child("content/count",cc.Label).string=""+n,e.Child("content/btnBuy",cc.Button).interactable=n>0;var o=e.Child("content/btnBuy");o.off("click"),o.on("click",t.watchReward,t)})},e.prototype.onUpdateCoin=function(){this.countLbl_.string=p.gameHelper.global.getCoin()},i([h],e)}(mc.BasePnlCmpt);n.default=d,cc._RF.pop()},{"../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/GameHelper":"GameHelper"}],SpinWindCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"73c4d+KZHhNXLXexd9rnY0d","SpinWindCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Constant"),l=t("../../common/constant/Enums"),u=t("../../common/event/EventType"),p=t("../../common/helper/GameHelper"),h=t("../../common/helper/GotoHelper"),d=t("../../common/helper/ResHelper"),f=t("../../common/helper/ViewHelper"),y=cc._decorator.ccclass,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tag="SpinWindCtrl",e.AdSilderNode_=null,e.adNode_=null,e.adStatusNode_=null,e.circleNode_=null,e.gotTipRt_=null,e.titleLbl_=null,e.movingRight=!0,e.range=400,e.duration=1.1,e.going=!0,e.rateList=[1,2,4,2,1],e.list=[],e.playing=!1,e}return r(e,t),e.prototype.eventMaps=function(){var t;return[(t={},t[u.default.UPDATE_SPIN]=this.refreshSpin,t)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("SpinPnlCtrl onCreate"),this.targetNode=this.AdSilderNode_.Child("silder"),[2]})})},e.prototype.onEnter=function(){var t=this;cc.log("SpinPnlCtrl onEnter"),this.circleNode_.children.map(function(e,n){var o=c.SPIN_REWARDS[n].reward,r=ut.stringToNumbers(o,"="),i=r[0],a=r[1];d.resHelper.loadTempIcon(e,""+i,t.tag),e.Child("val",cc.Label).string=""+a,e.Child("val",cc.Label).fontSize=24;var s=180*ut.sin(45*n),l=180*ut.cos(45*n);e.setPosition(s,l)}),this.AdSilderNode_.Child("bar").children.map(function(e,n){e.Child("val",cc.Label).string="x"+t.rateList[n]}),this.initList(),this.moveNode(),p.gameHelper.ad.initCurrentAd(l.AdType.REWARD),this.refreshSpin();var e=p.gameHelper.ad.isAdReady();this.adStatusNode_.Component(cc.MultiFrame).setFrame(e?0:1)},e.prototype.onRemove=function(){cc.log("SpinPnlCtrl onRemove")},e.prototype.onClean=function(){cc.log("SpinPnlCtrl onClean")},e.prototype.onClickClose=function(t,e){cc.log("onClickClose",e),this.playing||h.gotoHelper.gotoWind("main")},e.prototype.onClickAd=function(t,e){cc.log("onClickAd",e),this.btnADHandler()},e.prototype.moveNode=function(){var t=this,e=this.movingRight?this.range:0;this.tweenInstance=cc.tween(this.targetNode).to(this.duration,{x:e},{easing:cc.easing.sineInOut}).call(function(){t.movingRight=!t.movingRight,t.going&&t.moveNode()}).start()},e.prototype.update=function(){var t=this.getIndex(),e=cc.misc.clampf(t,0,this.rateList.length-1),n=this.rateList[e];this.adNode_.Child("Layout/text",cc.LocaleLabel).setLangKey("spin_ad",n)},e.prototype.getIndex=function(){var t=this.targetNode.x,e=this.list.findIndex(function(e){return t>e.min&&t<=e.max});return cc.misc.clampf(e,0,this.rateList.length-1)},e.prototype.initList=function(){this.list=this.AdSilderNode_.Child("bar").children.map(function(t){var e=t.x-t.width/2;return{min:e,max:e+t.width}})},e.prototype.btnADHandler=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,u,h,d;return s(this,function(s){switch(s.label){case 0:return p.gameHelper.global.getTodayLeftSpin()<=0?(f.viewHelper.showAlert("tomorrow_coming"),[2]):(this.playing=!0,t=this.getIndex(),e=cc.misc.clampf(t,0,this.rateList.length-1),n=this.rateList[e],this.tweenInstance.stop(),o=this.node.Child("root/spin",sp.Skeleton),r=this.node.Child("root/spin/effect",sp.Skeleton),i=this.circleNode_,[4,p.gameHelper.ad.showAd(l.AdPropType.Spin)]);case 1:return s.sent().status!==l.RewardAdStatus.SUCCESS?(this.playing=!1,this.moveNode(),o.play("idle"),r.play("idle"),i.angle=0,[2]):(p.gameHelper.global.addSpin(),a=ut.randomIndexByWeight(c.SPIN_REWARDS,"weight"),u=c.SPIN_REWARDS[a].reward,o.play("spin"),r.play("spin"),h=-45*a-5760,audioMgr.playSFX("rotate_spin"),[4,new Promise(function(t){cc.tween(i).set({angle:0}).to(4,{angle:-h},{easing:cc.easing.sineInOut}).call(t).start()})]);case 2:return s.sent(),this.isValid?(o.play("reward"),r.play("reward"),[4,ut.wait(.5)]):[2];case 3:return s.sent(),this.isValid?(d=u.split("|").map(function(t){var e=ut.stringToNumbers(t,"=");return{id:e[0],count:e[1]*n}}),p.gameHelper.getRewards(d),this.moveNode(),o.play("idle"),r.play("idle"),i.angle=0,this.playing=!1,[2]):[2]}})})},e.prototype.refreshSpin=function(){var t=p.gameHelper.global.getTodayLeftSpin();this.gotTipRt_.Component(cc.LocaleRichText).setLangKey("shop_video_left",t)},i([ut.addLock],e.prototype,"btnADHandler",null),i([y],e)}(mc.BaseWindCtrl);n.default=_,cc._RF.pop()},{"../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/GameHelper":"GameHelper","../../common/helper/GotoHelper":"GotoHelper","../../common/helper/ResHelper":"ResHelper","../../common/helper/ViewHelper":"ViewHelper"}],SpineMountCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"883ffq3od1Nv5I7SVvD01aR","SpineMountCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mount=null,e}return r(e,t),i([c(cc.Node)],e.prototype,"mount",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],StateConf:[function(t,e,n){"use strict";cc._RF.push(e,"4fa378HdOtNy6CV8f+SOd4H","StateConf"),Object.defineProperty(n,"__esModule",{value:!0}),n.D_SLEEP_TIME=n.SLEEP_TIME=void 0,n.SLEEP_TIME=[8,12],n.D_SLEEP_TIME=[5,7],cc._RF.pop()},{}],StateEnum:[function(t,e){"use strict";cc._RF.push(e,"e06e32XZeRLv6VATaPvZIGQ","StateEnum"),cc._RF.pop()},{}],StorageMgr:[function(t,e,n){"use strict";cc._RF.push(e,"68910T62iZKnKD+M44GPK4Y","StorageMgr");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i,a=t("../../script/common/helper/DatabaseHelper"),s=t("../../script/common/helper/GameHelper"),c=t("../../script/common/LocalConfig"),l=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),u=(i={},l.forEach(function(t,e){return i[t]=e}),i),p=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,h=String.fromCharCode.bind(String),d=function(){function t(){this._dataMap=null,this._keyDataMap={},this._dirtyMap={},this._bigJsonCacheMap={},this._saveLazyQue=[],this._dataLenMap={},this._tempKeyMap={},this._failAry=[],this._saveWorking=!1,this._version=0,this._objMap={},this._saveOrgMap={}}return t.prototype.__key=function(t){return mc.GameNameSpace+"_"+t},t.prototype.__getDataKey=function(t,e,n){void 0===n&&(n=null);var o=this._keyDataMap[t];if(!o){if(!e&&this._tempKeyMap[t])return null;for(var r=0;r<5;r++){var i=this.__key(r);if(this._dataMap[i][t]){o=i;break}}}if(!o){if(!e)return this._tempKeyMap[t]=!0,null;var a=void 0,s=-1;for(r=0;r<5;r++){i=this.__key(r);var c=this._dataMap[i].__data_len;(c<s||-1==s)&&(s=c,a=i)}o=a,this._keyDataMap[t]=o;var l=n?this.__getObjLen(n):0;this._dataMap[o].__data_len+=l,this._dataLenMap[t]=l,this._tempKeyMap[t]&&delete this._tempKeyMap[t]}return o},t.prototype.setVersion=function(t){this._version=t,this.setOrgItem("__@version__",String(this._version))},t.prototype.__init=function(){var t=this;if(!this._dataMap){if(c.localConfig.copyTestModel){for(var e={},n=0,o=0,r=function(e,r){var i=null;try{i=t.getItem(e),i=JSON.parse(i)}catch(s){}if(i&&i.__data_ver){var a=i.__data_ver;r?o+=a:n+=a}},i=0;i<localStorage.length;i++)(d=localStorage.key(i)).startsWith("hotel_debug_v1")?r(d,!0):(e[d]=localStorage.getItem(d),r(d,!1));if(n>o)for(i=0;i<localStorage.length;i++)if((d=localStorage.key(i)).startsWith("hotel_debug_v1")){var s="hotel"+d.substring("hotel_debug_v1".length);this.setItem(s,e[d])}}if("1"===this.getOrgItem("__@clearAll__")&&a.dbHelper.clear(),null===this.getItem(this.__key(0))?this.setVersion(2):this._version=parseInt(this.getOrgItem("__@version__"))||0,this._version<1){for(i=0;i<15;i++){var l=this.__key(i);if(w=this.getItem_version_0(l))try{JSON.parse(w),this.setItem(l,w)}catch(T){lplog.upLog.addFilterMsg("storage._version"),lplog.upLog.warn(this._version,T),console.error("initsetItemError",T)}}this.setVersion(1)}this._dataMap={},this._dataMap["__@version__"]=String(this._version);var u=function(e){for(var n=0;n<e;n++){var o=t.__key(n),r=t.getItem(o);if(r)try{t._dataMap[o]=JSON.parse(r)}catch(T){t._dataMap[o]={},console.error("initParseError",o,r,T)}for(var i in t._dataMap[o]||(t._dataMap[o]={}),t._dataMap[o]){var a=t._dataMap[o][i];t._dataLenMap[i]=t.__getObjLen(a)}t._dataMap[o].__data_len=r?r.length:0,t._dataMap[o].__data_ver||(t._dataMap[o].__data_ver=0)}};this._version<2?u(15):u(5);var p=mc.GameNameSpace+"_";if(this._version<2){for(var h=[];this._version<2;){if(this._version<2){for(var d in this._dataMap)for(var l in e=this._dataMap[d]){var f=e[l],y=typeof f;if("string"==y)try{y=typeof(f=JSON.parse(f))}catch(T){}if("object"==y){var _={};_.__data_ver=e.__data_ver,_.__data_date=e.__data_date,_[l]=f,this.copyToObject(l,_),this.removeData(l,d)}}for(var d in this._dataMap){e=this._dataMap[d];var g=d.split(p),m=(g[0],g[1]);if(parseInt(m)>=5){for(var l in e)l.startsWith("__")||this.__set(l,e[l],!1);h.push(d),delete this._dataMap[d]}}}this._version++}this.save(),this.setVersion(this._version);for(var v=0,b=h;v<b.length;v++)d=b[v],this.removeItem(d)}for(i=0;i<localStorage.length;i++)if((l=localStorage.key(i)).startsWith(p)){var w,S=l.split(p),C=(S[0],S[1]);if(isNaN(Number(C))&&(w=this.getItem(l)))try{"object"==typeof(w=JSON.parse(w))&&(this._objMap[l]=w)}catch(T){console.error("initParseError2",l,w,T)}}else l.startsWith("__@#_")&&(this._saveOrgMap[l]=this.getOrgItem(l));this._updateAuxiliary()}},t.prototype.__get=function(t){this.__init();var e=this.__getDataKey(t,!1);return e?this._dataMap[e][t]:null},t.prototype.__getObjLen=function(t){var e=typeof t;if("string"==e)return t.length;if("function"==e)return 0;if("object"==e){var n=0;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var r=t[o];n+=o.length+this.__getObjLen(r)}return n}return 2},t.prototype.__set=function(t,e,n){void 0===n&&(n=!0),n&&this.__init();var o=this.__getDataKey(t,!0,e);this._dataMap[o][t]=e,this._dataMap[o].__data_ver++,this._dataMap[o].__data_date||(this._dataMap[o].__data_date=s.gameHelper.now()),this._dirtyMap[o]||(this._dirtyMap[o]=!0,this._saveLazyQue.push(o))},t.prototype._updateAuxiliary=function(){var t=this;s.gameHelper.setInterval(function(){t.saveLazy()},100)},t.prototype.setOrgItem=function(t,e){if(!t.startsWith("__@"))throw new Error("need start with __");try{localStorage.setItem(t,e),t.startsWith("__@#_")&&(this._saveOrgMap[t]=e)}catch(n){lplog.upLog.addFilterMsg("storage.setOrgItem"),lplog.upLog.error(n)}},t.prototype.setItem=function(t,e){try{this._dataMap&&this._dataMap[t]&&(this._dataMap[t].__data_len=e.length),localStorage.setItem(t,this.compress(e))}catch(n){console.error("setItemError",t,e,n),this.doSvaeFail("storage.setItem",t,n)}},t.prototype.setItemAsync=function(t,e){return o(this,void 0,Promise,function(){var n=this;return r(this,function(){return this._dataMap&&this._dataMap[t]&&(this._dataMap[t].__data_len=e.length),[2,new Promise(function(o){wx.setStorage({key:t,data:n.compress(e),success:function(){o()},fail:function(e){n.doSvaeFail("storage.setItemAsync",t,e),o()}})})]})})},t.prototype.doSvaeFail=function(t,e,n){if(this._failAry.push(e),"object"==typeof n)try{n=JSON.stringify(n)}catch(o){n="object"}lplog.upLog.error(ut.dateFormat("yyyy-MM-dd hh:mm:ss")+", "+t+" failAry=["+this._failAry.join()+"], error="+n),eventMgr.emit("STORAGE_SAVE_FAIL",n||"unknow")},t.prototype.getItem=function(t){var e=null;try{e=localStorage.getItem(t)}catch(n){console.error("getItem error",n),lplog.upLog.addFilterMsg("storage.getFail"),lplog.upLog.error(n)}return""===e&&(e=null),this.decompress(e)},t.prototype.getOrgItem=function(t){var e;try{e=localStorage.getItem(t)}catch(n){e="",lplog.upLog.addFilterMsg("storage.getOrgItem"),lplog.upLog.error(n)}return e},t.prototype.getItem_version_0=function(t){var e=null;try{e=localStorage.getItem(t)}catch(n){lplog.upLog.addFilterMsg("storage.setFail"),lplog.upLog.error(n)}return""===e&&(e=null),this.lzw_decompress(e)},t.prototype.removeItem=function(t){localStorage.removeItem(t)},t.prototype.handleFailSave=function(){var t=this;this._failAry.length>0&&(this._failAry.forEach(function(e){t._dirtyMap[e]=!0,t._saveLazyQue.push(e)}),this._failAry.length=0)},t.prototype.save=function(){if(this._dataMap){var t=!1;for(var e in this._dirtyMap)t=!0,this._objMap[e]?this.setItem(e,JSON.stringify(this._objMap[e])):this.setItem(e,JSON.stringify(this._dataMap[e]));t&&(this._dirtyMap={},this._saveLazyQue.length=0,this.handleFailSave())}},t.prototype.saveLazy=function(){this._dataMap&&!this._saveWorking&&(this._saveWorking=!0,ut.isWechatOrQQ()?o(this,void 0,void 0,function(){var t,e,n,o,i;return r(this,function(r){switch(r.label){case 0:for(t=[];this._saveLazyQue.length>0;)o=this._saveLazyQue.pop(),t.push(o);e=[],n=0,r.label=1;case 1:return t.length>0?(o=t.pop(),void 0,i=this._objMap[o]?JSON.stringify(this._objMap[o]):JSON.stringify(this._dataMap[o]),this._dirtyMap[o]?(e.push(this.setItemAsync(o,i)),this._dirtyMap[o]=!1,(n+=i.length)>=3e3?(n=0,t.length>0?[4,ut.waitNextFrame()]:[3,3]):[3,3]):[3,3]):[3,4];case 2:r.sent(),r.label=3;case 3:return[3,1];case 4:return e.length>0?[4,Promise.all(e)]:[3,6];case 5:r.sent(),r.label=6;case 6:return this._saveWorking=!1,this.handleFailSave(),[2]}})}):(this.syncSaveLazy(),this._saveWorking=!1,this.handleFailSave()))},t.prototype.syncSaveLazy=function(){if(this._dataMap)for(;this._saveLazyQue.length>0;){var t=this._saveLazyQue.pop();this._objMap[t]?this.setItem(t,JSON.stringify(this._objMap[t])):this.setItem(t,JSON.stringify(this._dataMap[t])),this._dirtyMap[t]=!1}},t.prototype.loadString=function(t){return this.__get(t)},t.prototype.saveString=function(t,e){this.__set(t,e)},t.prototype.loadNumber=function(t){var e=this.__get(t);return e?Number(e):null},t.prototype.saveNumber=function(t,e){this.__set(t,String(e))},t.prototype.changeNumber=function(t,e){var n=this.loadNumber(t)||0;this.saveNumber(t,e+n)},t.prototype.loadBool=function(t){var e=this.__get(t);return e?"1"===e:null},t.prototype.saveBool=function(t,e){this.__set(t,e?"1":"0")},t.prototype.loadJson=function(t){return this.loadBigJson(t)},t.prototype.saveJson=function(t,e){this.saveBigJson(t,e)},t.prototype.loadObject=function(t){this.__init();var e=this.__key(t);return this._objMap[e]&&this._objMap[e][t]},t.prototype.saveObject=function(t,e){this.__init();var n=this.__key(t);this._objMap[n]||(this._objMap[n]={}),this._objMap[n].__data_ver||(this._objMap[n].__data_ver=0),this._objMap[n].__data_date||(this._objMap[n].__data_date=s.gameHelper.now()),this._objMap[n][t]=e,this._objMap[n].__data_ver++,this._dirtyMap[n]||(this._dirtyMap[n]=!0,this._saveLazyQue.push(n))},t.prototype.getVersion=function(t){this.__init();var e=this.__key(t);return this._objMap[e]?this._objMap[e].__data_ver:0},t.prototype.setKeyVersion=function(t,e){this.__init();var n=this.__key(t);this._objMap[n]&&(this._objMap[n].__data_ver=e,this._dirtyMap[n]||(this._dirtyMap[n]=!0,this._saveLazyQue.push(n)))},t.prototype.copyToObject=function(t,e){var n=this.__key(t),o=this.getItem(n);if(o)try{if("object"==typeof(o=JSON.parse(o)))return}catch(r){}this._objMap[n]=e,this._dirtyMap[n]||(this._dirtyMap[n]=!0,this._saveLazyQue.push(n))},t.prototype.reset=function(){this._dataMap=null,this._objMap={},this._keyDataMap={},this._dirtyMap={},this._dataLenMap={},this._tempKeyMap={},this._bigJsonCacheMap={},this._objMap={},this._saveLazyQue.length=0,this._failAry.length=0,this._saveWorking=!1},t.prototype.clear=function(){localStorage.clear(),this.reset()},t.prototype.loadBigJson=function(t){if(this._bigJsonCacheMap[t])return this._bigJsonCacheMap[t];var e=this.getItem(t);return e?(this._bigJsonCacheMap[t]=JSON.parse(e),this._bigJsonCacheMap[t]):null},t.prototype.saveBigJson=function(t,e){this._bigJsonCacheMap[t]=e,this.setItem(t,JSON.stringify(e))},t.prototype.getStorageInfo=function(){this.__init();var t={};function e(e){for(var n in e)t[n]=e[n]}return t["__@version__"]=this._version,e(this._dataMap),e(this._objMap),e(this._saveOrgMap),t},t.prototype.getFromRecord=function(t,e){var n=t.split(".");for(var o in e)if(!o.startsWith("__@")){for(var r=e[o],i=!1,a=0;a<n.length;a++){var s=n[a];if(void 0===r[s]){i=!1;break}if(i=!0,0==a&&"string"==typeof r[s])try{r=JSON.parse(r[s])}catch(c){r=r[s]}else r=r[s]}if(i)return r}},t.prototype.getCheckInfoFromRecord=function(t){t=t||this.getStorageInfo();var e={},n={};for(var o in t){var r=t[o];o.startsWith("__@")&&"object"!=typeof r||(n[o]={},n[o].__data_ver=r.__data_ver,n[o].__data_date=r.__data_date)}return e.heart=this.getFromRecord("global.heart",t)||0,e.playTime=this.getFromRecord("user.playTime",t)||0,e.dataMap=n,e},t.prototype.setStorageInfo=function(t,e){var n,o=((n={})["__@version__"]=!0,n);try{this.setOrgItem("__@clearAll__","1"),e||(t=this.lzw_decompress(t));var r=JSON.parse(t);for(var i in r)o[i]||i.startsWith("__@#_")?this.setOrgItem(i,r[i]):this.setItem(i,JSON.stringify(r[i]));return this.removeItem("__@clearAll__"),this.setVersion(r["__@version__"]||0),this.reset(),this.__init(),!0}catch(a){return this.removeItem("__@clearAll__"),console.error("setStorageInfo",a),console.error(t),!1}},t.prototype.removeData=function(t,e){(e=e||this.__getDataKey(t,!1))&&null!=this._dataMap[e]&&(delete this._dataMap[e][t],this._dirtyMap[e]=!0,this._tempKeyMap[t]&&delete this._tempKeyMap[t],this._dataLenMap[t]&&(this._dataMap[e].__data_len-=this._dataLenMap[t],delete this._dataLenMap[t]))},t.prototype.b64Encode=function(t){return this.btoaPolyfill(encodeURIComponent(t))},t.prototype.b64Decode=function(t){return decodeURIComponent(this.atobPolyfill(t))},t.prototype.removeKeyFromData=function(t,e){t.__data_len-=this.__getObjLen(t[e]),delete t[e]},t.prototype.do_lzw_decompress=function(t){for(var e=new function(){var e=[],n=0,o=0,r=13,i=s(r),a=4294967295;function s(t){return(1<<t)-1}this.r=function(){var t;return t=32-n%32<r?((e[n>>5]&s(32-n%32))<<(n+r)%32|e[1+(n>>5)]>>>32-(n+r)%32)&i:e[n>>5]>>>32-(n+r)%32&i,n+=r,t},this.w=function(t){t&=i,32-o%32<r?(e[o>>5]|=t>>>r-(32-o%32),e[1+(o>>5)]|=t<<32-(o+r)%32&a):e[o>>5]|=t<<32-(o+r)%32&a,o+=r},this.e=function(){return n>=o},this.l=function(t){r=Math.max(0|t,1),i=s(r)};for(var c=2;c<t.length;c++)this.w(t.charCodeAt(c)-19968);o=t.charCodeAt(0)-19968<<13|t.charCodeAt(1)-19968&s(13),n=0},n=[],o=-1,r={},i=[],a=8,s=0;s<2+(1<<a);s++)r[s]=String.fromCharCode(++o);for(e.l(a),i[0]=e.r();!e.e();)i[1]=e.r(),128==i[1]&&(e.l(++a),i[1]=e.r()),null==r[i[1]]?r[++o]=r[i[0]]+r[i[0]].charAt(0):r[++o]=r[i[0]]+r[i[1]].charAt(0),n.push(r[i[0]]),i[0]=i[1];return n.push(r[i[0]]),n.join("").replace(/\&\#u[0-9a-fA-F]{4};/g,function(t){return String.fromCharCode(parseInt(t.substring(3,7),16))})},t.prototype.lzw_decompress=function(t){if(null!=t)try{return this.do_lzw_decompress(t)}catch(e){return lplog.upLog.addFilterMsg("storage.decompress"),lplog.upLog.error(e),null}},t.prototype.compress=function(t){if(c.localConfig.debugStorage)return t;if(null==t)return null;try{for(var e,n={},o=(t+"").split(""),r=[],i=o[0],a=256,s=1;s<o.length;s++)null!=n[i+(e=o[s])]?i+=e:(r.push(i.length>1?n[i]:i.charCodeAt(0)),n[i+e]=a,a++,i=e);for(r.push(i.length>1?n[i]:i.charCodeAt(0)),s=0;s<r.length;s++)r[s]=String.fromCharCode(r[s]);return r.join("")}catch(l){return lplog.upLog.addFilterMsg("storage.decompress"),lplog.upLog.error("decompress error",l),t}},t.prototype.decompress=function(t){if(null==t)return null;try{for(var e,n={},o=(t+"").split(""),r=o[0],i=r,a=[r],s=256,c=1;c<o.length;c++){var l=o[c].charCodeAt(0);e=l<256?o[c]:n[l]?n[l]:i+r,a.push(e),r=e.charAt(0),n[s]=i+r,s++,i=e}return a.join("")}catch(u){return lplog.upLog.addFilterMsg("storage.decompress"),lplog.upLog.error("decompress error",u),t}},t.prototype.btoaPolyfill=function(t){for(var e,n,o,r,i="",a=t.length%3,s=0;s<t.length;){if((n=t.charCodeAt(s++))>255||(o=t.charCodeAt(s++))>255||(r=t.charCodeAt(s++))>255)throw new TypeError("invalid character found");i+=l[(e=n<<16|o<<8|r)>>18&63]+l[e>>12&63]+l[e>>6&63]+l[63&e]}return a?i.slice(0,a-3)+"===".substring(a):i},t.prototype.atobPolyfill=function(t){if(t=t.replace(/\s+/g,""),!p.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));for(var e,n,o,r="",i=0;i<t.length;)e=u[t.charAt(i++)]<<18|u[t.charAt(i++)]<<12|(n=u[t.charAt(i++)])<<6|(o=u[t.charAt(i++)]),r+=64===n?h(e>>16&255):64===o?h(e>>16&255,e>>8&255):h(e>>16&255,e>>8&255,255&e);return r},t}();window.storageMgr=new d,cc._RF.pop()},{"../../script/common/LocalConfig":"LocalConfig","../../script/common/helper/DatabaseHelper":"DatabaseHelper","../../script/common/helper/GameHelper":"GameHelper"}],StoryPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"8e1380i06NMy5uHwD9TuUCm","StoryPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Constant"),l=t("../../common/constant/Enums"),u=t("../../common/event/EventType"),p=t("../../common/helper/GameHelper"),h=cc._decorator.ccclass,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blockNode_=null,e.continueNode_=null,e.dialogNode_=null,e.speakerNode_=null,e.skipNode_=null,e.goonNode_=null,e.nameLbl_=null,e.textLbl_=null,e.model=null,e.dialogStartY=0,e.preIconName="",e.continueTime=0,e}return r(e,t),e.prototype.eventMaps=function(){var t,e,n,o,r;return[(t={},t[u.default.START_STORY]=this.onStoryStart,t),(e={},e[u.default.CHANGE_STORY]=this.onStoryChange,e),(n={},n[u.default.PROCEED_STORY]=this.onStoryProceed,n),(o={},o[u.default.END_STORY]=this.onStoryEnd,o),(r={},r[u.default.CLEAN_GUIDE]=this.onCleanGuide,r)]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.setParam({isClean:!1,isAct:!1,isMask:!1,Index:c.PNL_ZINDEX.Story,isHideClean:!1}),this.model=this.getModel("story"),this.blockNode_.active=!1,this.continueNode_.active=!1,this.goonNode_.active=!1,this.dialogStartY=this.dialogNode_.y,[2]})})},e.prototype.onEnter=function(){},e.prototype.onRemove=function(){},e.prototype.onDispose=function(){},e.prototype.onClickContinue=function(){audioMgr.playSFX("click"),this.model.onNext()},e.prototype.onClickSkip=function(){this.model.end()},e.prototype.onStoryStart=function(t){this.continueTime=t||0,this.showDialog(!0)},e.prototype.onStoryProceed=function(t){t&&this.showDialog(!0)},e.prototype.onStoryEnd=function(){this.showDialog(!1)},e.prototype.onStoryChange=function(t){if(t.speaker&&this.showSpeaker(t.speaker),t.type==l.StoryType.OPTION);else{var e=t.speaker.includes("mama2")?"guide.mama":t.speaker;this.nameLbl_.setLocaleKey(e),this.textLbl_.setLocaleKey(t.text)}},e.prototype.onCleanGuide=function(){this.setParam({isClean:!0}),this.close()},e.prototype.showDialog=function(t){var e,n=this;if(this.continueNode_.active!==t){var o=t?0:this.dialogStartY;cc.tween(this.dialogNode_).to(.3,{y:o}).start(),this.blockNode_.active=t,this.continueNode_.stopAllActions(),this.continueNode_.active=!1,this.goonNode_.active=!1,this.skipNode_.active=!1,t&&(null===(e=p.gameHelper.ad)||void 0===e||e.hideAllBannerAd(),cc.tween(this.continueNode_).delay(.5+this.continueTime).call(function(){n.continueNode_.active=!0,n.goonNode_.active=!0,n.skipNode_.active=!0}).start())}},e.prototype.showSpeaker=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},i([h],e)}(mc.BasePnlCmpt);n.default=d,cc._RF.pop()},{"../../common/constant/Constant":"Constant","../../common/constant/Enums":"Enums","../../common/event/EventType":"EventType","../../common/helper/GameHelper":"GameHelper"}],SubscribeHelper:[function(t,e,n){"use strict";cc._RF.push(e,"19bd9sj8q1OHKayUpgJ0RDR","SubscribeHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.subscribeHelper=void 0;var i=t("../constant/Enums"),a=t("./ViewHelper"),s=t("../wx/WxHelper"),c=t("../net/netMgr"),l=t("./GameHelper"),u=t("../constant/Constant"),p=t("../LocalConfig"),h=function(){function t(){}return t.prototype.requestSubscribeMessage=function(t){return o(this,void 0,void 0,function(){var e;return r(this,function(){return ut.isWechatOrQQ()?(e=this.getSubcirbeId(t))?[2,s.wxHelper.requestSubscribeMessage(e)]:[2,!1]:[2,!0]})})},t.prototype.updateSub=function(t,e,n){return o(this,void 0,void 0,function(){var o,i;return r(this,function(r){switch(r.label){case 0:return o=this.getSubcirbeId(t),ut.isWechatOrQQ()&&!o?(lplog.error("updateSub tmpId not foud",t),[2,!1]):[4,c.netMgr.post("subscribe/sub",{uid:l.gameHelper.user.getUid(),template_id:o,notifyTime:e,data:JSON.stringify(n),platform:this.getSubcirbePlatform(),msgType:t})];case 1:return 0!==(i=(r.sent()||{status:-504}).status)?(a.viewHelper.showAlert("toast.subscribe_fail",{params:[null!=i?i:-1e3]}),[2,!1]):[2,!0]}})})},t.prototype.subGaliExplore=function(t){return o(this,void 0,void 0,function(){var e,n,o;return r(this,function(){return n=i.SubscribeType.GALI_EXPLORE,o=assetsMgr.lang("share.gali_explore_desc"),e=ut.isWechatOrQQ()?{thing1:{value:o},time2:{value:ut.dateFormat("yyyy-MM-dd hh:mm:ss",t)}}:{title:assetsMgr.lang("share.gali_explore"),msg:o},[2,this.updateSub(n,t,e)]})})},t.prototype.subBeauty=function(t){return o(this,void 0,void 0,function(){var e,n,o;return r(this,function(){return p.localConfig.release||(t=l.gameHelper.now()+5*ut.Time.Minute),n=i.SubscribeType.BEAUTY_SS,o=assetsMgr.lang("share.beauty_ss_desc"),e=ut.isWechatOrQQ()?ut.isWechatGame()?{thing2:{value:o},time1:{value:ut.dateFormat("yyyy-MM-dd hh:mm:ss",t)}}:{thing1:{value:o},time2:{value:ut.dateFormat("yyyy-MM-dd hh:mm:ss",l.gameHelper.now())}}:{title:assetsMgr.lang("share.beauty_ss_title"),msg:o},[2,this.updateSub(n,t,e)]})})},t.prototype.subHomeParty=function(t){return o(this,void 0,void 0,function(){var e,n,o;return r(this,function(){return p.localConfig.release||(t=l.gameHelper.now()+5*ut.Time.Minute),n=i.SubscribeType.HOME_PARTY,o=assetsMgr.lang("share.home_party_prepare_desc"),e=ut.isWechatOrQQ()?ut.isWechatGame()?{thing2:{value:o},time1:{value:ut.dateFormat("yyyy-MM-dd hh:mm:ss",t)}}:{thing1:{value:o},time2:{value:ut.dateFormat("yyyy-MM-dd hh:mm:ss",l.gameHelper.now())}}:{title:assetsMgr.lang("share.home_party_prepare_title"),msg:o},[2,this.updateSub(n,t,e)]})})},t.prototype.subWudongWork=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(){return e=assetsMgr.lang("share.wudong_work"),t=ut.isWechatOrQQ()?ut.isWechatGame()?{thing1:{value:e},time2:{value:ut.dateFormat("yyyy-MM-dd hh:mm:ss",l.gameHelper.now())}}:{thing1:{value:e}}:{msg:e},[2,this.updateSub(i.SubscribeType.WUDONG_WORK,l.gameHelper.now()+36135*ut.Time.Day,t)]})})},t.prototype.subFilmAward=function(t){return o(this,void 0,void 0,function(){var e,n,o,a,s,c;return r(this,function(){return n=[{key:"film_rowpiece",weight:2},{key:"film_award",weight:10}],o=ut.randomIndexByWeight(n,"weight"),a=n[o].key.toLowerCase(),s=assetsMgr.lang("share."+a+"_desc"),c=assetsMgr.lang("share."+a),e=ut.isWechatOrQQ()?ut.isWechatGame()?{thing1:{value:c},thing3:{value:s}}:{thing1:{value:s},time2:{value:ut.dateFormat("yyyy-MM-dd hh:mm:ss",l.gameHelper.now())}}:{title:c,msg:s},[2,this.updateSub(i.SubscribeType.FILM_AWARD,t,e)]})})},t.prototype.getSubcirbeId=function(t){if(ut.isWechatOrQQ()){var e=u.WxSubscribeId[t];return ut.isQQ()&&(e=u.QQSubscribeId[t]),e}},t.prototype.getSubcirbePlatform=function(){return l.gameHelper.getPlatform()},t}();n.subscribeHelper=new h,cc._RF.pop()},{"../LocalConfig":"LocalConfig","../constant/Constant":"Constant","../constant/Enums":"Enums","../net/netMgr":"netMgr","../wx/WxHelper":"WxHelper","./GameHelper":"GameHelper","./ViewHelper":"ViewHelper"}],Table:[function(t,e){"use strict";cc._RF.push(e,"a02e0bkEy5AXbX/m6w//Z+F","Table"),cc._RF.pop()},{}],TargetDonePnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"1d3a8MZVRNFEKdSHBowB7wl","TargetDonePnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/GameHelper"),l=t("../../common/helper/ResHelper"),u=t("../../common/helper/ViewHelper"),p=cc._decorator.ccclass,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetLayoutNode_=null,e.animNode_=null,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("TargetDonePnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){var e=this;cc.log("TargetDonePnlCtrl onEnter");var n=t.data,o=t.level,r=n.questList,i=r.some(function(t){return 0==t.type});this.animNode_.active=i,this.targetLayoutNode_.active=!i,i?(this.animNode_.Child("content/text",cc.Label).string=""+r[0].count,cc.tween(this.animNode_).set({scale:0}).to(.5,{scale:.4},{easing:cc.easing.backOut}).start()):(this.targetLayoutNode_.Items(n.questList,function(t,e){l.resHelper.loadTargetIcon(t,"level_item_gem_"+e.type,"level")}),cc.tween(this.targetLayoutNode_).set({scale:0}).to(.5,{scale:1},{easing:cc.easing.backOut}).start()),audioMgr.playSFX("common/well"),c.gameHelper.setTimeout(function(){e.close(),u.viewHelper.gotoWind("collect",{data:n,level:o})},1500)},e.prototype.onRemove=function(){cc.log("TargetDonePnlCtrl onRemove")},e.prototype.onClean=function(){cc.log("TargetDonePnlCtrl onClean")},i([p],e)}(mc.BasePnlCmpt);n.default=h,cc._RF.pop()},{"../../common/helper/GameHelper":"GameHelper","../../common/helper/ResHelper":"ResHelper","../../common/helper/ViewHelper":"ViewHelper"}],TargetShowPnlCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"6ae98c9/DlAjrI9so15VmAB","TargetShowPnlCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/helper/AnimHelper"),l=t("../../common/helper/ResHelper"),u=cc._decorator.ccclass,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.atNode_=null,e.targetLayoutNode_=null,e.targetRootNode_=null,e.scoreRootNode_=null,e.animNode_=null,e.levelJson=null,e.level=1,e.targetPos=null,e.callback=null,e}return r(e,t),e.prototype.listenEventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return this.setParam({isAct:!1,isMask:!1}),cc.log("TargetShowPnlCtrl onCreate"),[2]})})},e.prototype.onEnter=function(t){this.levelJson=t.data,this.level=t.level,this.targetPos=t.targetPos,this.callback=t.callback,this.playTargetAnim(),cc.log("TargetShowPnlCtrl onEnter")},e.prototype.onRemove=function(){cc.log("TargetShowPnlCtrl onRemove")},e.prototype.onClean=function(){cc.log("TargetShowPnlCtrl onClean")},e.prototype.playTargetAnim=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i,a,u,p=this;return s(this,function(s){switch(s.label){case 0:return t=this.levelJson.questList,e=t.some(function(t){return 0==t.type}),this.scoreRootNode_.active=e,this.targetRootNode_.active=!e,n=[],e?(this.animNode_.Child("content/text",cc.Label).string=""+t[0].count,n=[this.animNode_]):(this.targetRootNode_.Items(this.levelJson.questList,function(t,e){var n=t.Child("content");l.resHelper.loadTargetIcon(n,"level_item_gem_"+e.type,"level"),n.Child("text",cc.Label).string=""+e.count}),n=this.targetRootNode_.children),o=this.Child("bg"),r=this.Child("musk"),o.scaleY=0,o.opacity=255,r.opacity=0,cc.tween(o).to(.2,{scaleY:1}).start(),cc.tween(r).to(.2,{opacity:120}).start(),n.forEach(function(t){var e=t.Child("content"),n=e.scale;e.setScale(0),cc.tween(e).to(.5,{scale:n},{easing:cc.easing.backOut}).delay(1).start()}),[4,ut.wait(1.5,this)];case 1:return s.sent(),cc.tween(o).to(.2,{opacity:0}).start(),cc.tween(r).to(.2,{opacity:0}).start(),e?(a=this.atNode_.convertToWorldSpaceAR(cc.Vec2.ZERO),i=this.animNode_.parent.convertToNodeSpaceAR(a),[4,c.animHelper.flyOneTarget(this.animNode_,i)]):[3,3];case 2:return s.sent(),[3,5];case 3:return a=this.targetLayoutNode_.convertToWorldSpaceAR(cc.Vec2.ZERO),u=this.node.convertToNodeSpaceAR(a),[4,new Promise(function(t){cc.tween(p.targetRootNode_).to(.3,{x:u.x,y:u.y}).call(t).start()})];case 4:s.sent(),s.label=5;case 5:return audioMgr.playSFX("common/target_fly_to"),this.callback&&this.callback(),this.close(),[2]}})})},i([u],e)}(mc.BasePnlCmpt);n.default=p,cc._RF.pop()},{"../../common/helper/AnimHelper":"AnimHelper","../../common/helper/ResHelper":"ResHelper"}],TaskConditionObj:[function(t,e,n){"use strict";cc._RF.push(e,"10573aj9+NH+7U3f9aehHQl","TaskConditionObj"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../../../core/utils/EncValue"),r=t("../../common/helper/TaskHelper"),i=function(){function t(){this.id=0,this._count=new o.default(0),this._progress=new o.default(0),this.saveTid=!1,this.saveCount=!1,this.saveProgress=!1,this.got=!1}return t.prototype.init=function(t,e){void 0===e&&(e="QuestConfig");var n=assetsMgr.getJsonData(e,t);return!n&&t&&cc.error("!json id="+t),this.id=t,this.type=null==n?void 0:n.type,this.tid=(null==n?void 0:n.tid)||this.tid,this.count=(null==n?void 0:n.condition)||1,this.progress=0,this.saveProgress=r.taskHelper.isNeedProgress(this.type),this},t.prototype.fromString=function(t){if(!t)return null;this.id=0;var e=t.split(","),n=e[0],o=e[1],r=e[2];this.type=Number(n);var i=Number(o);return this.tid=isNaN(i)?o:i,this.count=Number(r),this},t.prototype.set=function(t,e){return this.tid=t,this.count=e,this.saveTid=!0,this.saveCount=!0,this},t.prototype.setTid=function(t,e){return this.tid=t,this.saveTid=!!e,this},t.prototype.setGot=function(t){return this.got=t,this},t.prototype.setCount=function(t,e){return this.count=t,this.saveCount=!!e,this},t.prototype.setSaveProgress=function(t){this.saveProgress=t},t.prototype.fromDB=function(t){if(t){var e=assetsMgr.getJsonData("QuestConfig",t.id);e&&(this.id=t.id,this.progress=t.progress||0,this.setTid(t.tid||this.tid,!!t.tid),this.setGot(t.got||this.got),this.type=null==e?void 0:e.type,this.tid=(null==e?void 0:e.tid)||this.tid,this.count=(null==e?void 0:e.condition)||1,this.saveProgress=!0)}return this},t.prototype.toDB=function(){return{id:this.id,progress:this.saveProgress?this.progress:void 0,tid:this.saveTid?this.tid:void 0,count:this.saveCount?this.count:void 0,got:this.got}},t.prototype.getObMap=function(){return{progress:["_progress","saveProgress"],count:["_count","saveCount"],tid:["tid","saveTid"]}},Object.defineProperty(t.prototype,"progress",{get:function(){return this._progress.value},set:function(t){this._progress.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._count.value},set:function(t){this._count.value=t},enumerable:!1,configurable:!0}),t.prototype.recordProgress=function(t,e){return this.type===t&&(this.progress+=e,!0)},t}();n.default=i,cc._RF.pop()},{"../../../core/utils/EncValue":"EncValue","../../common/helper/TaskHelper":"TaskHelper"}],TaskHelper:[function(t,e,n){"use strict";cc._RF.push(e,"ff03eSBdb9KW4hkGUKkChRx","TaskHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.taskHelper=void 0;var o=t("../../model/task/TaskConditionObj"),r=function(){function t(){this._global=null}return Object.defineProperty(t.prototype,"global",{get:function(){return this._global||(this._global=mc.modelMgr.get("global"))},enumerable:!1,configurable:!0}),t.prototype.stringToConditions=function(t){return t?t.split("|").filter(function(t){return!!t.trim()}).map(function(t){return(new o.default).fromString(t)}):[]},t.prototype.isNeedProgress=function(){return!0},t.prototype.checkTaskConditions=function(t){var e=this;return!(null==t?void 0:t.some(function(t){return!e.checkTaskCondition(t)}))},t.prototype.checkTaskCondition=function(t){return!t||!!this.isNeedProgress(t.type)&&t.progress>=t.count},t.prototype.recordProgress=function(){this.global},t.prototype.getTaskConditionProgress=function(t){return t?[Math.min(t.progress,t.count),t.count]:[0,0]},t.prototype.getNameByCond=function(){return""},t}();n.taskHelper=new r,cc.sys.isBrowser&&(window.taskHelper=n.taskHelper),cc._RF.pop()},{"../../model/task/TaskConditionObj":"TaskConditionObj"}],TopNotCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"7fed8Euc0VHHq5moTU6/zm5","TopNotCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator.ccclass,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rootNode_=null,e.addNode_=null,e.areaNode_=null,e}return r(e,t),e.prototype.eventMaps=function(){return[]},e.prototype.onCreate=function(){return a(this,void 0,void 0,function(){return s(this,function(){return cc.log("TopNotCtrl onCreate"),[2]})})},e.prototype.show=function(){this.adapterPos()},e.prototype.hide=function(){this.addNode_.active=!1},e.prototype.adapterPos=function(){if(cc.sys.platform==cc.sys.WECHAT_GAME){var t=wx.getMenuButtonBoundingClientRect(),e=wx.getSystemInfoSync(),n=this.node.parent.height*(t.bottom/e.screenHeight),o=this.addNode_.Component(cc.Widget),r=this.node.parent.width*(1-(t.left+.25*t.width)/e.screenWidth);o.top=n,o.right=r,o.isAbsoluteTop=!0,o.isAlignTop=!0,o.updateAlignment(),this.addNode_.active=!0}else this.addNode_.active=!1},i([c],e)}(mc.BaseNoticeCtrl);n.default=l,cc._RF.pop()},{}],TopTouchCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"46ce48ebJFIzrDsUZ+1LC9g","TopTouchCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../common/constant/Constant"),s=t("../../../common/event/EventType"),c=t("../../../common/helper/DatabaseHelper"),l=t("../../../common/helper/GameHelper"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchId=-1,e.clickAnimPool=[],e._temp_vec2_1=cc.v2(),e._temp_vec2_2=cc.v2(),e.lastClickAnimPos=cc.v2(),e}return r(e,t),e.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.node.SetSwallowTouches(!1)},e.prototype.onTouchStart=function(t){if(-1===this.touchId){this.touchId=t.getID();var e=t.getLocation(),n=this.node.convertToNodeSpaceAR(e);this.playClickAnim(n)}},e.prototype.onTouchMove=function(t){this.touchId,t.getID()},e.prototype.onTouchEnd=function(t){this.touchId===t.getID()&&(this.touchId=-1)},e.prototype.onTouchCancel=function(t){this.touchId===t.getID()&&(this.touchId=-1)},e.prototype.update=function(t){c.dbHelper.update(t),l.gameHelper.lastTopTouchTime<=0||l.gameHelper.now()-l.gameHelper.lastTopTouchTime>a.TOUCH_TIME_ON_HOOK&&(l.gameHelper.lastTopTouchTime=-1,eventMgr.emit(s.default.ENTER_ON_HOOK_STATE))},e.prototype.putClickAnim=function(t){t&&t.isValid&&(t.parent=null,this.clickAnimPool.push(t))},e.prototype.playClickAnim=function(t){var e=this,n=this.clickAnimPool.pop()||cc.instantiate(assetsMgr.getPrefab("CLICK_ANIM"));n&&(n.active=!0,n.parent=this.node,n.Component(sp.Skeleton).play("animation"),n.setPosition(t),this.lastClickAnimPos.set(t),ut.wait(.5,this).then(function(){return e.isValid&&e.putClickAnim(n)}))},i([p],e)}(cc.Component));n.default=h,cc._RF.pop()},{"../../../common/constant/Constant":"Constant","../../../common/event/EventType":"EventType","../../../common/helper/DatabaseHelper":"DatabaseHelper","../../../common/helper/GameHelper":"GameHelper"}],TouchHelper:[function(t,e,n){"use strict";cc._RF.push(e,"1a194oVsbFLxIBzIz/I2NgY","TouchHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.touchHelper=void 0;var o=function(){function t(){this.clickInfos=[],this.isClickGuest=!1}return t.prototype.addClickInfo=function(t){this.clickInfos.push(t)},t.prototype.removeClickInfo=function(t){this.clickInfos.remove("uuid",t.uuid)},t.prototype.getHitNodes=function(t){for(var e=[],n=this.clickInfos.length-1;n>=0;n--){var o=this.clickInfos[n];o&&o.isValid?o._hitTest(t)&&e.push(o):this.clickInfos.splice(n,1)}return e},t}();n.touchHelper=new o,cc.sys.isBrowser&&(window.touchHelper=n.touchHelper),cc._RF.pop()},{}],TwitterHelper:[function(t,e,n){"use strict";cc._RF.push(e,"d4b68ngQuJPgJdie9+5rl6t","TwitterHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.twitterHelper=void 0;var i=t("../event/JsbEvent"),a=function(){function t(){}return t.prototype.nativeLogin=function(){return o(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return[4,jsbHelper.call(i.default.TWITTER_LOGIN)];case 1:return"success"==(t=e.sent()||{}).result?[2,{userId:t.userId,avatarUrl:t.photoUrl,nickName:t.nickName}]:[2,{errcode:t.errCode||-10086,msg:t.msg}]}})})},t.prototype.nativeShare=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,jsbHelper.call(i.default.TWITTER_SHARE,t)];case 1:return[2,e.sent().result]}})})},t}();n.twitterHelper=new a,cc._RF.pop()},{"../event/JsbEvent":"JsbEvent"}],TxShanCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"52609rhQ/tIhIwv+E6ugA+V","TxShanCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.interval=cc.v2(),e.anim=null,e.isPlayInterval=!1,e.playInterval=0,e}return r(e,t),e.prototype.onLoad=function(){this.anim=this.getComponent(sp.Skeleton),this.isPlayInterval=this.interval.x>0&&this.interval.y>0,this.isPlayInterval&&this.anim.setCompleteListener(this.onPlayComplete.bind(this)),this.anim.loop=!this.isPlayInterval,this.play()},e.prototype.play=function(){this.playInterval=0,this.node.opacity=255,this.anim.animation="shan"+ut.random(1,6)},e.prototype.onPlayComplete=function(){this.isPlayInterval&&(this.anim.animation="",this.node.opacity=0,this.playInterval=ut.random(this.interval.x,this.interval.y))},e.prototype.update=function(t){this.playInterval<=0||!this.isPlayInterval||(this.playInterval-=t,this.playInterval<=0&&this.play())},i([c(cc.Vec2)],e.prototype,"interval",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],UserModel:[function(t,e,n){"use strict";cc._RF.push(e,"59c7cn3Wb1DqomnAfqsRqVv","UserModel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Enums"),l=t("../../common/crypto/CryptoHelper"),u=t("../../common/event/EventType"),p=t("../../common/helper/DatabaseHelper"),h=t("../../common/helper/GameHelper"),d=t("../../common/LocalConfig"),f=t("../../common/net/netMgr"),y=t("../../common/wx/WxHelper"),_=t("../../common/event/JsbEvent"),g=t("../../common/message/MessageHelper"),m=t("../../common/helper/ShareHelper"),v=t("../../common/shareParams/ShareParamsHelper"),b=t("../../common/facebook/FBInstantHelper"),w=60*ut.Time.Second;d.localConfig.release;var S=10*ut.Time.Second,C=5*ut.Time.Minute,T=3*ut.Time.Minute,A=(ut.Time.Minute,ut.Time.Minute,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dbName="user",e.serverTimeSyncTime=0,e.playTimeUpdateTime=0,e.recordCheckTime=0,e.syncServerWorking=!1,e.recordCheckWorking=!1,e.gm=!1,e.nickName="",e.avatarUrl="",e.diyAvatar="",e.uploadTime=0,e.signupTime=0,e.loginTime=0,e.appWxLogined=!0,e.shareEnterFg=!0,e.toAppTime=0,e.lastOfflineTime=0,e.showToApp=!1,e.showShareReward=!1,e.token=null,e.canDeblock=!1,e.age=0,e.nonagePlayTime=0,e.currNonagePlayTime=0,e.sessionId=null,e.sessionKey=null,e.logined=!1,e.logoutTime=0,e.party=0,e}return r(e,t),e.prototype.init=function(){var t=this,e=null;cc.game.on(cc.game.EVENT_HIDE,function(){var e=h.gameHelper.now();if(!h.gameHelper.isStop())if(e-t.toAppTime<20*ut.Time.Minute)t.uploadRecord(!0);else{if(m.shareHelper.isWorking()||h.gameHelper.ad.isWorking())return;t.uploadTime>ut.Time.Minute&&(t.uploadRecord(!0),t.uploadTime=0)}}),cc.game.on(cc.game.EVENT_SHOW,function(){e&&(h.gameHelper.clearTimeout(e),e=null),h.gameHelper.isStop()||(t.checkUserEnter(),t.serverTimeSyncTime=w)}),this.checkUserEnter()},e.prototype.checkUserEnter=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return(t=h.gameHelper.getEnterQuery())?(t.appToMini&&(e={},ut.isIos()?e.ios=1:ut.isAndroid()?e.android=1:e.unknow=1),t.uid&&t.uid!=this.uid&&this.shareEnterFg?h.gameHelper.now()-this.signupTime<240*ut.Time.Minute?[4,f.netMgr.post("share/onEnter",{uid:this.uid,enterInfo:t})]:[3,2]:[3,3]):[2];case 1:return 0===n.sent().status&&(this.shareEnterFg=!1),[3,3];case 2:this.shareEnterFg=!1,n.label=3;case 3:return[2]}})})},e.prototype.updatePlayTime=function(t){t=Math.floor(1e3*t),this.playTimeUpdateTime+=t,null==this.adTime?this.adTime=t:this.adTime+=t},e.prototype.update=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return this.logined?(t=Math.floor(1e3*t),this.uploadTime+=t,this.playTimeUpdateTime+=t,this.playTimeUpdateTime>=S&&(null==this.playTime&&(this.playTime=0),this.playTime+=this.playTimeUpdateTime,this.playTimeUpdateTime=0),this.serverTimeSyncTime+=t,this.serverTimeSyncTime>=w&&(this.syncServerWorking||(this.syncServerWorking=!0,this.syncServerWorking=!1,this.serverTimeSyncTime=0)),this.recordCheckTime+=t,this.recordCheckTime>=C&&h.gameHelper.now()-this.lastTimeRecord>=T?this.recordCheckWorking?[3,4]:(this.recordCheckWorking=!0,[4,this.checkRecord()]):[3,4]):[2];case 1:return(e.sent()||{}).state!=c.RecordState.UPLOAD?[3,3]:[4,this.uploadRecord()];case 2:e.sent(),e.label=3;case 3:this.recordCheckWorking=!1,this.recordCheckTime=0,e.label=4;case 4:return[2]}})})},e.prototype.login=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r,i;return s(this,function(a){switch(a.label){case 0:return e={},n=Date.now(),ut.isWechatOrQQ()?[4,y.wxHelper.login(e)]:[3,2];case 1:return t=a.sent(),[3,6];case 2:return ut.isMobile()?[4,jsbHelper.getPackageSign()]:[3,5];case 3:return r=a.sent(),e.sign=r,(null==(i=v.shareParamsHelper.getAwakeParams())?void 0:i.uid)&&(e.launchInfo=i),[4,f.netMgr.post("login/applogin",e)];case 4:return t=a.sent(),o=Date.now()-n,[3,6];case 5:return ut.isFBInstant()?((null==(i=b.fbInstantHelper.getAwakeParams())?void 0:i.uid)&&(e.launchInfo=i),[2,this.fbInstantLogin(e)]):d.localConfig.isTestServer?[2,this.webLogin()]:[2,{status:0}];case 6:return[4,this.loginHandle(t,{costTime:o})];case 7:return[2,a.sent()]}})})},e.prototype.wxRelogin=function(t){return void 0===t&&(t=3),a(this,void 0,Promise,function(){var e,n,o,r,i,a,c,l,u,p;return s(this,function(s){switch(s.label){case 0:return[4,y.wxHelper.getCode()];case 1:return e=s.sent(),[4,y.wxHelper.getUserInfo()];case 2:return(n=s.sent())&&e?[4,y.wxHelper.getBaseUserInfo()]:[2,!1];case 3:return o=s.sent(),r=o[0],i=o[1],a=n.encryptedData,c=n.iv,l=h.gameHelper.getHeart(),u="login/wxRelogin","undefined"!=typeof qq&&(u="login/qqRelogin"),[4,f.netMgr.get(u,{code:e,encryptedData:a,iv:c,uid:this.uid,starSum:l,nickName:r,avatarUrl:i},null,1)];case 4:return(p=s.sent())&&p.uid?(this.uid!=p.uid?(this.uid=p.uid,h.gameHelper.gameRestart()):(this.nickName=r,this.avatarUrl=i,this.diyAvatar||(this.diyAvatar=i)),[2,!0]):[3,5];case 5:return t>0?[4,ut.wait(1)]:[3,8];case 6:return s.sent(),[4,this.wxRelogin(t-1)];case 7:return[2,s.sent()];case 8:return[2,!1]}})})},e.prototype.webLogin=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t={},[4,f.netMgr.get("login/web",t)];case 1:return e=n.sent(),[2,this.loginHandle(e)]}})})},e.prototype.fbInstantLogin=function(t){return a(this,void 0,void 0,function(){var e,n,o;return s(this,function(r){switch(r.label){case 0:return(e=b.fbInstantHelper.login()).errcode?[2,{status:e.errcode,reqData:e}]:((n=storageMgr.getOrgItem("__@FBINSTANT_OPENID_"))&&""!==n&&n!==e.userId&&(p.dbHelper.clear(),h.gameHelper.gameRestart()),storageMgr.setOrgItem("__@FBINSTANT_OPENID_",e.userId),(t=Object.assign(e,t)).uid&&delete t.userId,[4,f.netMgr.get("login/fbInstantLogin",t)]);case 1:return o=r.sent(),[2,this.loginHandle(o)]}})})},e.prototype.checkRecord=function(){return a(this,void 0,Promise,function(){var t,e;return s(this,function(){return this.uid?(t=h.gameHelper.getHeart(),e=this.playTime,[2,f.netMgr.get("record/check",{uid:this.uid,starSum:t,playTime:e})]):[2,null]})})},e.prototype.uploadRecord=function(t,e,n){return void 0===t&&(t=!1),void 0===e&&(e=1),void 0===n&&(n=3),a(this,void 0,Promise,function(){var o,r,i,a,c;return s(this,function(s){switch(s.label){case 0:if(o=f.netMgr.getServerTime(),!(!(r=this.lastTimeRecord)||o-r>=T||t))return[3,6];i=this.getStorageInfo(),s.label=1;case 1:return a=h.gameHelper.getVersion(),[4,f.netMgr.post("record/upload",{uid:this.uid,verifyCode:"",record:i,gameVer:a,checkType:e},null,1)];case 2:return(c=s.sent())?(this.lastTimeRecord=f.netMgr.getServerTime(),[2,c]):[3,3];case 3:return n>0?[4,ut.wait(.5)]:[3,5];case 4:s.sent(),n--,s.label=5;case 5:if(n>0)return[3,1];s.label=6;case 6:return[2,{status:-1002}]}})})},e.prototype.downloadRecord=function(t){return a(this,void 0,Promise,function(){return s(this,function(){return this.uid?[2,this.downloadRecordByUid(this.uid,t)]:(lplog.error("downloadRecord no uid"),[2,{status:-1001}])})})},e.prototype.downloadRecordByUid=function(t,e){return a(this,void 0,void 0,function(){var n,o,r;return s(this,function(i){switch(i.label){case 0:return n=null,e||(n=this.getStorageInfo()),o=h.gameHelper.getVersion(),[4,f.netMgr.post("record/download",{uid:t,verifyCode:"",clientRecord:n,gameVer:o,deviceId:void 0},null,1)];case 1:return(r=i.sent())?0==r.status?r.record?(storageMgr.setStorageInfo(r.record,r.version)&&f.netMgr.updateData(),[2,{status:0}]):[2,{status:-1002}]:1==r.status?[2,{status:0}]:[2,{status:r.status}]:[2,{status:-1003}]}})})},e.prototype.getStorageInfo=function(){return JSON.stringify(storageMgr.getStorageInfo())},e.prototype.getCode=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2,"jxXGNLoJhKQGJYKL"]})})},e.prototype.getType=function(){return ut.isWechatOrQQ()?"undefined"!=typeof qq?"qq":"wx":"native"},e.prototype.isGuest=function(){return null==this.openid},e.prototype.getUid=function(){return this.uid},e.prototype.getServerId=function(){return this.serverId},e.prototype.getOpenId=function(){return this.openid},e.prototype.getPlayTime=function(){return this.playTime||0},e.prototype.isGM=function(){return this.gm},e.prototype.getAppUserType=function(){return this.userType},e.prototype.isLoginedAppWx=function(){return this.appWxLogined},e.prototype.getLastOfflineTime=function(){return this.lastOfflineTime},e.prototype.isCanDeblock=function(){return this.canDeblock},e.prototype.isAdult=function(){return this.age>=18},e.prototype.getNonagePlayTime=function(){return this.nonagePlayTime},e.prototype.getLoginTime=function(){return this.loginTime},e.prototype.getSessionId=function(){return this.sessionId},e.prototype.getSessionKey=function(){return this.sessionKey},e.prototype.getIndexId=function(){return this.index_id},e.prototype.getLoginoutTime=function(){return this.logoutTime},e.prototype.getNickName=function(){return this.nickName},e.prototype.setNickName=function(t){this.nickName=t},e.prototype.setAvatarUrl=function(t){this.diyAvatar=t},e.prototype.getBaseUserInfo=function(){return{uid:this.uid,nickName:this.nickName,avatarUrl:this.avatarUrl,diyAvatar:""}},e.prototype.syncLoginInfo=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2,{status:0}]})})},e.prototype.loginHandle=function(t,e){return void 0===e&&(e={}),a(this,void 0,void 0,function(){var n;return s(this,function(){return e.sdk,t?t.status?-1==t.status?(this.uid=null,console.error("\u7528\u6237\u4e0d\u5b58\u5728\uff0c\u91cd\u65b0\u8d70\u4e09\u65b9\u767b\u5f55",t),ut.isMobile()?(h.gameHelper.gameRestart(),[2,{status:-1}]):[2,this.login()]):[2,t]:t.cheater?[2,{status:0,cheater:t.cheater}]:(t.uid&&(this.uid=t.uid),this.uid?(t.tokenExpire?this.setToken(""):t.token&&this.setToken(t.token),t.party?this.party=t.party:this.party=0,this.openid=t.openid,this.serverId=t.serverId,this.gm=t.gm,this.userType=t.userType,this.nickName=t.nickName||"",this.avatarUrl=t.avatarUrl||"",this.diyAvatar=t.diyAvatar||"",this.signupTime=t.signupTime,this.appWxLogined=t.appWxLogined,this.canDeblock=t.canDeblock||!1,this.lastOfflineTime=t.updateTime||t.time,this.logoutTime=t.logoutTime,this.age=t.age||0,this.nonagePlayTime=t.nonagePlayTime||0,h.gameHelper.isGm()?this.loginTime=Date.now():this.loginTime=t.loginTime||Date.now(),this.sessionId=t.sessionId,this.index_id=t.index_id,t.sessionKey&&(this.sessionKey=t.sessionKey),(n=t.syncInfo)&&n.state!=c.LoginSyncState.SAME&&n.state!=c.LoginSyncState.SYNC||(this.logined=!0),this.emit(u.default.OPENID_CHANGE,this.openid),this.gm&&ut.isWechatOrQQ()&&y.wxHelper.uploadScoce(0),this.checkLoginReport(t),storageMgr.saveNumber("last_login_time",this.loginTime),[2,{status:0,syncInfo:n}]):[2,{status:-1002}]):[2,{status:-504}]})})},e.prototype.reloginHandle=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return t?t.uid?t.uid!=this.uid?(this.uid=t.uid,h.gameHelper.gameRestart(),[2,{status:0}]):[2,this.loginHandle(t)]:[2,{status:t.status||-503}]:[2,{status:-504}]})})},e.prototype.checkLoginReport=function(t){if(ut.isMobile()&&!h.gameHelper.isGLobal()&&t.isNew&&(jsbHelper.call(_.default.REPORT_REGISTER),jsbHelper.call(_.default.PANGLE_EVENT,{eventId:"register"})),ut.isMobile()&&h.gameHelper.isGLobal()){var e=storageMgr.loadNumber("last_login_time");if(e){var n=new Date(e),o=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0).getTime();n=new Date(this.loginTime);var r=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0).getTime();n=new Date(this.signupTime);var i=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0).getTime();Math.floor(Math.max(r-o,0)/ut.Time.Day),Math.floor(Math.max(r-i,0)/ut.Time.Day),storageMgr.loadNumber("loginDayCounts")}}},e.prototype.downloadUserDataByUid=function(t){return a(this,void 0,Promise,function(){var e,n,o,r;return s(this,function(i){switch(i.label){case 0:return[4,f.netMgr.get("record/downloadByUid",{uid:this.uid,downloadUid:t,gameVer:h.gameHelper.getVersion()})];case 1:if(e=i.sent()||{status:-1},n=e.status,o=e.record,r=e.baseInfo,0!=n||!o)return[2,{status:n,baseInfo:null,record:null}];try{return[2,{status:n,baseInfo:r,record:JSON.parse(l.cryptoHelper.aseDecrypt(o,this.uid))}]}catch(a){return[2,{status:n,baseInfo:null,record:null}]}return[2]}})})},e.prototype.roomLike=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,f.netMgr.post("room/like",{uid:this.uid,toUid:t,roomId:e})];case 1:return[2,(n.sent()||{status:-1}).status]}})})},e.prototype.getRoomlikeList=function(t){return a(this,void 0,void 0,function(){var e,n,o;return s(this,function(r){switch(r.label){case 0:return[4,f.netMgr.get("room/likeInfo",{uid:this.uid,roomId:t})];case 1:return e=r.sent()||{},n=e.status,o=e.data,0!=n?(lplog.error("\u670d\u52a1\u5668\u9519\u8bef",n),[2,null]):[2,o]}})})},e.prototype.uploadRoomPlan=function(t,e,n){return a(this,void 0,void 0,function(){var o,r,i;return s(this,function(a){switch(a.label){case 0:return o=l.cryptoHelper.md5(n),r=storageMgr.loadString(this.uid+"_"+t+"_"+e),[4,f.netMgr.post("room/savePlan",{uid:this.uid,content:n,md5:o,oldMD5:r})];case 1:return 0==(i=(a.sent()||{status:-1}).status)&&storageMgr.saveString(this.uid+"_"+t+"_"+e,o),[2,i]}})})},e.prototype.mmjTougao=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,f.netMgr.post("motherMsg/submit",{uid:this.uid,content:t})];case 1:return[2,(e.sent()||{status:-1}).status]}})})},e.prototype.debugCopy=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c,l,u,d,y,_;return s(this,function(s){switch(s.label){case 0:return e=this.uid,[4,f.netMgr.get("record/debug_copy",{uid:e,targetId:t})];case 1:if(n=s.sent(),o=n.status,r=n.record,0!=o)return lplog.error("\u670d\u52a1\u5668\u9519\u8bef",o),[2];if(!r)return lplog.error("\u627e\u4e0d\u5230\u7528\u6237"),[2];for(_ in r=JSON.parse(r),i=[],a={},r)_.startsWith("hotel_")&&-1==_.indexOf("debug")&&((c=_.split("hotel_"))[0],l=c[1],u=mc.GameNameSpace+"_"+l,a[u]=r[_],i.push(_));for(d=0,y=i;d<y.length;d++)_=y[d],delete r[_];return Object.assign(r,a),r=JSON.stringify(r),p.dbHelper.clear(),storageMgr.setStorageInfo(r,1)&&h.gameHelper.gameRestart(),[2]}})})},e.prototype.debugCopyTest=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i,a,c,u,d,y,_,g;return s(this,function(s){switch(s.label){case 0:return e=this.uid,[4,f.netMgr.get("record/downloadByUid",{uid:e,downloadUid:t,gameVer:h.gameHelper.getVersion()})];case 1:if(n=s.sent()||{status:-1},o=n.status,r=n.record,0!=o)return lplog.error("\u670d\u52a1\u5668\u9519\u8bef",o),[2];if(!r)return lplog.error("\u627e\u4e0d\u5230\u7528\u6237"),[2];for(g in r=JSON.parse(l.cryptoHelper.aseDecrypt(r,this.uid)),i=[],a={},r)g.startsWith("hotel_")&&-1==g.indexOf("debug")&&((c=g.split("hotel_"))[0],u=c[1],d=mc.GameNameSpace+"_"+u,a[d]=r[g],i.push(g));for(y=0,_=i;y<_.length;y++)g=_[y],delete r[g];return Object.assign(r,a),r=JSON.stringify(r),p.dbHelper.clear(),storageMgr.setStorageInfo(r,1)&&h.gameHelper.gameRestart(),[2]}})})},e.prototype.checkLogin=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.isShowToApp=function(){return this.showToApp},e.prototype.isShowShareReward=function(){return this.showShareReward},e.prototype.onToApp=function(){this.toAppTime=h.gameHelper.now()},e.prototype.getToken=function(){return this.token||(this.token=storageMgr.getOrgItem("__@USER_TOKEN")),this.token},e.prototype.getSignupTime=function(){return this.signupTime},e.prototype.setToken=function(t){storageMgr.setOrgItem("__@USER_TOKEN",t),this.token=t},e.prototype.genToken=function(){return a(this,void 0,void 0,function(){return s(this,function(){return[2]})})},e.prototype.reconnect=function(){return a(this,void 0,void 0,function(){var t,e;return s(this,function(n){switch(n.label){case 0:return t={},[4,f.netMgr.post("login/reconnect",t)];case 1:return e=(n.sent()||{status:-504}).sessionKey,lplog.info("reconnect",e),e?(this.sessionKey=e,[2,!0]):[2,!1]}})})},e.prototype.getTempUid=function(){var t="__@tempUid",e=storageMgr.getOrgItem(t);return e||(e=this.uid||g.messageHelper.deviceToken||Date.now()+"_"+ut.getRandomString(10),storageMgr.setOrgItem(t,e)),e},i([ut.dataProp],e.prototype,"uid",void 0),i([ut.dataProp],e.prototype,"playTime",void 0),i([ut.dataProp],e.prototype,"adTime",void 0),i([ut.dataProp],e.prototype,"serverId",void 0),i([ut.dataProp],e.prototype,"lastTimeRecord",void 0),i([ut.dataProp],e.prototype,"index_id",void 0),i([ut.addLock],e.prototype,"checkUserEnter",null),i([mc.addmodel("user")],e)}(mc.BaseModel));n.default=A,cc._RF.pop()},{"../../common/LocalConfig":"LocalConfig","../../common/constant/Enums":"Enums","../../common/crypto/CryptoHelper":"CryptoHelper","../../common/event/EventType":"EventType","../../common/event/JsbEvent":"JsbEvent","../../common/facebook/FBInstantHelper":"FBInstantHelper","../../common/helper/DatabaseHelper":"DatabaseHelper","../../common/helper/GameHelper":"GameHelper","../../common/helper/ShareHelper":"ShareHelper","../../common/message/MessageHelper":"MessageHelper","../../common/net/netMgr":"netMgr","../../common/shareParams/ShareParamsHelper":"ShareParamsHelper","../../common/wx/WxHelper":"WxHelper"}],Utils:[function(t,e,n){"use strict";cc._RF.push(e,"de9065oPUdAX6JvWpmJLpr3","Utils");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};function i(t,e){void 0===e&&(e="mm:ss");var n=t/1e3;if(/(d+)/i.test(e)){var o=Math.floor(n/86400);n-=86400*o,e=e.replace(/(d+)/g,1===RegExp.$1.length?o+"":f(o))}if(/(h+)/i.test(e)){var r=Math.floor(n/3600);n-=3600*r,e=e.replace(/(h+)/g,1===RegExp.$1.length?r+"":f(r))}if(/(m+)/i.test(e)){var i=Math.floor(n/60);n-=60*i,e=e.replace(/(m+)/g,1===RegExp.$1.length?i+"":f(i))}return/(s+)/i.test(e)&&(e=e.replace(/(s+)/g,1===RegExp.$1.length?Math.floor(n)+"":f(Math.floor(n)))),e}function a(t,e){return void 0===e&&(e=t,t=0),t>=e?t:Math.floor(Math.random()*(Math.max(e-t,0)+1))+t}function s(t){return Math.sin(cc.misc.degreesToRadians(t))}function c(t){return Math.cos(cc.misc.degreesToRadians(t))}Object.defineProperty(n,"__esModule",{value:!0}),n.util=void 0;var l=cc.v2(),u=cc.v3(),p=cc.v2(),h=cc.mat4(),d={};function f(t,e){void 0===e&&(e=2);var n=e-t.toString().length;return n<=0?t+"":(d[n]||(d[n]=new Array(n+1).join("0")),d[n]+t)}var y=1,_=0,g=[];window.ut={Time:{Day:864e5,Hour:36e5,Minute:6e4,Second:1e3},MAX_VALUE:0x4000000000000,MIN_VALUE:-0x4000000000000,now:function(){return Date.now()},millisecondToString:function(t){var e=Math.floor(t/ut.Time.Day);return e>0?e+1+" day":this.millisecondFormat(t,"hh:mm:ss")},timediff:function(t,e){var n=(e=new Date(this.now()).getFullYear()+"-"+e).split("-"),o=n[0],r=n[1],i=n[2],a=n[3],s=n[4],c=n[5];return a=a||"00",s=s||"00",c=c||"00",new Date(o+"/"+r+"/"+i+" "+a+":"+s+":"+c).getTime()-t},timediff2:function(t,e){var n=e.split("-"),o=n[0],r=n[1],i=n[2],a=n[3],s=n[4],c=n[5];return a=a||"00",s=s||"00",c=c||"00",new Date(o+"/"+r+"/"+i+" "+a+":"+s+":"+c).getTime()-t},millisecondFormat:i,secondFormat:function(t,e){return void 0===e&&(e="mm:ss"),i(1e3*t,e)},dateFormat:function(t,e){var n=e?new Date(e):new Date,o={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),"S+":n.getMilliseconds()};for(var r in/(y+)/i.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length))),o)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?String(o[r]):f(o[r])));return t},formatDuring:function(t){return{days:Math.floor(t/86400),hours:Math.floor(t%86400/3600),minutes:Math.floor(t%3600/60),seconds:t%60}},initialUpperCase:function(t){return t.length>0?t[0].toUpperCase()+t.substring(1,t.length):t},simplifyMoneyCh:function(t,e){void 0===e&&(e=1e3);var n=Math.abs(t);return n>=1e8&&n>=e?parseFloat((t/1e8).toFixed(2))+"\u4ebf":n>=1e4&&n>=e?parseFloat((t/1e4).toFixed(2))+"\u4e07":n>=1e3&&n>=e?parseFloat((t/1e3).toFixed(2))+"\u5343":t+""},simplifyMoneyEn:function(t,e){void 0===e&&(e=1e3);var n=Math.abs(t);return n<e?parseFloat(t.toFixed(2))+"":n>=1e12?parseFloat((t/1e12).toFixed(2))+"T":n>=1e9?parseFloat((t/1e9).toFixed(2))+"G":n>=1e6?parseFloat((t/1e6).toFixed(2))+"M":parseFloat((t/1e3).toFixed(2))+"K"},simplifyMoney:function(t,e,n){void 0===e&&(e=1e6),void 0===n&&(n=2);var o=Math.abs(t);return o>=1e8&&o>=e?parseFloat((t/1e6).toFixed(n))+"M":o>=1e6&&o>=e?parseFloat((t/1e3).toFixed(n))+"K":t+""},nameFormator:function(t,e,n){if(void 0===n&&(n="..."),t.length<=e)return t;var o=0,r=0;e*=2;for(var i=0;i<t.length;i++){var a=t.charCodeAt(i)>255?2:1;if(r+a<=e-2&&(o+=1),(r+=a)>e)break}return r<=e?t:t.substr(0,o)+n},formatNumberByComma:function(t){return t.toString().replace(/\d(?=(?:\d{3})+\b)/g,"$&,")},random:a,chance:function(t,e){return void 0===e&&(e=100),t>0&&a(0,100*e-1)<t*e},randomRange:function(t,e){return Math.floor(Math.random()*t)+Math.floor(Math.random()*e)},randomIndex:function(t,e,n){if(0===t)return-1;var o=[],r=e;n=Array.isArray(n)?n:[n],r=(r=r||1)>t?t:r;for(var i=0;i<t;i++)-1===n.indexOf(i)&&o.push(i);for(var s=[];o.length>0&&s.length<r;){var c=a(o.length-1);s.push(o.splice(c,1)[0])}return 0===s.length?-1:1===e?s[0]:s},randomIndexByWeight:function(t,e){if(!t||!Array.isArray(t)||!t.length)return-1;var n=t.reduce(function(t,n){return t+100*Number(e?n[e]:n)},0);if(0===n)return a(0,t.length-1);for(var o=a(0,n-1),r=0,i=t.length;r<i;r++){var s=100*(e?t[r][e]:t[r]);if(o<s)return r;o-=s}return a(0,t.length-1)},randomArray:function(t){if(t&&t.length>0)for(var e=0;e<t.length;e++){var n=Math.floor(Math.random()*t.length),o=t[n];t[n]=t[e],t[e]=o}return t},randomNoRepeat:function(t,e){var n=[];if(!t||t.length<=0)return n;if(t.length<e)return t;for(var o=t.length,r=0,i=0;i<e;i++){do{r=Math.floor(Math.random()*o)}while(null==t[r]);n.push(t[r]),t[r]=null}return n},randomNoRepeatByWeight:function(t,e,n){var o=[];if(!t||t.length<=0)return o;if(t.length<e)return t;for(var r=0,i=0;i<e;i++){do{r=ut.randomIndexByWeight(t,n)}while(null==t[r]);o.push(t[r]),t.splice(r,1)}return o},getAngle:function(t,e){return cc.misc.radiansToDegrees(Math.atan2(e.y-t.y,e.x-t.x))},normAngle:function(t){return t>0?t-360:t},sin:s,cos:c,angleToPoint:function(t,e,n){return(n=n||l).x=c(t)*e,n.y=s(t)*e,n},convertToNodeAR:function(t,e,n){return n=n||p.set2(0,0),(null==t?void 0:t.isValid)&&(null==e?void 0:e.isValid)?(t.getWorldMatrix(h).getTranslation(u),e.convertToNodeSpaceAR(u.toVec2(),n)):n},convertToNodePosAR:function(t,e,n,o,r){void 0===r&&(r=!0),o=o||p.set2(0,0);var i=t.getWorldMatrix(h);if(n?cc.Vec2.transformMat4(u,cc.v3(n),i):i.getTranslation(u),r){var a=cc.Camera.findCamera(t),s=cc.Camera.findCamera(e);a!=s&&(a.getWorldToScreenPoint(u,u),s.getScreenToWorldPoint(u,u))}return e.convertToNodeSpaceAR(u.toVec2(),o)},pad:f,decomposeNumberToTypes:function(t,e,n){void 0===e&&(e=[1e5,1e4,1e3,100,10,1]);var o,r,i=n||{};e.sort(function(t,e){return e-t});for(var a=0;a<e.length;a++)o=e[a],(r=Math.floor(t/e[a]))>=1&&(i[o]=r,t-=o*r);return t>0&&(r=i[o=e[e.length-1]]||0,i[o]=r?r+1:1),i},stringToVec2:function(t,e){if(void 0===e&&(e=","),!t)return cc.v2();var n=t.split(e),o=n[0],r=n[1];return cc.v2(parseFloat(o),parseFloat(r))},stringToNumbers:function(t,e){return void 0===e&&(e="|"),null==t||""===t?[]:"number"==typeof t?[t]:t.split(e).filter(function(t){return""!==t.trim()}).map(function(t){return Number(t)})},normalizeNumber:function(t){return 0===t?0:t/Math.abs(t)},numberToString:function(t){return(t>=0?"+":"")+t},stringFormat:function(t,e){return t&&e&&0!==e.length?(e.forEach(function(e,n){return t=t.replace(new RegExp("\\{"+n+"\\}","g"),e)}),t):t},wait:function(t,e){return o(this,void 0,Promise,function(){var n;return r(this,function(){return t<=0?[2,Promise.resolve()]:(n=e||cc.Canvas.instance,[2,new Promise(function(e){return n.scheduleOnce(e,t)})])})})},waitTimeout:function(t){return o(this,void 0,Promise,function(){return r(this,function(){return t<=0?[2,Promise.resolve()]:[2,new Promise(function(e){return setTimeout(e,t)})]})})},waitNextFrame:function(t,e){return o(this,void 0,Promise,function(){return r(this,function(){return t=Math.max(1,t||1),[2,new Promise(function(n){var o=e||cc.Canvas.instance;o?o.schedule(function e(){(t-=1)<=0&&(o.unschedule(e),n())},0):(console.warn("no canvas waitNextFrame"),setTimeout(function(){n()},0))})]})})},colorFromHEX:function(t){return cc.Color.WHITE.fromHEX(t)},uid:function(){var t=Date.now(),e=1e3*t+1;return t!==_?(_=t,y=0):y>=999?(y=0,e=1e3*(_=t+1)+1):e+=y+=1,e+""},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isEmptyObject:function(t){if(!t)return!0;for(var e in t)return!1;return!0},cloneObject:function(t){var e={};for(var n in t)e[n]=t[n];return e},deepClone:function t(e,n){if(void 0===n&&(n=!1),!e)return null;n||(g=[]);var o=Array.isArray(e)?[]:{};if(e&&"object"==typeof e)for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];i&&"object"==typeof i?-1===g.indexOf(i)&&(g.push(i),o[r]=t(i,!0)):o[r]=i}return n||(g=null),o},compareObject:function t(e,n,o,r){if(void 0===o&&(o=[]),void 0===r&&(r=[]),isNaN(e)&&isNaN(n)&&"number"==typeof e&&"number"==typeof n)return!0;if(e===n)return!0;if(!(e instanceof Object&&n instanceof Object))return!1;if(e.isPrototypeOf(n)||n.isPrototypeOf(e))return!1;if(e.constructor!==n.constructor)return!1;if(e.prototype!==n.prototype)return!1;if(o.indexOf(e)>-1||r.indexOf(n)>-1)return!1;var i;for(i in n)if(void 0!==n[i]){if(n.hasOwnProperty(i)!==e.hasOwnProperty(i))return!1;if(typeof n[i]!=typeof e[i])return!1}for(i in e)if(void 0!==e[i]){if(n.hasOwnProperty(i)!==e.hasOwnProperty(i))return!1;if(typeof n[i]!=typeof e[i])return!1;var a=typeof e[i];if("object"===a||"function"===a){if(o.push(e),r.push(n),!t(e[i],n[i],o,r))return!1;o.pop(),r.pop()}else if(e[i]!==n[i])return!1}return!0},items:function(t,e,n,o,r){for(var i=0,a=e.length,s=t.length;i<s;i++)i<a?r(t[i],e[i],i):t[i].active=!1;for(;i<a;i++){var c=cc.instantiate2(n,o);r(c,e[i],i),t.push(c)}},loopValue:function(t,e){return t<0?e-1:t>=e?0:t},setKeepScreenOn:function(){},boolToNumber:function(t){return t?1:0},httpRequest:function(t,e,n){return o(this,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(o){if("POST"!==(t=t.toUpperCase())&&"GET"!==t)return lplog.info("method error"),o(null);var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&200===r.status&&o(r.responseText)},r.timeout=5e3,r.ontimeout=function(){lplog.info("http timeout"),o(null)},r.onerror=function(){o(null)},r.open(t,e,!0),"POST"===t&&n?(r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(n))):r.send(null)})]})})},isMobile:function(){return cc.sys.isNative&&(cc.sys.os==cc.sys.OS_ANDROID||cc.sys.os==cc.sys.OS_IOS)},isWechatOrQQ:function(){return cc.sys.platform===cc.sys.WECHAT_GAME||"undefined"!=typeof qq},isWechatGame:function(){return cc.sys.platform===cc.sys.WECHAT_GAME&&"undefined"==typeof qq},isQQ:function(){return"undefined"!=typeof qq},isIos:function(){return cc.sys.os==cc.sys.OS_IOS},isAndroid:function(){return cc.sys.os==cc.sys.OS_ANDROID},getRandomString:function(t){void 0===t&&(t=8);for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,o="",r=0;r<t;r++)o+=e.charAt(Math.floor(Math.random()*n));return o},compareVersion:function(t,e){if(null==t||null==e)return!1;var n=t.split("."),o=e.split(".");return parseInt(n[0])<parseInt(o[0])||!(parseInt(n[0])>parseInt(o[0]))&&(parseInt(n[1])<parseInt(o[1])||!(parseInt(n[1])>parseInt(o[1]))&&parseInt(n[2])<parseInt(o[2]))},newArray:function(t,e){return new Array(t).fill(e)},promiseMap:function(t,e){return o(this,void 0,Promise,function(){var n;return r(this,function(o){switch(o.label){case 0:return n=t,e&&(n=t.map(e)),[4,Promise.all(n)];case 1:return[2,o.sent()]}})})},addLock:function(t,e,n){var i="__lock_"+e;t&&!e&&(i=t);var a=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,void 0,function(){var e;return r(this,function(n){switch(n.label){case 0:if(this[i])return[2];this[i]=!0,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,a.apply(this,t)];case 2:return e=n.sent(),this[i]=!1,[2,e];case 3:return this[i]=!1,[7];case 4:return[2]}})})},n},dataProp:function(t,e){function n(t,e){Object.defineProperty(t,e,{get:function(){var t=null;if(!this._dbName)return console.error("need dbName!!!"),t;var n=storageMgr.loadObject(this._dbName)||{};return"string"==typeof n&&(n=JSON.parse(n)),n[e]},set:function(t){if(this._dbName){var n=storageMgr.loadObject(this._dbName)||{};"string"==typeof n&&(n=JSON.parse(n)),t!=n[e]&&(n[e]=t,storageMgr.saveObject(this._dbName,n))}else console.error("need dbName!!!")},enumerable:!0,configurable:!0})}if(void 0===e)return n;n(t,e)},toFloor:function(t){return t<10?Math.floor(t):t<1e3?Math.floor(10*Math.floor(.1*t)):t<1e5?Math.floor(100*Math.floor(.01*t)):Math.floor(1e3*Math.floor(.001*t))},queueLast:function(t,e,n){var i="__queueLast_"+e;t&&!e&&(i=t);var a=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,void 0,function(){var e,n,s,c=this;return r(this,function(){return this[i]||(this[i]=[]),(e=this[i])||(this[i]=[]),n=new Promise(function(n){e.push({args:t,resolve:n})}),e.length>1?[2,n]:((s=function(){return o(c,void 0,void 0,function(){var t,n,o,i;return r(this,function(r){switch(r.label){case 0:return t=e.length,(n=e[t-1])?[4,a.apply(this,n.args)]:[2];case 1:for(o=r.sent(),i=0;i<t;i++)e[i].resolve(o);return e.splice(0,t),s(),[2]}})})})(),[2,n])})})},n},queueEvery:function(t,e,n){var i="__queueEvery_"+e;t&&!e&&(i=t);var a=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,void 0,function(){var e,n,s=this;return r(this,function(){return this[i]||(this[i]=[]),e=this[i],n=new Promise(function(n){e.push({args:t,resolve:n})}),e.length>1?[2,n]:(o(s,void 0,void 0,function(){var t,n,o,i,s;return r(this,function(r){switch(r.label){case 0:if(!(e.length>0))return[3,5];t=e.shift(),n=t.args,o=t.resolve,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.apply(this,n)];case 2:return i=r.sent(),o(i),[3,4];case 3:return s=r.sent(),lplog.error(s),[3,4];case 4:return[3,0];case 5:return[2]}})}),[2,n])})})},n},callOnce:function(t,e,n){var o="__callOnce_"+e;t&&!e&&(o=t);var r=n.value;return n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return void 0!==this[o]?this[o]:(this[o]=r.apply(this,t),this[o])},n},joinPath:function(t,e){return t?e?("/"!=t[t.length-1]&&"/"!=e[0]||(t=t.substring(0,t.length-1)),"/"==e[0]&&(e=e.substring(1)),t+"/"+e):t:e},isFBInstant:function(){return"undefined"!=typeof FBInstant},xyToIndex:function(t,e){return t+8*e},indexToXY:function(t){return{x:t%8,y:Math.floor(t/8)}},clamp:function(t,e,n){return t<e?e:t>n?n:void 0},isTikTok:function(){return cc.sys.BYTEDANCE_GAME===cc.sys.platform}},n.util=window.ut,cc._RF.pop()},{}],ViewCtrlMgr:[function(t,e,n){"use strict";cc._RF.push(e,"7b762tQD0JATLLljp2IsxGT","ViewCtrlMgr");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../base/BasePnlCmpt"),c=t("../event/CoreEventType"),l=t("../utils/ResLoader"),u=function(){function t(){this.node=null,this.caches=new Map,this.opened=[],this.masks=[],this.loadQueues=[],this.loadId=0,this.shop_buttom_uis=[],this.deletes=[],this._ad=null}return Object.defineProperty(t.prototype,"ad",{get:function(){return this._ad||(this._ad=mc.modelMgr.get("ad"))},enumerable:!1,configurable:!0}),t.prototype.getOpened=function(){return this.opened},t.prototype.addLoadQueue=function(t){return this.loadQueues.add({id:++this.loadId,name:t,url:""})},t.prototype.hasLoadQueue=function(t){return this.loadQueues.has("name",t)},t.prototype.__load=function(t,e){return r(this,void 0,void 0,function(){var n,o,r,a,s,c,u;return i(this,function(i){switch(i.label){case 0:return n=null,o="",r="",a=t.split("/"),s=a[0],c=a[1],l.loader.error=!1,c?[3,4]:(u=ut.initialUpperCase(s).replace("Pnl",""),r=mc.currWindName,e.url=o="view/"+r+"/"+u+"Pnl",[4,l.loader.loadRes(o,cc.Prefab)]);case 1:return(n=i.sent())?[3,3]:(r="common",e.url=o="view/"+r+"/"+u+"Pnl",[4,l.loader.loadRes(o,cc.Prefab)]);case 2:n=i.sent(),i.label=3;case 3:return[3,6];case 4:return u=ut.initialUpperCase(c).replace("Pnl",""),r=s,e.url=o="view/"+r+"/"+u+"Pnl",[4,l.loader.loadRes(o,cc.Prefab)];case 5:n=i.sent(),i.label=6;case 6:return l.loader.error=!0,this.loadQueues.remove("id",e.id)||(n=null),[2,Promise.resolve({mod:r,url:o,pfb:n})]}})})},t.prototype.__loadPnl=function(t,e){return r(this,void 0,Promise,function(){var n,o,r,a,c,l,u;return i(this,function(i){switch(i.label){case 0:return t&&"string"==typeof t?[4,this.__load(t,e)]:[2,Promise.resolve(null)];case 1:return n=i.sent(),o=n.mod,r=n.url,(a=n.pfb)?(c=cc.instantiate2(a,this.node),l=c.name+"Ctrl",cc.js.getClassByName(l)?((u=c.getComponent(l))||(u=c.addComponent(l)),u&&u instanceof s.default?(u.key=t,u.moudleName=o,u.url=r,u._isLoadedProperty||(lplog.error("load pnl error! not load property. at="+l),u.loadProperty()),c.active=!1,[4,u.__create()]):(lplog.error("loadPnl error! not found class "+l),[2,Promise.resolve(null)])):(lplog.error("loadPnl error! not found class "+l),[2,Promise.resolve(null)])):[2,Promise.resolve(null)];case 2:return i.sent(),this.caches.set(r,u),[2,Promise.resolve(u)]}})})},t.prototype.__getForCache=function(t){if(!t||"string"!=typeof t)return null;var e=t.split("/"),n=e[0],o=e[1],r=null;if(o)i=ut.initialUpperCase(o).replace("Pnl",""),r=this.caches.get("view/"+n+"/"+i+"Pnl");else{var i=ut.initialUpperCase(n).replace("Pnl","");(r=this.caches.get("view/"+mc.currWindName+"/"+i+"Pnl"))||(r=this.caches.get("view/common/"+i+"Pnl"))}return r},t.prototype.preloadPnl=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return(e=this.__getForCache(t))||this.hasLoadQueue(t)?[3,2]:[4,this.__loadPnl(t,this.addLoadQueue(t))];case 1:e=n.sent(),n.label=2;case 2:return[2,e]}})})},t.prototype.pushPnl=function(t){var e;this.opened.remove("url",t.url);var n=(null===(e=this.opened.find(function(t){return"shop/Shop"===t.key||"shop/ShopInland"===t.key}))||void 0===e?void 0:e.node.zIndex)||0;n&&(n+=2),"shop/Shop"!==t.key&&"shop/ShopInland"!==t.key||(this.shop_buttom_uis=this.opened.map(function(t){return t.key})),this.opened.push(t);for(var o=0,r=this.opened.length;o<r;o++){var i=this.opened[o],a=n;("shop/Shop"===i.key||"shop/ShopInland"===i.key||"common/Top"===i.key||"common/UI"===i.key||"common/Bottom"===i.key||"common/UnlockNpcTip"===i.key||"common/UnlockRoleTip"===i.key||"common/GetFavTip"===i.key||"common/Offline"===i.key||this.shop_buttom_uis.has(i.key))&&(a=0);var s=a+(i.Index||10*o);i.node&&(i.node.zIndex=s),i.mask&&(i.mask.zIndex=s-1)}this.opened.sort(function(t,e){return t.node.zIndex-e.node.zIndex})},t.prototype.popPnl=function(t){"shop/Shop"!==t.key&&"shop/ShopInland"!==t.key||(this.shop_buttom_uis=[]),this.opened.remove("url",t.url),this.opened.sort(function(t,e){return t.node.zIndex-e.node.zIndex})},t.prototype.getMask=function(t){var e=this.masks.pop()||cc.instantiate(assetsMgr.getPrefab("PNL_MASK"));e.parent=this.node,e.active=!0,e.zIndex=t.node.zIndex-1,t.mask=e},t.prototype.putMask=function(t){t&&t.mask&&(t.mask.parent=null,this.masks.push(t.mask),t.mask=null)},t.prototype.playShowAction=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return(e=t.Component(cc.Widget))&&e.enabled&&(e.updateAlignment(),e.enabled=!1),t.node.scale=.4,cc.tween(t.node).to(.25,{scale:1},{easing:cc.easing.backOut}).start(),[4,ut.wait(.25)];case 1:return n.sent(),mc.lockTouch(!1),[2]}})})},t.prototype.getTopPnl=function(){for(var t=this.opened.length-1;t>=0;t--){var e=this.opened[t];if("common/Top"!==e.key)return e}return null},t.prototype.adaptRootSize=function(t,e){if(!t)return e&&this.ad.hideAllBannerAd();var n=t.Child("root")||t.Child("root_n");if(!n)return e&&this.ad.hideAllBannerAd();var o=n._oy;void 0===o&&(o=n._oy=n.y);var r=e&&this.ad.checkBannerAd(t.adIndex,n)||{offsetY:0,maxAdaptScale:1.2};n.y=o+r.offsetY;var i=cc.winSize,a=cc.view.getDesignResolutionSize(),s=n.getContentSize(),c=s.width/a.width*i.width/s.width,l=i.height-t.adaptHeight;s.height*c>l&&(c=l/s.height),(c=Math.min(r.maxAdaptScale,c))!==n.scale&&(n.scale=c,t.__rootScaleChange())},t.prototype.show=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return r(this,void 0,Promise,function(){var n,o;return i(this,function(r){switch(r.label){case 0:return mc.lockTouch(!0),n=null,"string"!=typeof t?[3,3]:(n=this.__getForCache(t))||this.hasLoadQueue(t)?[3,2]:((o=this.addLoadQueue(t)).params=e,eventMgr.emit(c.default.LOAD_BEGIN_PNL,o),[4,this.__loadPnl(t,o)]);case 1:n=r.sent(),eventMgr.emit(c.default.LOAD_END_PNL,o),r.label=2;case 2:return[3,4];case 3:if(!t.isValid||!t.checkValid())return[2,this.show.apply(this,a([t.key],e))];n=t,r.label=4;case 4:return n?(this.deletes.has(n)&&this.deletes.remove(n),n.getActive()?mc.lockTouch(!1):(this.pushPnl(n),n.setActive(!0),n.setOpacity(255),n.needDark&&this.getMask(n),n.__enter.apply(n,e),this.adaptRootSize(n,this.getTopPnl()==n),eventMgr.emit(c.default.PNL_ENTER,n),n.needAction?this.playShowAction(n):(n.node.scale=1,mc.lockTouch(!1))),[2,Promise.resolve(n)]):(mc.lockTouch(!1),[2,Promise.resolve(null)])}})})},t.prototype.hide=function(t){var e=t instanceof s.default?t:this.__getForCache(t);if(e&&cc.isValid(e.node,!0)){var n=this.getTopPnl();this.popPnl(e),this.putMask(e),e.getActive()&&(e.__remove(),e.setActive(!1),eventMgr.emit(c.default.PNL_LEAVE,e)),n==e&&this.adaptRootSize(this.getTopPnl(),!0),e.isClean&&e.isHideClean&&e.checkValid()&&!this.deletes.has(e)&&(this.deletes.push(e),this.deleteNextFrame())}},t.prototype.deleteNextFrame=function(){return r(this,void 0,void 0,function(){var t=this;return i(this,function(e){switch(e.label){case 0:return[4,ut.waitNextFrame()];case 1:return e.sent(),this.deletes.forEach(function(e){e.checkValid()&&(e.__clean(),e.node.destroy(),t.caches.delete(e.url),l.loader.releaseRes(e.url,cc.Prefab))}),this.deletes.length=0,[2]}})})},t.prototype.hideAll=function(t,e){var n=this;if(t)t.split("|").forEach(function(t){return n.hide(t)});else{var o=e?e.split("|"):[];this.caches.forEach(function(t){return-1===o.indexOf(t.key)&&n.hide(t)})}},t.prototype.clean=function(t){var e=t instanceof s.default?t:this.__getForCache(t);e&&e.isClean&&cc.isValid(e.node,!0)&&(this.hide(e),!this.deletes.has(e)&&e.checkValid()&&(e.__clean(),e.node.destroy(),this.caches.delete(e.url),l.loader.releaseRes(e.url,cc.Prefab)))},t.prototype.cleanAll=function(t){var e=this;t?t.split("|").forEach(function(t){e.clean(t),e.giveupLoadByName(t)}):(this.caches.forEach(function(t){return e.clean(t)}),this.cleanLoadQueue())},t.prototype.cleanByMod=function(t){var e=this;this.caches.forEach(function(n){return n.moudleName===t&&e.clean(n)})},t.prototype.cleanAllUnused=function(t){var e=this;this.caches.forEach(function(t){return!t.getActive()&&e.clean(t)}),t&&this.cleanLoadQueue()},t.prototype.cleanLoadQueue=function(){for(;this.loadQueues.length>0;)l.loader.giveupLoad(this.loadQueues.pop().url)},t.prototype.giveupLoadByName=function(t){var e=this.loadQueues.remove("name",t);e&&l.loader.giveupLoad(e.url)},t.prototype.giveupLoadById=function(t){var e=this.loadQueues.remove("id",t);e&&l.loader.giveupLoad(e.url)},t.prototype.setPnlOpts=function(t,e){var n;null===(n=this.__getForCache(t))||void 0===n||n.setParam(e)},o([ut.addLock],t.prototype,"deleteNextFrame",null),t}();n.default=u,cc._RF.pop()},{"../base/BasePnlCmpt":"BasePnlCmpt","../event/CoreEventType":"CoreEventType","../utils/ResLoader":"ResLoader"}],ViewHelper:[function(t,e,n){"use strict";cc._RF.push(e,"d7769eBkKxF1YXHywafMCu6","ViewHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.viewHelper=void 0;var a=t("../event/NetEvent"),s=t("../event/NotEvent"),c=t("../LocalConfig"),l=t("./GameHelper"),u=t("./ResHelper"),p=function(){function t(){this.readyShowPnls=[]}return t.prototype.gotoWind=function(t,e){eventMgr.emit(mc.Event.GOTO_WIND,t,e)},t.prototype.changeWind=function(t,e){var o;mc.currWindName===e&&(null===(o=mc.currWind)||void 0===o||o.setParam({isClean:!0})),l.gameHelper.cleanByMemoryWarning(!0),n.viewHelper.gotoWind(t)},t.prototype.delayEnterWind=function(t,e){return o(this,void 0,void 0,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return n=Date.now(),eventMgr.emit(mc.Event.LOAD_BEGIN_WIND),[4,this.preloadWind(t)];case 1:return r.sent(),(o=e-.001*(Date.now()-n))>0?[4,ut.wait(o)]:[3,3];case 2:r.sent(),r.label=3;case 3:return eventMgr.emit(mc.Event.LOAD_END_WIND),eventMgr.emit(mc.Event.GOTO_WIND,t),[2]}})})},t.prototype.preloadWind=function(t,e){return o(this,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(n){return eventMgr.emit(mc.Event.PRELOAD_WIND,t,n,e)})]})})},t.prototype.preloadPnl=function(t,e){return o(this,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(n){return eventMgr.emit(mc.Event.PRELOAD_PNL,t,n,e)})]})})},t.prototype.showPnl=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return o(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return this.addReadyShowPnl(t),[4,new Promise(function(n){return eventMgr.emit.apply(eventMgr,i([mc.Event.OPEN_PNL,t,n],e))})];case 1:return[2,n.sent()]}})})},t.prototype.addReadyShowPnl=function(t){var e=t instanceof mc.BasePnlCmpt?t.key:t;this.readyShowPnls.has(e)||this.readyShowPnls.push(e)},t.prototype.setPnlOpts=function(t,e){eventMgr.emit(mc.Event.SET_PNL_OPTS,t,e)},t.prototype.isHasOpenPnl=function(){return this.readyShowPnls.length>3},t.prototype.hidePnl=function(t){eventMgr.emit(mc.Event.HIDE_PNL,t)},t.prototype.showAlert=function(t,e){eventMgr.emit(s.default.OPEN_ALERT,t,e||{})},t.prototype.showLoading=function(){eventMgr.emit(s.default.SHOW_LOADING)},t.prototype.hideLoading=function(){eventMgr.emit(s.default.HIDE_LOADING)},t.prototype.showMessageBox=function(t,e,n,o){"toast.net_error"===t&&l.gameHelper.isShowLoading||eventMgr.emit(s.default.OPEN_MESSAGE_BOX,t,e,n,o)},t.prototype.showNet=function(){eventMgr.emit(a.default.NET_REQ_BEGIN)},t.prototype.hideNet=function(){eventMgr.emit(a.default.NET_REQ_END)},t.prototype.showLoadingWait=function(t){t?eventMgr.emit(s.default.SHOW_LOADING):eventMgr.emit(s.default.HIDE_LOADING)},t.prototype.updateUnfoldList=function(t,e,n){for(var o=e=n?0:e,r=t.length;o<r;o++)t[o].active=n},t.prototype.adaptNodeSize13=function(t,e,n){this.adaptNodeSize(t,e,n,1.3)},t.prototype.adaptNodeSize=function(t,e,n,o){var r=Math.min(n.width/e.width,o),i=Math.floor(r*e.height);i<=n.height?(t.width=Math.floor(r*e.width),t.height=i):(r=Math.min(n.height/e.height,o),t.width=Math.floor(r*e.width),t.height=Math.floor(r*e.height))},t.prototype.adaptSpineSize=function(t,e,n,o){void 0===o&&(o=1.3),n=n||t.getContentSize();var r=e.width/n.width;n.height*r>e.height&&(r=e.height/n.height),t.scale=Math.min(r,o)},t.prototype.changeNodeChildrenToNode=function(t,e){if(t&&e)for(var n=t.childrenCount-1;n>=0;n--)t.children[n].parent=e},t.prototype.updateBuildStock=function(t,e){t&&this.updateBuildStockByArr(t.children,e)},t.prototype.updateBuildStockByArr=function(t,e){if(t&&e&&0!==t.length){var n=Math.floor((1-e.curr/e.max)*t.length),o=t.filter(function(t){return!t.active}).length,r=!0;if(n<o)n=o-n;else{if(!(n>o))return;n-=o,r=!1}for(var i=t.length-1;i>=0&&n>0;i--){var a=t[i];r!==a.active&&(a.active=r,n-=1)}}},t.prototype.releaseNode=function(t){t&&(t.getComponentsInChildren(cc.Sprite).forEach(function(t){t.spriteFrame&&t.spriteFrame.isValid&&(t.spriteFrame.decRef(),t.spriteFrame=null)}),t.destroy())},t.prototype.setGrayMaterial=function(t,e){var n;null===(n=t.getComponent(cc.Sprite))||void 0===n||n.setMaterial(0,u.resHelper.get2dSpriteMaterial(e));for(var o=t.childrenCount,r=0;r<o;r++)this.setGrayMaterial(t.children[r],e)},t.prototype.hideMainUI=function(t){l.gameHelper.global.setHideMainUI(t),mc.getOpenPnls().forEach(function(e){"common/UI"!==e.key&&"common/Top"!==e.key||(e.node.opacity=t?0:255)})},t.prototype.goToWindAndPnl=function(t,e,i){return o(this,void 0,void 0,function(){return r(this,function(o){switch(o.label){case 0:return mc.currWindName==t?[3,2]:(eventMgr.emit(mc.Event.LOAD_BEGIN_WIND),[4,n.viewHelper.preloadWind(t)]);case 1:o.sent(),eventMgr.emit(mc.Event.LOAD_END_WIND),eventMgr.emit(mc.Event.GOTO_WIND,t),o.label=2;case 2:return[4,n.viewHelper.showPnl(e,i)];case 3:return o.sent(),[2]}})})},t.prototype.exitShopinalnd=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(n){switch(n.label){case 0:return(null==(t=l.gameHelper.getLastSceneInfo())?void 0:t.s)?(e=t.s)===mc.currWindName?[3,2]:[4,this.goToWindAndPnl(e,t.u)]:[3,3];case 1:n.sent(),n.label=2;case 2:return this.hidePnl("shop/ShopInland"),l.gameHelper.setLastSceneInfo(null),[3,4];case 3:l.gameHelper.setLastSceneInfo(null),l.gameHelper.gotoWind("main"),n.label=4;case 4:return[2]}})})},t}();n.viewHelper=new p,(c.localConfig.isGm||c.localConfig.isTestServer)&&(window.viewHelper=n.viewHelper),cc._RF.pop()},{"../LocalConfig":"LocalConfig","../event/NetEvent":"NetEvent","../event/NotEvent":"NotEvent","./GameHelper":"GameHelper","./ResHelper":"ResHelper"}],WBHelper:[function(t,e,n){"use strict";cc._RF.push(e,"f5f19OzKJtO7J5kh9mdb9eG","WBHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.wbHelper=void 0;var i=t("../event/JsbEvent"),a=function(){function t(){}return t.prototype.nativeShare=function(t){return o(this,void 0,void 0,function(){var e,n,o;return r(this,function(r){switch(r.label){case 0:return[4,Promise.race([jsbHelper.call(i.default.WEIBO_SHARE,t),this.onShow()])];case 1:return e=r.sent()||{result:"success"},n=e.result,o=e.message,[2,{result:"success"===n,message:o}]}})})},t.prototype.onShow=function(){var t=this;return new Promise(function(e){var n=function(){cc.game.off(cc.game.EVENT_SHOW,n,t),e()};cc.game.on(cc.game.EVENT_SHOW,n,t)})},t}();n.wbHelper=new a,cc._RF.pop()},{"../event/JsbEvent":"JsbEvent"}],WeakGuideFingerCmpt:[function(t,e,n){"use strict";cc._RF.push(e,"7568elXXv5CCJCvgw5BrClI","WeakGuideFingerCmpt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../common/event/EventType"),s=t("../../common/helper/AnimHelper"),c=cc._decorator,l=c.ccclass,u=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clickBg=null,e.isAutoRemove=!1,e}return r(e,t),e.prototype.start=function(){this.clickBg||(this.clickBg=this.FindChild("click"),this.register())},e.prototype.setAutoRemove=function(t){this.isAutoRemove=t},e.prototype.register=function(){this.clickBg.on(cc.Node.EventType.TOUCH_START,this.onTouchEnd,this),this.clickBg.SetSwallowTouches(!1)},e.prototype.onTouchEnd=function(){this.isAutoRemove&&(s.animHelper.removeWeakGuideFinger(),eventMgr.emit(a.default.SET_UI_FOCUS_TARGET_ID,null))},i([l],e)}(cc.Component));n.default=u,cc._RF.pop()},{"../../common/event/EventType":"EventType","../../common/helper/AnimHelper":"AnimHelper"}],WifiHelper:[function(t,e,n){"use strict";cc._RF.push(e,"ee266QwvR5MYIsfSjgCY3L7","WifiHelper"),Object.defineProperty(n,"__esModule",{value:!0}),n.wifiHelper=void 0;var o=function(){};n.default=o,n.wifiHelper=new o,window.wifiHelper=n.wifiHelper,cc._RF.pop()},{}],WindCtrlMgr:[function(t,e,n){"use strict";cc._RF.push(e,"eb804ZmyxpIU6KaNRbfkeC3","WindCtrlMgr");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i=t("../base/BaseWindCmpt"),a=t("../event/CoreEventType"),s=t("../utils/ResLoader"),c=function(){function t(){this.node=null,this.currWind=null,this.nextWind=null,this.caches=new Map,this.isLockGoto=!1}return t.prototype.cleanCacheWind=function(){this.caches.forEach(function(t,e){var n=t.getComponent(ut.initialUpperCase(e)+"WindCtrl");n.isAutoReleaseSprite&&n.__needLoadSprite&&n.resotreAllSprites(),n.__clean(),t.destroy(),assetsMgr.releaseTempResByTag(e),s.loader.releaseRes("view/"+e+"/"+ut.initialUpperCase(e)+"Wind",cc.Prefab)}),this.caches.clear()},t.prototype.load=function(t,e){return o(this,void 0,void 0,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return n=0,[4,s.loader.loadRes("view/"+t+"/"+ut.initialUpperCase(t)+"Wind",cc.Prefab,function(t,o){e&&(e(t,2*o),o>n&&(n=o))})];case 1:return(o=r.sent())?[2,this.ready(cc.instantiate(o),t,o,function(t){e&&e(n+n*t,2*n)})]:[2,lplog.error("\u52a0\u8f7d\u573a\u666f\u51fa\u9519","view/"+t+"/"+ut.initialUpperCase(t)+"Wind")]}})})},t.prototype.putWind=function(t){audioMgr.releaseByMod(t.key),eventMgr.emit(a.default.CLOSE_ALL_PNL),t.__leave(),t.isClean||assetsMgr.isLowMemory(3)?(t.__clean(),t.node.destroy(),assetsMgr.releaseTempResByTag(t.key),s.loader.releaseRes("view/"+t.key+"/"+ut.initialUpperCase(t.key)+"Wind",cc.Prefab)):(t.isAutoReleaseSprite&&(t.disposeAllSprites(),t.__needLoadSprite=!0),t.node.parent=null,this.caches.set(t.key,t.node))},t.prototype.ready=function(t,e,n,a){return o(this,void 0,void 0,function(){var o,s,c;return r(this,function(r){switch(r.label){case 0:return o=ut.initialUpperCase(e)+"WindCtrl",cc.js.getClassByName(o)&&(s=t.getComponent(o)||t.addComponent(o))&&s instanceof i.default?(n&&s.initPrefab(n),t.parent=this.node,this.nextWind=s,this.nextWind.key=e,this.nextWind.node.zIndex=0,s._isLoadedProperty||(lplog.error("load wind error! not load property. at="+o),s.loadProperty()),s.setActive(!1),c=this.caches.delete(e),s.isAutoReleaseSprite&&s.__needLoadSprite?(s.__needLoadSprite=!1,[4,s.whenSpritesLoaded()]):[3,2]):(lplog.error("load wind error! not found class "+o),[2,Promise.resolve()]);case 1:r.sent(),r.label=2;case 2:return c?[3,4]:[4,s.__create(a)];case 3:r.sent(),r.label=4;case 4:return[4,s.__ready()];case 5:return r.sent(),[2]}})})},t.prototype.show=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.nextWind&&(this.currWind&&this.putWind(this.currWind,this.nextWind),this.nextWind.key,ut.waitNextFrame(2).then(function(){cc.sys.garbageCollect()}),this.currWind=this.nextWind,this.nextWind=null,this.currWind.setActive(!0),this.currWind.node.zIndex=10,(t=this.currWind).__enter.apply(t,e),eventMgr.emit(a.default.WIND_ENTER,this.currWind))},t.prototype.preLoad=function(t,e,n){return o(this,void 0,void 0,function(){var o,i,a;return r(this,function(r){switch(r.label){case 0:return this.currWind&&this.currWind.key===t||this.nextWind&&this.nextWind.key===t?(e&&e(1,1),n&&n(),[2]):(o=0,i=1,(a=this.caches.get(t))?[4,this.ready(a,t)]:[3,2]);case 1:return r.sent(),[3,4];case 2:return[4,this.load(t,function(t,n){o=t,i=n+1,e&&e(o,i)})];case 3:r.sent(),r.label=4;case 4:return o=i,e&&e(o,i),n&&n(),[2]}})})},t.prototype.goto=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return o(this,void 0,void 0,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return this.isLockGoto?[2]:this.currWind&&this.currWind.key===t?[2,(o=this.currWind).__enter.apply(o,e)]:this.nextWind&&this.nextWind.key===t?[2,this.show.apply(this,e)]:(this.isLockGoto=!0,mc.lockTouch(!0),(n=this.caches.get(t))?(eventMgr.emit(a.default.LOAD_BEGIN_SPRITE),[4,this.ready(n,t)]):[3,2]);case 1:return r.sent(),eventMgr.emit(a.default.LOAD_END_SPRITE),[3,4];case 2:return eventMgr.emit(a.default.LOAD_BEGIN_WIND,t),[4,this.load(t)];case 3:r.sent(),eventMgr.emit(a.default.LOAD_END_WIND,t),r.label=4;case 4:return this.show.apply(this,e),mc.lockTouch(!1),this.isLockGoto=!1,[2]}})})},t}();n.default=c,cc._RF.pop()},{"../base/BaseWindCmpt":"BaseWindCmpt","../event/CoreEventType":"CoreEventType","../utils/ResLoader":"ResLoader"}],WxAppHelper:[function(t,e,n){"use strict";cc._RF.push(e,"fc128FJUlFET7eJkftruJFb","WxAppHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.wxAppHelper=void 0;var i=t("../net/netMgr"),a=t("../event/JsbEvent"),s=t("../LocalConfig"),c=function(){function t(){}return t.prototype.nativeLogin=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(n){switch(n.label){case 0:return t={scope:"snsapi_userinfo",state:ut.getRandomString(16)},[4,jsbHelper.call(a.default.WX_APP_LOGIN,t)];case 1:return"success"==(e=n.sent()||{}).result&&e.code?[2,{code:e.code}]:[2,{errcode:e.errcode||-10086}]}})})},t.prototype.shareToTimeLine=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return t.imgUrl.startsWith("http")?[4,this.callShare(a.default.WX_SHARE_LINK,t)]:[3,2];case 1:return[2,(e.sent()||{result:!1}).result];case 2:return[4,this.shareImage(t.imgUrl)];case 3:return[2,(e.sent()||{result:!1}).result]}})})},t.prototype.shareMiniGame=function(t,e,n){return o(this,void 0,void 0,function(){var o,c,l;return r(this,function(){return o=i.netMgr.encodeURIObj(n,!0),c=0,s.localConfig.release||(c=1),l={title:t,miniprogramType:c,imgUrl:e,path:o},[2,this.callShare(a.default.WX_SHARE_MINIGAME,l)]})})},t.prototype.callShare=function(t,e){return o(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:return[4,Promise.race([jsbHelper.call(t,e),this.onShow()])];case 1:return[2,n.sent()||{result:!0}]}})})},t.prototype.onShow=function(){var t=this;return new Promise(function(e){var n=function(){cc.game.off(cc.game.EVENT_SHOW,n,t),e()};cc.game.on(cc.game.EVENT_SHOW,n,t)})},t.prototype.shareImage=function(t,e){return void 0===e&&(e="timeLine"),o(this,void 0,void 0,function(){var n;return r(this,function(o){switch(o.label){case 0:return n={imgPath:t,scene:e},[4,Promise.race([jsbHelper.call(a.default.WX_SHARE_IMAGE,n),this.onShow()])];case 1:return[2,o.sent()||{result:!0}]}})})},t.prototype.savePhoto=function(t){return o(this,void 0,void 0,function(){var e;return r(this,function(n){switch(n.label){case 0:return e={imgPath:t},[4,jsbHelper.call(a.default.SAVE_PHOTO,e)];case 1:return[2,n.sent()]}})})},t.prototype.photoPermitStatus=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,jsbHelper.call(a.default.SAVE_PHOTO_PERMIT)];case 1:return[2,t.sent()]}})})},t.prototype.photoPermit=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,jsbHelper.call(a.default.PHOTO_PERMIT)];case 1:return[2,t.sent()]}})})},t}();n.wxAppHelper=new c,cc._RF.pop()},{"../LocalConfig":"LocalConfig","../event/JsbEvent":"JsbEvent","../net/netMgr":"netMgr"}],WxAsyncMethods:[function(t,e,n){"use strict";cc._RF.push(e,"52ecdPdmVBOyYVOdAoJ6WMD","WxAsyncMethods"),Object.defineProperty(n,"__esModule",{value:!0}),n.asyncMethods=void 0,n.asyncMethods=["canvasGetImageData","canvasPutImageData","canvasToTempFilePath","setEnableDebug","startAccelerometer","stopAccelerometer","getBatteryInfo","getClipboardData","setClipboardData","startCompass","stopCompass","addPhoneContact","startGyroscope","stopGyroscope","startBeaconDiscovery","stopBeaconDiscovery","getBeacons","startLocalServiceDiscovery","stopLocalServiceDiscovery","startDeviceMotionListening","stopDeviceMotionListening","getNetworkType","makePhoneCall","scanCode","getSystemInfo","vibrateShort","vibrateLong","getExtConfig","chooseLocation","getLocation","openLocation","chooseMessageFile","loadFontFace","chooseImage","previewImage","getImageInfo","saveImageToPhotosAlbum","compressImage","chooseVideo","saveVideoToPhotosAlbum","downloadFile","request","connectSocket","closeSocket","sendSocketMessage","uploadFile","login","checkSession","chooseAddress","authorize","addCard","openCard","chooseInvoice","chooseInvoiceTitle","getUserInfo","requestPayment","getWeRunData","showModal","showToast","hideToast","showLoading","hideLoading","showActionSheet","pageScrollTo","startPullDownRefresh","stopPullDownRefresh","setBackgroundColor","setBackgroundTextStyle","setTabBarBadge","removeTabBarBadge","showTabBarRedDot","hideTabBarRedDot","showTabBar","hideTabBar","setTabBarStyle","setTabBarItem","setTopBarText","saveFile","openDocument","getSavedFileList","getSavedFileInfo","removeSavedFile","getFileInfo","getStorage","setStorage","removeStorage","clearStorage","getStorageInfo","closeBLEConnection","closeBluetoothAdapter","createBLEConnection","getBLEDeviceCharacteristics","getBLEDeviceServices","getBluetoothAdapterState","getBluetoothDevices","getConnectedBluetoothDevices","notifyBLECharacteristicValueChange","openBluetoothAdapter","readBLECharacteristicValue","startBluetoothDevicesDiscovery","stopBluetoothDevicesDiscovery","writeBLECharacteristicValue","getHCEState","sendHCEMessage","startHCE","stopHCE","getScreenBrightness","setKeepScreenOn","setScreenBrightness","connectWifi","getConnectedWifi","getWifiList","setWifiList","startWifi","stopWifi","getBackgroundAudioPlayerState","playBackgroundAudio","pauseBackgroundAudio","seekBackgroundAudio","stopBackgroundAudio","getAvailableAudioSources","startRecord","stopRecord","setInnerAudioOption","playVoice","pauseVoice","stopVoice","getSetting","openSetting","getShareInfo","hideShareMenu","showShareMenu","updateShareMenu","checkIsSoterEnrolledInDevice","checkIsSupportSoterAuthentication","startSoterAuthentication","navigateBackMiniProgram","navigateToMiniProgram","setNavigationBarTitle","showNavigationBarLoading","hideNavigationBarLoading","setNavigationBarColor","redirectTo","reLaunch","navigateTo","switchTab","navigateBack","getUserInteractiveStorage","requestSubscribeSystemMessage"],cc._RF.pop()},{}],WxGameCenter:[function(t,e,n){"use strict";cc._RF.push(e,"e4e40Appr5LcakGVPc8FqDY","WxGameCenter");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../common/constant/Enums"),l=t("../../common/helper/GameHelper"),u=t("../event/EventType"),p=t("../helper/ViewHelper"),h=t("./WxHelper"),d=cc._decorator.ccclass,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timestamp=0,e.lastHeart=-1,e.first=!0,e.callback=null,e.gamecenter=null,e}return r(e,t),e.prototype.onLoad=function(){var t=this;try{if("undefined"==typeof wx||"undefined"==typeof wxPc||!wx.getSystemInfoSync||!ut.compareVersion("2.15.1",wx.getSystemInfoSync().SDKVersion))return;if(this.gamecenter||(this.gamecenter=new wxPc({x:10,y:.66*cc.view.getFrameSize().height,autoShow:!1})),!this.gamecenter||!this.gamecenter.on)return;this.gamecenter.on("ready",function(){t.init(),eventMgr.on(u.default.EVENT_HEART_CHANGE,t.onHeartChange,t),eventMgr.on(mc.Event.PNL_ENTER,t.updateWxGameCenter,t),eventMgr.on(mc.Event.PNL_LEAVE,t.updateWxGameCenter,t),h.wxHelper.setWxGameCenter(t),t.onHeartChange(l.gameHelper.getHeart())}),this.gamecenter.on("open",function(){t.first&&(t.first=!1,p.viewHelper.showLoadingWait(!1),t.callback&&t.callback(),t.callback=null)}),this.gamecenter.on("interact",function(e){if(e&&e.interactID)if(e.is_self)wx.showToast({icon:"none",title:"\u4e0d\u80fd\u540c\u610f\u81ea\u5df1\u7684\u9080\u8bf7\u54e6~"});else{var n=Number(e.interactID.split("|")[0]);if(e.interactID.split("|")[1])switch(t.gamecenter.close(),n){case c.ShareType.FRIEND:break;default:wx.showToast({icon:"none",title:"\u672a\u77e5\u6570\u636e\uff0c\u65e0\u6cd5\u540c\u610f\u9080\u8bf7"})}else wx.showToast({icon:"none",title:"\u6570\u636e\u9519\u8bef\uff0c\u65e0\u6cd5\u540c\u610f\u9080\u8bf7"})}}),this.gamecenter.on("error",function(){t.first&&p.viewHelper.showLoadingWait(!1)});try{this.gamecenter.setTabs(["chat","player","bulletin","voip"])}catch(e){lplog.upLog.setFilterMsg("wxgameCenter"),lplog.upLog.error(e)}}catch(e){this.gamecenter=null,lplog.upLog.setFilterMsg("wxgameCenter onLoad"),lplog.upLog.error(e)}},e.prototype.init=function(){},e.prototype.update=function(){},e.prototype.updateWxGameCenter=function(){if(this.gamecenter){for(var t=0,e=[],n=mc.getOpenPnls(),o=function(o){e.forEach(function(e){n[o]instanceof e&&t++})},r=0;r<n.length;r++)o(r);t>=n.length?this.gamecenter.show():this.gamecenter.hide()}},e.prototype.applyWxGameCenterFriend=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return this.gamecenter?l.gameHelper.now()-this.timestamp<1e4?(p.viewHelper.showAlert(assetsMgr.lang("toast.wx_game_center_fail")),[2]):(this.first?(p.viewHelper.showLoadingWait(!0),this.callback=this.applyWxGameCenterFriend.bind(this),this.gamecenter.open()):this.gamecenter.sendInteract({interactID:c.ShareType.FRIEND+"|"+l.gameHelper.user.getUid(),content:"\u55e8\uff5e\u4ea4\u4e2a\u670b\u53cb\u5427",buttonText:"\u540c\u610f",modalTitle:"",modalContent:"\u540d\u7247\u5df2\u53d1\u9001\u5230\u4e16\u754c\u804a\u5929"}).then(function(){t.timestamp=l.gameHelper.now(),t.gamecenter.open()}).catch(function(){wx.showToast({icon:"none",title:"\u53d1\u9001\u540d\u7247\u5230\u4e16\u754c\u804a\u5929\u5931\u8d25"})}),[2]):[2]})})},e.prototype.onHeartChange=function(t){-1==this.lastHeart&&(this.lastHeart=t)},i([d],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../../common/constant/Enums":"Enums","../../common/helper/GameHelper":"GameHelper","../event/EventType":"EventType","../helper/ViewHelper":"ViewHelper","./WxHelper":"WxHelper"}],WxHelper:[function(t,e,n){"use strict";cc._RF.push(e,"63b2es0nzlNwIX0KA01Uj7F","WxHelper");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.wxHelper=void 0;var i=t("../net/netMgr"),a=t("./WxPromise"),s=t("../helper/GameHelper"),c=t("./WxOpenData"),l=t("../helper/ViewHelper"),u=t("../constant/Enums"),p=t("../helper/CosHelper"),h=t("../event/EventType"),d=function(){function t(){this.systemInfo=null,this.buttons={},this.toAppBanner=null,this.gameCenter=null,this.serverList=[{url:""}],this.userInfo=null}return t.prototype.init=function(){var t=this;"undefined"!=typeof wx&&(null!=wx.onMemoryWarning&&wx.onMemoryWarning(function(){s.gameHelper.onMemoryWarning(),wx.triggerGC()}),c.wxOpenData.init(),wx.setMessageToFriendQuery&&wx.setMessageToFriendQuery({shareMessageToFriendScene:1}),wx.onShareMessageToFriend&&wx.onShareMessageToFriend(function(t){t.success||l.viewHelper.showAlert("\u9080\u8bf7\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")}),this.checkShareMessageToFriend(this.getEnterInfo()),wx.onShow(function(e){t.checkShareMessageToFriend(e),null!=wx.onUserCaptureScreen&&wx.onUserCaptureScreen(function(){eventMgr.emit(h.default.GAME_CAPTURE_SCREEN)})}),wx.onHide(function(){null!=wx.offUserCaptureScreen&&wx.offUserCaptureScreen(function(){})}),null!=wx.onUserCaptureScreen&&wx.onUserCaptureScreen(function(){eventMgr.emit(h.default.GAME_CAPTURE_SCREEN)}),p.cosHelper.init())},t.prototype.login=function(t){return o(this,void 0,void 0,function(){var e,o,a,s;return r(this,function(r){switch(r.label){case 0:return e=t.uid,(o=this.getLaunchInfo()).type===u.ShareType.MMJ&&(o.content=null),Object.assign(o,t),e?[3,2]:[4,this.getCode()];case 1:a=r.sent(),o.code=a,r.label=2;case 2:return n.wxHelper.isTest(),s="undefined"!=typeof qq?"login/qq":"login/wx",[4,i.netMgr.get(s,o)];case 3:return[2,r.sent()]}})})},t.prototype.getCode=function(t){return void 0===t&&(t=1e3),o(this,void 0,Promise,function(){var e;return r(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,9]),[4,wxPro.login()];case 1:return[2,n.sent().code];case 2:return e=n.sent(),ut.isWechatOrQQ()?[3,4]:(console.error("\u7f51\u9875\u7248\u4e0d\u652f\u6301\u8fde\u63a5\u6b63\u5f0f\u670d"),[4,ut.wait(5e3)]);case 3:n.sent(),n.label=4;case 4:return t>0?[4,ut.wait(.5)]:[3,7];case 5:return n.sent(),console.error("getCode retry",e),[4,this.getCode(t-1)];case 6:return[2,n.sent()];case 7:console.error("getCode fail",e),n.label=8;case 8:return[3,9];case 9:return[2]}})})},t.prototype.getLaunchInfo=function(){var t={};try{var e=wx.getLaunchOptionsSync().query;e&&Object.keys(e).length>0&&(t.launchInfo=e)}catch(n){lplog.error("getLaunchOptionsSync",n),lplog.upLog.error("getLaunchOptionsSync",n)}return t},t.prototype.getEnterInfo=function(){try{return"undefined"!=typeof qq?qq.getLaunchOptionsSync():wx.getEnterOptionsSync()}catch(t){return lplog.error("getEnterInfo",t),lplog.upLog.error("getEnterInfo",t),null}},t.prototype.checkSession=function(){return o(this,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(t){try{wx.checkSession({success:function(){t(0)},fail:function(){t(-1)}})}catch(e){t(-1)}})]})})},t.prototype.requirePrivacyAuthorize=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,wxPro.requirePrivacyAuthorize()];case 1:return t=n.sent(),console.log("requirePrivacyAuthorize",t),[3,3];case 2:return e=n.sent(),lplog.error(e),[2,!1];case 3:return[2]}})})},t.prototype.checkAuthorize=function(t){return void 0===t&&(t=["userInfo"]),o(this,void 0,void 0,function(){var e,n;return r(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,wxPro.getSetting()];case 1:return[2,(e=o.sent())&&e.authSetting&&t.every(function(t){return e.authSetting["scope."+t]})];case 2:return n=o.sent(),lplog.error(n),[2,!1];case 3:return[2]}})})},t.prototype.getUserInfo=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),t=void 0,"undefined"==typeof qq?[3,2]:this.userInfo?[2,this.userInfo]:[4,wxPro.getUserInfo({withCredentials:!0})];case 1:return t=n.sent(),[3,4];case 2:return[4,wxPro.getUserInfo()];case 3:t=n.sent(),n.label=4;case 4:return t&&(this.userInfo=t.userInfo),[2,t];case 5:return e=n.sent(),lplog.error(e),[3,6];case 6:return[2]}})})},t.prototype.getBaseUserInfo=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this.userInfo||t?[2,this.userInfo]:[4,this.getUserInfo()];case 1:return e.sent(),[2,this.userInfo]}})})},t.prototype.request=function(t,e){return void 0===e&&(e=3),o(this,void 0,void 0,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,wxPro.request(t)];case 1:return(n=r.sent()).data&&"string"==typeof n.data&&-1!=n.data.indexOf("html")?[2,null]:[2,n.data];case 2:return o=r.sent(),lplog.error(t.url,o),e>0?(ut.wait(.5),[2,this.request(t,e-1)]):[3,3];case 3:return[2]}})})},t.prototype.compareVersion=function(t){if("undefined"==typeof wx)return-1;var e=this.getSystemInfo().SDKVersion;if(!e||!t)return-1;for(var n=e.split("."),o=t.split("."),r=Math.max(n.length,o.length);n.length<r;)n.push("0");for(;o.length<r;)o.push("0");for(var i=0;i<r;i++){var a=parseInt(n[i]),s=parseInt(o[i]);if(a>s)return 1;if(a<s)return-1}return 0},t.prototype.getSystemInfo=function(){return this.systemInfo||(this.systemInfo=wx.getSystemInfoSync()),this.systemInfo},t.prototype.getRect=function(t){var e=t.getBoundingBoxToWorld();e.x-=5,e.y-=5,e.width+=10,e.height+=10;var n=cc.view.getFrameSize(),o=cc.winSize;return{height:e.height/o.width*n.width,width:e.width/o.width*n.width,left:e.x/o.width*n.width,top:n.height-(e.y+e.height)/o.height*n.height}},t.prototype.createGameClubButton=function(t,e){return this.createBtn("createGameClubButton",t,e)},t.prototype.createUserInfoButton=function(t,e){return this.createBtn("createUserInfoButton",t,e)},t.prototype.createFeedbackButton=function(t,e){return this.createBtn("createFeedbackButton",t,e)},t.prototype.createModalBtn=function(t,e,n){void 0===e&&(e="\u63d0\u793a"),void 0===n&&(n="\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002");var o=t.getComponent(cc.Button);o||(o=t.addComponent(cc.Button)),t.on("click",function(){wx.showModal({title:e,content:n})})},t.prototype.createBtn=function(t,e,n){var o=this;if(!wx[t])return this.createModalBtn(e);var r=this.getRect(e),i=r.height,a=r.width,s=r.left,c=r.top;n=n||{type:"text",text:"",style:{left:s,top:c,width:a,height:i,lineHeight:0,backgroundColor:"",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}},"undefined"!=typeof qq&&(n.withCredentials=!0);var l=wx[t](n);return ut.waitNextFrame().then(function(){var t=o.getRect(e),n=t.left,r=t.top;l.style.left=n,l.style.top=r}),e.isValid?("undefined"!=typeof qq&&l.onTap(function(t){t.errMsg&&"ok"===t.errMsg.split(":")[1]&&(o.userInfo=t.userInfo)}),this.buttons[e.uuid]=l,l):void 0},t.prototype.destroyButton=function(t){var e=this.buttons[t];delete this.buttons[t],e&&e.destroy()},t.prototype.destroyAllButton=function(){for(var t in this.buttons)this.buttons[t].destroy();this.buttons={}},t.prototype.markScene=function(){wx.markScene&&wx.markScene({sceneId:0})},t.prototype.share=function(t,e,n,s){return void 0===n&&(n={}),void 0===s&&(s=!0),o(this,void 0,void 0,function(){var o,c;return r(this,function(r){switch(r.label){case 0:return o=i.netMgr.encodeURIObj(n),c=wx.uma||wx,s?(c.shareAppMessage({title:t,imageUrl:e,query:o}),[2,!0]):[3,1];case 1:return c.shareAppMessage({title:t,imageUrl:e,query:o}),[4,a.promisefyOnce(wx.onShow,wx.offShow)];case 2:return r.sent(),[2,!0]}})})},t.prototype.isTest=function(){return"undefined"!=typeof GameGlobal&&void 0!==GameGlobal.isTest&&GameGlobal.isTest},t.prototype.uploadScoce=function(t){return o(this,void 0,void 0,function(){var e,n,o,i;return r(this,function(r){switch(r.label){case 0:e=Math.floor((new Date).getTime()/1e3),o={wxgame:{score:t,update_time:e}},(n=[{key:"starSum",value:t+""}]).push({key:"starRank",value:JSON.stringify(o)}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,wxPro.setUserCloudStorage({KVDataList:n})];case 2:return r.sent(),[3,4];case 3:return i=r.sent(),console.error("uploadDataToRank fail",i),[3,4];case 4:return[2]}})})},t.prototype.checkShareMessageToFriend=function(t){var e=(t||{}).query;e&&"1"==e.shareMessageToFriendScene&&c.wxOpenData.post("reciveInvite")},t.prototype.getUserInteractiveStorage=function(t){return o(this,void 0,void 0,function(){var e,n,o,a,s,c,l,u,p;return r(this,function(r){switch(r.label){case 0:t=t||["1"],r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Promise.all([wx.getUserInteractiveStorage({keyList:t}),this.getCode()])];case 2:return e=r.sent(),n=e[0],o=n.encryptedData,a=n.iv,s=e[1],[4,i.netMgr.get("decryptWxData",{encryptedData:o,iv:a,code:s})];case 3:return c=r.sent()||{status:-404},l=c.status,u=c.data,0==l?[2,u.kv_list||[]]:[3,5];case 4:return p=r.sent(),lplog.error("getUserInteractiveStorage error",p),[3,5];case 5:return[2]}})})},t.prototype.isAlwaysSubscribe=function(t){return o(this,void 0,void 0,function(){var e,n;return r(this,function(o){switch(o.label){case 0:if(!wx.getSetting)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,wx.getSetting({withSubscriptions:!0})];case 2:return(e=o.sent()).mainSwitch&&"accept"==e.itemSettings[t]?[2,!0]:[2,!1];case 3:return n=o.sent(),lplog.error("isAlwaysSubscribe",n),[3,4];case 4:return[2,!1]}})})},t.prototype.requestSubscribeMessage=function(t){var e;return o(this,void 0,void 0,function(){var n,o,i,a,s,c;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),"undefined"==typeof qq?[3,2]:(n=new Promise(function(e,n){qq.subscribeAppMsg({tmplIds:[t],subscribe:!0,success:function(t){e(t)},fail:function(t){n(t)}})}),o=new Promise(function(t){return setTimeout(t,1e4)}),[4,Promise.race([n,o])]);case 1:return(i=r.sent())&&"accept"==i[t]?[2,!0]:[2,!1];case 2:return wx.requestSubscribeMessage?[4,wx.requestSubscribeMessage({tmplIds:[t]})]:[2,!1];case 3:return"accept"==(a=r.sent())[t]?[2,!0]:(lplog.info("requestSubscribeMessage",a),[3,5]);case 4:return s=r.sent(),c=null!==(e=s.errCode)&&void 0!==e?e:-1e3,l.viewHelper.showAlert("toast.subscribe_fail",{params:[c]}),lplog.error("requestSubscribeMessage",s),[3,5];case 5:return[2,!1]}})})},t.prototype.navigateToMiniProgram=function(t,e){return o(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:if(!wx.navigateToMiniProgram)return[2,l.viewHelper.showAlert("\u8bf7\u5148\u5347\u7ea7\u5fae\u4fe1")];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,wx.navigateToMiniProgram({appId:t,path:e})];case 2:return[2,n.sent()];case 3:return n.sent(),[2,!1];case 4:return[2]}})})},t.prototype.isToAppBannerLoad=function(){return this.toAppBanner&&this.toAppBanner.isLoad},t.prototype.loadToAppBanner=function(){var t=this;if(!this.toAppBanner){var e;if(ut.isIos())e="adunit-f92323265793e281";else{if(!ut.isAndroid())return;e="adunit-d195ede7f99f8217"}var n=wx.createBannerAd({adUnitId:e,style:{left:0,top:0,width:320}});this.toAppBanner={adIns:n,isLoad:!1},n.onError(function(t){lplog.error("loadToAppBanner error",e,t)}),n.onLoad(function(){t.toAppBanner.isLoad=!0})}},t.prototype.shoowToAppBanner=function(t){if(!this.toAppBanner)return null;if(this.toAppBanner.isInit)return this.toAppBanner.adIns.show(),this.toAppBanner.adIns;this.toAppBanner.isInit=!0;var e=this.getRect(t),n=(e.height,e.width),o=e.left,r=e.top;n<300&&(o-=.5*(300-n),n=300);var i=this.toAppBanner.adIns;return i.style.left=o,i.style.top=r,i.style.width=n,i.onResize(function(){i.show()}),i},t.prototype.hideToAppBannerLoad=function(){return this.toAppBanner&&this.toAppBanner.adIns.hide()},t.prototype.getFileList=function(t){return o(this,void 0,void 0,function(){var e,n,i,a,s,c,l,u=this;return r(this,function(p){switch(p.label){case 0:return e=wx.getFileSystemManager(),n=[],i=0,a=0,s=performance.now(),c=function(t){return o(u,void 0,void 0,function(){return r(this,function(){return[2,new Promise(function(n){var o=performance.now();e.stat({path:t,success:function(e){var r=performance.now()-o;a+=r,i<r&&(i=r,console.log("stat",t,e.stats.size,r)),n(e.stats.isDirectory())},fail:function(e){console.error("isDir fail",t,e)}})})]})})},[4,(l=function(i){return new Promise(function(a){var s=performance.now();e.readdir({dirPath:i,success:function(e){return o(u,void 0,void 0,function(){var o,u,p,h;return r(this,function(r){switch(r.label){case 0:console.log("readdir",i,e.files.length,performance.now()-s),o=0,u=e.files,r.label=1;case 1:return o<u.length?(p=u[o],[4,c(h=i+"/"+p)]):[3,6];case 2:return r.sent()?[4,l(h)]:[3,4];case 3:return r.sent(),[3,5];case 4:n.push(h),t&&t(n.length),r.label=5;case 5:return o++,[3,1];case 6:return a(0),[2]}})})},fail:function(t){console.error("readdir fail",i,t),a(0)}})})})(wx.env.USER_DATA_PATH+"/gamecaches")];case 1:return p.sent(),console.log("done",n.length,a,performance.now()-s),[2,n]}})})},t.prototype.getWxGameCenter=function(){return this.gameCenter},t.prototype.setWxGameCenter=function(t){this.gameCenter=t},t.prototype.getWhatsNewSubscriptionsSetting=function(){return o(this,void 0,void 0,function(){var t,e;return r(this,function(n){switch(n.label){case 0:if(!wx.getSetting)return[2,!1];n.label=1;case 1:return n.trys.push([1,3,,4]),t="SYS_MSG_TYPE_WHATS_NEW",[4,wxPro.getSetting({withSubscriptions:!0})];case 2:return(e=n.sent())&&e.subscriptionsSetting&&e.subscriptionsSetting.itemSettings&&("accept"===e.subscriptionsSetting.itemSettings[void 0]||"accept"===e.subscriptionsSetting.itemSettings[t])?[2,!0]:[2,!1];case 3:return n.sent(),[2,!1];case 4:return[2]}})})},t.prototype.requestSubscribeSystemMessage=function(){return o(this,void 0,void 0,function(){var t,e,n,o;return r(this,function(r){switch(r.label){case 0:if(!wx.requestSubscribeSystemMessage)return[2,!1];r.label=1;case 1:return r.trys.push([1,3,,4]),t="SYS_MSG_TYPE_WHATS_NEW",[4,wxPro.requestSubscribeSystemMessage({msgTypeList:[t]})];case 2:return(e=r.sent())&&(n="ok"===e.errMsg.split(":")[1],o="accept"===e[t],n&&o)?[2,!0]:[2,!1];case 3:return r.sent(),[2,!1];case 4:return[2]}})})},t}();window.wxPro=a.promisifyAll(),n.wxHelper=new d,cc._RF.pop()},{"../constant/Enums":"Enums","../event/EventType":"EventType","../helper/CosHelper":"CosHelper","../helper/GameHelper":"GameHelper","../helper/ViewHelper":"ViewHelper","../net/netMgr":"netMgr","./WxOpenData":"WxOpenData","./WxPromise":"WxPromise"}],WxOpenData:[function(t,e,n){"use strict";cc._RF.push(e,"28c7dTn+fZC1az9GothU7Pr","WxOpenData");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.wxOpenData=void 0;var i=t("../event/EventType"),a=function(){function t(){}return t.prototype.init=function(){eventMgr.on(i.default.OPENID_CHANGE,this.setOpenID,this)},t.prototype.setOpenID=function(t){this.post("setOpenid",t)},t.prototype.updateViewPort=function(t){return o(this,void 0,void 0,function(){var e,n;return r(this,function(o){switch(o.label){case 0:return(e=wx.getOpenDataContext())?[4,ut.wait(.25)]:[3,2];case 1:if(o.sent(),!cc.isValid(t))return[2];(n=t.getWorldBox()).y=cc.winSize.height-n.height-n.y,e.postMessage({event:"updateViewPort",box:n,winSize:cc.winSize}),o.label=2;case 2:return[2]}})})},t.prototype.post=function(t,e){var n=wx.getOpenDataContext();n&&n.postMessage({event:t,data:e})},t}();n.wxOpenData=new a,cc._RF.pop()},{"../event/EventType":"EventType"}],WxPromise:[function(t,e,n){"use strict";cc._RF.push(e,"46d19otrKVG7KE8/wNluVxh","WxPromise");var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.promisefyOnce=n.promisifyAll=n.promisify=void 0;var r=t("./WxAsyncMethods");Promise.prototype.finally||(Promise.prototype.finally=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){throw n})})}),n.promisify=function(t){return function(e){return void 0===e&&(e={}),new Promise(function(n,r){t(o({fail:r,success:n},e))})}},n.promisifyAll=function(){if("undefined"!=typeof wx){var t={};return Object.keys(wx).forEach(function(e){r.asyncMethods.indexOf(e)>=0?t[e]=n.promisify(wx[e]):"createSignal"!==e&&(t[e]=wx[e])}),t}},n.promisefyOnce=function(t,e){return new Promise(function(n){var o=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(o),n.apply(void 0,t)};t(o)}).catch(function(t){throw t})},cc._RF.pop()},{"./WxAsyncMethods":"WxAsyncMethods"}],"cos-wx-sdk-v5":[function(t,e){"use strict";cc._RF.push(e,"bdeaayoNJlHtogKNZ+2jB6g","cos-wx-sdk-v5"),cc._RF.pop()},{}],netMgr:[function(t,e,n){"use strict";cc._RF.push(e,"150d3VOb95Jc4Gcnz2T/NPL","netMgr");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.netMgr=void 0;var a=t("../crypto/CryptoHelper"),s=t("../LocalConfig"),c=t("../wx/WxHelper"),l=t("./NetConfig"),u=t("../helper/DatabaseHelper"),p=t("../helper/GameHelper"),h=t("../event/EventType"),d=t("../../../core/utils/Utils"),f=t("../event/JsbEvent"),y=function(){function t(){this.serverInfoWaitPromise=null,this.lastServerId=0,this.lastLocalTime=0,this.serverDiffTime=0,this.gmOffsetTime=0,this.ganefDiffTime=0,this.requestMap={},this.serverList=[],this.serverTime=0,this.sessionId=null,this.ip=""}return t.prototype.init=function(){var t=u.dbHelper.register("net",1,this.toDB,this,Object.keys(this.toDB()))||{};this.initServer(),this.gmOffsetTime=t.gmOffsetTime||0,this.lastServerId=t.lastServerId||0,this.serverList[this.lastServerId]||(this.lastServerId=0),this.getHostAddress()},t.prototype.updateData=function(){var t=u.dbHelper.load("net",1);this.gmOffsetTime=t.gmOffsetTime||0},t.prototype.toDB=function(){return{gmOffsetTime:this.gmOffsetTime,lastServerId:this.lastServerId}},t.prototype.isFastReq=function(t){return"/"!=t[0]&&(t="/"+t),l.fastReqConfig[t]},t.prototype.get=function(t,e,n,o){return void 0===o&&(o=3),r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return this.isFastReq(t)?[2,this.fastRequest(t,e,"GET",n,o)]:[4,this.request(t,e,"GET",n,o)];case 1:return[2,r.sent()]}})})},t.prototype.post=function(t,e,n,o){return void 0===o&&(o=3),r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return this.isFastReq(t)?[2,this.fastRequest(t,e,"POST",n,o)]:[4,this.request(t,e,"POST",n,o)];case 1:return[2,r.sent()]}})})},t.prototype.initServer=function(){this.serverList=c.wxHelper.serverList},t.prototype.request=function(t,e,n,o,a){return void 0===a&&(a=3),r(this,void 0,void 0,function(){var u,h,d,f,y,_,g,m,v,b,w,S=this;return i(this,function(C){switch(C.label){case 0:for(y in"/"!=t[0]&&(t="/"+t),e=e||{},!1===(u=l.crpytoConifg[t])||u&&!1===u.req?p.gameHelper.user&&(d=p.gameHelper.user.getSessionId())&&(e.__sessionId=d):(h=p.gameHelper.user.getToken(),e.token&&e.token!=h&&lplog.error("token\u8fd9\u4e2a\u5b57\u6bb5\u5df2\u88ab\u5360\u7528"),e.token=h),!1===u||u&&!1===u.res||(e.__reqId?f=e.__reqId:(f=this.getReqId(),e.__reqId=f)),e)null==e[y]&&delete e[y];return _=function(){return r(S,void 0,void 0,function(){var r,u,p,h,d;return i(this,function(i){switch(i.label){case 0:return r=Date.now(),[4,this.getServerInfo(o)];case 1:return u=i.sent(),p=u.url+t,s.localConfig.isNetLog&&lplog.info("req - :",p,e),e=this.encryptReq(e,t),"undefined"==typeof wx?[3,3]:[4,c.wxHelper.request({url:p,data:e,method:n},a)];case 2:return h=i.sent(),[3,5];case 3:return d=l.timeoutConfig[t],[4,this.httpRequest(p,e,n,a,d)];case 4:h=i.sent(),i.label=5;case 5:return(h=this.decryptRes(h,t,f))&&h.nowTime&&this.updateServerTime(h.nowTime,Date.now()-r),[2,h]}})})},s.localConfig.openLog?[3,2]:[4,_()];case 1:return[2,C.sent()];case 2:return g=(new Date).getTime(),this.requestMap[t]||(this.requestMap[t]={__info:{time:g,count:0,frequeCnt:0}}),m=JSON.stringify(e),this.requestMap[t][m]||(this.requestMap[t][m]=_()),v=this.requestMap[t][m],b=this.requestMap[t].__info,g-b.time<3e3?b.frequeCnt++:b.frequeCnt=0,b.count++,(b.count>5||b.frequeCnt>10)&&lplog.error("too many requests",t,b.count,b.frequeCnt),[4,v];case 3:return w=C.sent(),b.count=0,b.time=(new Date).getTime(),b.request=null,this.requestMap[t].__info=b,delete this.requestMap[t][m],[2,w]}})})},t.prototype.fastRequest=function(t,e,n,o,a){return void 0===a&&(a=3),r(this,void 0,void 0,function(){var a,s,c,l=this;return i(this,function(){return a=[0,.4,1,2],s=!1,e.__reqId=this.getReqId(!0),c=0,[2,new Promise(function(u){for(var p=function(p){return r(l,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return[4,ut.wait(p)];case 1:return i.sent(),s?[2]:[4,this.request(t,e,n,o,1)];case 2:return r=i.sent(),s?[2]:++c>=a.length?(s=!0,u(r),[2]):(r&&-402!=r.status&&(s=!0,u(r)),[2])}})})},h=0,d=a;h<d.length;h++)p(d[h])})]})})},t.prototype.encryptReq=function(t,e){t=t||{};var n=l.crpytoConifg[e];return!1===n||n&&!1===n.req?t:a.cryptoHelper.pkEncrypt(JSON.stringify(t))},t.prototype.decryptRes=function(t,e,n){if(t){var o=l.crpytoConifg[e];if(!(!1===o||o&&!1===o.res)){var r=t.rawData,i=t.sign,s=t.status;if(-500==s||-400==s||-401==s||-402==s)return{status:s};if(a.cryptoHelper.pkVerify(r,i)){var c=JSON.parse(r);return c.__watermark==n?c:(lplog.error("\u6c34\u5370\u4e0d\u901a\u8fc7",e,c.__watermark,n,r),{status:4001})}return lplog.error("\u7b7e\u540d\u4e0d\u901a\u8fc7",e,r,i),lplog.upLog.error("\u7b7e\u540d\u4e0d\u901a\u8fc7",e,r,i),{status:4e3}}return t}},t.prototype.encodeURIObj=function(t,e){void 0===t&&(t={}),void 0===e&&(e=!1);var n=[],o="";for(var r in t)n.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return n.length>0&&(e&&(o+="?"),o+=n.join("&")),o},t.prototype.getReqId=function(t){return t?(e=p.gameHelper.user.getUid()||"test")+"_"+Date.now()+"_"+("test"==e?ut.getRandomString(50):ut.getRandomString(8)):(e=p.gameHelper.user.getUid()||"test").split("-")[0]+ut.getRandomString(8);var e},t.prototype.getUrl=function(t,e){return void 0===e&&(e={}),r(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return[4,this.getServerInfo()];case 1:return[2,n.sent().url+"/"+t+this.encodeURIObj(e,!0)]}})})},t.prototype.httpRequest=function(t,e,n,o,a){return void 0===o&&(o=3),void 0===a&&(a=6e3),r(this,void 0,void 0,function(){var r,s,c;return i(this,function(i){switch(i.label){case 0:r=null,"object"==typeof e&&("GET"==n?t+=this.encodeURIObj(e,!0):r=JSON.stringify(e)),this.getHostInfoByUrl(t),Date.now(),s=function(){return new Promise(function(e){var o=new XMLHttpRequest;o.open(n,t,!0),"POST"==n&&o.setRequestHeader("Content-Type","application/json"),o.timeout=a,o.ontimeout=function(){a*=1.5,lplog.error("http timeout",t),e(null)},o.onerror=function(){var n=o.responseErrorBuffer||"";lplog.error("http disconnect error: "+n,t),e(null)},o.onreadystatechange=function(){var n=o.responseText;if(4==o.readyState)if(200==o.status&&n)try{var r=JSON.parse(n);e(r)}catch(i){t.includes("errorReport")||n&&"string"==typeof n&&n.indexOf("html"),e(null)}else e(null)},o.send(r)})},i.label=1;case 1:return o>0?(o--,[4,s()]):[3,6];case 2:return(c=i.sent())?[2,c]:[3,3];case 3:return[4,ut.wait(.5)];case 4:i.sent(),i.label=5;case 5:return[3,1];case 6:return[2]}})})},t.prototype.getServerInfo=function(t){return r(this,void 0,Promise,function(){var e=this;return i(this,function(n){switch(n.label){case 0:return t?[2,t]:1==this.serverList.length?[2,this.serverList[0]]:(this.serverInfoWaitPromise||(this.serverInfoWaitPromise=r(e,void 0,void 0,function(){var t,e,n,o,a=this;return i(this,function(s){switch(s.label){case 0:if(t=this.lastServerId,this.serverList[t])return[3,5];e=function(t){return r(a,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return[4,this.get("getNowTime",t,this.serverList[t],1)];case 1:if((e=n.sent())&&e.nowTime)return[2,t];throw t}})})},n=-1,o=this.serverList.map(function(t,n){return e(n)}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.any(o)];case 2:return n=s.sent(),[3,4];case 3:return s.sent(),[3,4];case 4:this.lastServerId=n,s.label=5;case 5:return this.serverInfoWaitPromise=null,[2,this.serverList[this.lastServerId]]}})})),[4,this.serverInfoWaitPromise]);case 1:return[2,n.sent()]}})})},t.prototype.isNetConnect=function(){return r(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:if(!ut.isWechatOrQQ())return[3,5];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,wxPro.getNetworkType()];case 2:return"none"==e.sent().networkType?[2,!1]:[3,4];case 3:return t=e.sent(),lplog.error(t),[2,!1];case 4:return[3,6];case 5:return[2,this.getNetWorkType()>0];case 6:return[2,!0]}})})},t.prototype.getNetWorkType=function(){var t=0;return cc.sys.os==cc.sys.OS_IOS?t=jsb.reflection.callStaticMethod("jsbHelp","getNetWorkType"):ut.isAndroid()&&(t=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/JsbHelper","getNetWorkType","()I")),t},t.prototype.getHostAddress=function(t){return r(this,void 0,void 0,function(){var e,n,o;return i(this,function(r){switch(r.label){case 0:return[3,4];case 1:e=r.sent().url,r.label=2;case 2:return t=e,n=this.getHostInfoByUrl(t).hostname,Date.now(),[4,jsbHelper.call(f.default.GET_HOST_ADDRESS,{hostName:n})];case 3:(o=r.sent()).error,o.ip,r.label=4;case 4:return[2]}})})},t.prototype.getHostInfoByUrl=function(t){var e=/(http|https):\/\/([^:|\/|\?]*):?([0-9]*)?([^\?]*)?\??(\S*)/.exec(t)||[],n=(e[0],e[1]),o=e[2],r=e[3],i=e[4],a=e[5];return{protocol:n||"",hostname:o||"",port:r&&Number(r)||("https"==n?443:80),pathname:i||"/",params:a||""}},Object.defineProperty(t.prototype,"CDN_DOMAIN",{get:function(){if(p.gameHelper.isInland())return"https://twgame-hotel-1257666530.file.myqcloud.com";p.gameHelper.isGLobal()},enumerable:!1,configurable:!0}),t.prototype.updateServerTime=function(t,e){if(void 0===e&&(e=0),t){if(t<=this.serverTime)return;if(this.serverTime=t,this.lastLocalTime=Date.now(),this.serverDiffTime=t-this.lastLocalTime,e>5*ut.Time.Second)return;var n=this.ganefDiffTime;if(this.ganefDiffTime=this.serverDiffTime,0!=n&&this.ganefDiffTime+3e4<n){var o=Math.floor((n-this.ganefDiffTime)/3e4);storageMgr.changeNumber("timeGanef",Math.min(o,3))}}else lplog.error("error time!!!!! ")},t.prototype.getCacheTime=function(t){void 0===t&&(t=9e4);var e=Date.now()-this.lastLocalTime;return e>=0&&e<=t?this.getServerTime():null},t.prototype.syncServerTime=function(t){return r(this,void 0,Promise,function(){var e;return i(this,function(){return(e=this.getCacheTime(t))?[2,e]:[2,this.reqServerTime()]})})},t.prototype.reqServerTime=function(){return r(this,void 0,Promise,function(){var t,e;return i(this,function(n){switch(n.label){case 0:return t=Date.now(),[4,this.get("getNowTime")];case 1:return(e=n.sent())&&e.nowTime?(this.updateServerTime(e.nowTime,Date.now()-t),[2,e.nowTime+this.gmOffsetTime]):[2,0]}})})},t.prototype.getServerTime=function(){return Date.now()+this.serverDiffTime+this.gmOffsetTime},t.prototype.isTimeGoBack=function(){return!!this.lastLocalTime&&Date.now()-this.lastLocalTime<0},t.prototype.setGmOffsetTime=function(t){this.gmOffsetTime=t,eventMgr.emit(h.default.UPDATE_GM_OFFSET_TIME,t)},t.prototype.changeGmOffsetTime=function(t){this.setGmOffsetTime(this.gmOffsetTime+t)},t.prototype.getGmOffsetTime=function(){return this.gmOffsetTime},o([d.util.queueLast],t.prototype,"getHostAddress",null),t}();n.netMgr=new y,cc._RF.pop()},{"../../../core/utils/Utils":"Utils","../LocalConfig":"LocalConfig","../crypto/CryptoHelper":"CryptoHelper","../event/EventType":"EventType","../event/JsbEvent":"JsbEvent","../helper/DatabaseHelper":"DatabaseHelper","../helper/GameHelper":"GameHelper","../wx/WxHelper":"WxHelper","./NetConfig":"NetConfig"}]},{},["CCMvc","BaseCmpt","BaseLanguage","BaseLayerCmpt","BaseLogger","BaseModel","BaseNoticeCmpt","BasePnlCmpt","BaseViewCmpt","BaseWdtCmpt","BaseWindCmpt","ButtonEx","ButtonLongPress","CocosAssembler2D","EditBoxMaxLength","LabelAutoAdaptSize","LabelRollNumber","LabelTimer","LabelWaitDot","List","ListItem","LocaleLabel","LocaleRichText","LocaleSprite","MultiColor","MultiFrame","MultiFrameParticle","ScrollViewEx","CoreEventType","ExString","ExtendAnimation","ExtendArray","ExtendButton","ExtendCC","ExtendComponent","ExtendLabel","ExtendNode","ExtendPromise","ExtendScrollView","ExtendSprite","ExtendToggleContainer","ExtendVec","RKNoticeRootCmpt","RKViewRootCmpt","RKWindRootCmpt","AssetsMgr","AudioMgr","BannerAdMgr","HotUpdateMgr","LanguageMgr","ModelMgr","NoticeCtrlMgr","StorageMgr","ViewCtrlMgr","WindCtrlMgr","AtomicLock","Decorator","EncValue","EventManager","Logger","Observer","ResLoader","Utils","App","CameraCtrl","LoginCmpt","Table","LocalConfig","ResConfig","AdModel","BannerAd","EcpmLevelAd","GamePortalAd","GridAd","InterstitialAd","NativeAd","RewardAd","ShareAd","AppleHelper","AppsFlyerHelper","AutoReleaseCmt","Constant","DBCompat","DataType","Enums","LocalLang","StateConf","StateEnum","cos-wx-sdk-v5","ByteArrayMD5","CryptoHelper","CryptoJS","JSEncrypt","EventType","JsbEvent","NetEvent","NotEvent","FBInstantHelper","FacebookHelper","GoogleHelper","AStar","AbTestHelper","AnimHelper","CosHelper","DatabaseHelper","DatabaseHelperOld","EncHelper","GameHelper","GotoHelper","JsbHelper","MainSkinHelper","PerformanceHelper","ReddotHelper","ResHelper","ShareHelper","ShootHelper","SubscribeHelper","TaskHelper","TouchHelper","ViewHelper","WifiHelper","InstagramHelper","MessageHelper","NetConfig","netMgr","OpenInstallHelper","GlobalAppPayHelper","FlashLightShaderCtrl","ShareParamsHelper","TwitterHelper","WBHelper","WxAsyncMethods","WxGameCenter","WxHelper","WxOpenData","WxPromise","WxAppHelper","AdSkipCardModel","PropObj","BlockObj","ColorGemShapeObj","ColorShapeObj","GlobalModel","IItemObj","ShapeObj","UserModel","DigModel","TaskConditionObj","AdaptNodeSizeCmpt","AdaptWidthCmpt","AddLabelAutoAdaptSizeCmpt","CameraInertiaCmpt","ChitchatBoxCmpt","ClickTouchCmpt","DoubleEranAnimCmpt","FeedbackCmpt","FlashLightCmpt","FollowCameraScaleCmpt","IgnoreAutoReleaseSpriteCmpt","IgnoreFlashLightCmpt","LabelMaskCmpt","LockTouchCmpt","MapTouchCmpt","MessageBoxCmpt","PnlBgCmpt","ReddotCmpt","ReddotMultiCmpt","RelevancyNodeCmpt","RoleTouchCmpt","ScalingAnimCmpt","SceneMapBgCmpt","ScreenAdapterCmpt","ScrollViewInnerCmpt","ScrollViewOuterCmpt","SpineMountCmpt","TopTouchCmpt","TxShanCmpt","BlockCmpt","GemShapeCmpt","ShapeCmpt","CollectNode","CollectWindCtrl","HeartPnlCtrl","RewardPnlCtrl","SettingPnlCtrl","ShopPnlCtrl","DebugWindCtrl","DigWindCtrl","DrillWindCtrl","FailWindCtrl","FinishWindCtrl","GameWindCtrl","RevivePnlCtrl","GuidePnlCtrl","StoryPnlCtrl","WeakGuideFingerCmpt","LevelBootPnlCtrl","LevelRevivePnlCtrl","LevelSettingPnlCtrl","LevelWindCtrl","LostLifePnlCtrl","TargetDonePnlCtrl","TargetShowPnlCtrl","AuthTipPnlCtrl","AdPnlCtrl","BonusPnlCtrl","CheckPnlCtrl","MainWindCtrl","AlertNotCtrl","EventNotCtrl","LoadSpriteWaitNotCtrl","LoadingNotCtrl","NetWaitNotCtrl","PnlWaitNotCtrl","TopNotCtrl","RankWindCtrl","ResultWindCtrl","SpinWindCtrl"]);